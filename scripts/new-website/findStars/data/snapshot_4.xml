<?xml version="1.0" encoding="utf-8"?>
<HTTPSnapshot xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:xsd="http://www.w3.org/2001/XMLSchema" id="4">
  <HTTPTask id="449" hostname="g.alicdn.com" path="/alilog/oneplus/blk.html" url="https://g.alicdn.com/alilog/oneplus/blk.html" ip="124.239.162.241" port="443" connectionId="13" origin="Primary" frame="1" startDateTime="2019-06-12T18:56:39.004+08:00" startTime="295718" endTime="295750">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Accept" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9odG1sLCBhcHBsaWNhdGlvbi94aHRtbCt4bWwsIGltYWdlL2p4ciwgKi8q</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9zZWFyY2guZGFtYWkuY24vc2VhcmNoLmh0bWw/a2V5d29yZD0lRTUlOTElQTglRTYlOUQlQjAlRTQlQkMlQTYmc3BtPWEyb2VnLmhvbWUuc2VhcmNodHh0LmRzZWFyY2hidG4=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>emgtQ04=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Zy5hbGljZG4uY29t</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>X2xhc3R2aXNpdGVkPWdKdUhGUUpwWG5RQ0FjcDRDeHFaJTJGODVOJTJDJTJDZ0p1SEZRSnBYblFDQWNwNEN4cVo4NU4ySTd4bEJiZG4lMkNqd3N4aXJwMyUyQ2p3c3hpcnAzJTJDMyUyQzYyNzNmYjhhJTJDZ0p1SEZRSnBYblFDQWNwNEN4cVolMkY4NU4lMkNqd3Q0OWFlZTsgX3VhYl9jb2xsaW5hPTE1NjAzMjU1MDg5NDI1NTA4OTExODM0MTsgX3VtZGF0YT1HNjczRkQ0NjBFQzcxQjFEODg5RUYwRjNBMkZCRDJGRTk1RkIwMDY=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9hbGlsb2cvb25lcGx1cy9ibGsuaHRtbCBIVFRQLzEuMQ0KQWNjZXB0OiB0ZXh0L2h0bWwsIGFwcGxpY2F0aW9uL3hodG1sK3htbCwgaW1hZ2UvanhyLCAqLyoNClJlZmVyZXI6IGh0dHBzOi8vc2VhcmNoLmRhbWFpLmNuL3NlYXJjaC5odG1sP2tleXdvcmQ9JUU1JTkxJUE4JUU2JTlEJUIwJUU0JUJDJUE2JnNwbT1hMm9lZy5ob21lLnNlYXJjaHR4dC5kc2VhcmNoYnRuDQpBY2NlcHQtTGFuZ3VhZ2U6IHpoLUNODQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXT1c2NDsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28NCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZQ0KSG9zdDogZy5hbGljZG4uY29tDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQpDb29raWU6IF9sYXN0dmlzaXRlZD1nSnVIRlFKcFhuUUNBY3A0Q3hxWiUyRjg1TiUyQyUyQ2dKdUhGUUpwWG5RQ0FjcDRDeHFaODVOMkk3eGxCYmRuJTJDandzeGlycDMlMkNqd3N4aXJwMyUyQzMlMkM2MjczZmI4YSUyQ2dKdUhGUUpwWG5RQ0FjcDRDeHFaJTJGODVOJTJDand0NDlhZWU7IF91YWJfY29sbGluYT0xNTYwMzI1NTA4OTQyNTUwODkxMTgzNDE7IF91bWRhdGE9RzY3M0ZENDYwRUM3MUIxRDg4OUVGMEYzQTJGQkQyRkU5NUZCMDA2DQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="_lastvisited" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>Z0p1SEZRSnBYblFDQWNwNEN4cVolMkY4NU4lMkMlMkNnSnVIRlFKcFhuUUNBY3A0Q3hxWjg1TjJJN3hsQmJkbiUyQ2p3c3hpcnAzJTJDandzeGlycDMlMkMzJTJDNjI3M2ZiOGElMkNnSnVIRlFKcFhuUUNBY3A0Q3hxWiUyRjg1TiUyQ2p3dDQ5YWVl</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="_uab_collina" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTU2MDMyNTUwODk0MjU1MDg5MTE4MzQx</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="_umdata" index="2">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RzY3M0ZENDYwRUM3MUIxRDg4OUVGMEYzQTJGQkQyRkU5NUZCMDA2</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>5176</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGVuZ2luZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>dGV4dC9odG1s</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NTE3Ng==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAxMiBKdW4gMjAxOSAxMDo0NToxNiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-request-id" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NUQwMEQ3QkNCRkI4OEFFNDk4OUQ1NUZF</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-object-type" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Tm9ybWFs</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-hash-crc64ecma" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NTY2NDc2ODExNzM5NDYwOTY5NA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-storage-class" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U3RhbmRhcmQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-MD5" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>M3RMTUpMWm40R0hCYWg3SERVOXBvZz09</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-server-time" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Mg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bWF4LWFnZT0yNTkyMDAwLHMtbWF4YWdlPTM2MDA=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Access-Control-Allow-Origin" index="13">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Source-Scheme" index="14">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="15">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Ali-Swift-Global-Savetime" index="16">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTU2MDMzNjMxNg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Via" index="17">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2FjaGUyNC5sMmNuMTc5M1s2OSwyMDAtMCxNXSwgY2FjaGUzOC5sMmNuMTc5M1s3MCwwXSwgY2FjaGUyLmNuNDcwWzAsMjAwLTAsSF0sIGNhY2hlMy5jbjQ3MFsxLDBd</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Age" index="18">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NjY5</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Cache" index="19">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SElUIFRDUF9NRU1fSElUIGRpcm46LTI6LTI=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-SaveTime" index="20">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAxMiBKdW4gMjAxOSAxMDo0NToxNiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-CacheTime" index="21">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MzYwMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Timing-Allow-Origin" index="22">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="EagleId" index="23">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>N2NlZmEyY2IxNTYwMzM2OTg1MTY3ODYwNWU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IFRlbmdpbmUNCkNvbnRlbnQtVHlwZTogdGV4dC9odG1sDQpDb250ZW50LUxlbmd0aDogNTE3Ng0KQ29ubmVjdGlvbjoga2VlcC1hbGl2ZQ0KRGF0ZTogV2VkLCAxMiBKdW4gMjAxOSAxMDo0NToxNiBHTVQNClZhcnk6IEFjY2VwdC1FbmNvZGluZw0KeC1vc3MtcmVxdWVzdC1pZDogNUQwMEQ3QkNCRkI4OEFFNDk4OUQ1NUZFDQp4LW9zcy1vYmplY3QtdHlwZTogTm9ybWFsDQp4LW9zcy1oYXNoLWNyYzY0ZWNtYTogNTY2NDc2ODExNzM5NDYwOTY5NA0KeC1vc3Mtc3RvcmFnZS1jbGFzczogU3RhbmRhcmQNCkNvbnRlbnQtTUQ1OiAzdExNSkxabjRHSEJhaDdIRFU5cG9nPT0NCngtb3NzLXNlcnZlci10aW1lOiAyDQpDYWNoZS1Db250cm9sOiBtYXgtYWdlPTI1OTIwMDAscy1tYXhhZ2U9MzYwMA0KQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luOiAqDQpYLVNvdXJjZS1TY2hlbWU6IGh0dHBzDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpBbGktU3dpZnQtR2xvYmFsLVNhdmV0aW1lOiAxNTYwMzM2MzE2DQpWaWE6IGNhY2hlMjQubDJjbjE3OTNbNjksMjAwLTAsTV0sIGNhY2hlMzgubDJjbjE3OTNbNzAsMF0sIGNhY2hlMi5jbjQ3MFswLDIwMC0wLEhdLCBjYWNoZTMuY240NzBbMSwwXQ0KQWdlOiA2NjkNClgtQ2FjaGU6IEhJVCBUQ1BfTUVNX0hJVCBkaXJuOi0yOi0yDQpYLVN3aWZ0LVNhdmVUaW1lOiBXZWQsIDEyIEp1biAyMDE5IDEwOjQ1OjE2IEdNVA0KWC1Td2lmdC1DYWNoZVRpbWU6IDM2MDANClRpbWluZy1BbGxvdy1PcmlnaW46ICoNCkVhZ2xlSWQ6IDdjZWZhMmNiMTU2MDMzNjk4NTE2Nzg2MDVlDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>PCFET0NUWVBFIGh0bWw+CjxodG1sPgo8aGVhZD4KICAgIDxtZXRhIGh0dHAtZXF1aXY9IkNvbnRlbnQtVHlwZSIgY29udGVudD0idGV4dC9odG1sOyBjaGFyc2V0PVVURi04Ij4KPC9oZWFkPgo8Ym9keT4KCTxzY3JpcHQgdHlwZT0idGV4dC9qYXZhc2NyaXB0IiBjaGFyc2V0PSJVVEYtOCI+IWZ1bmN0aW9uIGUodCxuLG8pe2Z1bmN0aW9uIGkocixzKXtpZighbltyXSl7aWYoIXRbcl0pe3ZhciBjPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlO2lmKCFzJiZjKXJldHVybiBjKHIsITApO2lmKGEpcmV0dXJuIGEociwhMCk7dGhyb3cgbmV3IEVycm9yKCJDYW5ub3QgZmluZCBtb2R1bGUgJyIrcisiJyIpfXZhciBsPW5bcl09e2V4cG9ydHM6e319O3Rbcl1bMF0uY2FsbChsLmV4cG9ydHMsZnVuY3Rpb24oZSl7dmFyIG49dFtyXVsxXVtlXTtyZXR1cm4gaShuP246ZSl9LGwsbC5leHBvcnRzLGUsdCxuLG8pfXJldHVybiBuW3JdLmV4cG9ydHN9Zm9yKHZhciBhPSJmdW5jdGlvbiI9PXR5cGVvZiByZXF1aXJlJiZyZXF1aXJlLHI9MDtyPG8ubGVuZ3RoO3IrKylpKG9bcl0pO3JldHVybiBpfSh7MTpbZnVuY3Rpb24oZSx0LG4peyFmdW5jdGlvbihlLHQpe2Z1bmN0aW9uIG4oKXt2YXIgZT0obmV3IERhdGUpLmdldFRpbWUoKTtlLXAudGltZXM8OGUzJiYoZy5nZXRIYXNoUGFyYW0oImNvaWQiKXx8Zy5nZXRIYXNoUGFyYW0oIm5vaWQiKT8ocC5hY29va2llPWcuZ2V0SGFzaFBhcmFtKCJjb2lkIikscC5uaWNrbmFtZT1nLmdldEhhc2hQYXJhbSgibm9pZCIpLGYocykpOm0uZ2V0Q29va2llKCJjbmEiKXx8bS5nZXRDb29raWUoIm5pY2tuYW1lIik/KHAuYWNvb2tpZT1tLmdldENvb2tpZSgiY25hIikscC5uaWNrbmFtZT1tLmdldENvb2tpZSgibmlja25hbWUiKSxmKHMpKTppLnNldFRpbWVvdXQoZnVuY3Rpb24oKXtuKCl9LDEwMCkpfWZ1bmN0aW9uIG8oKXt2YXIgZT0obmV3IERhdGUpLmdldFRpbWUoKSx0PW0uZ2V0KCJfbGFzdHZpc2l0ZWQiKSxvPWcucGFyc2UodHx8IiIpLGk9cGFyc2VJbnQoby5qc0xhc3RMb2FkVGltZXx8MCwzNik7ZS1pPnUuYWlkQ2xpZW50TG9kZXJUaW1lJiYoby5qc0xhc3RMb2FkVGltZT1lLnRvU3RyaW5nKDM2KSxtLnNldCgiX2xhc3R2aXNpdGVkIixnLnN0cmluZ2lmeShvKSxoKSxuKCkpfXZhciBpPWUsYT10LHI9aS5uYXZpZ2F0b3Iscz1bImFjb29raWUiLCJuaWNrbmFtZSIsInRva2VuIiwibGFzdFRpbWUiLCJ0b2tlbkxhc3RUaW1lIiwicmVxdWVzdCIsImhhc2giLCJmaXJzdF9jbmEiLCJqc0xhc3RMb2FkVGltZSJdLGM9e2FpZHZlcjoiMTAwOTE0MTIyMyIsYWlkOiIiLGFpZF90YW54OiJodHRwOi8vYS50YW54LmNvbS90YW54L2ltZyIsYWlkX2Nueno6Imh0dHA6Ly9haWQuY256ei5jb20vY256ei9pbWciLGFpZF90YW9uZWk6Imh0dHBzOi8vb25laWQubW1zdGF0LmNvbS90YW9iYW8vaW1nIixyZXBvcnRUb2tlbjoiIixyZXBvcnRUb2tlbkh0dHA6Imh0dHA6Ly9qc29ucC5haWQuYWxpYmFiYS5jb20vVW1pZC9nZXREZXZpY2VJbmZvIixyZXBvcnRUb2tlbkh0dHBzOiJodHRwczovL29uZWlkLm1tc3RhdC5jb20vdGFvYmFvL2dldERldmljZUluZm8iLHVtc2VydmljZToiaHR0cHM6Ly95bnVmLmFsaXBheS5jb20vc2VydmljZS91bS5qc29uIix1bWpzOiJodHRwczovL2Fzc2V0cy5hbGljZG4uY29tL2cvc2VjdXJpdHkvdW1zY3JpcHQvMi4xLjQvdW0uanMifSxsPTM2ZTUsdT17YWlkQ2xpZW50TG9kZXJUaW1lOjE4ZTQsYWlkOjEyKmwsYWlkU2Vjb25kOjRlMyx0b2tlbkludmVyc2VUaW1lOjMzNipsLHRva2VuOjM2MCpsLHJlcG9ydERlbGF5OjUwMCxyZXBvcnREZWxheVNlY29uZDozZTN9LGQ9WyIxNjg4LmNvbSIsImFsaWJhYmEuY29tIiwiYWxpbWFtYS5jb20iLCJhbGlsb2FuLmNvbSIsImFsaXBheS5jb20iLCJhbGl5dW4uY29tIiwiY256ei5jb20iLCJldGFvLmNvbSIsImhpY2hpbmEuY29tIiwiaGl0YW8uY29tIiwianVodWFzdWFuLmNvbSIsIm5ldC5jbiIsInBocHdpbmQuY29tIiwidGFvMTIzLmNvbSIsInRhb2Jhby5jb20iLCJ0bWFsbC5jb20iLCJ0bWFsbC5oayIsInRhb2h1YS5jb20iXSxoPSIvYWxpbG9nL29uZXBsdXMiLG09ZnVuY3Rpb24oZSl7dmFyIHQsbj1yLmNvb2tpZUVuYWJsZWQsbz0vbXNpZSAoXGQrXC5cZCkvaS50ZXN0KHIudXNlckFnZW50KTt0cnl7c3VwcG9ydFN0b3JhZ2U9ImxvY2FsU3RvcmFnZSJpbiBpJiZudWxsIT09aS5sb2NhbFN0b3JhZ2UmJiJvYmplY3QiPT10eXBlb2YgaS5sb2NhbFN0b3JhZ2Usc3VwcG9ydFN0b3JhZ2UmJihsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgidGVzdHRkb2lkIiwidGVzdCIpLGxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKCJ0ZXN0dGRvaWQiKSl9Y2F0Y2goZSl7c3VwcG9ydFN0b3JhZ2U9ITF9aWYobyl0cnl7dD1hLmNyZWF0ZUVsZW1lbnQoIklOUFVUIiksdC50eXBlPSJoaWRkZW4iLHQuc3R5bGUuZGlzcGxheT0ibm9uZSIsdC5hZGRCZWhhdmlvcigiI2RlZmF1bHQjdXNlckRhdGEiKSxhLmJvZHkuYXBwZW5kQ2hpbGQodCl9Y2F0Y2goZSl7bz0hMX1yZXR1cm57Z2V0OmZ1bmN0aW9uKGUpe3JldHVybiB0aGlzLmdldFN0b3JhZ2UoZSl8fHRoaXMuZ2V0Q29va2llKGUpfHx0aGlzLmdldFVzZXJEYXRhKGUpfHxudWxsfSxzZXQ6ZnVuY3Rpb24oZSx0LGkpe3ZhciBhLHI9ITE7cmV0dXJuIG4mJihhPW5ldyBEYXRlLGEuc2V0VGltZShhLmdldFRpbWUoKSs4NzYwKmwpLHRoaXMuc2V0Q29va2llKGUsdCx7ZXhwaXJlczphLHBhdGg6aX0pLG49cj10aGlzLmdldENvb2tpZShlKT09dCksc3VwcG9ydFN0b3JhZ2UmJih0aGlzLnNldFN0b3JhZ2UoZSx0KSxzdXBwb3J0U3RvcmFnZT1yPXRoaXMuZ2V0U3RvcmFnZShlKT09dCksIXImJm8mJih0aGlzLnNldFVzZXJEYXRhKGUsdCksbz1yPXRoaXMuZ2V0VXNlckRhdGEoZSk9PXQpLHJ9LGNsZWFyOmZ1bmN0aW9uKGUpe2U9ZXx8Il9sYXN0dmlzaXRlZCIsbiYmdGhpcy5zZXRDb29raWUoZSwiIix7ZXhwaXJlczpuZXcgRGF0ZSgxKX0pLHN1cHBvcnRTdG9yYWdlJiZpLmxvY2FsU3RvcmFnZS5yZW1vdmVJdGVtKGUpfSxnZXRDb29raWU6ZnVuY3Rpb24oZSl7dmFyIHQ9bmV3IFJlZ0V4cCgiKF58ICkiK2UrIj0oW147XSopKDt8JCkiKSxuPWEuY29va2llLm1hdGNoKHQpO3JldHVybiBuP2RlY29kZVVSSUNvbXBvbmVudChuWzJdKXx8bnVsbDpudWxsfSxzZXRDb29raWU6ZnVuY3Rpb24oZSx0LG4pe2EuY29va2llPWUrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh0KSsoIjsgcGF0aD0iKygobj1ufHx7fSkucGF0aHx8Ii8iKSkrKG4uZXhwaXJlcz8iOyBleHBpcmVzPSIrbi5leHBpcmVzLnRvR01UU3RyaW5nKCk6IiIpKyhuLmRvbWFpbj8iOyBkb21haW49IituLmRvbWFpbjoiIikrKG4uc2VjdXJlPyI7IHNlY3VyZSI6IiIpfSxnZXRTdG9yYWdlOmZ1bmN0aW9uKGUpe3ZhciB0PW51bGw7cmV0dXJuIHN1cHBvcnRTdG9yYWdlJiYodD1pLmxvY2FsU3RvcmFnZS5nZXRJdGVtKGUpKSx0fSxzZXRTdG9yYWdlOmZ1bmN0aW9uKGUsdCl7c3VwcG9ydFN0b3JhZ2UmJmkubG9jYWxTdG9yYWdlLnNldEl0ZW0oZSx0KX0sZ2V0VXNlckRhdGE6ZnVuY3Rpb24obil7aWYobyl0cnl7cmV0dXJuIHQubG9hZChlLmhvc3QpLHQuZ2V0QXR0cmlidXRlKG4pfHxudWxsfWNhdGNoKGUpe289ITF9fSxzZXRVc2VyRGF0YTpmdW5jdGlvbihuLGkpe2lmKG8pdHJ5e3QubG9hZChlLmhvc3QpLHQuc2V0QXR0cmlidXRlKG4saSksdC5zYXZlKGUuaG9zdCl9Y2F0Y2goZSl7bz0hMX19fX0ocyksZz1mdW5jdGlvbih0LG4pe3ZhciBvPXt9O3JldHVybiBvLnRvSGV4U3RyPWZ1bmN0aW9uKGUpe2Zvcih2YXIgdCxuPSIiLG89NztvPj0wO28tLSl0PWU+Pj40Km8mMTUsbis9dC50b1N0cmluZygxNik7cmV0dXJuIG59LG8uaGFzaENvZGU9ZnVuY3Rpb24oZSl7dmFyIHQ9MDtpZigwPT1lLmxlbmd0aClyZXR1cm4gby50b0hleFN0cih0KTtmb3IodmFyIG49MDtuPGUubGVuZ3RoO24rKyl7dmFyIGk9ZS5jaGFyQ29kZUF0KG4pO3Q9KHQ8PDUpLXQraSx0Jj10fXJldHVybiBvLnRvSGV4U3RyKHQpfSxvLmVuY3J5cHQ9ZnVuY3Rpb24oZSx0KXtmb3IodmFyIG49IjAxMjM0NTY3ODlBQkNERUZHSElKS0xNTk9QUVJTVFVWV1hZWmFiY2RlZmdoaWprbG1ub3BxcnN0dXZ3eHl6IixpPTk9PWUubGVuZ3RoP051bWJlcihlLnN1YnN0cig4LDEpKTowLGE9ZS5zdWJzdHIoMCw4KSxyPWk7cjx0O3IrKylhPW8uaGFzaENvZGUoYStuLnN1YnN0cihyKSk7cmV0dXJuIGErdH0se251aDpvLGhhc2g6by5oYXNoQ29kZSxndWlkOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1bXSxuPSIwMTIzNDU2Nzg5QUJDREVGR0hJSktMTU5PUFFSU1RVVldYWVphYmNkZWZnaGlqa2xtbm9wcXJzdHV2d3h5eiIsbz0oZXx8MzIpLTE7bz4tMTtvLS0pdFtvXT1uLmNoYXJBdChNYXRoLnJhbmRvbSgpKm4ubGVuZ3RoKTtyZXR1cm4gdC5qb2luKCIiKX0sdG9rZW46ZnVuY3Rpb24oKXt2YXIgZT1wLmFjb29raWU/cC5hY29va2llLnJlcGxhY2UoL1teXGRhLXpdL2dpLCIiKToiIjtyZXR1cm4oZSt0aGlzLmd1aWQoKSkuc3Vic3RyKDAsMzIpfSxyZXF1ZXN0SW1nOmZ1bmN0aW9uKGUsdCxuKXt2YXIgbz0iaW1nXyIrdGhpcy5ndWlkKDgpLGE9W10scj1pW29dPW5ldyBJbWFnZTtpZihyLm9ubG9hZD1mdW5jdGlvbigpe2lbb109bnVsbCxuJiZuKCEwKX0sci5vbmVycm9yPWZ1bmN0aW9uKCl7aVtvXT1udWxsLG4mJm4oITEpfSx0JiYib2JqZWN0Ij09dHlwZW9mIHQpZm9yKHZhciBzIGluIHQpdC5oYXNPd25Qcm9wZXJ0eShzKSYmKGFbYS5sZW5ndGhdPXMrIj0iK2VuY29kZVVSSUNvbXBvbmVudCh0W3NdKSk7YS5sZW5ndGgmJihlKz0oZS5pbmRleE9mKCI/Iik+LTE/IiYiOiI/IikrYS5qb2luKCImIikpLHIuc3JjPWV9LGNyeFJlcTpmdW5jdGlvbihlLHQpe3RoaXMuaXNUYW9Eb21haW4oKT90aGlzLnJlcXVlc3RJbWcoZSx0KTp0aGlzLmpzb25wKGUsdCl9LGpzb25wOmZ1bmN0aW9uKGUsdCxuKXt2YXIgbz0iZm5fIit0aGlzLmd1aWQoOCk7aVtvXT1mdW5jdGlvbihlKXsiZnVuY3Rpb24iPT10eXBlb2YgbiYmbihlKTt2YXIgdCxyO2lbb109bnVsbCwodD1jfHxhLmdldEVsZW1lbnRCeUlkKCJpZF8iK28pKSYmKHI9dC5wYXJlbnROb2RlLHImJjExIT1yLm5vZGVUeXBlJiZyLnJlbW92ZUNoaWxkKHQpKSxjPW51bGx9O3ZhciByPVsiX2NiRnVuY3Rpb249IitvXTt0PXR8fHt9O2Zvcih2YXIgcyBpbiB0KXQuaGFzT3duUHJvcGVydHkocykmJihyW3IubGVuZ3RoXT1zKyI9IitlbmNvZGVVUklDb21wb25lbnQodFtzXSkpO3ZhciBjPWEuY3JlYXRlRWxlbWVudCgiU0NSSVBUIik7Yy50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiLGMuaWQ9ImlkXyIrbyxlKz1lLmluZGV4T2YoIj8iKT09PS0xPyI/IjoiJiIsYy5zcmM9ZStyLmpvaW4oIiYiKTt2YXIgbD1hLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJIRUFEIik7bCYmbFswXSYmbFswXS5hcHBlbmRDaGlsZChjKX0sc3RyaW5naWZ5OmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD1uZXcgQXJyYXkobi5sZW5ndGgpLG89MDtvPG4ubGVuZ3RoO28rKyl0W29dPWVbbltvXV07cmV0dXJuIHQuam9pbigiLCIpfSxwYXJzZTpmdW5jdGlvbihlKXtmb3IodmFyIHQ9e30sbz1lLnNwbGl0KCIsIiksaT0wO2k8bi5sZW5ndGg7aSsrKXRbbltpXV09b1tpXTtyZXR1cm4gdH0sZ2V0SG9zdEZyb21VUkw6ZnVuY3Rpb24oZSl7aWYoL2h0dHBzPzpcL1wvKFteOlwvXSspKDp8XC8pLy50ZXN0KGUpKXtlPVJlZ0V4cC4kMTt2YXIgdD1lLnNwbGl0KCIuIik7cmV0dXJuIHQubGVuZ3RoPD0yP3Quam9pbigiLiIpOnQuc2xpY2UoMSkuam9pbigiLiIpfXJldHVybiIifSxyZXBvcnRVTTpmdW5jdGlvbihvLGkpe2lmKCFhLmdldEVsZW1lbnRCeUlkKCJfdW1mcCIpKXt2YXIgcz1hLmNyZWF0ZUVsZW1lbnQoIkRJViIpO3MuaWQ9Il91bWZwIixzLnN0eWxlLndpZHRoPSIxcHgiLHMuc3R5bGUuaGVpZ2h0PSIxcHgiLHMuc3R5bGUub3ZlcmZsb3c9ImhpZGRlbiIsYS5ib2R5LmFwcGVuZENoaWxkKHMpO3ZhciBjPWEuY3JlYXRlRWxlbWVudCgiU0NSSVBUIik7Yy50eXBlPSJ0ZXh0L2phdmFzY3JpcHQiLGMuY2hhcnNldD0idXRmLTgiLGMub25sb2FkPWMub25yZWFkeXN0YXRlY2hhbmdlPWZ1bmN0aW9uKCl7aWYoIXRoaXMucmVhZHlTdGF0ZXx8ImxvYWRlZCI9PXRoaXMucmVhZHlTdGF0ZXx8ImNvbXBsZXRlIj09dGhpcy5yZWFkeVN0YXRlKXtpZighYylyZXR1cm47Yy5vbmxvYWQ9Yy5vbnJlYWR5c3RhdGVjaGFuZ2U9bnVsbDt2YXIgbD1hLmdldEVsZW1lbnRCeUlkKCJfdW1mcCIpO2UmJmUudW0mJnVtLmluaXQoe2FwcE5hbWU6ImFsaXl1bl9haWQiLGVuYWJsZU1vZDpudWxsIT09aSYmIiIhPT1pJiYoZC5qb2luKCIiKS5pbmRleE9mKGkpPi0xJiZyLnVzZXJBZ2VudC5pbmRleE9mKCJGaXJlZm94Iik8MCksc2VydmljZVVybDp0LnVtc2VydmljZSx0b2tlbjpvLHRpbWVvdXQ6MTUwMCx0aW1lc3RhbXA6KG5ldyBEYXRlKS5nZXRUaW1lKCksY29udGFpbmVyczp7Zmxhc2g6bCxkY3A6bH0sY2FsbGJhY2s6ZnVuY3Rpb24oKXtuLnRva2VuTGFzdFRpbWU9bi50aW1lcy50b1N0cmluZygzNiksbS5zZXQoIl9sYXN0dmlzaXRlZCIsZy5zdHJpbmdpZnkobiksaCksZy5qc29ucCh0LnJlcG9ydFRva2VuLHt0b2tlbmlkOm8sYWNvb2tpZTpuLmFjb29raWUsbjoiY2FsbGJhY2sifSl9fSk7dmFyIHU9e3Rva2VuaWQ6byxhY29va2llOm4uYWNvb2tpZSxuOiJmaXJzdCJ9O24uaGFzRmxhc2gmJih1LmY9IjEiKSxuLmhhc1BkZiYmKHUucD0iMSIpLHUuc2NyMT1uLnNjcmVlbldpZHRoKyJ4IituLnNjcmVlbkhlaWdodCx1LnNjcjI9bi5zY3JlZW5BV2lkdGgrIngiK24uc2NyZWVuQUhlaWdodDt2YXIgZj1nLmdldFBsdWdpbnNIYXNoKCkuam9pbigiIik7dS5wMT1mLnN1YnN0cigwLDE0NCksdS5wMj1mLnN1YnN0cigxNDQsMTQ0KSxnLmpzb25wKHQucmVwb3J0VG9rZW4sdSkscz1udWxsLGM9bnVsbH19LGMuc3JjPXQudW1qcyxhLmdldEVsZW1lbnRzQnlUYWdOYW1lKCJIRUFEIilbMF0uYXBwZW5kQ2hpbGQoYyl9fSxnZXRQbHVnaW5zOmZ1bmN0aW9uKCl7dmFyIGU9ci5wbHVnaW5zfHxbXTtpZihlLmxlbmd0aCl7Zm9yKHZhciB0PVtdLG49MDtuPGUubGVuZ3RoO24rKyl0aGlzLmZ1Y2tIaW50KGVbbl0sdCk7cmV0dXJuIHR9cmV0dXJuIHRoaXMuZ2V0UGx1Z2luc0lFKCl9LGZ1Y2tIaW50OmZ1bmN0aW9uKGUsdCl7dHJ5e2lmKGUpe2Zvcih2YXIgbj1bXSxvPTA7bzxlLmxlbmd0aDtvKyspZS5pdGVtKG8pJiZuLnB1c2goZS5pdGVtKG8pLnR5cGUpO3ZhciBpPWUubmFtZSsiOyI7ZS52ZXJzaW9uJiYoaSs9ZS52ZXJzaW9uKyI7IiksaSs9ZS5maWxlbmFtZSsiOyIsaSs9bi5qb2luKCI7IiksdC5wdXNoKGkpfX1jYXRjaChlKXt9fSxnZXRQbHVnaW5zSUU6ZnVuY3Rpb24oKXtmb3IodmFyIHQ9W10sbj1mdW5jdGlvbihuKXtpZihlJiZuJiZlLkFjdGl2ZVhPYmplY3Qpe2Zvcih2YXIgbz0wLGk9bnVsbDtudWxsPT09aSYmbzxuLmlkcy5sZW5ndGg7KXt0cnl7aT1uZXcgZS5BY3RpdmVYT2JqZWN0KG4uaWRzW29dKX1jYXRjaChlKXt9bysrfWlmKGkpdHJ5e3QucHVzaChuLm5hbWUrIj09IituLmdldFZlcnNpb24oaSxuLmlkc1tvXSkpfWNhdGNoKGUpe319fSxvPVt7bmFtZToiUXVpY2t0aW1lIixpZHM6WyJRdWlja1RpbWVDaGVja09iamVjdC5RdWlja1RpbWVDaGVjay4xIiwiUXVpY2tUaW1lLlF1aWNrVGltZSJdLGdldFZlcnNpb246ZnVuY3Rpb24oZSl7cmV0dXJuIGUuUXVpY2tUaW1lVmVyc2lvbi50b1N0cmluZygxNikucmVwbGFjZSgvXiguKSguKSguKS4qLywiJDEuJDIuJDMiKX19LHtuYW1lOiJBY3JvYmF0IixpZHM6WyJQREYuUGRmQ3RybC43IiwiUERGLlBkZkN0cmwuNiIsIlBERi5QZGZDdHJsLjUiLCJQREYuUGRmQ3RybC40IiwiUERGLlBkZkN0cmwuMyIsIkFjcm9QREYuUERGLjEiXSxnZXRWZXJzaW9uOmZ1bmN0aW9uKGUsdCl7cmV0dXJuIHQucmVwbGFjZSgvXlthLXpBLVouXStcLihbMC05XVswLTkuXSopLywiJDEiKX19LHtuYW1lOiJSZWFsUGxheWVyIixpZHM6WyJSZWFsUGxheWVyLlJlYWxQbGF5ZXIodG0pIEFjdGl2ZVggQ29udHJvbCAoMzItYml0KSIsIlJlYWxWaWRlby5SZWFsVmlkZW8odG0pIEFjdGl2ZVggQ29udHJvbCAoMzItYml0KSIsInJtb2N4LlJlYWxQbGF5ZXIgRzIgQ29udHJvbCJdLGdldFZlcnNpb246ZnVuY3Rpb24oZSl7cmV0dXJuIGUuR2V0VmVyc2lvbkluZm8oKX19LHtuYW1lOiJGbGFzaCIsaWRzOlsiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guOSIsIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoLjguNSIsIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoLjgiLCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC43IiwiU2hvY2t3YXZlRmxhc2guU2hvY2t3YXZlRmxhc2guNiIsIlNob2Nrd2F2ZUZsYXNoLlNob2Nrd2F2ZUZsYXNoLjUiLCJTaG9ja3dhdmVGbGFzaC5TaG9ja3dhdmVGbGFzaC40Il0sZ2V0VmVyc2lvbjpmdW5jdGlvbihlKXtyZXR1cm4gZS5HZXRWYXJpYWJsZSgiJHZlcnNpb24iKS5yZXBsYWNlKC9bYS16QS1aIF0qKFswLTksXSspLywiJDEiKS5yZXBsYWNlKC8sL2csIi4iKX19LHtuYW1lOiJBZG9iZSBTVkciLGlkczpbIkFkb2JlLlNWR0N0bCJdLGdldFZlcnNpb246ZnVuY3Rpb24oZSl7cmV0dXJuIGUuZ2V0U1ZHVmlld2VyVmVyc2lvbigpLnJlcGxhY2UoL1thLXpBLVo7IF0qKFswLTkuXSspLywiJDEiKX19LHtuYW1lOiJXaW5kb3dzIE1lZGlhIFBsYXllciIsaWRzOlsiV01QbGF5ZXIuT0NYIiwiTWVkaWFQbGF5ZXIuTWVkaWFQbGF5ZXIuMSJdLGdldFZlcnNpb246ZnVuY3Rpb24oZSl7cmV0dXJuIGUudmVyc2lvbkluZm99fSx7bmFtZToiRGl2WCIsaWRzOlsibnBkaXZ4LkRpdlhCcm93c2VyUGx1Z2luLjEiLCJucGRpdnguRGl2WEJyb3dzZXJQbHVnaW4iXSxnZXRWZXJzaW9uOmZ1bmN0aW9uKGUpe3JldHVybiBlLkdldFZlcnNpb24oKX19LHtuYW1lOiJXUEZlIChTaWx2ZXJsaWdodCkiLGlkczpbIkFnQ29udHJvbC5BZ0NvbnRyb2wiXSxnZXRWZXJzaW9uOmZ1bmN0aW9uKGUpe2Zvcih2YXIgdD0iMSIsbj0iMCIsbz0iMCI7ZS5Jc1ZlcnNpb25TdXBwb3J0ZWQodCsiLiIrbisiLiIrbyk7KXQrKztmb3IodC0tO2UuSXNWZXJzaW9uU3VwcG9ydGVkKHQrIi4iK24rIi4iK28pOyluKys7Zm9yKG4tLTtlLklzVmVyc2lvblN1cHBvcnRlZCh0KyIuIituKyIuIitvKTspbysrO3JldHVybiBvLS0sdCsiLiIrbisiLiIrb319LHtuYW1lOiJNU1hNTCIsaWRzOlsiTVNYTUwyLkRPTURvY3VtZW50LjYuMCIsIk1TWE1MMi5ET01Eb2N1bWVudC41LjAiLCJNU1hNTDIuRE9NRG9jdW1lbnQuNC4wIiwiTVNYTUwyLkRPTURvY3VtZW50LjMuMCJdLGdldFZlcnNpb246ZnVuY3Rpb24oZSx0KXtyZXR1cm4gdC5yZXBsYWNlKC9eW2EtekEtWi4yXStcLihbMC05XStcLlswLTkuXSspLywiJDEiKX19XSxpPTA7aTxvLmxlbmd0aDtpKyspbihvW2ldKTtyZXR1cm4gdH0sZ2V0UGx1Z2luc0hhc2g6ZnVuY3Rpb24oKXtmb3IodmFyIGU9dGhpcy5nZXRQbHVnaW5zKCksdD0wO3Q8ZS5sZW5ndGg7dCsrKWVbdF09by5oYXNoQ29kZShlW3RdKSxlW3RdPW8uZW5jcnlwdChlW3RdLE1hdGgucm91bmQoNSpNYXRoLnJhbmRvbSgpKSk7cmV0dXJuIGV9LGdldENsaWVudEluZm9IYXNoOmZ1bmN0aW9uKCl7dmFyIGU9W107ci5wbHVnaW5zJiYoZT10aGlzLmdldFBsdWdpbnMoKSk7dmFyIHQ9ZS5sZW5ndGg/ZS5qb2luKCIsIik6IiIsYT1pLnNjcmVlbi53aWR0aCxzPWkuc2NyZWVuLmhlaWdodCxjPWkuc2NyZWVuLmF2YWlsV2lkdGgsbD1pLnNjcmVlbi5hdmFpbEhlaWdodCx1PXIudXNlckFnZW50O3JldHVybiB0aGlzLmhhc1BkZkFuZEZsYXNoKHQpLG4udWE9dSxuLnNjcmVlbldpZHRoPWEsbi5zY3JlZW5IZWlnaHQ9cyxuLnNjcmVlbkFXaWR0aD1jLG4uc2NyZWVuQUhlaWdodD1sLGU9W3QsYSxzLGMsbCx1XSxvLmhhc2hDb2RlKGUuam9pbigiQCIpKX0saGFzUGRmQW5kRmxhc2g6ZnVuY3Rpb24oZSl7bi5oYXNQZGY9L3BkZi9pLnRlc3QoZSksbi5oYXNGbGFzaD0vZmxhc2gvaS50ZXN0KGUpfSxnZXRIYXNoUGFyYW06ZnVuY3Rpb24oZSl7dmFyIHQ9bG9jYXRpb24uaGFzaC5tYXRjaChuZXcgUmVnRXhwKCJbIyY/XSIrZSsiPShbXiY/XSspIikpO3JldHVybiBkZWNvZGVVUklDb21wb25lbnQodD90WzFdOiIiKX0saXNUYW9Eb21haW46ZnVuY3Rpb24oKXtyZXR1cm4iaHR0cHM6Ij09PWkubG9jYXRpb24ucHJvdG9jb2x9LGlzSUU4U1AzOmZ1bmN0aW9uKCl7cmV0dXJuIHIudXNlckFnZW50LmluZGV4T2YoIldpbmRvd3MgTlQgNS4xIik+PTAmJihyLnVzZXJBZ2VudC5pbmRleE9mKCJNU0lFIDYiKT49MHx8ci51c2VyQWdlbnQuaW5kZXhPZigiTVNJRSA3Iik+PTB8fHIudXNlckFnZW50LmluZGV4T2YoIk1TSUUgOCIpPj0wKSYmImh0dHBzOiI9PT1sb2NhdGlvbi5wcm90b2NvbH0sam9pbk9iajpmdW5jdGlvbihlKXt2YXIgdD1bXSxuPSIiO2lmKGUmJiJvYmplY3QiPT10eXBlb2YgZSlmb3IodmFyIG8gaW4gZSllLmhhc093blByb3BlcnR5KG8pJiYodFt0Lmxlbmd0aF09bysiPSIrZW5jb2RlVVJJQ29tcG9uZW50KGVbb10pKTtyZXR1cm4gdC5sZW5ndGgmJihuPXQuam9pbigiJiIpKSxufX19KGMscyksZj1mdW5jdGlvbihlKXt2YXIgdD1lLm5pY2tuYW1lPyJ0YW9iYW9fbmljayI6ZS5hY29va2llPyJhY29va2llX2lkIjoiIjtpZih0KXt2YXIgbj0wLG89bS5nZXQoIl9sYXN0dmlzaXRlZCIpLGk9Zy5wYXJzZShvfHwiIik7aWYoZS5qc0xhc3RMb2FkVGltZT1pLmpzTGFzdExvYWRUaW1lLGUucmVxdWVzdHw9Im5pY2tuYW1lIj09dD80OjEsZS5maXJzdF9jbmE9aS5maXJzdF9jbmF8fGUuYWNvb2tpZSxpLnRva2VuJiZpLmxhc3RUaW1lJiZpLnRva2VuTGFzdFRpbWUpe3ZhciBhPWkucmVxdWVzdHx8MCxyPSExLHM9ITE7ZS50b2tlbj1pLnRva2VuLGUubGFzdFRpbWU9aS5sYXN0VGltZSxlLnRva2VuTGFzdFRpbWU9aS50b2tlbkxhc3RUaW1lO3ZhciBsPXBhcnNlSW50KGkudG9rZW5MYXN0VGltZXx8MCwzNik7KGUudGltZXMtbD49dS50b2tlbnx8ZS5oYXNoIT1pLmhhc2gpJiYoZS50b2tlbj1nLnRva2VuKCksZS5sYXN0VGltZT1lLnRpbWVzLnRvU3RyaW5nKDM2KSxlLnRva2VuTGFzdFRpbWU9KGUudGltZXMtdS50b2tlbkludmVyc2VUaW1lKS50b1N0cmluZygzNikscj0hMCxnLnJlcG9ydFVNKGUudG9rZW4sZS5kb21haW4pKTt2YXIgZD1wYXJzZUludChpLmxhc3RUaW1lfHwwLDM2KTtlLnRpbWVzLWQ+PXUuYWlkJiYoZS5sYXN0VGltZT1lLnRpbWVzLnRvU3RyaW5nKDM2KSxzPSEwKSxlLnRpbWVzLWQ+PXUuYWlkU2Vjb25kJiYocnx8c3x8MSZhJiZpLmFjb29raWUhPWUuYWNvb2tpZXx8MiZhJiZpLnRva2VuIT1lLnRva2VufHw0JmEmJmkubmlja25hbWUhPWUubmlja25hbWV8fDIhPSgyJmEpKSYmKGUucmVxdWVzdHw9MixtLnNldCgiX2xhc3R2aXNpdGVkIixnLnN0cmluZ2lmeShlKSxoKSxufD0xKX1lbHNlIGUudG9rZW49Zy50b2tlbigpLGUubGFzdFRpbWU9ZS50aW1lcy50b1N0cmluZygzNiksZS50b2tlbkxhc3RUaW1lPShlLnRpbWVzLXUudG9rZW5JbnZlcnNlVGltZSkudG9TdHJpbmcoMzYpLG58PTMsZy5yZXBvcnRVTShlLnRva2VuLGUuZG9tYWluKSxtLnNldCgiX2xhc3R2aXNpdGVkIixnLnN0cmluZ2lmeShlKSxoKTtpZigxPT0oMSZuKSl7dmFyIGY9e307Zi50eXBlPXQsZi5pZD0idGFvYmFvX25pY2siPT10P2Uubmlja25hbWU6ZS5hY29va2llLDIhPSgyJm4pJiYoZi50eXBlX2FkZD0idG9rZW5pZCIsZi5pZF9hZGQ9ZS50b2tlbiksZi5fdHM9IjMiK2cuZ3VpZCg0KSxmLmNhZD1tLmdldENvb2tpZSgiY2FkIiksZi5jYXA9bS5nZXRDb29raWUoImNhcCIpLGYuY25hPW0uZ2V0Q29va2llKCJjbmEiKSxmLl9sYXN0dmlzaXRlZD1tLmdldCgiX2xhc3R2aXNpdGVkIiksZy5yZXF1ZXN0SW1nKGMuYWlkLGYpfX19O2lmKCFnLmlzSUU4U1AzKCkpe3ZhciBwPXM7cC5ub3c9bmV3IERhdGUscC50aW1lcz1wLm5vdy5nZXRUaW1lKCkscC5yZXF1ZXN0PTAscC5ob3N0PWcuZ2V0SG9zdEZyb21VUkwoaS5sb2NhdGlvbi5ocmVmKSxwLmRvbWFpbj1nLmdldEhvc3RGcm9tVVJMKGEucmVmZXJyZXJ8fCIiKSxwLmhhc2g9Zy5nZXRDbGllbnRJbmZvSGFzaCgpLGMuYWlkPWMuYWlkX3RhbngsImNuenouY29tIj09cC5ob3N0LnRvTG93ZXJDYXNlKCk/Yy5haWQ9Yy5haWRfY256ejpnLmlzVGFvRG9tYWluKCkmJihjLmFpZD1jLmFpZF90YW9uZWkpLGcuaXNUYW9Eb21haW4oKT9jLnJlcG9ydFRva2VuPWMucmVwb3J0VG9rZW5IdHRwczpjLnJlcG9ydFRva2VuPWMucmVwb3J0VG9rZW5IdHRwLG8oKX19KHdpbmRvdyxkb2N1bWVudCl9LHt9XX0se30sWzFdKTs8L3NjcmlwdD4KPC9ib2R5Pgo8L2h0bWw+</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="295750" offset="0" length="5999" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
  <HTTPTask id="451" hostname="g.alicdn.com" path="/kissy/k/6.2.4/??base.js,attribute.js,event-custom.js,event-base.js,io.js,io-extra.js,io-base.js,promise.js,dom-base.js,query-selector-base.js,dom-extra.js,io-form.js,node.js,node-base.js,node-event.js,event-dom-base.js,event-dom-extra.js,event-gesture.js,event-touch.js,node-anim.js,anim-transition.js,anim-base.js" url="https://g.alicdn.com/kissy/k/6.2.4/??base.js,attribute.js,event-custom.js,event-base.js,io.js,io-extra.js,io-base.js,promise.js,dom-base.js,query-selector-base.js,dom-extra.js,io-form.js,node.js,node-base.js,node-event.js,event-dom-base.js,event-dom-extra.js,event-gesture.js,event-touch.js,node-anim.js,anim-transition.js,anim-base.js" ip="124.239.162.241" port="443" connectionId="12" origin="ExtraRes" frame="1" startDateTime="2019-06-12T18:56:39.013+08:00" startTime="295734" endTime="295765">
    <QueryString>
      <HTTPDataSet>
        <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
          <ActualData>P2Jhc2UuanMsYXR0cmlidXRlLmpzLGV2ZW50LWN1c3RvbS5qcyxldmVudC1iYXNlLmpzLGlvLmpzLGlvLWV4dHJhLmpzLGlvLWJhc2UuanMscHJvbWlzZS5qcyxkb20tYmFzZS5qcyxxdWVyeS1zZWxlY3Rvci1iYXNlLmpzLGRvbS1leHRyYS5qcyxpby1mb3JtLmpzLG5vZGUuanMsbm9kZS1iYXNlLmpzLG5vZGUtZXZlbnQuanMsZXZlbnQtZG9tLWJhc2UuanMsZXZlbnQtZG9tLWV4dHJhLmpzLGV2ZW50LWdlc3R1cmUuanMsZXZlbnQtdG91Y2guanMsbm9kZS1hbmltLmpzLGFuaW0tdHJhbnNpdGlvbi5qcyxhbmltLWJhc2UuanM=</ActualData>
        </HTTPData>
      </HTTPDataSet>
      <IsExternalData>false</IsExternalData>
    </QueryString>
    <HTTPSplittedQueryStrings>
      <HTTPHeaderEntity name="" index="0">
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>P2Jhc2UuanMsYXR0cmlidXRlLmpzLGV2ZW50LWN1c3RvbS5qcyxldmVudC1iYXNlLmpzLGlvLmpzLGlvLWV4dHJhLmpzLGlvLWJhc2UuanMscHJvbWlzZS5qcyxkb20tYmFzZS5qcyxxdWVyeS1zZWxlY3Rvci1iYXNlLmpzLGRvbS1leHRyYS5qcyxpby1mb3JtLmpzLG5vZGUuanMsbm9kZS1iYXNlLmpzLG5vZGUtZXZlbnQuanMsZXZlbnQtZG9tLWJhc2UuanMsZXZlbnQtZG9tLWV4dHJhLmpzLGV2ZW50LWdlc3R1cmUuanMsZXZlbnQtdG91Y2guanMsbm9kZS1hbmltLmpzLGFuaW0tdHJhbnNpdGlvbi5qcyxhbmltLWJhc2UuanM=</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPHeaderEntity>
    </HTTPSplittedQueryStrings>
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Accept" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdCwgKi8qO3E9MC44</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9zZWFyY2guZGFtYWkuY24vc2VhcmNoLmh0bWw/a2V5d29yZD0lRTUlOTElQTglRTYlOUQlQjAlRTQlQkMlQTYmc3BtPWEyb2VnLmhvbWUuc2VhcmNodHh0LmRzZWFyY2hidG4=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>emgtQ04=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Zy5hbGljZG4uY29t</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cookie" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>X3VhYl9jb2xsaW5hPTE1NjAzMjU1MDg5NDI1NTA4OTExODM0MTsgX3VtZGF0YT1HNjczRkQ0NjBFQzcxQjFEODg5RUYwRjNBMkZCRDJGRTk1RkIwMDY=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9raXNzeS9rLzYuMi40Lz8/YmFzZS5qcyxhdHRyaWJ1dGUuanMsZXZlbnQtY3VzdG9tLmpzLGV2ZW50LWJhc2UuanMsaW8uanMsaW8tZXh0cmEuanMsaW8tYmFzZS5qcyxwcm9taXNlLmpzLGRvbS1iYXNlLmpzLHF1ZXJ5LXNlbGVjdG9yLWJhc2UuanMsZG9tLWV4dHJhLmpzLGlvLWZvcm0uanMsbm9kZS5qcyxub2RlLWJhc2UuanMsbm9kZS1ldmVudC5qcyxldmVudC1kb20tYmFzZS5qcyxldmVudC1kb20tZXh0cmEuanMsZXZlbnQtZ2VzdHVyZS5qcyxldmVudC10b3VjaC5qcyxub2RlLWFuaW0uanMsYW5pbS10cmFuc2l0aW9uLmpzLGFuaW0tYmFzZS5qcyBIVFRQLzEuMQ0KQWNjZXB0OiBhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCAqLyo7cT0wLjgNClJlZmVyZXI6IGh0dHBzOi8vc2VhcmNoLmRhbWFpLmNuL3NlYXJjaC5odG1sP2tleXdvcmQ9JUU1JTkxJUE4JUU2JTlEJUIwJUU0JUJDJUE2JnNwbT1hMm9lZy5ob21lLnNlYXJjaHR4dC5kc2VhcmNoYnRuDQpBY2NlcHQtTGFuZ3VhZ2U6IHpoLUNODQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXT1c2NDsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28NCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZQ0KSG9zdDogZy5hbGljZG4uY29tDQpDb25uZWN0aW9uOiBLZWVwLUFsaXZlDQpDb29raWU6IF91YWJfY29sbGluYT0xNTYwMzI1NTA4OTQyNTUwODkxMTgzNDE7IF91bWRhdGE9RzY3M0ZENDYwRUM3MUIxRDg4OUVGMEYzQTJGQkQyRkU5NUZCMDA2DQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
        <HTTPCookies>
          <HTTPHeaderEntity name="_uab_collina" index="0">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>MTU2MDMyNTUwODk0MjU1MDg5MTE4MzQx</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
          <HTTPHeaderEntity name="_umdata" index="1">
            <HTTPDataSet>
              <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
                <ActualData>RzY3M0ZENDYwRUM3MUIxRDg4OUVGMEYzQTJGQkQyRkU5NUZCMDA2</ActualData>
              </HTTPData>
            </HTTPDataSet>
            <IsExternalData>false</IsExternalData>
          </HTTPHeaderEntity>
        </HTTPCookies>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>101227</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGVuZ2luZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>YXBwbGljYXRpb24vamF2YXNjcmlwdA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTAxMjI3</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAxMiBKdW4gMjAxOSAwOTo1OToyMSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Vary" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>QWNjZXB0LUVuY29kaW5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-request-id" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NUQwMENDRjlFMDRCMjM5NDVCMUVERjUy</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-object-type" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Tm9ybWFs</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-hash-crc64ecma" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NDk2MjM4NzAwNjA0MDI2NDgxMQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-storage-class" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U3RhbmRhcmQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-MD5" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>WCtsdnNFdzVhdU9yV2R1YUZFMlpQUT09</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-oss-server-time" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Mg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bWF4LWFnZT0yNTkyMDAwLHMtbWF4YWdlPTM2MDA=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Access-Control-Allow-Origin" index="13">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Source-Scheme" index="14">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Encoding" index="15">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Ali-Swift-Global-Savetime" index="16">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTU2MDMzMzU2MQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Via" index="17">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2FjaGU0NC5sMmNuNjI4WzY3LDIwMC0wLE1dLCBjYWNoZTQ2LmwyY242MjhbODQsMF0sIGNhY2hlOC5jbjQ3MFswLDIwMC0wLEhdLCBjYWNoZTEuY240NzBbMSwwXQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Age" index="18">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MzQyNA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Cache" index="19">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SElUIFRDUF9ISVQgZGlybjo0OjEwNTI5NDg4MA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-SaveTime" index="20">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAxMiBKdW4gMjAxOSAwOTo1OToyMSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-CacheTime" index="21">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MzYwMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Timing-Allow-Origin" index="22">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="EagleId" index="23">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>N2NlZmEyYzkxNTYwMzM2OTg1MTg4MzA5OGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IFRlbmdpbmUNCkNvbnRlbnQtVHlwZTogYXBwbGljYXRpb24vamF2YXNjcmlwdA0KQ29udGVudC1MZW5ndGg6IDEwMTIyNw0KQ29ubmVjdGlvbjoga2VlcC1hbGl2ZQ0KRGF0ZTogV2VkLCAxMiBKdW4gMjAxOSAwOTo1OToyMSBHTVQNClZhcnk6IEFjY2VwdC1FbmNvZGluZw0KeC1vc3MtcmVxdWVzdC1pZDogNUQwMENDRjlFMDRCMjM5NDVCMUVERjUyDQp4LW9zcy1vYmplY3QtdHlwZTogTm9ybWFsDQp4LW9zcy1oYXNoLWNyYzY0ZWNtYTogNDk2MjM4NzAwNjA0MDI2NDgxMQ0KeC1vc3Mtc3RvcmFnZS1jbGFzczogU3RhbmRhcmQNCkNvbnRlbnQtTUQ1OiBYK2x2c0V3NWF1T3JXZHVhRkUyWlBRPT0NCngtb3NzLXNlcnZlci10aW1lOiAyDQpDYWNoZS1Db250cm9sOiBtYXgtYWdlPTI1OTIwMDAscy1tYXhhZ2U9MzYwMA0KQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luOiAqDQpYLVNvdXJjZS1TY2hlbWU6IGh0dHBzDQpDb250ZW50LUVuY29kaW5nOiBnemlwDQpBbGktU3dpZnQtR2xvYmFsLVNhdmV0aW1lOiAxNTYwMzMzNTYxDQpWaWE6IGNhY2hlNDQubDJjbjYyOFs2NywyMDAtMCxNXSwgY2FjaGU0Ni5sMmNuNjI4Wzg0LDBdLCBjYWNoZTguY240NzBbMCwyMDAtMCxIXSwgY2FjaGUxLmNuNDcwWzEsMF0NCkFnZTogMzQyNA0KWC1DYWNoZTogSElUIFRDUF9ISVQgZGlybjo0OjEwNTI5NDg4MA0KWC1Td2lmdC1TYXZlVGltZTogV2VkLCAxMiBKdW4gMjAxOSAwOTo1OToyMSBHTVQNClgtU3dpZnQtQ2FjaGVUaW1lOiAzNjAwDQpUaW1pbmctQWxsb3ctT3JpZ2luOiAqDQpFYWdsZUlkOiA3Y2VmYTJjOTE1NjAzMzY5ODUxODgzMDk4ZQ0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>ZGVmaW5lKCJiYXNlIiwgWyd1dGlsJywiYXR0cmlidXRlIl0sIGZ1bmN0aW9uKHJlcXVpcmUpIHsKdmFyIHV0aWxCYXNlID0gcmVxdWlyZSgndXRpbCcpOwp2YXIgYXR0cmlidXRlID0gcmVxdWlyZSgiYXR0cmlidXRlIik7Ci8vISBDb3B5cmlnaHQgMjAxNSwgYmFzZUA2LjEuMCBNSVQgTGljZW5zZWQsIGJ1aWxkIHRpbWU6IFRodSwgMjkgT2N0IDIwMTUgMDc6MDI6MDcgR01UIAovKgpjb21iaW5lZCBtb2R1bGVzOgpiYXNlCmJhc2UvbGliL2Jhc2UKKi8KdmFyIGJhc2VMaWJCYXNlLCBiYXNlSW5kZXg7CmJhc2VMaWJCYXNlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKiohCiAgICogQGlnbm9yZQogICAqIEtJU1NZIENsYXNzIFN5c3RlbQogICAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tCiAgICovCiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgQXR0cmlidXRlID0gYXR0cmlidXRlOwogIHZhciB1Y2ZpcnN0ID0gdXRpbC51Y2ZpcnN0LCBPTl9TRVQgPSAnX29uU2V0Jywgbm9vcCA9IHV0aWwubm9vcDsKICBmdW5jdGlvbiBfX2dldEhvb2sobWV0aG9kLCByZXZlcnNlKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKG9yaWdGbikgewogICAgICByZXR1cm4gZnVuY3Rpb24gd3JhcCgpIHsKICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgaWYgKHJldmVyc2UpIHsKICAgICAgICAgIGlmIChvcmlnRm4gIT09IG5vb3ApIHsKICAgICAgICAgICAgb3JpZ0ZuLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHNlbGYuY2FsbFN1cGVyLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7CiAgICAgICAgfQogICAgICAgIC8vIGNhbiBub3QgdXNlIHdyYXAgaW4gb2xkIGllCiAgICAgICAgLypqc2hpbnQgbm9hcmc6IGZhbHNlKi8KICAgICAgICB2YXIgZXh0ZW5zaW9ucyA9IGFyZ3VtZW50cy5jYWxsZWUuX19vd25lcl9fLl9fZXh0ZW5zaW9uc19fIHx8IFtdOwogICAgICAgIGlmIChyZXZlcnNlKSB7CiAgICAgICAgICBleHRlbnNpb25zLnJldmVyc2UoKTsKICAgICAgICB9CiAgICAgICAgY2FsbEV4dGVuc2lvbnNNZXRob2Qoc2VsZiwgZXh0ZW5zaW9ucywgbWV0aG9kLCBhcmd1bWVudHMpOwogICAgICAgIGlmIChyZXZlcnNlKSB7CiAgICAgICAgICBzZWxmLmNhbGxTdXBlci5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAob3JpZ0ZuICE9PSBub29wKSB7CiAgICAgICAgICAgIG9yaWdGbi5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgIH07CiAgfQogIC8vbm9pbnNwZWN0aW9uIEpTVmFsaWRhdGVKU0RvYwogIC8qKgogICAqIEBjbGFzcyBCYXNlCiAgICogQG1peGlucyBiYXNlCiAgICoKICAgKiBBIGJhc2UgY2xhc3Mgd2hpY2ggb2JqZWN0cyByZXF1aXJpbmcgYmFzZXMsIGV4dGVuc2lvbiwgcGx1Z2luLCBjdXN0b20gZXZlbnQgc3VwcG9ydCBjYW4KICAgKiBleHRlbmQuCiAgICogYmFzZXMgY29uZmlndXJlZAogICAqIHRocm91Z2ggdGhlIHN0YXRpYyB7QGxpbmsgQmFzZSNzdGF0aWMtQVRUUlN9IHByb3BlcnR5IGZvciBlYWNoIGNsYXNzCiAgICogaW4gdGhlIGhpZXJhcmNoeSB3aWxsIGJlIGluaXRpYWxpemVkIGJ5IEJhc2UuCiAgICovCiAgdmFyIEJhc2UgPSBBdHRyaWJ1dGUuZXh0ZW5kKHsKICAgIGNvbnN0cnVjdG9yOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgc2VsZi5jYWxsU3VwZXIuYXBwbHkoc2VsZiwgYXJndW1lbnRzKTsKICAgICAgLy8gc2V0dXAgbGlzdGVuZXJzCiAgICAgIHZhciBsaXN0ZW5lcnMgPSBzZWxmLmdldCgnbGlzdGVuZXJzJyk7CiAgICAgIGlmIChsaXN0ZW5lcnMpIHsKICAgICAgICBmb3IgKHZhciBuIGluIGxpc3RlbmVycykgewogICAgICAgICAgc2VsZi5vbihuLCBsaXN0ZW5lcnNbbl0pOwogICAgICAgIH0KICAgICAgfQogICAgICAvLyBpbml0aWFsaXplcgogICAgICBzZWxmLmluaXRpYWxpemVyKCk7CiAgICAgIC8vIGNhbGwgcGx1Z2lucwogICAgICBjb25zdHJ1Y3RQbHVnaW5zKHNlbGYpOwogICAgICBjYWxsUGx1Z2luc01ldGhvZC5jYWxsKHNlbGYsICdwbHVnaW5Jbml0aWFsaXplcicpOwogICAgICAvLyBiaW5kIGF0dHIgY2hhbmdlCiAgICAgIHNlbGYuYmluZEludGVybmFsKCk7CiAgICAgIC8vIHN5bmMgYXR0cgogICAgICBzZWxmLnN5bmNJbnRlcm5hbCgpOwogICAgfSwKICAgIGluaXRpYWxpemVyOiBub29wLAogICAgX19nZXRIb29rOiBfX2dldEhvb2ssCiAgICBfX2NhbGxQbHVnaW5zTWV0aG9kOiBjYWxsUGx1Z2luc01ldGhvZCwKICAgIC8qKgogICAgICogYmluZCBiYXNlIGNoYW5nZSBldmVudAogICAgICogQHByb3RlY3RlZAogICAgICovCiAgICBiaW5kSW50ZXJuYWw6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBhdHRycyA9IHNlbGYuZ2V0QXR0cnMoKSwgYXR0ciwgbTsKICAgICAgZm9yIChhdHRyIGluIGF0dHJzKSB7CiAgICAgICAgbSA9IE9OX1NFVCArIHVjZmlyc3QoYXR0cik7CiAgICAgICAgaWYgKHNlbGZbbV0pIHsKICAgICAgICAgIC8vIOiHquWKqOe7keWumuS6i+S7tuWIsOWvueW6lOWHveaVsAogICAgICAgICAgc2VsZi5vbignYWZ0ZXInICsgdWNmaXJzdChhdHRyKSArICdDaGFuZ2UnLCBvblNldEF0dHJDaGFuZ2UpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIC8qKgogICAgICogc3luYyBiYXNlIGNoYW5nZSBldmVudAogICAgICogQHByb3RlY3RlZAogICAgICovCiAgICBzeW5jSW50ZXJuYWw6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBjcyA9IFtdLCBpLCBjID0gc2VsZi5jb25zdHJ1Y3RvciwgYXR0cnMgPSBzZWxmLmdldEF0dHJzKCk7CiAgICAgIHdoaWxlIChjKSB7CiAgICAgICAgY3MucHVzaChjKTsKICAgICAgICBjID0gYy5zdXBlcmNsYXNzICYmIGMuc3VwZXJjbGFzcy5jb25zdHJ1Y3RvcjsKICAgICAgfQogICAgICBjcy5yZXZlcnNlKCk7CiAgICAgIC8vIGZyb20gc3VwZXIgY2xhc3MgdG8gc3ViIGNsYXNzCiAgICAgIGZvciAoaSA9IDA7IGkgPCBjcy5sZW5ndGg7IGkrKykgewogICAgICAgIHZhciBBVFRSUyA9IGNzW2ldLkFUVFJTIHx8IHt9OwogICAgICAgIGZvciAodmFyIGJhc2VOYW1lIGluIEFUVFJTKSB7CiAgICAgICAgICBpZiAoYmFzZU5hbWUgaW4gYXR0cnMpIHsKICAgICAgICAgICAgdmFyIGJhc2VWYWx1ZSwgb25TZXRNZXRob2Q7CiAgICAgICAgICAgIHZhciBvblNldE1ldGhvZE5hbWUgPSBPTl9TRVQgKyB1Y2ZpcnN0KGJhc2VOYW1lKTsKICAgICAgICAgICAgLy8g5a2Y5Zyo5pa55rOV77yM5bm25LiU55So5oi36K6+572u5LqG5Yid5aeL5YC85oiW6ICF5a2Y5Zyo6buY6K6k5YC877yM5bCx5ZCM5q2l54q25oCBCiAgICAgICAgICAgIGlmICgob25TZXRNZXRob2QgPSBzZWxmW29uU2V0TWV0aG9kTmFtZV0pICYmIC8vIOeUqOaIt+WmguaenOiuvue9ruS6huaYvuW8j+S4jeWQjOatpe+8jOWwseS4jeWQjOatpe+8jAogICAgICAgICAgICAgIC8vIOavlOWmguS4gOS6m+WAvOS7jiBodG1sIOS4reivu+WPlu+8jOS4jemcgOimgeWQjOatpeWGjeasoeiuvue9rgogICAgICAgICAgICAgIGF0dHJzW2Jhc2VOYW1lXS5zeW5jICE9PSAwICYmIChiYXNlVmFsdWUgPSBzZWxmLmdldChiYXNlTmFtZSkpICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgICBvblNldE1ldGhvZC5jYWxsKHNlbGYsIGJhc2VWYWx1ZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICAvKioKICAgICAqIHBsdWdpbiBhIG5ldyBwbHVnaW5zIHRvIGN1cnJlbnQgaW5zdGFuY2UKICAgICAqIEBwYXJhbSB7RnVuY3Rpb258T2JqZWN0fSBwbHVnaW4KICAgICAqIEBjaGFpbmFibGUKICAgICAqLwogICAgcGx1ZzogZnVuY3Rpb24gKHBsdWdpbikgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGlmICh0eXBlb2YgcGx1Z2luID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgdmFyIFBsdWdpbiA9IHBsdWdpbjsKICAgICAgICBwbHVnaW4gPSBuZXcgUGx1Z2luKCk7CiAgICAgIH0KICAgICAgLy8gaW5pdGlhbGl6ZSBwbHVnaW4KICAgICAgLy9ub2luc3BlY3Rpb24gSlNVbnJlc29sdmVkVmFyaWFibGUKICAgICAgaWYgKHBsdWdpbi5wbHVnaW5Jbml0aWFsaXplcikgewogICAgICAgIC8vIG5vaW5zcGVjdGlvbiBKU1VucmVzb2x2ZWRGdW5jdGlvbgogICAgICAgIHBsdWdpbi5wbHVnaW5Jbml0aWFsaXplcihzZWxmKTsKICAgICAgfQogICAgICBzZWxmLmdldCgncGx1Z2lucycpLnB1c2gocGx1Z2luKTsKICAgICAgcmV0dXJuIHNlbGY7CiAgICB9LAogICAgLyoqCiAgICAgKiB1bnBsdWcgYnkgcGx1Z2luSWQgb3IgcGx1Z2luIGluc3RhbmNlLgogICAgICogaWYgY2FsbGVkIHdpdGggbm8gcGFyYW1ldGVyLCB0aGVuIGRlc3Ryb3kgYWxsIHBsdWdpbnMuCiAgICAgKiBAcGFyYW0ge09iamVjdHxTdHJpbmd9IFtwbHVnaW5dCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKi8KICAgIHVucGx1ZzogZnVuY3Rpb24gKHBsdWdpbikgewogICAgICB2YXIgcGx1Z2lucyA9IFtdLCBzZWxmID0gdGhpcywgaXNTdHJpbmcgPSB0eXBlb2YgcGx1Z2luID09PSAnc3RyaW5nJzsKICAgICAgdXRpbC5lYWNoKHNlbGYuZ2V0KCdwbHVnaW5zJyksIGZ1bmN0aW9uIChwKSB7CiAgICAgICAgdmFyIGtlZXAgPSAwLCBwbHVnaW5JZDsKICAgICAgICBpZiAocGx1Z2luKSB7CiAgICAgICAgICBpZiAoaXNTdHJpbmcpIHsKICAgICAgICAgICAgLy8gdXNlciBkZWZpbmVkIHRha2VzIHByaW9yaXR5CiAgICAgICAgICAgIHBsdWdpbklkID0gcC5nZXQgJiYgcC5nZXQoJ3BsdWdpbklkJykgfHwgcC5wbHVnaW5JZDsKICAgICAgICAgICAgaWYgKHBsdWdpbklkICE9PSBwbHVnaW4pIHsKICAgICAgICAgICAgICBwbHVnaW5zLnB1c2gocCk7CiAgICAgICAgICAgICAga2VlcCA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmIChwICE9PSBwbHVnaW4pIHsKICAgICAgICAgICAgICBwbHVnaW5zLnB1c2gocCk7CiAgICAgICAgICAgICAga2VlcCA9IDE7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFrZWVwKSB7CiAgICAgICAgICBwLnBsdWdpbkRlc3RydWN0b3Ioc2VsZik7CiAgICAgICAgfQogICAgICB9KTsKICAgICAgc2VsZi5zZXRJbnRlcm5hbCgncGx1Z2lucycsIHBsdWdpbnMpOwogICAgICByZXR1cm4gc2VsZjsKICAgIH0sCiAgICAvKioKICAgICAqIGdldCBzcGVjaWZpZWQgcGx1Z2luIGluc3RhbmNlIGJ5IGlkCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gaWQgcGx1Z2luSWQgb2YgcGx1Z2luIGluc3RhbmNlCiAgICAgKiBAcmV0dXJuIHtPYmplY3R9CiAgICAgKi8KICAgIGdldFBsdWdpbjogZnVuY3Rpb24gKGlkKSB7CiAgICAgIHZhciBwbHVnaW4gPSBudWxsOwogICAgICB1dGlsLmVhY2godGhpcy5nZXQoJ3BsdWdpbnMnKSwgZnVuY3Rpb24gKHApIHsKICAgICAgICAvLyB1c2VyIGRlZmluZWQgdGFrZXMgcHJpb3JpdHkKICAgICAgICB2YXIgcGx1Z2luSWQgPSBwLmdldCAmJiBwLmdldCgncGx1Z2luSWQnKSB8fCBwLnBsdWdpbklkOwogICAgICAgIGlmIChwbHVnaW5JZCA9PT0gaWQpIHsKICAgICAgICAgIHBsdWdpbiA9IHA7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0pOwogICAgICByZXR1cm4gcGx1Z2luOwogICAgfSwKICAgIGRlc3RydWN0b3I6IG5vb3AsCiAgICBkZXN0cm95OiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgYXJncyA9IHV0aWwubWFrZUFycmF5KGFyZ3VtZW50cyk7CiAgICAgIGlmICghc2VsZi5nZXQoJ2Rlc3Ryb3llZCcpKSB7CiAgICAgICAgY2FsbFBsdWdpbnNNZXRob2QuY2FsbChzZWxmLCAncGx1Z2luRGVzdHJ1Y3RvcicsIGFyZ3MpOwogICAgICAgIHNlbGYuZGVzdHJ1Y3Rvci5hcHBseShzZWxmLCBhcmdzKTsKICAgICAgICBzZWxmLnNldCgnZGVzdHJveWVkJywgdHJ1ZSk7CiAgICAgICAgc2VsZi5maXJlKCdkZXN0cm95Jyk7CiAgICAgICAgc2VsZi5kZXRhY2goKTsKICAgICAgfQogICAgfQogIH0pOwogIHV0aWwubWl4KEJhc2UsIHsKICAgIF9faG9va3NfXzogewogICAgICBpbml0aWFsaXplcjogX19nZXRIb29rKCksCiAgICAgIGRlc3RydWN0b3I6IF9fZ2V0SG9vaygnX19kZXN0cnVjdG9yJywgdHJ1ZSkKICAgIH0sCiAgICBBVFRSUzogewogICAgICAvKioKICAgICAgICogUGx1Z2lucyBmb3IgY3VycmVudCBjb21wb25lbnQuCiAgICAgICAqIEBjZmcge0Z1bmN0aW9uW10vT2JqZWN0W119IHBsdWdpbnMKICAgICAgICovCiAgICAgIC8qKgogICAgICAgKiBAaWdub3JlCiAgICAgICAqLwogICAgICBwbHVnaW5zOiB7CiAgICAgICAgdmFsdWVGbjogZnVuY3Rpb24gKCkgewogICAgICAgICAgcmV0dXJuIFtdOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZGVzdHJveWVkOiB7IHZhbHVlOiBmYWxzZSB9LAogICAgICAvKioKICAgICAgICogQ29uZmlnIGxpc3RlbmVyIG9uIGNyZWF0ZWQuCiAgICAgICAqCiAgICAgICAqIGZvciBleGFtcGxlOgogICAgICAgKgogICAgICAgKiAgICAgIHsKICAgICAgICAgICAqICAgICAgICAgIGNsaWNrOnsKICAgICAgICAgICAqICAgICAgICAgICAgICBjb250ZXh0Ont4OjF9LAogICAgICAgICAgICogICAgICAgICAgICAgIGZuOmZ1bmN0aW9uKCl7CiAgICAgICAgICAgKiAgICAgICAgICAgICAgICAgIGFsZXJ0KHRoaXMueCk7CiAgICAgICAgICAgKiAgICAgICAgICAgICAgfQogICAgICAgICAgICogICAgICAgICAgfQogICAgICAgICAgICogICAgICB9CiAgICAgICAqICAgICAgLy8gb3IKICAgICAgICogICAgICB7CiAgICAgICAgICAgKiAgICAgICAgICBjbGljazpmdW5jdGlvbigpewogICAgICAgICAgICogICAgICAgICAgICAgIGFsZXJ0KHRoaXMueCk7CiAgICAgICAgICAgKiAgICAgICAgICB9CiAgICAgICAgICAgKiAgICAgIH0KICAgICAgICoKICAgICAgICogQGNmZyB7T2JqZWN0fSBsaXN0ZW5lcnMKICAgICAgICovCiAgICAgIC8qKgogICAgICAgKiBAaWdub3JlCiAgICAgICAqLwogICAgICBsaXN0ZW5lcnM6IHt9CiAgICB9LAogICAgLyoqCiAgICAgKiBjcmVhdGUgYSBuZXcgY2xhc3MgZnJvbSBleHRlbnNpb25zIGFuZCBzdGF0aWMvcHJvdG90eXBlIHByb3BlcnRpZXMvbWV0aG9kcy4KICAgICAqIEBwYXJhbSB7RnVuY3Rpb25bXX0gW2V4dGVuc2lvbnNdIGV4dGVuc2lvbiBjbGFzc2VzCiAgICAgKiBAcGFyYW0ge09iamVjdH0gW3B4XSBrZXktdmFsdWUgbWFwIGZvciBwcm90b3R5cGUgcHJvcGVydGllcy9tZXRob2RzLgogICAgICogQHBhcmFtIHtPYmplY3R9IFtzeF0ga2V5LXZhbHVlIG1hcCBmb3Igc3RhdGljIHByb3BlcnRpZXMvbWV0aG9kcy4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbc3gubmFtZV0gbmV3IENsYXNzJ3MgbmFtZS4KICAgICAqIEByZXR1cm4ge0Z1bmN0aW9ufSBuZXcgY2xhc3Mgd2hpY2ggZXh0ZW5kIGNhbGxlZCwgaXQgYWxzbyBoYXMgYSBzdGF0aWMgZXh0ZW5kIG1ldGhvZAogICAgICogQHN0YXRpYwogICAgICoKICAgICAqIGZvciBleGFtcGxlOgogICAgICoKICAgICAqICAgICAgdmFyIFBhcmVudCA9IEJhc2UuZXh0ZW5kKHsKICAgICAgICAgKiAgICAgICAgICBpc1BhcmVudDogMQogICAgICAgICAqICAgICAgfSk7CiAgICAgKiAgICAgIHZhciBDaGlsZCA9IFBhcmVudC5leHRlbmQoewogICAgICAgICAqICAgICAgICAgIGlzQ2hpbGQ6IDEsCiAgICAgICAgICogICAgICAgICAgaXNQYXJlbnQ6IDAKICAgICAgICAgKiAgICAgIH0pCiAgICAgKi8KICAgIGV4dGVuZDogZnVuY3Rpb24gZXh0ZW5kKGV4dGVuc2lvbnMsIHB4LCBzeCkgewogICAgICBpZiAoIXV0aWwuaXNBcnJheShleHRlbnNpb25zKSkgewogICAgICAgIHN4ID0gcHg7CiAgICAgICAgcHggPSAvKipAdHlwZSB7T2JqZWN0fSBAaWdub3JlKi8KICAgICAgICBleHRlbnNpb25zOwogICAgICAgIGV4dGVuc2lvbnMgPSBbXTsKICAgICAgfQogICAgICB2YXIgU3ViQ2xhc3MgPSBBdHRyaWJ1dGUuZXh0ZW5kLmNhbGwodGhpcywgcHgsIHN4KTsKICAgICAgU3ViQ2xhc3MuX19leHRlbnNpb25zX18gPSBleHRlbnNpb25zOwogICAgICAvLyBzdHViIGhvb2tzIGZvciBleHRlbnNpb25zCiAgICAgIGJhc2VBZGRNZW1iZXJzLmNhbGwoU3ViQ2xhc3MsIHt9KTsKICAgICAgLy8gbWVyZ2UgZXh0ZW5zaW9ucwogICAgICBpZiAoZXh0ZW5zaW9ucy5sZW5ndGgpIHsKICAgICAgICB2YXIgYXR0cnMgPSB7fTsKICAgICAgICB2YXIgcHJvdG90eXBlID0ge307CiAgICAgICAgLy8gW2V4MSxleDJd77yM5omp5bGV57G75ZCO6Z2i55qE5LyY5YWI77yMZXgyIOWumuS5ieeahOimhuebliBleDEg5a6a5LmJ55qECiAgICAgICAgLy8g5Li757G75pyA5LyY5YWICiAgICAgICAgdXRpbC5lYWNoKGV4dGVuc2lvbnMuY29uY2F0KFN1YkNsYXNzKSwgZnVuY3Rpb24gKGV4dCkgewogICAgICAgICAgaWYgKGV4dCkgewogICAgICAgICAgICAvLyDlkIjlubYgQVRUUlMg5Yiw5Li757G7CiAgICAgICAgICAgIC8vIOS4jeimhuebluS4u+exu+S4iueahOWumuS5iSjkuLvnsbvkvY3kuo4gY29uc3RydWN0b3JzIOacgOWQjikKICAgICAgICAgICAgLy8g5Zug5Li657un5om/5bGC5qyh5LiK5omp5bGV57G75q+U5Li757G75bGC5qyh6auYCiAgICAgICAgICAgIC8vIOazqOaEj++8muacgOWlvSB2YWx1ZSDlv4XpobvmmK/nroDljZXlr7nosaHvvIzoh6rlrprkuYkgbmV3IOWHuuadpeeahOWvueixoeWwseS8muaciemXrumimAogICAgICAgICAgICAvLyAo55SoIGZ1bmN0aW9uIHJldHVybiDlh7rmnaUpIQogICAgICAgICAgICAvLyBhIHt5Ont2YWx1ZToyfX0gYiB7eTp7dmFsdWU6MyxnZXR0ZXI6Zm59fQogICAgICAgICAgICAvLyBiIGlzIGEgZXh0ZW5zaW9uIG9mIGEKICAgICAgICAgICAgLy8gPT4KICAgICAgICAgICAgLy8gYSB7eTp7dmFsdWU6MixnZXR0ZXI6Zm59fQogICAgICAgICAgICB1dGlsLmVhY2goZXh0LkFUVFJTLCBmdW5jdGlvbiAodiwgbmFtZSkgewogICAgICAgICAgICAgIHZhciBhdiA9IGF0dHJzW25hbWVdID0gYXR0cnNbbmFtZV0gfHwge307CiAgICAgICAgICAgICAgdXRpbC5taXgoYXYsIHYpOwogICAgICAgICAgICB9KTsKICAgICAgICAgICAgLy8g5pa55rOV5ZCI5bm2CiAgICAgICAgICAgIHZhciBleHAgPSBleHQucHJvdG90eXBlLCBwOwogICAgICAgICAgICBmb3IgKHAgaW4gZXhwKSB7CiAgICAgICAgICAgICAgLy8gZG8gbm90IG1lc3Mgd2l0aCBwYXJlbnQgY2xhc3MKICAgICAgICAgICAgICBpZiAoZXhwLmhhc093blByb3BlcnR5KHApKSB7CiAgICAgICAgICAgICAgICBwcm90b3R5cGVbcF0gPSBleHBbcF07CiAgICAgICAgICAgICAgfQogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgICAgU3ViQ2xhc3MuQVRUUlMgPSBhdHRyczsKICAgICAgICBwcm90b3R5cGUuY29uc3RydWN0b3IgPSBTdWJDbGFzczsKICAgICAgICB1dGlsLmF1Z21lbnQoU3ViQ2xhc3MsIHByb3RvdHlwZSk7CiAgICAgIH0KICAgICAgU3ViQ2xhc3MuZXh0ZW5kID0gc3ggJiYgc3guZXh0ZW5kIHx8IGV4dGVuZDsKICAgICAgU3ViQ2xhc3MuYWRkTWVtYmVycyA9IGJhc2VBZGRNZW1iZXJzOwogICAgICByZXR1cm4gU3ViQ2xhc3M7CiAgICB9CiAgfSk7CiAgdmFyIGFkZE1lbWJlcnMgPSBCYXNlLmFkZE1lbWJlcnM7CiAgZnVuY3Rpb24gYmFzZUFkZE1lbWJlcnMocHgpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHZhciBleHRlbnNpb25zID0gc2VsZi5fX2V4dGVuc2lvbnNfXzsKICAgIHZhciBob29rcyA9IHNlbGYuX19ob29rc19fOwogICAgdmFyIHByb3RvID0gc2VsZi5wcm90b3R5cGU7CiAgICBpZiAoZXh0ZW5zaW9ucy5sZW5ndGggJiYgaG9va3MpIHsKICAgICAgLy8gc3R1YiBmb3IgY2FsbCBleHRlbnNpb24gbWV0aG9kCiAgICAgIGZvciAodmFyIGggaW4gaG9va3MpIHsKICAgICAgICAvLyBkbyBub3Qgb3ZlcnJpZGUgY3VycmVudCB3aXRoIHN0dWIgZnVuY3Rpb24KICAgICAgICBpZiAocHJvdG8uaGFzT3duUHJvcGVydHkoaCkgJiYgIXB4Lmhhc093blByb3BlcnR5KGgpKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgcHhbaF0gPSBweFtoXSB8fCBub29wOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gYWRkTWVtYmVycy5jYWxsKHNlbGYsIHB4KTsKICB9CiAgLyoqCiAgICogVGhlIGRlZmF1bHQgc2V0IG9mIGJhc2VzIHdoaWNoIHdpbGwgYmUgYXZhaWxhYmxlIGZvciBpbnN0YW5jZXMgb2YgdGhpcyBjbGFzcywgYW5kCiAgICogdGhlaXIgY29uZmlndXJhdGlvbgogICAqCiAgICogQnkgZGVmYXVsdCBpZiB0aGUgdmFsdWUgaXMgYW4gb2JqZWN0IGxpdGVyYWwgb3IgYW4gYXJyYXkgaXQgd2lsbCBiZSAnc2hhbGxvdycgY2xvbmVkLCB0bwogICAqIHByb3RlY3QgdGhlIGRlZmF1bHQgdmFsdWUuCiAgICoKICAgKiAgICAgIGZvciBleGFtcGxlOgogICAqICAgICAgQGV4YW1wbGUKICAgKiAgICAgIHsKICAgICAgICogICAgICAgICAgeDp7CiAgICAgICAqICAgICAgICAgICAgICB2YWx1ZTogLy8gZGVmYXVsdCB2YWx1ZQogICAgICAgKiAgICAgICAgICAgICAgdmFsdWVGbjogLy8gZGVmYXVsdCBmdW5jdGlvbiB0byBnZXQgdmFsdWUKICAgICAgICogICAgICAgICAgICAgIGdldHRlcjogLy8gZ2V0dGVyIGZ1bmN0aW9uCiAgICAgICAqICAgICAgICAgICAgICBzZXR0ZXI6IC8vIHNldHRlciBmdW5jdGlvbgogICAgICAgKiAgICAgICAgICB9CiAgICAgICAqICAgICAgfQogICAqCiAgICogQHByb3BlcnR5IEFUVFJTCiAgICogQG1lbWJlciBCYXNlCiAgICogQHN0YXRpYwogICAqIEB0eXBlIHtPYmplY3R9CiAgICovCiAgZnVuY3Rpb24gb25TZXRBdHRyQ2hhbmdlKGUpIHsKICAgIHZhciBzZWxmID0gdGhpcywgbWV0aG9kOwogICAgLy8gaWdub3JlIGJ1YmJsaW5nCiAgICBpZiAoZS50YXJnZXQgPT09IHNlbGYpIHsKICAgICAgbWV0aG9kID0gc2VsZltPTl9TRVQgKyBlLnR5cGUuc2xpY2UoNSkuc2xpY2UoMCwgLTYpXTsKICAgICAgbWV0aG9kLmNhbGwoc2VsZiwgZS5uZXdWYWwsIGUpOwogICAgfQogIH0KICBmdW5jdGlvbiBjb25zdHJ1Y3RQbHVnaW5zKHNlbGYpIHsKICAgIHZhciBwbHVnaW5zID0gc2VsZi5nZXQoJ3BsdWdpbnMnKSwgUGx1Z2luOwogICAgdXRpbC5lYWNoKHBsdWdpbnMsIGZ1bmN0aW9uIChwbHVnaW4sIGkpIHsKICAgICAgaWYgKHR5cGVvZiBwbHVnaW4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBQbHVnaW4gPSBwbHVnaW47CiAgICAgICAgcGx1Z2luc1tpXSA9IG5ldyBQbHVnaW4oKTsKICAgICAgfQogICAgfSk7CiAgfQogIGZ1bmN0aW9uIGNhbGxQbHVnaW5zTWV0aG9kKG1ldGhvZCwgYXJncykgewogICAgdmFyIGxlbiwgZm4sIHNlbGYgPSB0aGlzLCBwbHVnaW5zID0gc2VsZi5nZXQoJ3BsdWdpbnMnKTsKICAgIGFyZ3MgPSBhcmdzIHx8IFtdOwogICAgYXJncyA9IFtzZWxmXS5jb25jYXQoYXJncyk7CiAgICBpZiAobGVuID0gcGx1Z2lucy5sZW5ndGgpIHsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgIGZuID0gcGx1Z2luc1tpXVttZXRob2RdOwogICAgICAgIGlmIChmbikgewogICAgICAgICAgZm4uYXBwbHkocGx1Z2luc1tpXSwgYXJncyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNhbGxFeHRlbnNpb25zTWV0aG9kKHNlbGYsIGV4dGVuc2lvbnMsIG1ldGhvZCwgYXJncykgewogICAgdmFyIGxlbjsKICAgIGlmIChsZW4gPSBleHRlbnNpb25zICYmIGV4dGVuc2lvbnMubGVuZ3RoKSB7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgbGVuOyBpKyspIHsKICAgICAgICB2YXIgZm4gPSBleHRlbnNpb25zW2ldICYmICghbWV0aG9kID8gZXh0ZW5zaW9uc1tpXSA6IGV4dGVuc2lvbnNbaV0ucHJvdG90eXBlW21ldGhvZF0pOwogICAgICAgIGlmIChmbikgewogICAgICAgICAgZm4uYXBwbHkoc2VsZiwgYXJncyB8fCBbXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfQogIGV4cG9ydHMgPSBCYXNlOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmJhc2VJbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZXhwb3J0cyA9IGJhc2VMaWJCYXNlOwogIHJldHVybiBleHBvcnRzOwp9KCk7CnJldHVybiBiYXNlSW5kZXg7Cn0pO2RlZmluZSgiYXR0cmlidXRlIiwgWyd1dGlsJywiZXZlbnQtY3VzdG9tIl0sIGZ1bmN0aW9uKHJlcXVpcmUpIHsKdmFyIHV0aWxCYXNlID0gcmVxdWlyZSgndXRpbCcpOwp2YXIgZXZlbnRDdXN0b20gPSByZXF1aXJlKCJldmVudC1jdXN0b20iKTsKLy8hIENvcHlyaWdodCAyMDE1LCBhdHRyaWJ1dGVANi4xLjAgTUlUIExpY2Vuc2VkLCBidWlsZCB0aW1lOiBUaHUsIDI5IE9jdCAyMDE1IDA3OjAwOjI1IEdNVCAKLyoKY29tYmluZWQgbW9kdWxlczoKYXR0cmlidXRlCmF0dHJpYnV0ZS9saWIvYXR0cmlidXRlCiovCnZhciBhdHRyaWJ1dGVMaWJBdHRyaWJ1dGUsIGF0dHJpYnV0ZUluZGV4OwphdHRyaWJ1dGVMaWJBdHRyaWJ1dGUgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKiEKICAgKiBAaWdub3JlCiAgICogYXR0cmlidXRlIG1hbmFnZW1lbnQKICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbSwgbGlmZXNpbmdlckBnbWFpbC5jb20KICAgKi8KICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIC8qIGdsb2JhbCBDdXN0b21FdmVudDogdHJ1ZSAqLwogIHZhciBDdXN0b21FdmVudCA9IGV2ZW50Q3VzdG9tOwogIGZ1bmN0aW9uIGJpbmQodikgewogICAgaWYgKHYgPT09IHV0aWwubm9vcCkgewogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICB9OwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIHV0aWwuYmluZCh2KTsKICAgIH0KICB9CiAgLy8gYXRvbWljIGZsYWcKICB2YXIgSU5WQUxJRCA9IHt9OwogIHZhciBGQUxTRSA9IGZhbHNlOwogIGZ1bmN0aW9uIG5vcm1hbEZuKGhvc3QsIG1ldGhvZCkgewogICAgaWYgKHR5cGVvZiBtZXRob2QgPT09ICdzdHJpbmcnKSB7CiAgICAgIHJldHVybiBob3N0W21ldGhvZF07CiAgICB9CiAgICByZXR1cm4gbWV0aG9kOwogIH0KICBmdW5jdGlvbiBnZXRBdHRyVmFscyhzZWxmKSB7CiAgICByZXR1cm4gc2VsZi5fX2F0dHJWYWxzIHx8IChzZWxmLl9fYXR0clZhbHMgPSB7fSk7CiAgfQogIGZ1bmN0aW9uIHdoZW5BdHRyQ2hhbmdlRXZlbnROYW1lKHdoZW4sIG5hbWUpIHsKICAgIHJldHVybiB3aGVuICsgdXRpbC51Y2ZpcnN0KG5hbWUpICsgJ0NoYW5nZSc7CiAgfQogIC8vIGZpcmUgYXR0cmlidXRlIHZhbHVlIGNoYW5nZQogIGZ1bmN0aW9uIF9fZmlyZUF0dHJDaGFuZ2Uoc2VsZiwgd2hlbiwgbmFtZSwgcHJldlZhbCwgbmV3VmFsLCBzdWJBdHRyTmFtZSwgYXR0ck5hbWUsIGRhdGEpIHsKICAgIGF0dHJOYW1lID0gYXR0ck5hbWUgfHwgbmFtZTsKICAgIHJldHVybiBzZWxmLmZpcmUod2hlbkF0dHJDaGFuZ2VFdmVudE5hbWUod2hlbiwgbmFtZSksIHV0aWwubWl4KHsKICAgICAgYXR0ck5hbWU6IGF0dHJOYW1lLAogICAgICBzdWJBdHRyTmFtZTogc3ViQXR0ck5hbWUsCiAgICAgIHByZXZWYWw6IHByZXZWYWwsCiAgICAgIG5ld1ZhbDogbmV3VmFsCiAgICB9LCBkYXRhKSk7CiAgfQogIGZ1bmN0aW9uIGVuc3VyZU5vbkVtcHR5KG9iaiwgbmFtZSwgZG9Ob3RDcmVhdGUpIHsKICAgIHZhciByZXQgPSBvYmpbbmFtZV07CiAgICBpZiAoIWRvTm90Q3JlYXRlICYmICFyZXQpIHsKICAgICAgb2JqW25hbWVdID0gcmV0ID0ge307CiAgICB9CiAgICByZXR1cm4gcmV0IHx8IHt9OwogIH0KICAvKgogICBvLCBbeCx5LHpdID0+IG9beF1beV1bel0KICAgKi8KICBmdW5jdGlvbiBnZXRWYWx1ZUJ5UGF0aChvLCBwYXRoKSB7CiAgICBmb3IgKHZhciBpID0gMCwgbGVuID0gcGF0aC5sZW5ndGg7IG8gIT09IHVuZGVmaW5lZCAmJiBpIDwgbGVuOyBpKyspIHsKICAgICAgbyA9IG9bcGF0aFtpXV07CiAgICB9CiAgICByZXR1cm4gbzsKICB9CiAgLyoKICAgbywgW3gseSx6XSwgdmFsID0+IG9beF1beV1bel09dmFsCiAgICovCiAgZnVuY3Rpb24gc2V0VmFsdWVCeVBhdGgobywgcGF0aCwgdmFsKSB7CiAgICB2YXIgbGVuID0gcGF0aC5sZW5ndGggLSAxLCBzID0gbzsKICAgIGlmIChsZW4gPj0gMCkgewogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgbyA9IG9bcGF0aFtpXV07CiAgICAgIH0KICAgICAgaWYgKG8gIT09IHVuZGVmaW5lZCkgewogICAgICAgIG9bcGF0aFtpXV0gPSB2YWw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcyA9IHVuZGVmaW5lZDsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHM7CiAgfQogIGZ1bmN0aW9uIGdldFBhdGhOYW1lUGFpcihuYW1lKSB7CiAgICB2YXIgcGF0aDsKICAgIGlmIChuYW1lLmluZGV4T2YoJy4nKSAhPT0gLTEpIHsKICAgICAgcGF0aCA9IG5hbWUuc3BsaXQoJy4nKTsKICAgICAgbmFtZSA9IHBhdGguc2hpZnQoKTsKICAgIH0KICAgIHJldHVybiB7CiAgICAgIHBhdGg6IHBhdGgsCiAgICAgIG5hbWU6IG5hbWUKICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldFZhbHVlQnlTdWJWYWx1ZShwcmV2VmFsLCBwYXRoLCB2YWx1ZSkgewogICAgdmFyIHRtcCA9IHZhbHVlOwogICAgaWYgKHBhdGgpIHsKICAgICAgaWYgKHByZXZWYWwgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHRtcCA9IHt9OwogICAgICB9IGVsc2UgewogICAgICAgIHRtcCA9IHV0aWwuY2xvbmUocHJldlZhbCk7CiAgICAgIH0KICAgICAgc2V0VmFsdWVCeVBhdGgodG1wLCBwYXRoLCB2YWx1ZSk7CiAgICB9CiAgICByZXR1cm4gdG1wOwogIH0KICBmdW5jdGlvbiBwcmVwYXJlRGVmYXVsdFNldEZuKHNlbGYsIG5hbWUpIHsKICAgIHZhciBkZWZhdWx0QmVmb3JlRm5zID0gZW5zdXJlTm9uRW1wdHkoc2VsZiwgJ19fZGVmYXVsdEJlZm9yZUZucycpOwogICAgaWYgKGRlZmF1bHRCZWZvcmVGbnNbbmFtZV0pIHsKICAgICAgcmV0dXJuOwogICAgfQogICAgZGVmYXVsdEJlZm9yZUZuc1tuYW1lXSA9IDE7CiAgICB2YXIgYmVmb3JlQ2hhbmdlRXZlbnROYW1lID0gd2hlbkF0dHJDaGFuZ2VFdmVudE5hbWUoJ2JlZm9yZScsIG5hbWUpOwogICAgc2VsZi5wdWJsaXNoKGJlZm9yZUNoYW5nZUV2ZW50TmFtZSwgewogICAgICBkZWZhdWx0Rm46IGRlZmF1bHRTZXRGbiwKICAgICAgLy8gb25seSBwcm9jZXNzIGl0cyBvd24gZGVmYXVsdCBmdW5jdGlvbgogICAgICBkZWZhdWx0VGFyZ2V0T25seTogdHJ1ZQogICAgfSk7CiAgfQogIGZ1bmN0aW9uIHNldEludGVybmFsKHNlbGYsIG5hbWUsIHZhbHVlLCBvcHRzLCBhdHRycykgewogICAgdmFyIHBhdGgsIHN1YlZhbCwgcHJldlZhbCwgcGF0aE5hbWVQYWlyID0gZ2V0UGF0aE5hbWVQYWlyKG5hbWUpLCBmdWxsTmFtZSA9IG5hbWU7CiAgICBuYW1lID0gcGF0aE5hbWVQYWlyLm5hbWU7CiAgICBwYXRoID0gcGF0aE5hbWVQYWlyLnBhdGg7CiAgICBwcmV2VmFsID0gc2VsZi5nZXQobmFtZSk7CiAgICBwcmVwYXJlRGVmYXVsdFNldEZuKHNlbGYsIG5hbWUpOwogICAgaWYgKHBhdGgpIHsKICAgICAgc3ViVmFsID0gZ2V0VmFsdWVCeVBhdGgocHJldlZhbCwgcGF0aCk7CiAgICB9CiAgICAvLyBpZiBubyBjaGFuZ2UsIGp1c3QgcmV0dXJuCiAgICAvLyBwYXNzIGVxdWFsIGNoZWNrIHRvIGZpcmUgY2hhbmdlIGV2ZW50CiAgICBpZiAoIW9wdHMuZm9yY2UpIHsKICAgICAgaWYgKCFwYXRoICYmIHByZXZWYWwgPT09IHZhbHVlKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfSBlbHNlIGlmIChwYXRoICYmIHN1YlZhbCA9PT0gdmFsdWUpIHsKICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CiAgICB9CiAgICB2YWx1ZSA9IGdldFZhbHVlQnlTdWJWYWx1ZShwcmV2VmFsLCBwYXRoLCB2YWx1ZSk7CiAgICB2YXIgYmVmb3JlRXZlbnRPYmplY3QgPSB1dGlsLm1peCh7CiAgICAgIGF0dHJOYW1lOiBuYW1lLAogICAgICBzdWJBdHRyTmFtZTogZnVsbE5hbWUsCiAgICAgIHByZXZWYWw6IHByZXZWYWwsCiAgICAgIG5ld1ZhbDogdmFsdWUsCiAgICAgIF9vcHRzOiBvcHRzLAogICAgICBfYXR0cnM6IGF0dHJzLAogICAgICB0YXJnZXQ6IHNlbGYKICAgIH0sIG9wdHMuZGF0YSk7CiAgICAvLyBjaGVjayBiZWZvcmUgZXZlbnQKICAgIGlmIChvcHRzLnNpbGVudCkgewogICAgICBpZiAoRkFMU0UgPT09IGRlZmF1bHRTZXRGbi5jYWxsKHNlbGYsIGJlZm9yZUV2ZW50T2JqZWN0KSkgewogICAgICAgIHJldHVybiBGQUxTRTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgaWYgKEZBTFNFID09PSBzZWxmLmZpcmUod2hlbkF0dHJDaGFuZ2VFdmVudE5hbWUoJ2JlZm9yZScsIG5hbWUpLCBiZWZvcmVFdmVudE9iamVjdCkpIHsKICAgICAgICByZXR1cm4gRkFMU0U7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBzZWxmOwogIH0KICBmdW5jdGlvbiBkZWZhdWx0U2V0Rm4oZSkgewogICAgdmFyIHNlbGYgPSB0aGlzLCB2YWx1ZSA9IGUubmV3VmFsLCBwcmV2VmFsID0gZS5wcmV2VmFsLCBuYW1lID0gZS5hdHRyTmFtZSwgZnVsbE5hbWUgPSBlLnN1YkF0dHJOYW1lLCBhdHRycyA9IGUuX2F0dHJzLCBvcHRzID0gZS5fb3B0czsKICAgIC8vIHNldCBpdAogICAgdmFyIHJldCA9IHNlbGYuc2V0SW50ZXJuYWwobmFtZSwgdmFsdWUpOwogICAgaWYgKHJldCA9PT0gRkFMU0UpIHsKICAgICAgcmV0dXJuIHJldDsKICAgIH0KICAgIC8vIGZpcmUgYWZ0ZXIgZXZlbnQKICAgIGlmICghb3B0cy5zaWxlbnQpIHsKICAgICAgdmFsdWUgPSBnZXRBdHRyVmFscyhzZWxmKVtuYW1lXTsKICAgICAgX19maXJlQXR0ckNoYW5nZShzZWxmLCAnYWZ0ZXInLCBuYW1lLCBwcmV2VmFsLCB2YWx1ZSwgZnVsbE5hbWUsIG51bGwsIG9wdHMuZGF0YSk7CiAgICAgIGlmIChhdHRycykgewogICAgICAgIGF0dHJzLnB1c2goewogICAgICAgICAgcHJldlZhbDogcHJldlZhbCwKICAgICAgICAgIG5ld1ZhbDogdmFsdWUsCiAgICAgICAgICBhdHRyTmFtZTogbmFtZSwKICAgICAgICAgIHN1YkF0dHJOYW1lOiBmdWxsTmFtZQogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIF9fZmlyZUF0dHJDaGFuZ2Uoc2VsZiwgJycsICcqJywgW3ByZXZWYWxdLCBbdmFsdWVdLCBbZnVsbE5hbWVdLCBbbmFtZV0sIG9wdHMuZGF0YSk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQogIC8qKgogICAqIGF0dHJpYnV0ZSBtYW5hZ2VtZW50CiAgICogQGNsYXNzIEtJU1NZLkF0dHJpYnV0ZQogICAqLwogIGZ1bmN0aW9uIEF0dHJpYnV0ZShjb25maWcpIHsKICAgIHZhciBzZWxmID0gdGhpcywgYyA9IHNlbGYuY29uc3RydWN0b3I7CiAgICAvLyBzYXZlIHVzZXIgY29uZmlnCiAgICBzZWxmLnVzZXJDb25maWcgPSBjb25maWc7CiAgICAvLyBkZWZpbmUKICAgIHdoaWxlIChjKSB7CiAgICAgIGFkZEF0dHJzKHNlbGYsIGMuQVRUUlMpOwogICAgICBjID0gYy5zdXBlcmNsYXNzID8gYy5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yIDogbnVsbDsKICAgIH0KICAgIC8vIGluaXRpYWwgYXR0cgogICAgaW5pdEF0dHJzKHNlbGYsIGNvbmZpZyk7CiAgfQogIGZ1bmN0aW9uIHdyYXBQcm90b0ZvclN1cGVyKHB4LCBTdWJDbGFzcykgewogICAgdmFyIGhvb2tzID0gU3ViQ2xhc3MuX19ob29rc19fOwogICAgLy8gaW4gY2FzZSBweCBjb250YWlucyB0b1N0cmluZwogICAgaWYgKGhvb2tzKSB7CiAgICAgIGZvciAodmFyIHAgaW4gaG9va3MpIHsKICAgICAgICBpZiAocCBpbiBweCkgewogICAgICAgICAgcHhbcF0gPSBob29rc1twXShweFtwXSk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICB1dGlsLmVhY2gocHgsIGZ1bmN0aW9uICh2LCBwKSB7CiAgICAgIGlmICh0eXBlb2YgdiA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIHZhciB3cmFwcGVkID0gMDsKICAgICAgICBpZiAodi5fX293bmVyX18pIHsKICAgICAgICAgIHZhciBvcmlnaW5hbE93bmVyID0gdi5fX293bmVyX187CiAgICAgICAgICBkZWxldGUgdi5fX293bmVyX187CiAgICAgICAgICBkZWxldGUgdi5fX25hbWVfXzsKICAgICAgICAgIHdyYXBwZWQgPSB2Ll9fd3JhcHBlZF9fID0gMTsKICAgICAgICAgIHZhciBuZXdWID0gYmluZCh2KTsKICAgICAgICAgIG5ld1YuX19vd25lcl9fID0gb3JpZ2luYWxPd25lcjsKICAgICAgICAgIG5ld1YuX19uYW1lX18gPSBwOwogICAgICAgICAgb3JpZ2luYWxPd25lci5wcm90b3R5cGVbcF0gPSBuZXdWOwogICAgICAgIH0gZWxzZSBpZiAodi5fX3dyYXBwZWRfXykgewogICAgICAgICAgd3JhcHBlZCA9IDE7CiAgICAgICAgfQogICAgICAgIGlmICh3cmFwcGVkKSB7CiAgICAgICAgICBweFtwXSA9IHYgPSBiaW5kKHYpOwogICAgICAgIH0KICAgICAgICB2Ll9fb3duZXJfXyA9IFN1YkNsYXNzOwogICAgICAgIHYuX19uYW1lX18gPSBwOwogICAgICB9CiAgICB9KTsKICB9CiAgZnVuY3Rpb24gYWRkTWVtYmVycyhweCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgd3JhcFByb3RvRm9yU3VwZXIocHgsIHNlbGYpOwogICAgdXRpbC5taXgoc2VsZi5wcm90b3R5cGUsIHB4KTsKICB9CiAgQXR0cmlidXRlLmV4dGVuZCA9IGZ1bmN0aW9uIGV4dGVuZChweCwgc3gpIHsKICAgIHZhciBTdWJDbGFzcywgb3B4ID0gcHgsIHNlbGYgPSB0aGlzOwogICAgc3ggPSB1dGlsLm1lcmdlKHN4KTsKICAgIC8vIHB4IGlzIHNoYXJlZCBhbW9uZyBjbGFzc2VzCiAgICBweCA9IHV0aWwubWVyZ2UocHgpOwogICAgLy8gT24gbGVzc2VyIElFIDgsIFV0aWwubWVyZ2UgZG9lcyBub3QgY29waWVkIGZpZWxkIGNvbnN0cnVjdG9yLAogICAgLy8gZXZlbiByZXdyb3RlIHRoYXQgb24gb2JqZWN0IGl0c2VsZi4KICAgIGlmIChvcHguaGFzT3duUHJvcGVydHkoJ2NvbnN0cnVjdG9yJykpIHsKICAgICAgcHguY29uc3RydWN0b3IgPSBvcHguY29uc3RydWN0b3I7CiAgICB9CiAgICB2YXIgaG9va3MsIHN4SG9va3MgPSBzeC5fX2hvb2tzX187CiAgICBpZiAoaG9va3MgPSBzZWxmLl9faG9va3NfXykgewogICAgICBzeEhvb2tzID0gc3guX19ob29rc19fID0gc3guX19ob29rc19fIHx8IHt9OwogICAgICB1dGlsLm1peChzeEhvb2tzLCBob29rcywgZmFsc2UpOwogICAgfQogICAgdmFyIG5hbWUgPSBzeC5uYW1lIHx8ICdBdHRyaWJ1dGVEZXJpdmVkJzsKICAgIGlmIChweC5oYXNPd25Qcm9wZXJ0eSgnY29uc3RydWN0b3InKSkgewogICAgICBTdWJDbGFzcyA9IHB4LmNvbnN0cnVjdG9yOwogICAgfSBlbHNlIHsKICAgICAgLy8gZGVidWcgbW9kZSwgZ2l2ZSB0aGUgcmlnaHQgbmFtZSBmb3IgY29uc3RydWN0b3IKICAgICAgaWYgKCdAREVCVUdAJykgewogICAgICAgIC8qanNoaW50IGV2aWw6IHRydWUqLwogICAgICAgIFN1YkNsYXNzID0gbmV3IEZ1bmN0aW9uKCdyZXR1cm4gZnVuY3Rpb24gJyArIHV0aWwuY2FtZWxDYXNlKG5hbWUpICsgJygpeyAnICsgJ3RoaXMuY2FsbFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7JyArICd9JykoKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBTdWJDbGFzcyA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRoaXMuY2FsbFN1cGVyLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgfTsKICAgICAgfQogICAgfQogICAgcHguY29uc3RydWN0b3IgPSBTdWJDbGFzczsKICAgIFN1YkNsYXNzLl9faG9va3NfXyA9IHN4SG9va3M7CiAgICB3cmFwUHJvdG9Gb3JTdXBlcihweCwgU3ViQ2xhc3MpOwogICAgdmFyIGluaGVyaXRlZFN0YXRpY3MsIHN4SW5oZXJpdGVkU3RhdGljcyA9IHN4LmluaGVyaXRlZFN0YXRpY3M7CiAgICBpZiAoaW5oZXJpdGVkU3RhdGljcyA9IHNlbGYuaW5oZXJpdGVkU3RhdGljcykgewogICAgICBzeEluaGVyaXRlZFN0YXRpY3MgPSBzeC5pbmhlcml0ZWRTdGF0aWNzID0gc3guaW5oZXJpdGVkU3RhdGljcyB8fCB7fTsKICAgICAgdXRpbC5taXgoc3hJbmhlcml0ZWRTdGF0aWNzLCBpbmhlcml0ZWRTdGF0aWNzLCBmYWxzZSk7CiAgICB9CiAgICB1dGlsLmV4dGVuZChTdWJDbGFzcywgc2VsZiwgcHgsIHN4KTsKICAgIGlmIChzeEluaGVyaXRlZFN0YXRpY3MpIHsKICAgICAgdXRpbC5taXgoU3ViQ2xhc3MsIHN4SW5oZXJpdGVkU3RhdGljcyk7CiAgICB9CiAgICBTdWJDbGFzcy5leHRlbmQgPSBzeC5leHRlbmQgfHwgZXh0ZW5kOwogICAgU3ViQ2xhc3MuYWRkTWVtYmVycyA9IGFkZE1lbWJlcnM7CiAgICByZXR1cm4gU3ViQ2xhc3M7CiAgfTsKICBmdW5jdGlvbiBhZGRBdHRycyhob3N0LCBhdHRycykgewogICAgaWYgKGF0dHJzKSB7CiAgICAgIGZvciAodmFyIGF0dHIgaW4gYXR0cnMpIHsKICAgICAgICAvLyDlrZDnsbvkuIrnmoQgQVRUUlMg6YWN572u5LyY5YWICiAgICAgICAgLy8g54i257G75ZCO5Yqg77yM54i257G75LiN6KaG55uW5a2Q57G755qE55u45ZCM6K6+572uCiAgICAgICAgLy8g5bGe5oCn5a+56LGh5LyaIHRydWN0b3JlcmdlCiAgICAgICAgLy8gYToge3k6IHtnZXR0ZXI6IGZufX0sIGI6IHt5OiB7dmFsdWU6IDN9fQogICAgICAgIC8vIGIgZXh0ZW5kcyBhCiAgICAgICAgLy8gPT4KICAgICAgICAvLyBiIHt5OiB7dmFsdWU6IDMsIGdldHRlcjogZm59fQogICAgICAgIGhvc3QuYWRkQXR0cihhdHRyLCBhdHRyc1thdHRyXSwgZmFsc2UpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGluaXRBdHRycyhob3N0LCBjb25maWcpIHsKICAgIGlmIChjb25maWcpIHsKICAgICAgZm9yICh2YXIgYXR0ciBpbiBjb25maWcpIHsKICAgICAgICAvLyDnlKjmiLforr7nva7kvJrosIPnlKggc2V0dGVyL3ZhbGlkYXRvciDnmoTvvIzkvYbkuI3kvJrop6blj5HlsZ7mgKflj5jljJbkuovku7YKICAgICAgICBob3N0LnNldEludGVybmFsKGF0dHIsIGNvbmZpZ1thdHRyXSk7CiAgICAgIH0KICAgIH0KICB9CiAgdXRpbC5hdWdtZW50KEF0dHJpYnV0ZSwgQ3VzdG9tRXZlbnQuVGFyZ2V0LCB7CiAgICBJTlZBTElEOiBJTlZBTElELAogICAgY2FsbFN1cGVyOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBtZXRob2QsIG9iaiwgc2VsZiA9IHRoaXMsIGFyZ3MgPSBhcmd1bWVudHM7CiAgICAgIGlmICh0eXBlb2Ygc2VsZiA9PT0gJ2Z1bmN0aW9uJyAmJiBzZWxmLl9fbmFtZV9fKSB7CiAgICAgICAgbWV0aG9kID0gc2VsZjsKICAgICAgICBvYmogPSBhcmdzWzBdOwogICAgICAgIGFyZ3MgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UuY2FsbChhcmdzLCAxKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvKmpzaGludCBub2FyZzogZmFsc2UqLwogICAgICAgIG1ldGhvZCA9IGFyZ3VtZW50cy5jYWxsZWUuY2FsbGVyOwogICAgICAgIGlmIChtZXRob2QuX193cmFwcGVkX18pIHsKICAgICAgICAgIG1ldGhvZCA9IG1ldGhvZC5jYWxsZXI7CiAgICAgICAgfQogICAgICAgIG9iaiA9IHNlbGY7CiAgICAgIH0KICAgICAgdmFyIG5hbWUgPSBtZXRob2QuX19uYW1lX187CiAgICAgIGlmICghbmFtZSkgewogICAgICAgIC8vUy5sb2coJ2NhbiBub3QgZmluZCBtZXRob2QgbmFtZSBmb3IgY2FsbFN1cGVyIFsnICsgc2VsZi5jb25zdHJ1Y3Rvci5uYW1lICsgJ106ICcgKyBtZXRob2QudG9TdHJpbmcoKSk7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgICB2YXIgbWVtYmVyID0gbWV0aG9kLl9fb3duZXJfXy5zdXBlcmNsYXNzW25hbWVdOwogICAgICBpZiAoIW1lbWJlcikgewogICAgICAgIC8vUy5sb2coJ2NhbiBub3QgZmluZCBtZXRob2QgWycgKyBuYW1lICsgJ10gZm9yIGNhbGxTdXBlcjogJyArIG1ldGhvZC5fX293bmVyX18ubmFtZSk7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgICByZXR1cm4gbWVtYmVyLmFwcGx5KG9iaiwgYXJncyB8fCBbXSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBnZXQgdW4tY2xvbmVkIGF0dHIgY29uZmlnIGNvbGxlY3Rpb25zCiAgICAgKiBAcmV0dXJuIHtPYmplY3R9CiAgICAgKiBAcHJpdmF0ZQogICAgICovCiAgICBnZXRBdHRyczogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gdGhpcy5fX2F0dHJzIHx8ICh0aGlzLl9fYXR0cnMgPSB7fSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBnZXQgdW4tY2xvbmVkIGF0dHIgdmFsdWUgY29sbGVjdGlvbnMKICAgICAqIEByZXR1cm4ge09iamVjdH0KICAgICAqLwogICAgZ2V0QXR0clZhbHM6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBvID0ge30sIGEsIGF0dHJzID0gc2VsZi5nZXRBdHRycygpOwogICAgICBmb3IgKGEgaW4gYXR0cnMpIHsKICAgICAgICBvW2FdID0gc2VsZi5nZXQoYSk7CiAgICAgIH0KICAgICAgcmV0dXJuIG87CiAgICB9LAogICAgLyoqCiAgICAgKiBBZGRzIGFuIGF0dHJpYnV0ZSB3aXRoIHRoZSBwcm92aWRlZCBjb25maWd1cmF0aW9uIHRvIHRoZSBob3N0IG9iamVjdC4KICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIGF0dHJOYW1lCiAgICAgKiBAcGFyYW0ge09iamVjdH0gYXR0ckNvbmZpZyBUaGUgY29uZmlnIHN1cHBvcnRzIHRoZSBmb2xsb3dpbmcgcHJvcGVydGllcwogICAgICogQHBhcmFtIFthdHRyQ29uZmlnLnZhbHVlXSBzaW1wbGUgb2JqZWN0IG9yIHN5c3RlbSBuYXRpdmUgb2JqZWN0CiAgICAgKiBAcGFyYW0gW2F0dHJDb25maWcudmFsdWVGbl0gYSBmdW5jdGlvbiB3aGljaCBjYW4gcmV0dXJuIGN1cnJlbnQgYXR0cmlidXRlICdzIGRlZmF1bHQgdmFsdWUKICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IFthdHRyQ29uZmlnLnNldHRlcl0gY2FsbCB3aGVuIHNldCBhdHRyaWJ1dGUgJ3MgdmFsdWUKICAgICAqIHBhc3MgY3VycmVudCBhdHRyaWJ1dGUgJ3MgdmFsdWUgYXMgcGFyYW1ldGVyCiAgICAgKiBpZiByZXR1cm4gdmFsdWUgaXMgbm90IHVuZGVmaW5lZCxzZXQgcmV0dXJuZWQgdmFsdWUgYXMgcmVhbCB2YWx1ZQogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2F0dHJDb25maWcuZ2V0dGVyXSBjYWxsIHdoZW4gZ2V0IGF0dHJpYnV0ZSAncyB2YWx1ZQogICAgICogcGFzcyBjdXJyZW50IGF0dHJpYnV0ZSAncyB2YWx1ZSBhcyBwYXJhbWV0ZXIKICAgICAqIHJldHVybiBnZXR0ZXIncyByZXR1cm5lZCB2YWx1ZSB0byBpbnZva2VyCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbYXR0ckNvbmZpZy52YWxpZGF0b3JdICBjYWxsIGJlZm9yZSBzZXQgYXR0cmlidXRlICdzIHZhbHVlCiAgICAgKiBpZiByZXR1cm4gZmFsc2UsY2FuY2VsIHRoaXMgc2V0IGFjdGlvbgogICAgICogQHBhcmFtIHtCb29sZWFufSBbb3ZlcnJpZGVdIHdoZXRoZXIgb3ZlcnJpZGUgZXhpc3RpbmcgYXR0cmlidXRlIGNvbmZpZyAsZGVmYXVsdCB0cnVlCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKi8KICAgIGFkZEF0dHI6IGZ1bmN0aW9uIChuYW1lLCBhdHRyQ29uZmlnLCBvdmVycmlkZSkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGF0dHJzID0gc2VsZi5nZXRBdHRycygpLCBhdHRyLAogICAgICAgIC8vIHNoYWRvdyBjbG9uZQogICAgICAgIGNmZyA9IHV0aWwubWVyZ2UoYXR0ckNvbmZpZyk7CiAgICAgIGlmIChjZmcudmFsdWUgJiYgdHlwZW9mIGNmZy52YWx1ZSA9PT0gJ29iamVjdCcpIHsKICAgICAgICBjZmcudmFsdWUgPSB1dGlsLmNsb25lKGNmZy52YWx1ZSk7CiAgICAgIH0KICAgICAgaWYgKGF0dHIgPSBhdHRyc1tuYW1lXSkgewogICAgICAgIHV0aWwubWl4KGF0dHIsIGNmZywgb3ZlcnJpZGUpOwogICAgICB9IGVsc2UgewogICAgICAgIGF0dHJzW25hbWVdID0gY2ZnOwogICAgICB9CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIC8qKgogICAgICogQ29uZmlndXJlcyBhIGdyb3VwIG9mIGF0dHJpYnV0ZXMsIGFuZCBzZXRzIGluaXRpYWwgdmFsdWVzLgogICAgICogQHBhcmFtIHtPYmplY3R9IGF0dHJDb25maWdzICBBbiBvYmplY3Qgd2l0aCBhdHRyaWJ1dGUgbmFtZS9jb25maWd1cmF0aW9uIHBhaXJzLgogICAgICogQHBhcmFtIHtPYmplY3R9IGluaXRpYWxWYWx1ZXMgdXNlciBkZWZpbmVkIGluaXRpYWwgdmFsdWVzCiAgICAgKiBAY2hhaW5hYmxlCiAgICAgKi8KICAgIGFkZEF0dHJzOiBmdW5jdGlvbiAoYXR0ckNvbmZpZ3MsIGluaXRpYWxWYWx1ZXMpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB1dGlsLmVhY2goYXR0ckNvbmZpZ3MsIGZ1bmN0aW9uIChhdHRyQ29uZmlnLCBuYW1lKSB7CiAgICAgICAgc2VsZi5hZGRBdHRyKG5hbWUsIGF0dHJDb25maWcpOwogICAgICB9KTsKICAgICAgaWYgKGluaXRpYWxWYWx1ZXMpIHsKICAgICAgICBzZWxmLnNldChpbml0aWFsVmFsdWVzKTsKICAgICAgfQogICAgICByZXR1cm4gc2VsZjsKICAgIH0sCiAgICAvKioKICAgICAqIENoZWNrcyBpZiB0aGUgZ2l2ZW4gYXR0cmlidXRlIGhhcyBiZWVuIGFkZGVkIHRvIHRoZSBob3N0LgogICAgICogQHBhcmFtIHtTdHJpbmd9IG5hbWUgYXR0cmlidXRlIG5hbWUKICAgICAqIEByZXR1cm4ge0Jvb2xlYW59CiAgICAgKi8KICAgIGhhc0F0dHI6IGZ1bmN0aW9uIChuYW1lKSB7CiAgICAgIHJldHVybiB0aGlzLmdldEF0dHJzKCkuaGFzT3duUHJvcGVydHkobmFtZSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBSZW1vdmVzIGFuIGF0dHJpYnV0ZSBmcm9tIHRoZSBob3N0IG9iamVjdC4KICAgICAqIEBjaGFpbmFibGUKICAgICAqLwogICAgcmVtb3ZlQXR0cjogZnVuY3Rpb24gKG5hbWUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgX19hdHRyVmFscyA9IGdldEF0dHJWYWxzKHNlbGYpOwogICAgICB2YXIgX19hdHRycyA9IHNlbGYuZ2V0QXR0cnMoKTsKICAgICAgaWYgKHNlbGYuaGFzQXR0cihuYW1lKSkgewogICAgICAgIGRlbGV0ZSBfX2F0dHJzW25hbWVdOwogICAgICAgIGRlbGV0ZSBfX2F0dHJWYWxzW25hbWVdOwogICAgICB9CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIC8qKgogICAgICogU2V0cyB0aGUgdmFsdWUgb2YgYW4gYXR0cmlidXRlLgogICAgICogQHBhcmFtIHtTdHJpbmd8T2JqZWN0fSBuYW1lIGF0dHJpYnV0ZSAncyBuYW1lIG9yIGF0dHJpYnV0ZSBuYW1lIGFuZCB2YWx1ZSBtYXAKICAgICAqIEBwYXJhbSBbdmFsdWVdIGF0dHJpYnV0ZSAncyB2YWx1ZQogICAgICogQHBhcmFtIHtPYmplY3R9IFtvcHRzXSBzb21lIG9wdGlvbnMKICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW29wdHMuc2lsZW50XSB3aGV0aGVyIGZpcmUgY2hhbmdlIGV2ZW50CiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbb3B0cy5lcnJvcl0gZXJyb3IgaGFuZGxlcgogICAgICogQHJldHVybiB7Qm9vbGVhbn0gd2hldGhlciBwYXNzIHZhbGlkYXRvcgogICAgICovCiAgICBzZXQ6IGZ1bmN0aW9uIChuYW1lLCB2YWx1ZSwgb3B0cykgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGU7CiAgICAgIGlmICh0eXBlb2YgbmFtZSAhPT0gJ3N0cmluZycpIHsKICAgICAgICBvcHRzID0gdmFsdWU7CiAgICAgICAgb3B0cyA9IG9wdHMgfHwge307CiAgICAgICAgdmFyIGFsbCA9IE9iamVjdChuYW1lKSwgYXR0cnMgPSBbXSwgZXJyb3JzID0gW107CiAgICAgICAgZm9yIChuYW1lIGluIGFsbCkgewogICAgICAgICAgLy8gYnVsayB2YWxpZGF0aW9uCiAgICAgICAgICAvLyBpZiBhbnkgb25lIGZhaWxlZCxhbGwgdmFsdWVzIGFyZSBub3Qgc2V0CiAgICAgICAgICBpZiAoKGUgPSB2YWxpZGF0ZShzZWxmLCBuYW1lLCBhbGxbbmFtZV0sIGFsbCkpICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgZXJyb3JzLnB1c2goZSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIGlmIChlcnJvcnMubGVuZ3RoKSB7CiAgICAgICAgICBpZiAob3B0cy5lcnJvcikgewogICAgICAgICAgICBvcHRzLmVycm9yKGVycm9ycyk7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gRkFMU0U7CiAgICAgICAgfQogICAgICAgIGZvciAobmFtZSBpbiBhbGwpIHsKICAgICAgICAgIHNldEludGVybmFsKHNlbGYsIG5hbWUsIGFsbFtuYW1lXSwgb3B0cywgYXR0cnMpOwogICAgICAgIH0KICAgICAgICB2YXIgYXR0ck5hbWVzID0gW10sIHByZXZWYWxzID0gW10sIG5ld1ZhbHMgPSBbXSwgc3ViQXR0ck5hbWVzID0gW107CiAgICAgICAgdXRpbC5lYWNoKGF0dHJzLCBmdW5jdGlvbiAoYXR0cikgewogICAgICAgICAgcHJldlZhbHMucHVzaChhdHRyLnByZXZWYWwpOwogICAgICAgICAgbmV3VmFscy5wdXNoKGF0dHIubmV3VmFsKTsKICAgICAgICAgIGF0dHJOYW1lcy5wdXNoKGF0dHIuYXR0ck5hbWUpOwogICAgICAgICAgc3ViQXR0ck5hbWVzLnB1c2goYXR0ci5zdWJBdHRyTmFtZSk7CiAgICAgICAgfSk7CiAgICAgICAgaWYgKGF0dHJOYW1lcy5sZW5ndGgpIHsKICAgICAgICAgIF9fZmlyZUF0dHJDaGFuZ2Uoc2VsZiwgJycsICcqJywgcHJldlZhbHMsIG5ld1ZhbHMsIHN1YkF0dHJOYW1lcywgYXR0ck5hbWVzLCBvcHRzLmRhdGEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gc2VsZjsKICAgICAgfQogICAgICBvcHRzID0gb3B0cyB8fCB7fTsKICAgICAgLy8gdmFsaWRhdG9yIGNoZWNrCiAgICAgIGUgPSB2YWxpZGF0ZShzZWxmLCBuYW1lLCB2YWx1ZSk7CiAgICAgIGlmIChlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAob3B0cy5lcnJvcikgewogICAgICAgICAgb3B0cy5lcnJvcihlKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIEZBTFNFOwogICAgICB9CiAgICAgIHJldHVybiBzZXRJbnRlcm5hbChzZWxmLCBuYW1lLCB2YWx1ZSwgb3B0cyk7CiAgICB9LAogICAgLyoqCiAgICAgKiBpbnRlcm5hbCB1c2UsIG5vIGV2ZW50IGludm9sdmVkLCBqdXN0IHNldC4KICAgICAqIG92ZXJyaWRlIGJ5IG1vZGVsCiAgICAgKiBAcHJvdGVjdGVkCiAgICAgKi8KICAgIHNldEludGVybmFsOiBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBzZXRWYWx1ZSwKICAgICAgICAvLyBpZiBob3N0IGRvZXMgbm90IGhhdmUgbWV0YSBpbmZvIGNvcnJlc3BvbmRpbmcgdG8gKG5hbWUsdmFsdWUpCiAgICAgICAgLy8gdGhlbiByZWdpc3RlciBvbiBkZW1hbmQgaW4gb3JkZXIgdG8gY29sbGVjdCBhbGwgZGF0YSBtZXRhIGluZm8KICAgICAgICAvLyDkuIDlrpropoHms6jlhozlsZ7mgKflhYPmlbDmja7vvIzlkKbliJnlhbbku5bmqKHlnZfpgJrov4cgX2F0dHJzIOS4jeiDveaemuS4vuWIsOaJgOacieacieaViOWxnuaApwogICAgICAgIC8vIOWboOS4uuWxnuaAp+WcqOWjsOaYjuazqOWGjOWJjeWPr+S7peebtOaOpeiuvue9ruWAvAogICAgICAgIGF0dHJDb25maWcgPSBlbnN1cmVOb25FbXB0eShzZWxmLmdldEF0dHJzKCksIG5hbWUpLCBzZXR0ZXIgPSBhdHRyQ29uZmlnLnNldHRlcjsKICAgICAgLy8gaWYgc2V0dGVyIGhhcyBlZmZlY3QKICAgICAgaWYgKHNldHRlciAmJiAoc2V0dGVyID0gbm9ybWFsRm4oc2VsZiwgc2V0dGVyKSkpIHsKICAgICAgICBzZXRWYWx1ZSA9IHNldHRlci5jYWxsKHNlbGYsIHZhbHVlLCBuYW1lKTsKICAgICAgfQogICAgICBpZiAoc2V0VmFsdWUgPT09IElOVkFMSUQpIHsKICAgICAgICByZXR1cm4gRkFMU0U7CiAgICAgIH0KICAgICAgaWYgKHNldFZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICB2YWx1ZSA9IHNldFZhbHVlOwogICAgICB9CiAgICAgIC8vIGZpbmFsbHkgc2V0CiAgICAgIGdldEF0dHJWYWxzKHNlbGYpW25hbWVdID0gdmFsdWU7CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9LAogICAgLyoqCiAgICAgKiBHZXRzIHRoZSBjdXJyZW50IHZhbHVlIG9mIHRoZSBhdHRyaWJ1dGUuCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBhdHRyaWJ1dGUgJ3MgbmFtZQogICAgICogQHJldHVybiB7Kn0KICAgICAqLwogICAgZ2V0OiBmdW5jdGlvbiAobmFtZSkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGRvdCA9ICcuJywgcGF0aCwgYXR0clZhbHMgPSBnZXRBdHRyVmFscyhzZWxmKSwgYXR0ckNvbmZpZywgZ2V0dGVyLCByZXQ7CiAgICAgIGlmIChuYW1lLmluZGV4T2YoZG90KSAhPT0gLTEpIHsKICAgICAgICBwYXRoID0gbmFtZS5zcGxpdChkb3QpOwogICAgICAgIG5hbWUgPSBwYXRoLnNoaWZ0KCk7CiAgICAgIH0KICAgICAgYXR0ckNvbmZpZyA9IGVuc3VyZU5vbkVtcHR5KHNlbGYuZ2V0QXR0cnMoKSwgbmFtZSwgMSk7CiAgICAgIGdldHRlciA9IGF0dHJDb25maWcuZ2V0dGVyOwogICAgICAvLyBnZXQgdXNlci1zZXQgdmFsdWUgb3IgZGVmYXVsdCB2YWx1ZQogICAgICAvL3VzZXItc2V0IHZhbHVlIHRha2VzIHByaXZpbGVnZQogICAgICByZXQgPSBuYW1lIGluIGF0dHJWYWxzID8gYXR0clZhbHNbbmFtZV0gOiBnZXREZWZBdHRyVmFsKHNlbGYsIG5hbWUpOwogICAgICAvLyBpbnZva2UgZ2V0dGVyIGZvciB0aGlzIGF0dHJpYnV0ZQogICAgICBpZiAoZ2V0dGVyICYmIChnZXR0ZXIgPSBub3JtYWxGbihzZWxmLCBnZXR0ZXIpKSkgewogICAgICAgIHJldCA9IGdldHRlci5jYWxsKHNlbGYsIHJldCwgbmFtZSk7CiAgICAgIH0KICAgICAgaWYgKCEobmFtZSBpbiBhdHRyVmFscykgJiYgcmV0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBhdHRyVmFsc1tuYW1lXSA9IHJldDsKICAgICAgfQogICAgICBpZiAocGF0aCkgewogICAgICAgIHJldCA9IGdldFZhbHVlQnlQYXRoKHJldCwgcGF0aCk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJldDsKICAgIH0sCiAgICAvKioKICAgICAqIFJlc2V0cyB0aGUgdmFsdWUgb2YgYW4gYXR0cmlidXRlLmp1c3QgcmVzZXQgd2hhdCBhZGRBdHRyIHNldAogICAgICogKG5vdCB3aGF0IGludm9rZXIgc2V0IHdoZW4gY2FsbCBuZXcgWHgoY2ZnKSkKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIG5hbWUgb2YgYXR0cmlidXRlCiAgICAgKiBAcGFyYW0ge09iamVjdH0gW29wdHNdIHNvbWUgb3B0aW9ucwogICAgICogQHBhcmFtIHtCb29sZWFufSBbb3B0cy5zaWxlbnRdIHdoZXRoZXIgZmlyZSBjaGFuZ2UgZXZlbnQKICAgICAqIEBjaGFpbmFibGUKICAgICAqLwogICAgcmVzZXQ6IGZ1bmN0aW9uIChuYW1lLCBvcHRzKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnc3RyaW5nJykgewogICAgICAgIGlmIChzZWxmLmhhc0F0dHIobmFtZSkpIHsKICAgICAgICAgIC8vIGlmIGF0dHJpYnV0ZSBkb2VzIG5vdCBoYXZlIGRlZmF1bHQgdmFsdWUsIHRoZW4gc2V0IHRvIHVuZGVmaW5lZAogICAgICAgICAgcmV0dXJuIHNlbGYuc2V0KG5hbWUsIGdldERlZkF0dHJWYWwoc2VsZiwgbmFtZSksIG9wdHMpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICByZXR1cm4gc2VsZjsKICAgICAgICB9CiAgICAgIH0KICAgICAgb3B0cyA9IG5hbWU7CiAgICAgIHZhciBhdHRycyA9IHNlbGYuZ2V0QXR0cnMoKSwgdmFsdWVzID0ge307CiAgICAgIC8vIHJlc2V0IGFsbAogICAgICBmb3IgKG5hbWUgaW4gYXR0cnMpIHsKICAgICAgICB2YWx1ZXNbbmFtZV0gPSBnZXREZWZBdHRyVmFsKHNlbGYsIG5hbWUpOwogICAgICB9CiAgICAgIHNlbGYuc2V0KHZhbHVlcywgb3B0cyk7CiAgICAgIHJldHVybiBzZWxmOwogICAgfQogIH0pOwogIC8vIGdldCBkZWZhdWx0IGF0dHJpYnV0ZSB2YWx1ZSBmcm9tIHZhbHVlRm4vdmFsdWUKICBmdW5jdGlvbiBnZXREZWZBdHRyVmFsKHNlbGYsIG5hbWUpIHsKICAgIHZhciBhdHRycyA9IHNlbGYuZ2V0QXR0cnMoKSwgYXR0ckNvbmZpZyA9IGVuc3VyZU5vbkVtcHR5KGF0dHJzLCBuYW1lLCAxKSwgdmFsRm4gPSBhdHRyQ29uZmlnLnZhbHVlRm4sIHZhbDsKICAgIGlmICh2YWxGbiAmJiAodmFsRm4gPSBub3JtYWxGbihzZWxmLCB2YWxGbikpKSB7CiAgICAgIHZhbCA9IHZhbEZuLmNhbGwoc2VsZik7CiAgICAgIGlmICh2YWwgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGF0dHJDb25maWcudmFsdWUgPSB2YWw7CiAgICAgIH0KICAgICAgZGVsZXRlIGF0dHJDb25maWcudmFsdWVGbjsKICAgICAgYXR0cnNbbmFtZV0gPSBhdHRyQ29uZmlnOwogICAgfQogICAgcmV0dXJuIGF0dHJDb25maWcudmFsdWU7CiAgfQogIGZ1bmN0aW9uIHZhbGlkYXRlKHNlbGYsIG5hbWUsIHZhbHVlLCBhbGwpIHsKICAgIHZhciBwYXRoLCBwcmV2VmFsLCBwYXRoTmFtZVBhaXI7CiAgICBwYXRoTmFtZVBhaXIgPSBnZXRQYXRoTmFtZVBhaXIobmFtZSk7CiAgICBuYW1lID0gcGF0aE5hbWVQYWlyLm5hbWU7CiAgICBwYXRoID0gcGF0aE5hbWVQYWlyLnBhdGg7CiAgICBpZiAocGF0aCkgewogICAgICBwcmV2VmFsID0gc2VsZi5nZXQobmFtZSk7CiAgICAgIHZhbHVlID0gZ2V0VmFsdWVCeVN1YlZhbHVlKHByZXZWYWwsIHBhdGgsIHZhbHVlKTsKICAgIH0KICAgIHZhciBhdHRyQ29uZmlnID0gZW5zdXJlTm9uRW1wdHkoc2VsZi5nZXRBdHRycygpLCBuYW1lKSwgZSwgdmFsaWRhdG9yID0gYXR0ckNvbmZpZy52YWxpZGF0b3I7CiAgICBpZiAodmFsaWRhdG9yICYmICh2YWxpZGF0b3IgPSBub3JtYWxGbihzZWxmLCB2YWxpZGF0b3IpKSkgewogICAgICBlID0gdmFsaWRhdG9yLmNhbGwoc2VsZiwgdmFsdWUsIG5hbWUsIGFsbCk7CiAgICAgIC8vIHVuZGVmaW5lZCBhbmQgdHJ1ZSB2YWxpZGF0ZSBzdWNjZXNzZnVsbHkKICAgICAgaWYgKGUgIT09IHVuZGVmaW5lZCAmJiBlICE9PSB0cnVlKSB7CiAgICAgICAgcmV0dXJuIGU7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQogIGV4cG9ydHMgPSBBdHRyaWJ1dGU7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKYXR0cmlidXRlSW5kZXggPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIGV4cG9ydHMgPSBhdHRyaWJ1dGVMaWJBdHRyaWJ1dGU7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGF0dHJpYnV0ZUluZGV4Owp9KTtkZWZpbmUoImV2ZW50LWN1c3RvbSIsIFsiZXZlbnQtYmFzZSIsJ3V0aWwnXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgZXZlbnRCYXNlID0gcmVxdWlyZSgiZXZlbnQtYmFzZSIpOwp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7Ci8vISBDb3B5cmlnaHQgMjAxNSwgZXZlbnQtY3VzdG9tQDYuMS4xIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAwNzo0MDo1NiBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmV2ZW50LWN1c3RvbQpldmVudC1jdXN0b20vbGliL2V2ZW50LWN1c3RvbQpldmVudC1jdXN0b20vbGliL2V2ZW50LWN1c3RvbS90YXJnZXQKZXZlbnQtY3VzdG9tL2xpYi9ldmVudC1jdXN0b20vb2JzZXJ2YWJsZQpldmVudC1jdXN0b20vbGliL2V2ZW50LWN1c3RvbS9vYnNlcnZlcgpldmVudC1jdXN0b20vbGliL2V2ZW50LWN1c3RvbS9vYmplY3QKKi8KdmFyIGV2ZW50Q3VzdG9tTGliRXZlbnRDdXN0b21PYnNlcnZlciwgZXZlbnRDdXN0b21MaWJFdmVudEN1c3RvbU9iamVjdCwgZXZlbnRDdXN0b21MaWJFdmVudEN1c3RvbU9ic2VydmFibGUsIGV2ZW50Q3VzdG9tTGliRXZlbnRDdXN0b21UYXJnZXQsIGV2ZW50Q3VzdG9tTGliRXZlbnRDdXN0b20sIGV2ZW50Q3VzdG9tSW5kZXg7CmV2ZW50Q3VzdG9tTGliRXZlbnRDdXN0b21PYnNlcnZlciA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgLyoqCiAgICogQGlnbm9yZQogICAqIE9ic2VydmVyIGZvciBjdXN0b20gZXZlbnQKICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbSwgYmVuZmNoZW4wNDE4QGdtYWlsLmNvbQogICAqLwogIHZhciBCYXNlRXZlbnQgPSBldmVudEJhc2U7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICAvKioKICAgKiBPYnNlcnZlciBmb3IgY3VzdG9tIGV2ZW50CiAgICogQGNsYXNzIEN1c3RvbUV2ZW50Lk9ic2VydmVyCiAgICogQGV4dGVuZHMgRXZlbnQuT2JzZXJ2ZXIKICAgKiBAcHJpdmF0ZQogICAqLwogIGZ1bmN0aW9uIEN1c3RvbUV2ZW50T2JzZXJ2ZXIoKSB7CiAgICBDdXN0b21FdmVudE9ic2VydmVyLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgdXRpbC5leHRlbmQoQ3VzdG9tRXZlbnRPYnNlcnZlciwgQmFzZUV2ZW50Lk9ic2VydmVyLCB7CiAgICBrZXlzOiBbCiAgICAgICdmbicsCiAgICAgICdjb250ZXh0JywKICAgICAgJ2dyb3VwcycKICAgIF0KICB9KTsKICBleHBvcnRzID0gQ3VzdG9tRXZlbnRPYnNlcnZlcjsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpldmVudEN1c3RvbUxpYkV2ZW50Q3VzdG9tT2JqZWN0ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlCiAgICogc2ltcGxlIGN1c3RvbSBldmVudCBvYmplY3QgZm9yIGN1c3RvbSBldmVudCBtZWNoYW5pc20uCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20sIGJlbmZjaGVuMDQxOEBnbWFpbC5jb20KICAgKi8KICB2YXIgQmFzZUV2ZW50ID0gZXZlbnRCYXNlOwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgLyoqCiAgICogRG8gbm90IG5ldyBieSB5b3Vyc2VsZi4KICAgKgogICAqIEN1c3RvbSBldmVudCBvYmplY3QuCiAgICogQHByaXZhdGUKICAgKiBAY2xhc3MgQ3VzdG9tRXZlbnQuT2JqZWN0CiAgICogQHBhcmFtIHtPYmplY3R9IGRhdGEgZGF0YSB3aGljaCB3aWxsIGJlIG1peGVkIGludG8gY3VzdG9tIGV2ZW50IGluc3RhbmNlCiAgICogQGV4dGVuZHMgRXZlbnQuT2JqZWN0CiAgICovCiAgZnVuY3Rpb24gQ3VzdG9tRXZlbnRPYmplY3QoZGF0YSkgewogICAgQ3VzdG9tRXZlbnRPYmplY3Quc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHRoaXMpOwogICAgdXRpbC5taXgodGhpcywgZGF0YSk7CiAgfQogIHV0aWwuZXh0ZW5kKEN1c3RvbUV2ZW50T2JqZWN0LCBCYXNlRXZlbnQuT2JqZWN0KTsKICBleHBvcnRzID0gQ3VzdG9tRXZlbnRPYmplY3Q7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnRDdXN0b21MaWJFdmVudEN1c3RvbU9ic2VydmFibGUgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBCYXNlRXZlbnQgPSBldmVudEJhc2U7CiAgdmFyIEN1c3RvbUV2ZW50T2JzZXJ2ZXIgPSBldmVudEN1c3RvbUxpYkV2ZW50Q3VzdG9tT2JzZXJ2ZXI7CiAgdmFyIEN1c3RvbUV2ZW50T2JqZWN0ID0gZXZlbnRDdXN0b21MaWJFdmVudEN1c3RvbU9iamVjdDsKICB2YXIgVXRpbHMgPSBCYXNlRXZlbnQuVXRpbHM7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICBmdW5jdGlvbiBDdXN0b21FdmVudE9ic2VydmFibGUoKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICBDdXN0b21FdmVudE9ic2VydmFibGUuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogICAgc2VsZi5kZWZhdWx0Rm4gPSBudWxsOwogICAgc2VsZi5kZWZhdWx0VGFyZ2V0T25seSA9IGZhbHNlOwogICAgc2VsZi5idWJibGVzID0gdHJ1ZTsKICB9CiAgdXRpbC5leHRlbmQoQ3VzdG9tRXZlbnRPYnNlcnZhYmxlLCBCYXNlRXZlbnQuT2JzZXJ2YWJsZSwgewogICAgb246IGZ1bmN0aW9uIChjZmcpIHsKICAgICAgdmFyIG9ic2VydmVyID0gbmV3IEN1c3RvbUV2ZW50T2JzZXJ2ZXIoY2ZnKTsKICAgICAgaWYgKHRoaXMuZmluZE9ic2VydmVyKG9ic2VydmVyKSA9PT0gLTEpIHsKICAgICAgICB0aGlzLm9ic2VydmVycy5wdXNoKG9ic2VydmVyKTsKICAgICAgfQogICAgfSwKICAgIGZpcmU6IGZ1bmN0aW9uIChldmVudERhdGEpIHsKICAgICAgZXZlbnREYXRhID0gZXZlbnREYXRhIHx8IHt9OwogICAgICB2YXIgc2VsZiA9IHRoaXMsIGJ1YmJsZXMgPSBzZWxmLmJ1YmJsZXMsIGN1cnJlbnRUYXJnZXQgPSBzZWxmLmN1cnJlbnRUYXJnZXQsIHBhcmVudHMsIHBhcmVudHNMZW4sIHR5cGUgPSBzZWxmLnR5cGUsIGRlZmF1bHRGbiA9IHNlbGYuZGVmYXVsdEZuLCBpLCBjdXN0b21FdmVudE9iamVjdCA9IGV2ZW50RGF0YSwgZ1JldCwgcmV0OwogICAgICBldmVudERhdGEudHlwZSA9IHR5cGU7CiAgICAgIGlmICghY3VzdG9tRXZlbnRPYmplY3QuaXNFdmVudE9iamVjdCkgewogICAgICAgIGN1c3RvbUV2ZW50T2JqZWN0ID0gbmV3IEN1c3RvbUV2ZW50T2JqZWN0KGN1c3RvbUV2ZW50T2JqZWN0KTsKICAgICAgfQogICAgICBjdXN0b21FdmVudE9iamVjdC50YXJnZXQgPSBjdXN0b21FdmVudE9iamVjdC50YXJnZXQgfHwgY3VycmVudFRhcmdldDsKICAgICAgY3VzdG9tRXZlbnRPYmplY3QuY3VycmVudFRhcmdldCA9IGN1cnJlbnRUYXJnZXQ7CiAgICAgIHJldCA9IHNlbGYubm90aWZ5KGN1c3RvbUV2ZW50T2JqZWN0KTsKICAgICAgaWYgKGdSZXQgIT09IGZhbHNlICYmIHJldCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgZ1JldCA9IHJldDsKICAgICAgfQogICAgICBpZiAoYnViYmxlcyAmJiAhY3VzdG9tRXZlbnRPYmplY3QuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSkgewogICAgICAgIHBhcmVudHMgPSBjdXJyZW50VGFyZ2V0LmdldFRhcmdldHMoKTsKICAgICAgICBwYXJlbnRzTGVuID0gcGFyZW50cyAmJiBwYXJlbnRzLmxlbmd0aCB8fCAwOwogICAgICAgIGZvciAoaSA9IDA7IGkgPCBwYXJlbnRzTGVuICYmICFjdXN0b21FdmVudE9iamVjdC5pc1Byb3BhZ2F0aW9uU3RvcHBlZCgpOyBpKyspIHsKICAgICAgICAgIHJldCA9IHBhcmVudHNbaV0uZmlyZSh0eXBlLCBjdXN0b21FdmVudE9iamVjdCk7CiAgICAgICAgICBpZiAoZ1JldCAhPT0gZmFsc2UgJiYgcmV0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgZ1JldCA9IHJldDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGRlZmF1bHRGbiAmJiAhY3VzdG9tRXZlbnRPYmplY3QuaXNEZWZhdWx0UHJldmVudGVkKCkpIHsKICAgICAgICB2YXIgdGFyZ2V0ID0gY3VzdG9tRXZlbnRPYmplY3QudGFyZ2V0LCBsb3dlc3RDdXN0b21FdmVudE9ic2VydmFibGUgPSB0YXJnZXQuZ2V0RXZlbnRMaXN0ZW5lcnMoY3VzdG9tRXZlbnRPYmplY3QudHlwZSk7CiAgICAgICAgaWYgKCFzZWxmLmRlZmF1bHRUYXJnZXRPbmx5ICYmICghbG93ZXN0Q3VzdG9tRXZlbnRPYnNlcnZhYmxlIHx8ICFsb3dlc3RDdXN0b21FdmVudE9ic2VydmFibGUuZGVmYXVsdFRhcmdldE9ubHkpIHx8IGN1cnJlbnRUYXJnZXQgPT09IHRhcmdldCkgewogICAgICAgICAgZ1JldCA9IGRlZmF1bHRGbi5jYWxsKGN1cnJlbnRUYXJnZXQsIGN1c3RvbUV2ZW50T2JqZWN0KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGdSZXQ7CiAgICB9LAogICAgbm90aWZ5OiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIG9ic2VydmVycyA9IFtdLmNvbmNhdCh0aGlzLm9ic2VydmVycyksIHJldCwgZ1JldCwgbGVuID0gb2JzZXJ2ZXJzLmxlbmd0aCwgaTsKICAgICAgZm9yIChpID0gMDsgaSA8IGxlbiAmJiAhZXZlbnQuaXNJbW1lZGlhdGVQcm9wYWdhdGlvblN0b3BwZWQoKTsgaSsrKSB7CiAgICAgICAgcmV0ID0gb2JzZXJ2ZXJzW2ldLm5vdGlmeShldmVudCwgdGhpcyk7CiAgICAgICAgaWYgKGdSZXQgIT09IGZhbHNlICYmIHJldCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBnUmV0ID0gcmV0OwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZ1JldDsKICAgIH0sCiAgICBkZXRhY2g6IGZ1bmN0aW9uIChjZmcpIHsKICAgICAgdmFyIGdyb3Vwc1JlLCBzZWxmID0gdGhpcywgZm4gPSBjZmcuZm4sIGNvbnRleHQgPSBjZmcuY29udGV4dCwgY3VycmVudFRhcmdldCA9IHNlbGYuY3VycmVudFRhcmdldCwgb2JzZXJ2ZXJzID0gc2VsZi5vYnNlcnZlcnMsIGdyb3VwcyA9IGNmZy5ncm91cHM7CiAgICAgIGlmICghb2JzZXJ2ZXJzLmxlbmd0aCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoZ3JvdXBzKSB7CiAgICAgICAgZ3JvdXBzUmUgPSBVdGlscy5nZXRHcm91cHNSZShncm91cHMpOwogICAgICB9CiAgICAgIHZhciBpLCBqLCB0LCBvYnNlcnZlciwgb2JzZXJ2ZXJDb250ZXh0LCBsZW4gPSBvYnNlcnZlcnMubGVuZ3RoOwogICAgICBpZiAoZm4gfHwgZ3JvdXBzUmUpIHsKICAgICAgICBjb250ZXh0ID0gY29udGV4dCB8fCBjdXJyZW50VGFyZ2V0OwogICAgICAgIGZvciAoaSA9IDAsIGogPSAwLCB0ID0gW107IGkgPCBsZW47ICsraSkgewogICAgICAgICAgb2JzZXJ2ZXIgPSBvYnNlcnZlcnNbaV07CiAgICAgICAgICB2YXIgb2JzZXJ2ZXJDb25maWcgPSBvYnNlcnZlci5jb25maWc7CiAgICAgICAgICBvYnNlcnZlckNvbnRleHQgPSBvYnNlcnZlckNvbmZpZy5jb250ZXh0IHx8IGN1cnJlbnRUYXJnZXQ7CiAgICAgICAgICBpZiAoY29udGV4dCAhPT0gb2JzZXJ2ZXJDb250ZXh0IHx8IGZuICYmIGZuICE9PSBvYnNlcnZlckNvbmZpZy5mbiB8fCBncm91cHNSZSAmJiAhb2JzZXJ2ZXJDb25maWcuZ3JvdXBzLm1hdGNoKGdyb3Vwc1JlKSkgewogICAgICAgICAgICB0W2orK10gPSBvYnNlcnZlcjsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2VsZi5vYnNlcnZlcnMgPSB0OwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYucmVzZXQoKTsKICAgICAgfQogICAgfQogIH0pOwogIGV4cG9ydHMgPSBDdXN0b21FdmVudE9ic2VydmFibGU7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnRDdXN0b21MaWJFdmVudEN1c3RvbVRhcmdldCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIEJhc2VFdmVudCA9IGV2ZW50QmFzZTsKICB2YXIgQ3VzdG9tRXZlbnRPYnNlcnZhYmxlID0gZXZlbnRDdXN0b21MaWJFdmVudEN1c3RvbU9ic2VydmFibGU7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgVXRpbHMgPSBCYXNlRXZlbnQuVXRpbHMsIHNwbGl0QW5kUnVuID0gVXRpbHMuc3BsaXRBbmRSdW4sIEtTX0JVQkJMRV9UQVJHRVRTID0gJ19ffmtzX2J1YmJsZV90YXJnZXRzJzsKICB2YXIgS1NfQ1VTVE9NX0VWRU5UUyA9ICdfX35rc19jdXN0b21fZXZlbnRzJzsKICBmdW5jdGlvbiBnZXRDdXN0b21FdmVudE9ic2VydmFibGUoc2VsZiwgdHlwZSkgewogICAgdmFyIGN1c3RvbUV2ZW50ID0gc2VsZi5nZXRFdmVudExpc3RlbmVycyh0eXBlKTsKICAgIGlmICghY3VzdG9tRXZlbnQpIHsKICAgICAgY3VzdG9tRXZlbnQgPSBzZWxmLmdldEV2ZW50TGlzdGVuZXJzKClbdHlwZV0gPSBuZXcgQ3VzdG9tRXZlbnRPYnNlcnZhYmxlKHsKICAgICAgICBjdXJyZW50VGFyZ2V0OiBzZWxmLAogICAgICAgIHR5cGU6IHR5cGUKICAgICAgfSk7CiAgICB9CiAgICByZXR1cm4gY3VzdG9tRXZlbnQ7CiAgfQogIGV4cG9ydHMgPSB7CiAgICBpc1RhcmdldDogMSwKICAgIGZpcmU6IGZ1bmN0aW9uICh0eXBlLCBldmVudERhdGEpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCByZXQsIHRhcmdldHMgPSBzZWxmLmdldFRhcmdldHMoKSwgaGFzVGFyZ2V0cyA9IHRhcmdldHMgJiYgdGFyZ2V0cy5sZW5ndGg7CiAgICAgIGlmICh0eXBlLmlzRXZlbnRPYmplY3QpIHsKICAgICAgICBldmVudERhdGEgPSB0eXBlOwogICAgICAgIHR5cGUgPSB0eXBlLnR5cGU7CiAgICAgIH0KICAgICAgZXZlbnREYXRhID0gZXZlbnREYXRhIHx8IHt9OwogICAgICBzcGxpdEFuZFJ1bih0eXBlLCBmdW5jdGlvbiAodHlwZSkgewogICAgICAgIHZhciByMiwgY3VzdG9tRXZlbnRPYnNlcnZhYmxlOwogICAgICAgIFV0aWxzLmZpbGxHcm91cHNGb3JFdmVudCh0eXBlLCBldmVudERhdGEpOwogICAgICAgIHR5cGUgPSBldmVudERhdGEudHlwZTsKICAgICAgICBjdXN0b21FdmVudE9ic2VydmFibGUgPSBzZWxmLmdldEV2ZW50TGlzdGVuZXJzKHR5cGUpOwogICAgICAgIGlmICghY3VzdG9tRXZlbnRPYnNlcnZhYmxlICYmICFoYXNUYXJnZXRzKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmIChjdXN0b21FdmVudE9ic2VydmFibGUpIHsKICAgICAgICAgIGlmICghY3VzdG9tRXZlbnRPYnNlcnZhYmxlLmhhc09ic2VydmVyKCkgJiYgIWN1c3RvbUV2ZW50T2JzZXJ2YWJsZS5kZWZhdWx0Rm4pIHsKICAgICAgICAgICAgaWYgKGN1c3RvbUV2ZW50T2JzZXJ2YWJsZS5idWJibGVzICYmICFoYXNUYXJnZXRzIHx8ICFjdXN0b21FdmVudE9ic2VydmFibGUuYnViYmxlcykgewogICAgICAgICAgICAgIHJldHVybjsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjdXN0b21FdmVudE9ic2VydmFibGUgPSBuZXcgQ3VzdG9tRXZlbnRPYnNlcnZhYmxlKHsKICAgICAgICAgICAgY3VycmVudFRhcmdldDogc2VsZiwKICAgICAgICAgICAgdHlwZTogdHlwZQogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICAgIHIyID0gY3VzdG9tRXZlbnRPYnNlcnZhYmxlLmZpcmUoZXZlbnREYXRhKTsKICAgICAgICBpZiAocmV0ICE9PSBmYWxzZSAmJiByMiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXQgPSByMjsKICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcmV0OwogICAgfSwKICAgIHB1Ymxpc2g6IGZ1bmN0aW9uICh0eXBlLCBjZmcpIHsKICAgICAgdmFyIGN1c3RvbUV2ZW50T2JzZXJ2YWJsZSwgc2VsZiA9IHRoaXM7CiAgICAgIHNwbGl0QW5kUnVuKHR5cGUsIGZ1bmN0aW9uICh0KSB7CiAgICAgICAgY3VzdG9tRXZlbnRPYnNlcnZhYmxlID0gZ2V0Q3VzdG9tRXZlbnRPYnNlcnZhYmxlKHNlbGYsIHQpOwogICAgICAgIHV0aWwubWl4KGN1c3RvbUV2ZW50T2JzZXJ2YWJsZSwgY2ZnKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIGFkZFRhcmdldDogZnVuY3Rpb24gKGFub3RoZXJUYXJnZXQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCB0YXJnZXRzID0gc2VsZi5nZXRUYXJnZXRzKCk7CiAgICAgIGlmICghdXRpbC5pbkFycmF5KGFub3RoZXJUYXJnZXQsIHRhcmdldHMpKSB7CiAgICAgICAgdGFyZ2V0cy5wdXNoKGFub3RoZXJUYXJnZXQpOwogICAgICB9CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIHJlbW92ZVRhcmdldDogZnVuY3Rpb24gKGFub3RoZXJUYXJnZXQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCB0YXJnZXRzID0gc2VsZi5nZXRUYXJnZXRzKCksIGluZGV4ID0gdXRpbC5pbmRleE9mKGFub3RoZXJUYXJnZXQsIHRhcmdldHMpOwogICAgICBpZiAoaW5kZXggIT09IC0xKSB7CiAgICAgICAgdGFyZ2V0cy5zcGxpY2UoaW5kZXgsIDEpOwogICAgICB9CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIGdldFRhcmdldHM6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRoaXNbS1NfQlVCQkxFX1RBUkdFVFNdIHx8ICh0aGlzW0tTX0JVQkJMRV9UQVJHRVRTXSA9IFtdKTsKICAgIH0sCiAgICBnZXRFdmVudExpc3RlbmVyczogZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgdmFyIG9ic2VydmFibGVzID0gdGhpc1tLU19DVVNUT01fRVZFTlRTXSB8fCAodGhpc1tLU19DVVNUT01fRVZFTlRTXSA9IHt9KTsKICAgICAgcmV0dXJuIHR5cGUgPyBvYnNlcnZhYmxlc1t0eXBlXSA6IG9ic2VydmFibGVzOwogICAgfSwKICAgIG9uOiBmdW5jdGlvbiAodHlwZSwgZm4sIGNvbnRleHQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBVdGlscy5iYXRjaEZvclR5cGUoZnVuY3Rpb24gKHR5cGUsIGZuLCBjb250ZXh0KSB7CiAgICAgICAgdmFyIGNmZyA9IFV0aWxzLm5vcm1hbGl6ZVBhcmFtKHR5cGUsIGZuLCBjb250ZXh0KTsKICAgICAgICB0eXBlID0gY2ZnLnR5cGU7CiAgICAgICAgdmFyIGN1c3RvbUV2ZW50ID0gZ2V0Q3VzdG9tRXZlbnRPYnNlcnZhYmxlKHNlbGYsIHR5cGUpOwogICAgICAgIGN1c3RvbUV2ZW50Lm9uKGNmZyk7CiAgICAgIH0sIDAsIHR5cGUsIGZuLCBjb250ZXh0KTsKICAgICAgcmV0dXJuIHNlbGY7CiAgICB9LAogICAgZGV0YWNoOiBmdW5jdGlvbiAodHlwZSwgZm4sIGNvbnRleHQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBVdGlscy5iYXRjaEZvclR5cGUoZnVuY3Rpb24gKHR5cGUsIGZuLCBjb250ZXh0KSB7CiAgICAgICAgdmFyIGNmZyA9IFV0aWxzLm5vcm1hbGl6ZVBhcmFtKHR5cGUsIGZuLCBjb250ZXh0KTsKICAgICAgICB0eXBlID0gY2ZnLnR5cGU7CiAgICAgICAgaWYgKHR5cGUpIHsKICAgICAgICAgIHZhciBjdXN0b21FdmVudCA9IHNlbGYuZ2V0RXZlbnRMaXN0ZW5lcnModHlwZSk7CiAgICAgICAgICBpZiAoY3VzdG9tRXZlbnQpIHsKICAgICAgICAgICAgY3VzdG9tRXZlbnQuZGV0YWNoKGNmZyk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHV0aWwuZWFjaChzZWxmLmdldEV2ZW50TGlzdGVuZXJzKCksIGZ1bmN0aW9uIChjdXN0b21FdmVudCkgewogICAgICAgICAgICBjdXN0b21FdmVudC5kZXRhY2goY2ZnKTsKICAgICAgICAgIH0pOwogICAgICAgIH0KICAgICAgfSwgMCwgdHlwZSwgZm4sIGNvbnRleHQpOwogICAgICByZXR1cm4gc2VsZjsKICAgIH0KICB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50Q3VzdG9tTGliRXZlbnRDdXN0b20gPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBUYXJnZXQgPSBldmVudEN1c3RvbUxpYkV2ZW50Q3VzdG9tVGFyZ2V0OwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgZXhwb3J0cyA9IHsKICAgIFRhcmdldDogVGFyZ2V0LAogICAgT2JqZWN0OiBldmVudEN1c3RvbUxpYkV2ZW50Q3VzdG9tT2JqZWN0LAogICAgZ2xvYmFsOiB1dGlsLm1peCh7fSwgVGFyZ2V0KQogIH07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnRDdXN0b21JbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZXhwb3J0cyA9IGV2ZW50Q3VzdG9tTGliRXZlbnRDdXN0b207CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGV2ZW50Q3VzdG9tSW5kZXg7Cn0pO2RlZmluZSgiZXZlbnQtYmFzZSIsIFsndXRpbCddLCBmdW5jdGlvbihyZXF1aXJlKSB7CnZhciB1dGlsQmFzZSA9IHJlcXVpcmUoJ3V0aWwnKTsKLy8hIENvcHlyaWdodCAyMDE1LCBldmVudC1iYXNlQDYuMS4xIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAwNzozMDozMCBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmV2ZW50LWJhc2UKZXZlbnQtYmFzZS9saWIvZXZlbnQtYmFzZQpldmVudC1iYXNlL2xpYi9ldmVudC1iYXNlL3V0aWxzCmV2ZW50LWJhc2UvbGliL2V2ZW50LWJhc2Uvb2JzZXJ2ZXIKZXZlbnQtYmFzZS9saWIvZXZlbnQtYmFzZS9vYnNlcnZhYmxlCmV2ZW50LWJhc2UvbGliL2V2ZW50LWJhc2Uvb2JqZWN0CiovCnZhciBldmVudEJhc2VMaWJFdmVudEJhc2VVdGlscywgZXZlbnRCYXNlTGliRXZlbnRCYXNlT2JzZXJ2ZXIsIGV2ZW50QmFzZUxpYkV2ZW50QmFzZU9ic2VydmFibGUsIGV2ZW50QmFzZUxpYkV2ZW50QmFzZU9iamVjdCwgZXZlbnRCYXNlTGliRXZlbnRCYXNlLCBldmVudEJhc2VJbmRleDsKZXZlbnRCYXNlTGliRXZlbnRCYXNlVXRpbHMgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKgogICAqIEBpZ25vcmUKICAgKiB1dGlscyBmb3IgZXZlbnQKICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbSwgYmVuZmNoZW4wNDE4QGdtYWlsLmNvbQogICAqLwogIHZhciBzcGxpdEFuZFJ1biwgZ2V0R3JvdXBzUmU7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICBmdW5jdGlvbiBnZXRUeXBlZEdyb3Vwcyh0eXBlKSB7CiAgICBpZiAodHlwZS5pbmRleE9mKCcuJykgPCAwKSB7CiAgICAgIHJldHVybiBbCiAgICAgICAgdHlwZSwKICAgICAgICAnJwogICAgICBdOwogICAgfQogICAgdmFyIG0gPSB0eXBlLm1hdGNoKC8oW14uXSspPyhcLi4rKT8kLyksIHQgPSBtWzFdLCByZXQgPSBbdF0sIGdzID0gbVsyXTsKICAgIGlmIChncykgewogICAgICBncyA9IGdzLnNwbGl0KCcuJykuc29ydCgpOwogICAgICByZXQucHVzaChncy5qb2luKCcuJykpOwogICAgfSBlbHNlIHsKICAgICAgcmV0LnB1c2goJycpOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9CiAgZXhwb3J0cyA9IHsKICAgIHNwbGl0QW5kUnVuOiBzcGxpdEFuZFJ1biA9IGZ1bmN0aW9uICh0eXBlLCBmbikgewogICAgICBpZiAodXRpbC5pc0FycmF5KHR5cGUpKSB7CiAgICAgICAgdXRpbC5lYWNoKHR5cGUsIGZuKTsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdHlwZSA9IHV0aWwudHJpbSh0eXBlKTsKICAgICAgaWYgKHR5cGUuaW5kZXhPZignICcpID09PSAtMSkgewogICAgICAgIGZuKHR5cGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHV0aWwuZWFjaCh0eXBlLnNwbGl0KC9ccysvKSwgZm4pOwogICAgICB9CiAgICB9LAogICAgbm9ybWFsaXplUGFyYW06IGZ1bmN0aW9uICh0eXBlLCBmbiwgY29udGV4dCkgewogICAgICB2YXIgY2ZnID0gZm4gfHwge307CiAgICAgIGlmICh0eXBlb2YgZm4gPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBjZmcgPSB7CiAgICAgICAgICBmbjogZm4sCiAgICAgICAgICBjb250ZXh0OiBjb250ZXh0CiAgICAgICAgfTsKICAgICAgfSBlbHNlIHsKICAgICAgICBjZmcgPSB1dGlsLm1lcmdlKGNmZyk7CiAgICAgIH0KICAgICAgdmFyIHR5cGVkR3JvdXBzID0gZ2V0VHlwZWRHcm91cHModHlwZSk7CiAgICAgIHR5cGUgPSB0eXBlZEdyb3Vwc1swXTsKICAgICAgY2ZnLmdyb3VwcyA9IHR5cGVkR3JvdXBzWzFdOwogICAgICBjZmcudHlwZSA9IHR5cGU7CiAgICAgIHJldHVybiBjZmc7CiAgICB9LAogICAgYmF0Y2hGb3JUeXBlOiBmdW5jdGlvbiAoZm4sIG51bSkgewogICAgICB2YXIgYXJncyA9IHV0aWwubWFrZUFycmF5KGFyZ3VtZW50cyksIHR5cGVzID0gYXJnc1syICsgbnVtXTsKICAgICAgaWYgKHR5cGVzICYmIHV0aWwuaXNPYmplY3QodHlwZXMpKSB7CiAgICAgICAgdXRpbC5lYWNoKHR5cGVzLCBmdW5jdGlvbiAodmFsdWUsIHR5cGUpIHsKICAgICAgICAgIHZhciBhcmdzMiA9IFtdLmNvbmNhdChhcmdzKTsKICAgICAgICAgIGFyZ3MyLnNwbGljZSgwLCAyKTsKICAgICAgICAgIGFyZ3MyW251bV0gPSB0eXBlOwogICAgICAgICAgYXJnczJbbnVtICsgMV0gPSB2YWx1ZTsKICAgICAgICAgIGZuLmFwcGx5KG51bGwsIGFyZ3MyKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzcGxpdEFuZFJ1bih0eXBlcywgZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgICAgIHZhciBhcmdzMiA9IFtdLmNvbmNhdChhcmdzKTsKICAgICAgICAgIGFyZ3MyLnNwbGljZSgwLCAyKTsKICAgICAgICAgIGFyZ3MyW251bV0gPSB0eXBlOwogICAgICAgICAgZm4uYXBwbHkobnVsbCwgYXJnczIpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgZmlsbEdyb3Vwc0ZvckV2ZW50OiBmdW5jdGlvbiAodHlwZSwgZXZlbnREYXRhKSB7CiAgICAgIHZhciB0eXBlZEdyb3VwcyA9IGdldFR5cGVkR3JvdXBzKHR5cGUpLCBfa3NHcm91cHMgPSB0eXBlZEdyb3Vwc1sxXTsKICAgICAgaWYgKF9rc0dyb3VwcykgewogICAgICAgIF9rc0dyb3VwcyA9IGdldEdyb3Vwc1JlKF9rc0dyb3Vwcyk7CiAgICAgICAgZXZlbnREYXRhLl9rc0dyb3VwcyA9IF9rc0dyb3VwczsKICAgICAgfQogICAgICBldmVudERhdGEudHlwZSA9IHR5cGVkR3JvdXBzWzBdOwogICAgfSwKICAgIGdldEdyb3Vwc1JlOiBnZXRHcm91cHNSZSA9IGZ1bmN0aW9uIChncm91cHMpIHsKICAgICAgcmV0dXJuIG5ldyBSZWdFeHAoZ3JvdXBzLnNwbGl0KCcuJykuam9pbignLipcXC4nKSArICcoPzpcXC58JCknKTsKICAgIH0KICB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50QmFzZUxpYkV2ZW50QmFzZU9ic2VydmVyID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdW5kZWY7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICBmdW5jdGlvbiBPYnNlcnZlcihjZmcpIHsKICAgIHRoaXMuY29uZmlnID0gY2ZnIHx8IHt9OwogIH0KICBPYnNlcnZlci5wcm90b3R5cGUgPSB7CiAgICBjb25zdHJ1Y3RvcjogT2JzZXJ2ZXIsCiAgICBlcXVhbHM6IGZ1bmN0aW9uIChzMikgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHJldHVybiAhIXV0aWwucmVkdWNlKHNlbGYua2V5cywgZnVuY3Rpb24gKHYsIGspIHsKICAgICAgICByZXR1cm4gdiAmJiBzZWxmLmNvbmZpZ1trXSA9PT0gczIuY29uZmlnW2tdOwogICAgICB9LCAxKTsKICAgIH0sCiAgICBzaW1wbGVOb3RpZnk6IGZ1bmN0aW9uIChldmVudCwgY2UpIHsKICAgICAgdmFyIHJldCwgc2VsZiA9IHRoaXMsIGNvbmZpZyA9IHNlbGYuY29uZmlnOwogICAgICByZXQgPSBjb25maWcuZm4uY2FsbChjb25maWcuY29udGV4dCB8fCBjZS5jdXJyZW50VGFyZ2V0LCBldmVudCwgY29uZmlnLmRhdGEpOwogICAgICBpZiAoY29uZmlnLm9uY2UpIHsKICAgICAgICBjZS5yZW1vdmVPYnNlcnZlcihzZWxmKTsKICAgICAgfQogICAgICByZXR1cm4gcmV0OwogICAgfSwKICAgIG5vdGlmeUludGVybmFsOiBmdW5jdGlvbiAoZXZlbnQsIGNlKSB7CiAgICAgIHZhciByZXQgPSB0aGlzLnNpbXBsZU5vdGlmeShldmVudCwgY2UpOwogICAgICBpZiAocmV0ID09PSBmYWxzZSkgewogICAgICAgIGV2ZW50LmhhbHQoKTsKICAgICAgfQogICAgICByZXR1cm4gcmV0OwogICAgfSwKICAgIG5vdGlmeTogZnVuY3Rpb24gKGV2ZW50LCBjZSkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGNvbmZpZyA9IHNlbGYuY29uZmlnLCBfa3NHcm91cHMgPSBldmVudC5fa3NHcm91cHM7CiAgICAgIGlmIChfa3NHcm91cHMgJiYgKCFjb25maWcuZ3JvdXBzIHx8ICFjb25maWcuZ3JvdXBzLm1hdGNoKF9rc0dyb3VwcykpKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmOwogICAgICB9CiAgICAgIHJldHVybiBzZWxmLm5vdGlmeUludGVybmFsKGV2ZW50LCBjZSk7CiAgICB9CiAgfTsKICBleHBvcnRzID0gT2JzZXJ2ZXI7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnRCYXNlTGliRXZlbnRCYXNlT2JzZXJ2YWJsZSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICBmdW5jdGlvbiBPYnNlcnZhYmxlKGNmZykgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgc2VsZi5jdXJyZW50VGFyZ2V0ID0gbnVsbDsKICAgIHV0aWwubWl4KHNlbGYsIGNmZyk7CiAgICBzZWxmLnJlc2V0KCk7CiAgfQogIE9ic2VydmFibGUucHJvdG90eXBlID0gewogICAgY29uc3RydWN0b3I6IE9ic2VydmFibGUsCiAgICBoYXNPYnNlcnZlcjogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gISF0aGlzLm9ic2VydmVycy5sZW5ndGg7CiAgICB9LAogICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBzZWxmLm9ic2VydmVycyA9IFtdOwogICAgfSwKICAgIHJlbW92ZU9ic2VydmVyOiBmdW5jdGlvbiAob2JzZXJ2ZXIpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBpLCBvYnNlcnZlcnMgPSBzZWxmLm9ic2VydmVycywgbGVuID0gb2JzZXJ2ZXJzLmxlbmd0aDsKICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgaWYgKG9ic2VydmVyc1tpXSA9PT0gb2JzZXJ2ZXIpIHsKICAgICAgICAgIG9ic2VydmVycy5zcGxpY2UoaSwgMSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgICAgc2VsZi5jaGVja01lbW9yeSgpOwogICAgfSwKICAgIGNoZWNrTWVtb3J5OiBmdW5jdGlvbiAoKSB7CiAgICB9LAogICAgZmluZE9ic2VydmVyOiBmdW5jdGlvbiAob2JzZXJ2ZXIpIHsKICAgICAgdmFyIG9ic2VydmVycyA9IHRoaXMub2JzZXJ2ZXJzLCBpOwogICAgICBmb3IgKGkgPSBvYnNlcnZlcnMubGVuZ3RoIC0gMTsgaSA+PSAwOyAtLWkpIHsKICAgICAgICBpZiAob2JzZXJ2ZXIuZXF1YWxzKG9ic2VydmVyc1tpXSkpIHsKICAgICAgICAgIHJldHVybiBpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gLTE7CiAgICB9CiAgfTsKICBleHBvcnRzID0gT2JzZXJ2YWJsZTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpldmVudEJhc2VMaWJFdmVudEJhc2VPYmplY3QgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciByZXR1cm5GYWxzZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwgcmV0dXJuVHJ1ZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9LCB1bmRlZjsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIGZ1bmN0aW9uIEV2ZW50T2JqZWN0KCkgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgc2VsZi50aW1lU3RhbXAgPSB1dGlsLm5vdygpOwogICAgc2VsZi50YXJnZXQgPSB1bmRlZjsKICAgIHNlbGYuY3VycmVudFRhcmdldCA9IHVuZGVmOwogIH0KICBFdmVudE9iamVjdC5wcm90b3R5cGUgPSB7CiAgICBpc0V2ZW50T2JqZWN0OiAxLAogICAgY29uc3RydWN0b3I6IEV2ZW50T2JqZWN0LAogICAgaXNEZWZhdWx0UHJldmVudGVkOiByZXR1cm5GYWxzZSwKICAgIGlzUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSwKICAgIGlzSW1tZWRpYXRlUHJvcGFnYXRpb25TdG9wcGVkOiByZXR1cm5GYWxzZSwKICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuaXNEZWZhdWx0UHJldmVudGVkID0gcmV0dXJuVHJ1ZTsKICAgIH0sCiAgICBzdG9wUHJvcGFnYXRpb246IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5pc1Byb3BhZ2F0aW9uU3RvcHBlZCA9IHJldHVyblRydWU7CiAgICB9LAogICAgc3RvcEltbWVkaWF0ZVByb3BhZ2F0aW9uOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgc2VsZi5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCA9IHJldHVyblRydWU7CiAgICAgIHNlbGYuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICB9LAogICAgaGFsdDogZnVuY3Rpb24gKGltbWVkaWF0ZSkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGlmIChpbW1lZGlhdGUpIHsKICAgICAgICBzZWxmLnN0b3BJbW1lZGlhdGVQcm9wYWdhdGlvbigpOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgIH0KICAgICAgc2VsZi5wcmV2ZW50RGVmYXVsdCgpOwogICAgfQogIH07CiAgZXhwb3J0cyA9IEV2ZW50T2JqZWN0OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50QmFzZUxpYkV2ZW50QmFzZSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIFV0aWxzID0gZXZlbnRCYXNlTGliRXZlbnRCYXNlVXRpbHM7CiAgdmFyIE9ic2VydmVyID0gZXZlbnRCYXNlTGliRXZlbnRCYXNlT2JzZXJ2ZXI7CiAgdmFyIE9ic2VydmFibGUgPSBldmVudEJhc2VMaWJFdmVudEJhc2VPYnNlcnZhYmxlOwogIGV4cG9ydHMgPSB7CiAgICBVdGlsczogVXRpbHMsCiAgICBPYmplY3Q6IGV2ZW50QmFzZUxpYkV2ZW50QmFzZU9iamVjdCwKICAgIE9ic2VydmVyOiBPYnNlcnZlciwKICAgIE9ic2VydmFibGU6IE9ic2VydmFibGUKICB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50QmFzZUluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICBleHBvcnRzID0gZXZlbnRCYXNlTGliRXZlbnRCYXNlOwogIHJldHVybiBleHBvcnRzOwp9KCk7CnJldHVybiBldmVudEJhc2VJbmRleDsKfSk7ZGVmaW5lKCJpbyIsIFsndXRpbCcsImlvLWV4dHJhIiwiaW8tZm9ybSJdLCBmdW5jdGlvbihyZXF1aXJlKSB7CnZhciB1dGlsQmFzZSA9IHJlcXVpcmUoJ3V0aWwnKTsKdmFyIGlvRXh0cmEgPSByZXF1aXJlKCJpby1leHRyYSIpOwp2YXIgaW9Gb3JtID0gcmVxdWlyZSgiaW8tZm9ybSIpOwovLyEgQ29weXJpZ2h0IDIwMTUsIGlvQDYuMS4yIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAxMjowNzoxNSBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmlvCiovCnZhciBpb0luZGV4Owppb0luZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBJTyA9IGlvRXh0cmE7CiAgdmFyIEZvcm1TZXJpYWxpemVyID0gaW9Gb3JtOwogIHV0aWwubWl4KElPLCB7CiAgICBzZXJpYWxpemU6IEZvcm1TZXJpYWxpemVyLnNlcmlhbGl6ZSwKICAgIGdldEZvcm1EYXRhOiBGb3JtU2VyaWFsaXplci5nZXRGb3JtRGF0YQogIH0pOwogIGV4cG9ydHMgPSBJTzsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gaW9JbmRleDsKfSk7ZGVmaW5lKCJpby1leHRyYSIsIFsndXRpbCcsInF1ZXJ5c3RyaW5nIiwnZG9tJywiaW8tYmFzZSIsJ3V0aWwnXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgdXRpbEV4dHJhID0gcmVxdWlyZSgndXRpbCcpOwp2YXIgX3F1ZXJ5c3RyaW5nXyA9IHJlcXVpcmUoInF1ZXJ5c3RyaW5nIik7CnZhciBkb21CYXNlID0gcmVxdWlyZSgnZG9tJyk7CnZhciBpb0Jhc2UgPSByZXF1aXJlKCJpby1iYXNlIik7CnZhciB1dGlsQmFzZSA9IHJlcXVpcmUoJ3V0aWwnKTsKLy8hIENvcHlyaWdodCAyMDE1LCBpby1leHRyYUA2LjEuMiBNSVQgTGljZW5zZWQsIGJ1aWxkIHRpbWU6IFRodSwgMjkgT2N0IDIwMTUgMTI6MTI6NDUgR01UIAovKgpjb21iaW5lZCBtb2R1bGVzOgppby1leHRyYQppby1leHRyYS9saWIvZXh0cmEKaW8tZXh0cmEvbGliL2V4dHJhL2lmcmFtZS10cmFuc3BvcnQKKi8KdmFyIGlvRXh0cmFMaWJFeHRyYUlmcmFtZVRyYW5zcG9ydCwgaW9FeHRyYUxpYkV4dHJhLCBpb0V4dHJhSW5kZXg7CmlvRXh0cmFMaWJFeHRyYUlmcmFtZVRyYW5zcG9ydCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgLyoqCiAgICogQGlnbm9yZQogICAqIG5vbi1yZWZyZXNoIHVwbG9hZCBmaWxlIHdpdGggZm9ybSBieSBpZnJhbWUKICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbQogICAqLwogIHZhciB1dGlsID0gdXRpbEV4dHJhOwogIHZhciBxdWVyeXN0cmluZyA9IF9xdWVyeXN0cmluZ187CiAgdmFyIERvbSA9IGRvbUJhc2U7CiAgdmFyIElPID0gaW9CYXNlOwogIHZhciBpb1V0aWxzID0gSU8uX3V0aWw7CiAgdmFyIGRvYyA9IGRvY3VtZW50LCBPS19DT0RFID0gMjAwLCBFUlJPUl9DT0RFID0gNTAwLCBCUkVBVEhfSU5URVJWQUwgPSAzMCwgaWZyYW1lQ29udmVydGVyID0gdXRpbC5jbG9uZShJTy5nZXRDb25maWcoKS5jb252ZXJ0ZXJzLnRleHQpOwogIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9raXNzeXRlYW0va2lzc3kvaXNzdWVzLzMwNAogIC8vIHJldHVybmVkIGRhdGEgbXVzdCBiZSBlc2NhcGVkIGJ5IHNlcnZlciBmb3IganNvbiBkYXRhVHlwZQogIC8vIGFzIGRhdGEKICAvLyBlZzoKICAvLyA8Ym9keT4KICAvLyB7CiAgLy8gICAgIiZsdDthJmd0O3h4Jmx0Oy9hJmd0OyIKICAvLyB9CiAgLy8gPC9ib2R5PgogIC8vIHRleHQgb3IgaHRtbCBkYXRhVHlwZSBpcyBvZiBzYW1lIGVmZmVjdC4KICAvLyBzYW1lIGFzIG5vcm1hbCBhamF4IG9yIGh0bWw1IEZpbGVEYXRhCiAgaWZyYW1lQ29udmVydGVyLmpzb24gPSBmdW5jdGlvbiAoc3RyKSB7CiAgICByZXR1cm4gdXRpbC5wYXJzZUpzb24odXRpbC51bkVzY2FwZUh0bWwoc3RyKSk7CiAgfTsKICAvLyBpZnJhbWUg5YaF55qE5YaF5a655bCx5pivIGJvZHkuaW5uZXJUZXh0CiAgSU8uc2V0dXBDb25maWcoewogICAgY29udmVydGVyczogewogICAgICAvLyBpZnJhbWUg5Yiw5YW25LuW57G75Z6L55qE6L2s5YyW5ZKMIHRleHQg5LiA5qC3CiAgICAgIGlmcmFtZTogaWZyYW1lQ29udmVydGVyLAogICAgICB0ZXh0OiB7CiAgICAgICAgLy8gZmFrZSB0eXBlLCBqdXN0IG1pcnJvcgogICAgICAgIGlmcmFtZTogZnVuY3Rpb24gKHRleHQpIHsKICAgICAgICAgIHJldHVybiB0ZXh0OwogICAgICAgIH0KICAgICAgfSwKICAgICAgeG1sOiB7CiAgICAgICAgLy8gZmFrZSB0eXBlLCBqdXN0IG1pcnJvcgogICAgICAgIGlmcmFtZTogZnVuY3Rpb24gKHhtbCkgewogICAgICAgICAgcmV0dXJuIHhtbDsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKICBmdW5jdGlvbiBjcmVhdGVJZnJhbWUoeGhyKSB7CiAgICB2YXIgaWQgPSB1dGlsLmd1aWQoJ2lvLWlmcmFtZScpLCBpZnJhbWUsCiAgICAgIC8vIGVtcHR5IHNyYywgc28gbm8gaGlzdG9yeQogICAgICBzcmMgPSBEb20uZ2V0RW1wdHlJZnJhbWVTcmMoKTsKICAgIGlmcmFtZSA9IHhoci5pZnJhbWUgPSBEb20uY3JlYXRlKCc8aWZyYW1lICcgKyAoc3JjID8gJyBzcmM9IicgKyBzcmMgKyAnIiAnIDogJycpICsgJyBpZD0iJyArIGlkICsgJyInICsgLy8gbmVlZCBuYW1lIGZvciB0YXJnZXQgb2YgZm9ybQogICAgJyBuYW1lPSInICsgaWQgKyAnIicgKyAnIHN0eWxlPSJwb3NpdGlvbjphYnNvbHV0ZTtsZWZ0Oi05OTk5cHg7dG9wOi05OTk5cHg7Ii8+Jyk7CiAgICBEb20ucHJlcGVuZChpZnJhbWUsIGRvYy5ib2R5IHx8IGRvYy5kb2N1bWVudEVsZW1lbnQpOwogICAgcmV0dXJuIGlmcmFtZTsKICB9CiAgZnVuY3Rpb24gYWRkRGF0YVRvRm9ybShxdWVyeSwgZm9ybSwgc2VyaWFsaXplQXJyYXkpIHsKICAgIHZhciByZXQgPSBbXSwgaXNBcnJheSwgaSwgZTsKICAgIHV0aWwuZWFjaChxdWVyeSwgZnVuY3Rpb24gKGRhdGEsIGspIHsKICAgICAgaXNBcnJheSA9IHV0aWwuaXNBcnJheShkYXRhKTsKICAgICAgaWYgKCFpc0FycmF5KSB7CiAgICAgICAgZGF0YSA9IFtkYXRhXTsKICAgICAgfQogICAgICAvLyDmlbDnu4Tlkozljp/nlJ/kuIDmoLflr7nlvoXvvIzliJvlu7rlpJrkuKrlkIzlkI3ovpPlhaXln58KICAgICAgZm9yIChpID0gMDsgaSA8IGRhdGEubGVuZ3RoOyBpKyspIHsKICAgICAgICBlID0gZG9jLmNyZWF0ZUVsZW1lbnQoJ2lucHV0Jyk7CiAgICAgICAgZS50eXBlID0gJ2hpZGRlbic7CiAgICAgICAgZS5uYW1lID0gayArIChpc0FycmF5ICYmIHNlcmlhbGl6ZUFycmF5ID8gJ1tdJyA6ICcnKTsKICAgICAgICBlLnZhbHVlID0gZGF0YVtpXTsKICAgICAgICBEb20uYXBwZW5kKGUsIGZvcm0pOwogICAgICAgIHJldC5wdXNoKGUpOwogICAgICB9CiAgICB9KTsKICAgIHJldHVybiByZXQ7CiAgfQogIGZ1bmN0aW9uIHJlbW92ZUZpZWxkc0Zyb21EYXRhKGZpZWxkcykgewogICAgRG9tLnJlbW92ZShmaWVsZHMpOwogIH0KICBmdW5jdGlvbiBjYWxsYmFjayhldmVudCkgewogICAgdmFyIHNlbGYgPSB0aGlzLCBmb3JtID0gc2VsZi5mb3JtLCBpbyA9IHNlbGYuaW8sIGV2ZW50VHlwZSA9IC8qKgogICAgICAgQHR5cGUgU3RyaW5nCiAgICAgICBAaWdub3JlKi8KICAgICAgZXZlbnQudHlwZSwgaWZyYW1lRG9jLCBpZnJhbWUgPSBpby5pZnJhbWU7CiAgICAvLyDpmLLmraLph43lpI3osIPnlKggLCDmiJDlip/lkI4gYWJvcnQKICAgIGlmICghaWZyYW1lKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIC8vIGllNiDnq4vljbPorr7nva4gYWN0aW9uIOiuvue9ruS4uuepuuWvvOiHtOeZveWxjwogICAgaWYgKGV2ZW50VHlwZSA9PT0gJ2Fib3J0JyAmJiBpb1V0aWxzLmllID09PSA2KSB7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIERvbS5hdHRyKGZvcm0sIHNlbGYuYXR0cnMpOwogICAgICB9LCAwKTsKICAgIH0gZWxzZSB7CiAgICAgIERvbS5hdHRyKGZvcm0sIHNlbGYuYXR0cnMpOwogICAgfQogICAgcmVtb3ZlRmllbGRzRnJvbURhdGEodGhpcy5maWVsZHMpOwogICAgaW9VdGlscy5yZW1vdmVFdmVudChpZnJhbWUsICdsb2FkJywgc2VsZi5fY2FsbGJhY2spOwogICAgaW9VdGlscy5yZW1vdmVFdmVudChpZnJhbWUsICdlcnJvcicsIHNlbGYuX2NhbGxiYWNrKTsKICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAvLyBmaXJlZm94IHdpbGwga2VlcCBsb2FkaW5nIGlmIG5vdCBzZXQgdGltZW91dAogICAgICBEb20ucmVtb3ZlKGlmcmFtZSk7CiAgICB9LCBCUkVBVEhfSU5URVJWQUwpOwogICAgLy8gbnVsbGlmeSB0byBwcmV2ZW50IG1lbW9yeSBsZWFrPwogICAgaW8uaWZyYW1lID0gbnVsbDsKICAgIGlmIChldmVudFR5cGUgPT09ICdsb2FkJykgewogICAgICB0cnkgewogICAgICAgIGlmcmFtZURvYyA9IGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50OwogICAgICAgIC8vIGllPDkKICAgICAgICBpZiAoaWZyYW1lRG9jICYmIGlmcmFtZURvYy5ib2R5KSB7CiAgICAgICAgICAvLyBodHRwczovL2dpdGh1Yi5jb20va2lzc3l0ZWFtL2tpc3N5L2lzc3Vlcy8zMDQKICAgICAgICAgIGlvLnJlc3BvbnNlVGV4dCA9IERvbS5odG1sKGlmcmFtZURvYy5ib2R5KTsKICAgICAgICAgIC8vIGllIHN0aWxsIGNhbiByZXRyaWV2ZSB4bWwgJ3MgcmVzcG9uc2VUZXh0CiAgICAgICAgICBpZiAodXRpbC5zdGFydHNXaXRoKGlvLnJlc3BvbnNlVGV4dCwgJzw/eG1sJykpIHsKICAgICAgICAgICAgaW8ucmVzcG9uc2VUZXh0ID0gdW5kZWZpbmVkOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICAvLyBpZTw5CiAgICAgICAgLy8gaHR0cDovL2hlbHAuZG90dG9yby5jb20vbGpiY2pmb3QucGhwCiAgICAgICAgLy8gaHR0cDovL21zZG4ubWljcm9zb2Z0LmNvbS9lbi11cy9saWJyYXJ5L3dpbmRvd3MvZGVza3RvcC9tczc2NjUxMih2PXZzLjg1KS5hc3B4CiAgICAgICAgLyoKICAgICAgICAgSW4gSW50ZXJuZXQgRXhwbG9yZXIsIFhNTCBkb2N1bWVudHMgY2FuIGFsc28gYmUgZW1iZWRkZWQgaW50byBIVE1MIGRvY3VtZW50cyB3aXRoIHRoZSB4bWwgSFRNTCBlbGVtZW50cy4KICAgICAgICAgVG8gZ2V0IGFuIFhNTERvY3VtZW50IG9iamVjdCB0aGF0IHJlcHJlc2VudHMgdGhlIGVtYmVkZGVkIFhNTCBkYXRhIGlzbGFuZCwKICAgICAgICAgdXNlIHRoZSBYTUxEb2N1bWVudCBwcm9wZXJ0eSBvZiB0aGUgeG1sIGVsZW1lbnQuCiAgICAgICAgIE5vdGUgdGhhdCB0aGUgc3VwcG9ydCBmb3IgdGhlIFhNTERvY3VtZW50IHByb3BlcnR5IGhhcyBiZWVuIHJlbW92ZWQgaW4gSW50ZXJuZXQgRXhwbG9yZXIgOS4KICAgICAgICAgKi8KICAgICAgICBpZiAoaWZyYW1lRG9jICYmIGlmcmFtZURvYy5YTUxEb2N1bWVudCkgewogICAgICAgICAgaW8ucmVzcG9uc2VYTUwgPSBpZnJhbWVEb2MuWE1MRG9jdW1lbnQ7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIGllOSBmaXJlZm94IGNocm9tZQogICAgICAgICAgaW8ucmVzcG9uc2VYTUwgPSBpZnJhbWVEb2M7CiAgICAgICAgfQogICAgICAgIGlmIChpZnJhbWVEb2MpIHsKICAgICAgICAgIGlvLl9pb1JlYWR5KE9LX0NPREUsICdzdWNjZXNzJyk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIC8vIGNocm9tZSBkb2VzIG5vdCB0aHJvdyBleGNlcHRpb246CiAgICAgICAgICAvLyBVbnNhZmUgSmF2YVNjcmlwdCBhdHRlbXB0IHRvIGFjY2VzcyBmcmFtZSB3aXRoIFVSTCB1cGxvYWQuanNzIGZyb20gZnJhbWUgd2l0aCBVUkwgdGVzdC5odG1sLgogICAgICAgICAgLy8gRG9tYWlucywgcHJvdG9jb2xzIGFuZCBwb3J0cyBtdXN0IG1hdGNoLgogICAgICAgICAgLy8gY2hyb21lIHdpbGwgZ2V0IGlmcmFtZURvYyB0byBudWxsCiAgICAgICAgICAvLyBzbyB0aGlzIGVycm9yIGlzIHBhcnNlciBlcnJvciB0byBub3JtYWxpemUgYWxsIGJyb3dzZXJzCiAgICAgICAgICBpby5faW9SZWFkeShFUlJPUl9DT0RFLCAncGFyc2VyIGVycm9yJyk7CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgLy8gIzI0NSBzdWJtaXQgdG8gYSAgY3Jvc3MgZG9tYWluIHBhZ2UgZXhjZXB0IGNocm9tZQogICAgICAgIGlvLl9pb1JlYWR5KEVSUk9SX0NPREUsICdwYXJzZXIgZXJyb3InKTsKICAgICAgfQogICAgfSBlbHNlIGlmIChldmVudFR5cGUgPT09ICdlcnJvcicpIHsKICAgICAgaW8uX2lvUmVhZHkoRVJST1JfQ09ERSwgJ2Vycm9yJyk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIElmcmFtZVRyYW5zcG9ydChpbykgewogICAgdGhpcy5pbyA9IGlvOwogICAgdGhpcy5fY2FsbGJhY2sgPSB1dGlsLmJpbmQoY2FsbGJhY2ssIHRoaXMpOwogIH0KICB1dGlsLmF1Z21lbnQoSWZyYW1lVHJhbnNwb3J0LCB7CiAgICBzZW5kOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgaW8gPSBzZWxmLmlvLCBjID0gaW8uY29uZmlnLCBmaWVsZHMsIGlmcmFtZSwgcXVlcnksIGRhdGEgPSBjLmRhdGEsIGZvcm0gPSBEb20uZ2V0KGMuZm9ybSk7CiAgICAgIHNlbGYuYXR0cnMgPSB7CiAgICAgICAgdGFyZ2V0OiBEb20uYXR0cihmb3JtLCAndGFyZ2V0JykgfHwgJycsCiAgICAgICAgYWN0aW9uOiBEb20uYXR0cihmb3JtLCAnYWN0aW9uJykgfHwgJycsCiAgICAgICAgLy8gZW5jdHlwZSDljLrliIYgaWZyYW1lIOS4jiBzZXJpYWxpemUKICAgICAgICBlbmNvZGluZzogRG9tLmF0dHIoZm9ybSwgJ2VuY29kaW5nJyksCiAgICAgICAgZW5jdHlwZTogRG9tLmF0dHIoZm9ybSwgJ2VuY3R5cGUnKSwKICAgICAgICBtZXRob2Q6IERvbS5hdHRyKGZvcm0sICdtZXRob2QnKQogICAgICB9OwogICAgICBzZWxmLmZvcm0gPSBmb3JtOwogICAgICBpZnJhbWUgPSBjcmVhdGVJZnJhbWUoaW8pOwogICAgICAvLyBzZXQgdGFyZ2V0IHRvIGlmcmFtZSB0byBhdm9pZCBtYWluIHBhZ2UgcmVmcmVzaAogICAgICBEb20uYXR0cihmb3JtLCB7CiAgICAgICAgdGFyZ2V0OiBpZnJhbWUuaWQsCiAgICAgICAgYWN0aW9uOiBpby5fZ2V0VXJsRm9yU2VuZCgpLAogICAgICAgIG1ldGhvZDogJ3Bvc3QnLAogICAgICAgIGVuY3R5cGU6ICdtdWx0aXBhcnQvZm9ybS1kYXRhJywKICAgICAgICBlbmNvZGluZzogJ211bHRpcGFydC9mb3JtLWRhdGEnCiAgICAgIH0pOwogICAgICAvLyB1bnBhcmFtIHRvIGt2IG1hcAogICAgICBpZiAoZGF0YSkgewogICAgICAgIHF1ZXJ5ID0gcXVlcnlzdHJpbmcucGFyc2UoZGF0YSk7CiAgICAgIH0KICAgICAgaWYgKHF1ZXJ5KSB7CiAgICAgICAgZmllbGRzID0gYWRkRGF0YVRvRm9ybShxdWVyeSwgZm9ybSwgYy5zZXJpYWxpemVBcnJheSk7CiAgICAgIH0KICAgICAgc2VsZi5maWVsZHMgPSBmaWVsZHM7CiAgICAgIGZ1bmN0aW9uIGdvKCkgewogICAgICAgIGlvVXRpbHMuYWRkRXZlbnQoaWZyYW1lLCAnbG9hZCcsIHNlbGYuX2NhbGxiYWNrKTsKICAgICAgICBpb1V0aWxzLmFkZEV2ZW50KGlmcmFtZSwgJ2Vycm9yJywgc2VsZi5fY2FsbGJhY2spOwogICAgICAgIGZvcm0uc3VibWl0KCk7CiAgICAgIH0KICAgICAgLy8gaWU2IG5lZWQgYSBicmVhdGgKICAgICAgaWYgKGlvVXRpbHMuaWUgPT09IDYpIHsKICAgICAgICBzZXRUaW1lb3V0KGdvLCAwKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBjYW4gbm90IHNldFRpbWVvdXQgb3IgZWxzZSBjaHJvbWUgd2lsbCBzdWJtaXQgdG8gdG9wIHdpbmRvdwogICAgICAgIGdvKCk7CiAgICAgIH0KICAgIH0sCiAgICBhYm9ydDogZnVuY3Rpb24gKCkgewogICAgICB0aGlzLl9jYWxsYmFjayh7IHR5cGU6ICdhYm9ydCcgfSk7CiAgICB9CiAgfSk7CiAgSU8uc2V0dXBUcmFuc3BvcnQoJ2lmcmFtZScsIElmcmFtZVRyYW5zcG9ydCk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKaW9FeHRyYUxpYkV4dHJhID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgSU8gPSBpb0Jhc2U7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICBpb0V4dHJhTGliRXh0cmFJZnJhbWVUcmFuc3BvcnQ7CiAgdXRpbC5taXgoSU8sIHsKICAgIHVwbG9hZDogZnVuY3Rpb24gKHVybCwgZm9ybSwgZGF0YSwgY2FsbGJhY2ssIGRhdGFUeXBlKSB7CiAgICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGRhdGFUeXBlID0gY2FsbGJhY2s7CiAgICAgICAgY2FsbGJhY2sgPSBkYXRhOwogICAgICAgIGRhdGEgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgcmV0dXJuIElPKHsKICAgICAgICB1cmw6IHVybCwKICAgICAgICB0eXBlOiAncG9zdCcsCiAgICAgICAgZGF0YVR5cGU6IGRhdGFUeXBlLAogICAgICAgIGZvcm06IGZvcm0sCiAgICAgICAgZGF0YTogZGF0YSwKICAgICAgICBjb21wbGV0ZTogY2FsbGJhY2sKICAgICAgfSk7CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IElPOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmlvRXh0cmFJbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZXhwb3J0cyA9IGlvRXh0cmFMaWJFeHRyYTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gaW9FeHRyYUluZGV4Owp9KTtkZWZpbmUoImlvLWJhc2UiLCBbJ3V0aWwnLCJxdWVyeXN0cmluZyIsInByb21pc2UiLCJ1cmwiLCdkb20nLCJpby1zY3JpcHQiXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7CnZhciBfcXVlcnlzdHJpbmdfID0gcmVxdWlyZSgicXVlcnlzdHJpbmciKTsKdmFyIHByb21pc2UgPSByZXF1aXJlKCJwcm9taXNlIik7CnZhciBfdXJsXyA9IHJlcXVpcmUoInVybCIpOwp2YXIgZG9tQmFzZSA9IHJlcXVpcmUoJ2RvbScpOwp2YXIgaW9TY3JpcHQgPSByZXF1aXJlKCJpby1zY3JpcHQiKTsKLy8hIENvcHlyaWdodCAyMDE1LCBpby1iYXNlQDYuMS40IE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAxMjoxMTo0NyBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmlvLWJhc2UKaW8tYmFzZS9saWIvbWFpbgppby1iYXNlL2xpYi9tYWluL2lvCmlvLWJhc2UvbGliL21haW4vYmFzZQppby1iYXNlL2xpYi9tYWluL3V0aWxzCmlvLWJhc2UvbGliL21haW4veGhyLXRyYW5zcG9ydAppby1iYXNlL2xpYi9tYWluL3hoci10cmFuc3BvcnQtYmFzZQppby1iYXNlL2xpYi9tYWluL3N1Yi1kb21haW4tdHJhbnNwb3J0CmlvLWJhc2UvbGliL21haW4vc2NyaXB0LXRyYW5zcG9ydAppby1iYXNlL2xpYi9tYWluL2pzb25wCmlvLWJhc2UvbGliL21haW4vbWV0aG9kcwoqLwp2YXIgaW9CYXNlTGliTWFpbkJhc2UsIGlvQmFzZUxpYk1haW5VdGlscywgaW9CYXNlTGliTWFpblhoclRyYW5zcG9ydEJhc2UsIGlvQmFzZUxpYk1haW5TdWJEb21haW5UcmFuc3BvcnQsIGlvQmFzZUxpYk1haW5TY3JpcHRUcmFuc3BvcnQsIGlvQmFzZUxpYk1haW5Kc29ucCwgaW9CYXNlTGliTWFpbk1ldGhvZHMsIGlvQmFzZUxpYk1haW5JbywgaW9CYXNlTGliTWFpblhoclRyYW5zcG9ydCwgaW9CYXNlTGliTWFpbiwgaW9CYXNlSW5kZXg7CmlvQmFzZUxpYk1haW5CYXNlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlCiAgICogYSBzY2FsYWJsZSBjbGllbnQgaW8gZnJhbWV3b3JrCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBxdWVyeXN0cmluZyA9IF9xdWVyeXN0cmluZ187CiAgdmFyIFhQcm9taXNlID0gcHJvbWlzZTsKICB2YXIgdXJsID0gX3VybF87CiAgdmFyIHJsb2NhbFByb3RvY29sID0gL14oPzphYm91dHxhcHB8YXBwXC1zdG9yYWdlfC4rXC1leHRlbnNpb258ZmlsZXx3aWRnZXQpOiQvLCByc3BhY2UgPSAvXHMrLywgbWlycm9yID0gZnVuY3Rpb24gKHMpIHsKICAgICAgcmV0dXJuIHM7CiAgICB9LCBybm9Db250ZW50ID0gL14oPzpHRVR8SEVBRCkkLywgbG9jYXRpb25IcmVmID0gbG9jYXRpb24uaHJlZiwgbG9jYXRpb25VcmwgPSB1cmwucGFyc2UobG9jYXRpb25IcmVmKSwgaXNMb2NhbCA9IHJsb2NhbFByb3RvY29sLnRlc3QobG9jYXRpb25VcmwucHJvdG9jb2wpLCB0cmFuc3BvcnRzID0ge30sIGRlZmF1bHRDb25maWcgPSB7CiAgICAgIHR5cGU6ICdHRVQnLAogICAgICBjb250ZW50VHlwZTogJ2FwcGxpY2F0aW9uL3gtd3d3LWZvcm0tdXJsZW5jb2RlZDsgY2hhcnNldD1VVEYtOCcsCiAgICAgIGFzeW5jOiB0cnVlLAogICAgICBzZXJpYWxpemVBcnJheTogdHJ1ZSwKICAgICAgcHJvY2Vzc0RhdGE6IHRydWUsCiAgICAgIGFjY2VwdHM6IHsKICAgICAgICB4bWw6ICdhcHBsaWNhdGlvbi94bWwsIHRleHQveG1sJywKICAgICAgICBodG1sOiAndGV4dC9odG1sJywKICAgICAgICB0ZXh0OiAndGV4dC9wbGFpbicsCiAgICAgICAganNvbjogJ2FwcGxpY2F0aW9uL2pzb24sIHRleHQvamF2YXNjcmlwdCcsCiAgICAgICAgJyonOiAnKi8qJwogICAgICB9LAogICAgICBjb252ZXJ0ZXJzOiB7CiAgICAgICAgdGV4dDogewogICAgICAgICAganNvbjogdXRpbC5wYXJzZUpzb24sCiAgICAgICAgICBodG1sOiBtaXJyb3IsCiAgICAgICAgICB0ZXh0OiBtaXJyb3IsCiAgICAgICAgICB4bWw6IHV0aWwucGFyc2VYTUwgfHwgbWlycm9yCiAgICAgICAgfQogICAgICB9LAogICAgICBoZWFkZXJzOiB7ICdYLVJlcXVlc3RlZC1XaXRoJzogJ1hNTEh0dHBSZXF1ZXN0JyB9LAogICAgICBjb250ZW50czogewogICAgICAgIHhtbDogL3htbC8sCiAgICAgICAgaHRtbDogL2h0bWwvLAogICAgICAgIGpzb246IC9qc29uLwogICAgICB9CiAgICB9OwogIGRlZmF1bHRDb25maWcuY29udmVydGVycy5odG1sID0gZGVmYXVsdENvbmZpZy5jb252ZXJ0ZXJzLnRleHQ7CiAgZnVuY3Rpb24gc2V0VXBDb25maWcoYykgewogICAgLy8gZGVlcCBtaXgsZXhjbHVkZSBjb250ZXh0IQogICAgdmFyIGNvbnRleHQgPSBjLmNvbnRleHQ7CiAgICBkZWxldGUgYy5jb250ZXh0OwogICAgYyA9IHV0aWwubWl4KHV0aWwuY2xvbmUoZGVmYXVsdENvbmZpZyksIGMsIHsgZGVlcDogdHJ1ZSB9KTsKICAgIGMuY29udGV4dCA9IGNvbnRleHQgfHwgYzsKICAgIHZhciBkYXRhLCB1cmksIHR5cGUgPSBjLnR5cGUsIGRhdGFUeXBlID0gYy5kYXRhVHlwZTsKICAgIHVyaSA9IGMudXJpID0gdXJsLnBhcnNlKHVybC5yZXNvbHZlKGxvY2F0aW9uSHJlZiwgYy51cmwpLCB0cnVlKTsKICAgIC8vIHNlZSBtZXRob2QgX2dldFVybEZvclNlbmQKICAgIHVyaS5xdWVyeSA9IHt9OwogICAgaWYgKCEoJ2Nyb3NzRG9tYWluJyBpbiBjKSkgewogICAgICBjLmNyb3NzRG9tYWluID0gISh1cmkucHJvdG9jb2wgPT09IGxvY2F0aW9uVXJsLnByb3RvY29sICYmIHVyaS5ob3N0ID09PSBsb2NhdGlvblVybC5ob3N0KTsKICAgIH0KICAgIHR5cGUgPSBjLnR5cGUgPSB0eXBlLnRvVXBwZXJDYXNlKCk7CiAgICBjLmhhc0NvbnRlbnQgPSAhcm5vQ29udGVudC50ZXN0KHR5cGUpOwogICAgaWYgKGMucHJvY2Vzc0RhdGEgJiYgKGRhdGEgPSBjLmRhdGEpICYmIHR5cGVvZiBkYXRhICE9PSAnc3RyaW5nJykgewogICAgICAvLyBub3JtYWxpemUgdG8gc3RyaW5nCiAgICAgIGMuZGF0YSA9IHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShkYXRhLCB1bmRlZmluZWQsIHVuZGVmaW5lZCwgYy5zZXJpYWxpemVBcnJheSk7CiAgICB9CiAgICAvLyDmlbDmja7nsbvlnovlpITnkIbpk77vvIzkuIDmraXmraXlsIbliY3pnaLnmoTmlbDmja7nsbvlnovovazljJbmiJDmnIDlkI7kuIDkuKoKICAgIGRhdGFUeXBlID0gYy5kYXRhVHlwZSA9IHV0aWwudHJpbShkYXRhVHlwZSB8fCAnKicpLnNwbGl0KHJzcGFjZSk7CiAgICBpZiAoISgnY2FjaGUnIGluIGMpICYmIHV0aWwuaW5BcnJheShkYXRhVHlwZVswXSwgWwogICAgICAgICdzY3JpcHQnLAogICAgICAgICdqc29ucCcKICAgICAgXSkpIHsKICAgICAgYy5jYWNoZSA9IGZhbHNlOwogICAgfQogICAgaWYgKCFjLmhhc0NvbnRlbnQpIHsKICAgICAgaWYgKGMuZGF0YSkgewogICAgICAgIHV0aWwubWl4KHVyaS5xdWVyeSwgcXVlcnlzdHJpbmcucGFyc2UoYy5kYXRhKSk7CiAgICAgIH0KICAgICAgaWYgKGMuY2FjaGUgPT09IGZhbHNlKSB7CiAgICAgICAgdXJpLnF1ZXJ5Ll9rc1RTID0gdXRpbC5ub3coKSArICdfJyArIHV0aWwuZ3VpZCgpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gYzsKICB9CiAgLyoqCiAgICogUmV0dXJuIGEgaW8gb2JqZWN0IGFuZCBzZW5kIHJlcXVlc3QgYnkgY29uZmlnLgogICAqCiAgICogQGNsYXNzIElPCiAgICogQGV4dGVuZHMgUHJvbWlzZQogICAqCiAgICogQGNmZyB7U3RyaW5nfSB1cmwKICAgKiByZXF1ZXN0IGRlc3RpbmF0aW9uCiAgICoKICAgKiBAY2ZnIHtTdHJpbmd9IHR5cGUgcmVxdWVzdCB0eXBlLgogICAqIGVnOiAnZ2V0JywncG9zdCcKICAgKiBEZWZhdWx0IHRvOiAnZ2V0JwogICAqCiAgICogQGNmZyB7U3RyaW5nfSBjb250ZW50VHlwZQogICAqIERlZmF1bHQgdG86ICdhcHBsaWNhdGlvbi94LXd3dy1mb3JtLXVybGVuY29kZWQ7IGNoYXJzZXQ9VVRGLTgnCiAgICogRGF0YSB3aWxsIGFsd2F5cyBiZSB0cmFuc21pdHRlZCB0byB0aGUgc2VydmVyIHVzaW5nIFVURi04IGNoYXJzZXQKICAgKgogICAqIEBjZmcge09iamVjdH0gYWNjZXB0cwogICAqIERlZmF1bHQgdG86IGRlcGVuZHMgb24gRGF0YVR5cGUuCiAgICogVGhlIGNvbnRlbnQgdHlwZSBzZW50IGluIHJlcXVlc3QgaGVhZGVyIHRoYXQgdGVsbHMgdGhlIHNlcnZlcgogICAqIHdoYXQga2luZCBvZiByZXNwb25zZSBpdCB3aWxsIGFjY2VwdCBpbiByZXR1cm4uCiAgICogSXQgaXMgcmVjb21tZW5kZWQgdG8gZG8gc28gb25jZSBpbiB0aGUge0BsaW5rIElPI21ldGhvZC1zZXR1cENvbmZpZ30KICAgKgogICAqIEBjZmcge0Jvb2xlYW59IGFzeW5jCiAgICogRGVmYXVsdCB0bzogdHJ1ZQogICAqIHdoZXRoZXIgcmVxdWVzdCBpcyBzZW50IGFzeW5jaHJvbm91c2x5CiAgICoKICAgKiBAY2ZnIHtCb29sZWFufSBjYWNoZQogICAqIERlZmF1bHQgdG86IHRydWUgLGZhbHNlIGZvciBkYXRhVHlwZSAnc2NyaXB0JyBhbmQgJ2pzb25wJwogICAqIGlmIHNldCBmYWxzZSx3aWxsIGFwcGVuZCBfa3NUcz1EYXRlLm5vdygpIHRvIHVybCBhdXRvbWF0aWNhbGx5CiAgICoKICAgKiBAY2ZnIHtPYmplY3R9IGNvbnRlbnRzCiAgICogYSBuYW1lLXJlZ2V4cCBtYXAgdG8gZGV0ZXJtaW5lIHJlcXVlc3QgZGF0YSdzIGRhdGFUeXBlCiAgICogSXQgaXMgcmVjb21tZW5kZWQgdG8gZG8gc28gb25jZSBpbiB0aGUge0BsaW5rIElPI21ldGhvZC1zZXR1cENvbmZpZ30KICAgKgogICAqIEBjZmcge09iamVjdH0gY29udGV4dAogICAqIHNwZWNpZnkgdGhlIGNvbnRleHQgb2YgdGhpcyByZXF1ZXN0ICdzIGNhbGxiYWNrIChzdWNjZXNzLGVycm9yLGNvbXBsZXRlKQogICAqCiAgICogQGNmZyB7T2JqZWN0fSBjb252ZXJ0ZXJzCiAgICogRGVmYXVsdCB0bzoge3RleHQ6e2pzb246SnNvbi5wYXJzZSxodG1sOm1pcnJvcix0ZXh0Om1pcnJvcix4bWw6cGFyc2VYTUx9fQogICAqIHNwZWNpZmllZCBob3cgdG8gdHJhbnNmb3JtIG9uZSBkYXRhVHlwZSB0byBhbm90aGVyIGRhdGFUeXBlCiAgICogSXQgaXMgcmVjb21tZW5kZWQgdG8gZG8gc28gb25jZSBpbiB0aGUge0BsaW5rIElPI21ldGhvZC1zZXR1cENvbmZpZ30KICAgKgogICAqIEBjZmcge0Jvb2xlYW59IGNyb3NzRG9tYWluCiAgICogRGVmYXVsdCB0bzogZmFsc2UgZm9yIHNhbWUtZG9tYWluIHJlcXVlc3QsdHJ1ZSBmb3IgY3Jvc3MtZG9tYWluIHJlcXVlc3QKICAgKiBpZiBzZXJ2ZXItc2lkZSBqc29ucCByZWRpcmVjdCB0byBhbm90aGVyIGRvbWFpbiwgeW91IHNob3VsZCBzZXQgdGhpcyB0byB0cnVlLgogICAqIGlmIHlvdSB3YW50IHVzZSBzY3JpcHQgZm9yIGpzb25wIGZvciBzYW1lIGRvbWFpbiByZXF1ZXN0LCB5b3Ugc2hvdWxkIHNldCB0aGlzIHRvIHRydWUuCiAgICoKICAgKiBAY2ZnIHtPYmplY3R9IGRhdGEKICAgKiBEYXRhIHNlbnQgdG8gc2VydmVyLmlmIHByb2Nlc3NEYXRhIGlzIHRydWUsZGF0YSB3aWxsIGJlIHNlcmlhbGl6ZWQgdG8gU3RyaW5nIHR5cGUuCiAgICogaWYgdmFsdWUgaXMgYW4gQXJyYXksIHNlcmlhbGl6YXRpb24gd2lsbCBiZSBiYXNlZCBvbiBzZXJpYWxpemVBcnJheS4KICAgKgogICAqIEBjZmcge1N0cmluZ30gZGF0YVR5cGUKICAgKiByZXR1cm4gZGF0YSBhcyBhIHNwZWNpZmllZCB0eXBlCiAgICogRGVmYXVsdCB0bzogQmFzZWQgb24gc2VydmVyIGNvbnRlbnRUeXBlIGhlYWRlcgogICAqICd4bWwnIDogYSBYTUwgZG9jdW1lbnQKICAgKiAndGV4dCcvJ2h0bWwnOiByYXcgc2VydmVyIGRhdGEKICAgKiAnc2NyaXB0JzogZXZhbHVhdGUgdGhlIHJldHVybiBkYXRhIGFzIHNjcmlwdAogICAqICdqc29uJzogcGFyc2UgdGhlIHJldHVybiBkYXRhIGFzIGpzb24gYW5kIHJldHVybiB0aGUgcmVzdWx0IGFzIGZpbmFsIGRhdGEKICAgKiAnanNvbnAnOiBsb2FkIGpzb24gZGF0YSB2aWEganNvbnAKICAgKgogICAqIEBjZmcge09iamVjdH0gaGVhZGVycwogICAqIGFkZGl0aW9uYWwgbmFtZS12YWx1ZSBoZWFkZXIgdG8gc2VuZCBhbG9uZyB3aXRoIHRoaXMgcmVxdWVzdC4KICAgKgogICAqIEBjZmcge1N0cmluZ30ganNvbnAKICAgKiBEZWZhdWx0IHRvOiAnY2FsbGJhY2snCiAgICogT3ZlcnJpZGUgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIG5hbWUgaW4gYSBqc29ucCByZXF1ZXN0LiBlZzoKICAgKiBzZXQgJ2NhbGxiYWNrMicgLCB0aGVuIGpzb25wIHVybCB3aWxsIGFwcGVuZCAgJ2NhbGxiYWNrMj0/Jy4KICAgKgogICAqIEBjZmcge1N0cmluZ30ganNvbnBDYWxsYmFjawogICAqIFNwZWNpZnkgdGhlIGNhbGxiYWNrIGZ1bmN0aW9uIG5hbWUgZm9yIGEganNvbnAgcmVxdWVzdC4KICAgKiBzZXQgdGhpcyB2YWx1ZSB3aWxsIHJlcGxhY2UgdGhlIGF1dG8gZ2VuZXJhdGVkIGZ1bmN0aW9uIG5hbWUuCiAgICogZWc6CiAgICogc2V0ICdjdXN0b21DYWxsJyAsIHRoZW4ganNvbnAgdXJsIHdpbGwgYXBwZW5kICdjYWxsYmFjaz1jdXN0b21DYWxsJwogICAqCiAgICogQGNmZyB7U3RyaW5nfSBtaW1lVHlwZQogICAqIG92ZXJyaWRlIHhociAncyBtaW1lIHR5cGUKICAgKgogICAqIEBjZmcge1N0cmluZ30gaWZNb2RpZmllZAogICAqIHdoZXRoZXIgZW50ZXIgaWYgbW9kaWZpZWQgbW9kZS4KICAgKiBEZWZhdWx0cyB0byBmYWxzZS4KICAgKgogICAqIEBjZmcge0Jvb2xlYW59IHByb2Nlc3NEYXRhCiAgICogRGVmYXVsdCB0bzogdHJ1ZQogICAqIHdoZXRoZXIgZGF0YSB3aWxsIGJlIHNlcmlhbGl6ZWQgYXMgU3RyaW5nCiAgICoKICAgKiBAY2ZnIHtTdHJpbmd9IHNjcmlwdENoYXJzZXQKICAgKiBvbmx5IGZvciBkYXRhVHlwZSAnanNvbnAnIGFuZCAnc2NyaXB0JyBhbmQgJ2dldCcgdHlwZS4KICAgKiBmb3JjZSB0aGUgc2NyaXB0IHRvIGNlcnRhaW4gY2hhcnNldC4KICAgKgogICAqIEBjZmcge0Z1bmN0aW9ufSBiZWZvcmVTZW5kCiAgICogYmVmb3JlU2VuZChpbyxjb25maWcpCiAgICogY2FsbGJhY2sgZnVuY3Rpb24gY2FsbGVkIGJlZm9yZSB0aGUgcmVxdWVzdCBpcyBzZW50LnRoaXMgZnVuY3Rpb24gaGFzIDIgYXJndW1lbnRzCiAgICoKICAgKiAxLiBjdXJyZW50IEtJU1NZIGlvIG9iamVjdAogICAqCiAgICogMi4gY3VycmVudCBpbyBjb25maWcKICAgKgogICAqIG5vdGU6IGNhbiBiZSB1c2VkIGZvciBhZGQgcHJvZ3Jlc3MgZXZlbnQgbGlzdGVuZXIgZm9yIG5hdGl2ZSB4aHIncyB1cGxvYWQgYXR0cmlidXRlCiAgICogc2VlIDxhIGhyZWY9J2h0dHA6Ly93d3cudzMub3JnL1RSL1hNTEh0dHBSZXF1ZXN0LyNldmVudC14aHItcHJvZ3Jlc3MnPlhNTEh0dHBSZXF1ZXN0MjwvYT4KICAgKgogICAqIEBjZmcge0Z1bmN0aW9ufSBzdWNjZXNzCiAgICogc3VjY2VzcyhkYXRhLHRleHRTdGF0dXMseGhyKQogICAqIGNhbGxiYWNrIGZ1bmN0aW9uIGNhbGxlZCBpZiB0aGUgcmVxdWVzdCBzdWNjZWVkcy50aGlzIGZ1bmN0aW9uIGhhcyAzIGFyZ3VtZW50cwogICAqCiAgICogMS4gZGF0YSByZXR1cm5lZCBmcm9tIHRoaXMgcmVxdWVzdCB3aXRoIHR5cGUgc3BlY2lmaWVkIGJ5IGRhdGFUeXBlCiAgICoKICAgKiAyLiBzdGF0dXMgb2YgdGhpcyByZXF1ZXN0IHdpdGggdHlwZSBTdHJpbmcKICAgKgogICAqIDMuIGlvIG9iamVjdCBvZiB0aGlzIHJlcXVlc3QgLCBmb3IgZGV0YWlscyB7QGxpbmsgSU99CiAgICoKICAgKiBAY2ZnIHtGdW5jdGlvbn0gZXJyb3IKICAgKiBzdWNjZXNzKGRhdGEsdGV4dFN0YXR1cyx4aHIpCiAgICogY2FsbGJhY2sgZnVuY3Rpb24gY2FsbGVkIGlmIHRoZSByZXF1ZXN0IG9jY3VycyBlcnJvci50aGlzIGZ1bmN0aW9uIGhhcyAzIGFyZ3VtZW50cwogICAqCiAgICogMS4gbnVsbCB2YWx1ZQogICAqCiAgICogMi4gc3RhdHVzIG9mIHRoaXMgcmVxdWVzdCB3aXRoIHR5cGUgU3RyaW5nLHN1Y2ggYXMgJ3RpbWVvdXQnLCdOb3QgRm91bmQnLCdwYXJzZXJlcnJvcjouLi4nCiAgICoKICAgKiAzLiBpbyBvYmplY3Qgb2YgdGhpcyByZXF1ZXN0ICwgZm9yIGRldGFpbHMge0BsaW5rIElPfQogICAqCiAgICogQGNmZyB7RnVuY3Rpb259IGNvbXBsZXRlCiAgICogc3VjY2VzcyhkYXRhLHRleHRTdGF0dXMseGhyKQogICAqIGNhbGxiYWNrIGZ1bmN0aW9uIGNhbGxlZCBpZiB0aGUgcmVxdWVzdCBmaW5pc2hlZChzdWNjZXNzIG9yIGVycm9yKS50aGlzIGZ1bmN0aW9uIGhhcyAzIGFyZ3VtZW50cwogICAqCiAgICogMS4gbnVsbCB2YWx1ZSBpZiBlcnJvciBvY2N1cnMgb3IgZGF0YSByZXR1cm5lZCBmcm9tIHNlcnZlcgogICAqCiAgICogMi4gc3RhdHVzIG9mIHRoaXMgcmVxdWVzdCB3aXRoIHR5cGUgU3RyaW5nLHN1Y2ggYXMgc3VjY2Vzczonb2snLAogICAqIGVycm9yOid0aW1lb3V0JywnTm90IEZvdW5kJywncGFyc2VyZXJyb3I6Li4uJwogICAqCiAgICogMy4gaW8gb2JqZWN0IG9mIHRoaXMgcmVxdWVzdCAsIGZvciBkZXRhaWxzIHtAbGluayBJT30KICAgKgogICAqIEBjZmcge051bWJlcn0gdGltZW91dAogICAqIFNldCBhIHRpbWVvdXQoaW4gc2Vjb25kcykgZm9yIHRoaXMgcmVxdWVzdC5pZiB3aWxsIGNhbGwgZXJyb3Igd2hlbiB0aW1lb3V0CiAgICoKICAgKiBAY2ZnIHtCb29sZWFufSBzZXJpYWxpemVBcnJheQogICAqIHdoZXRoZXIgYWRkIFtdIHRvIGRhdGEncyBuYW1lIHdoZW4gZGF0YSdzIHZhbHVlIGlzIGFycmF5IGluIHNlcmlhbGl6YXRpb24KICAgKgogICAqIEBjZmcge09iamVjdH0geGhyRmllbGRzCiAgICogbmFtZS12YWx1ZSB0byBzZXQgdG8gbmF0aXZlIHhoci5zZXQgYXMgeGhyRmllbGRzOnt3aXRoQ3JlZGVudGlhbHM6dHJ1ZX0KICAgKiBub3RlOiB3aXRoQ3JlZGVudGlhbHMgZGVmYXVsdHMgdG8gdHJ1ZS4KICAgKgogICAqIEBjZmcge1N0cmluZ30gdXNlcm5hbWUKICAgKiBhIHVzZXJuYW1lIHRvYmUgdXNlZCBpbiByZXNwb25zZSB0byBIVFRQIGFjY2VzcyBhdXRoZW50aWNhdGlvbiByZXF1ZXN0CiAgICoKICAgKiBAY2ZnIHtTdHJpbmd9IHBhc3N3b3JkCiAgICogYSBwYXNzd29yZCB0b2JlIHVzZWQgaW4gcmVzcG9uc2UgdG8gSFRUUCBhY2Nlc3MgYXV0aGVudGljYXRpb24gcmVxdWVzdAogICAqCiAgICogQGNmZyB7T2JqZWN0fSB4ZHIKICAgKiBjcm9zcyBkb21haW4gcmVxdWVzdCBjb25maWcgb2JqZWN0LCBjb250YWlucyBzdWIgY29uZmlnOgogICAqCiAgICogeGRyLnNyYwogICAqIERlZmF1bHQgdG86IEtJU1NZICdzIGZsYXNoIHVybAogICAqIGZsYXNoIHNlbmRlciB1cmwKICAgKgogICAqIHhkci51c2UKICAgKiBpZiBzZXQgdG8gJ3VzZScsIGl0IHdpbGwgYWx3YXlzIHVzZSBmbGFzaCBmb3IgY3Jvc3MgZG9tYWluIHJlcXVlc3QgZXZlbiBpbiBjaHJvbWUvZmlyZWZveAogICAqCiAgICogeGRyLnN1YkRvbWFpbgogICAqIGNyb3NzIHN1YiBkb21haW4gcmVxdWVzdCBjb25maWcgb2JqZWN0CiAgICoKICAgKiB4ZHIuc3ViRG9tYWluLnByb3h5CiAgICogcHJveHkgcGFnZSwgZWc6CiAgICogYS50LmNuL2EuaHRtIHNlbmQgcmVxdWVzdCB0byBiLnQuY24vYi5odG06CiAgICoKICAgKiAxLiBhLmh0bSBzZXQgPGNvZGU+IGRvY3VtZW50LmRvbWFpbj0ndC5jbicgPC9jb2RlPgogICAqCiAgICogMi4gYi50LmNuL3Byb3h5Lmh0bSAncyBjb250ZW50IGlzIDxjb2RlPiAmbHQ7c2NyaXB0PmRvY3VtZW50LmRvbWFpbj0ndC5jbicmbHQ7L3NjcmlwdD4gPC9jb2RlPgogICAqCiAgICogMy4gaW4gYS5odG0gLCBjYWxsIDxjb2RlPiBJTyh7eGRyOntzdWJEb21haW46e3Byb3h5OicvcHJveHkuaHRtJ319fSkgPC9jb2RlPgogICAqCiAgICovCiAgZnVuY3Rpb24gSU8oYykgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgaWYgKCEoc2VsZiBpbnN0YW5jZW9mIElPKSkgewogICAgICByZXR1cm4gbmV3IElPKGMpOwogICAgfQogICAgLy8gUHJvbWlzZS5jYWxsKHNlbGYpOwogICAgSU8uc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5jYWxsKHNlbGYpOwogICAgWFByb21pc2UuRGVmZXIoc2VsZik7CiAgICBzZWxmLnVzZXJDb25maWcgPSBjOwogICAgYyA9IHNldFVwQ29uZmlnKGMpOwogICAgdXRpbC5taXgoc2VsZiwgewogICAgICAvLyDnu5PmnoTljJbmlbDmja7vvIzlpoIganNvbgogICAgICByZXNwb25zZURhdGE6IG51bGwsCiAgICAgIC8qKgogICAgICAgKiBjb25maWcgb2YgY3VycmVudCBJTyBpbnN0YW5jZS4KICAgICAgICogQG1lbWJlciBJTwogICAgICAgKiBAcHJvcGVydHkgY29uZmlnCiAgICAgICAqIEB0eXBlIE9iamVjdAogICAgICAgKi8KICAgICAgY29uZmlnOiBjIHx8IHt9LAogICAgICB0aW1lb3V0VGltZXI6IG51bGwsCiAgICAgIC8qKgogICAgICAgKiBTdHJpbmcgdHlwZWQgZGF0YSByZXR1cm5lZCBmcm9tIHNlcnZlcgogICAgICAgKiBAdHlwZSBTdHJpbmcKICAgICAgICovCiAgICAgIHJlc3BvbnNlVGV4dDogbnVsbCwKICAgICAgLyoqCiAgICAgICAqIHhtbCB0eXBlZCBkYXRhIHJldHVybmVkIGZyb20gc2VydmVyCiAgICAgICAqIEB0eXBlIFN0cmluZwogICAgICAgKi8KICAgICAgcmVzcG9uc2VYTUw6IG51bGwsCiAgICAgIHJlc3BvbnNlSGVhZGVyc1N0cmluZzogJycsCiAgICAgIHJlc3BvbnNlSGVhZGVyczogbnVsbCwKICAgICAgcmVxdWVzdEhlYWRlcnM6IHt9LAogICAgICAvKioKICAgICAgICogcmVhZHlTdGF0ZSBvZiBjdXJyZW50IHJlcXVlc3QKICAgICAgICogMDogaW5pdGlhbGl6ZWQKICAgICAgICogMTogc2VuZAogICAgICAgKiA0OiBjb21wbGV0ZWQKICAgICAgICogQHR5cGUgTnVtYmVyCiAgICAgICAqLwogICAgICByZWFkeVN0YXRlOiAwLAogICAgICBzdGF0ZTogMCwKICAgICAgLyoqCiAgICAgICAqIEhUVFAgc3RhdHVzVGV4dCBvZiBjdXJyZW50IHJlcXVlc3QKICAgICAgICogQHR5cGUgU3RyaW5nCiAgICAgICAqLwogICAgICBzdGF0dXNUZXh0OiBudWxsLAogICAgICAvKioKICAgICAgICogSFRUUCBTdGF0dXMgQ29kZSBvZiBjdXJyZW50IHJlcXVlc3QKICAgICAgICogZWc6CiAgICAgICAqIDIwMDogb2sKICAgICAgICogNDA0OiBOb3QgRm91bmQKICAgICAgICogNTAwOiBTZXJ2ZXIgRXJyb3IKICAgICAgICogQHR5cGUgU3RyaW5nCiAgICAgICAqLwogICAgICBzdGF0dXM6IDAsCiAgICAgIHRyYW5zcG9ydDogbnVsbAogICAgfSk7CiAgICB2YXIgVHJhbnNwb3J0Q29uc3RydWN0b3IsIHRyYW5zcG9ydDsKICAgIC8qKgogICAgICogZmlyZWQgYmVmb3JlIGdlbmVyYXRpbmcgcmVxdWVzdCBvYmplY3QKICAgICAqIEBldmVudCBzdGFydAogICAgICogQG1lbWJlciBJTwogICAgICogQHN0YXRpYwogICAgICogQHBhcmFtIHtJT30gZS5pbyBjdXJyZW50IGlvCiAgICAgKi8KICAgIElPLmNhbGxQcmVwcm9jZXNzb3JzKCdzdGFydCcsIHsgaW86IHNlbGYgfSk7CiAgICBJTy5maXJlKCdzdGFydCcsIHsgaW86IHNlbGYgfSk7CiAgICBUcmFuc3BvcnRDb25zdHJ1Y3RvciA9IHRyYW5zcG9ydHNbYy5kYXRhVHlwZVswXV0gfHwgdHJhbnNwb3J0c1snKiddOwogICAgdHJhbnNwb3J0ID0gbmV3IFRyYW5zcG9ydENvbnN0cnVjdG9yKHNlbGYpOwogICAgc2VsZi50cmFuc3BvcnQgPSB0cmFuc3BvcnQ7CiAgICBpZiAoYy5jb250ZW50VHlwZSkgewogICAgICBzZWxmLnNldFJlcXVlc3RIZWFkZXIoJ0NvbnRlbnQtVHlwZScsIGMuY29udGVudFR5cGUpOwogICAgfQogICAgdmFyIGRhdGFUeXBlID0gYy5kYXRhVHlwZVswXSwgaSwgdGltZW91dCA9IGMudGltZW91dCwgY29udGV4dCA9IGMuY29udGV4dCwgaGVhZGVycyA9IGMuaGVhZGVycywgYWNjZXB0cyA9IGMuYWNjZXB0czsKICAgIC8vIFNldCB0aGUgQWNjZXB0cyBoZWFkZXIgZm9yIHRoZSBzZXJ2ZXIsIGRlcGVuZGluZyBvbiB0aGUgZGF0YVR5cGUKICAgIHNlbGYuc2V0UmVxdWVzdEhlYWRlcignQWNjZXB0JywgZGF0YVR5cGUgJiYgYWNjZXB0c1tkYXRhVHlwZV0gPyBhY2NlcHRzW2RhdGFUeXBlXSArIChkYXRhVHlwZSA9PT0gJyonID8gJycgOiAnLCAqLyo7IHE9MC4wMScpIDogYWNjZXB0c1snKiddKTsKICAgIC8vIENoZWNrIGZvciBoZWFkZXJzIG9wdGlvbgogICAgZm9yIChpIGluIGhlYWRlcnMpIHsKICAgICAgc2VsZi5zZXRSZXF1ZXN0SGVhZGVyKGksIGhlYWRlcnNbaV0pOwogICAgfQogICAgLy8gYWxsb3cgc2V0dXAgbmF0aXZlIGxpc3RlbmVyCiAgICAvLyBzdWNoIGFzIHhoci51cGxvYWQuYWRkRXZlbnRMaXN0ZW5lcigncHJvZ3Jlc3MnLCBmdW5jdGlvbiAoZXYpIHt9KQogICAgaWYgKGMuYmVmb3JlU2VuZCAmJiBjLmJlZm9yZVNlbmQuY2FsbChjb250ZXh0LCBzZWxmLCBjKSA9PT0gZmFsc2UpIHsKICAgICAgcmV0dXJuIHNlbGY7CiAgICB9CiAgICBzZWxmLnJlYWR5U3RhdGUgPSAxOwogICAgLyoqCiAgICAgKiBmaXJlZCBiZWZvcmUgc2VuZGluZyByZXF1ZXN0CiAgICAgKiBAZXZlbnQgc2VuZAogICAgICogQG1lbWJlciBJTwogICAgICogQHN0YXRpYwogICAgICogQHBhcmFtIHtJT30gZS5pbyBjdXJyZW50IGlvCiAgICAgKi8KICAgIElPLmNhbGxQcmVwcm9jZXNzb3JzKCdzZW5kJywgeyBpbzogc2VsZiB9KTsKICAgIElPLmZpcmUoJ3NlbmQnLCB7IGlvOiBzZWxmIH0pOwogICAgLy8gVGltZW91dAogICAgaWYgKGMuYXN5bmMgJiYgdGltZW91dCA+IDApIHsKICAgICAgc2VsZi50aW1lb3V0VGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICBzZWxmLmFib3J0KCd0aW1lb3V0Jyk7CiAgICAgIH0sIHRpbWVvdXQgKiAxMDAwKTsKICAgIH0KICAgIHRyeSB7CiAgICAgIC8vIGZsYWcgYXMgc2VuZGluZwogICAgICBzZWxmLnN0YXRlID0gMTsKICAgICAgdHJhbnNwb3J0LnNlbmQoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgaWYgKCdAREVCVUdAJykgewogICAgICAgIGNvbnNvbGUuZXJyb3IoZS5zdGFjayB8fCBlKTsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfSwgMCk7CiAgICAgIH0KICAgICAgLy8gUHJvcGFnYXRlIGV4Y2VwdGlvbiBhcyBlcnJvciBpZiBub3QgZG9uZQogICAgICBpZiAoc2VsZi5zdGF0ZSA8IDIpIHsKICAgICAgICBzZWxmLl9pb1JlYWR5KDAgLSAxLCBlLm1lc3NhZ2UgfHwgJ3NlbmQgZXJyb3InKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHNlbGY7CiAgfQogIHZhciBwcmVwcm9jZXNzb3JzID0ge307CiAgdmFyIGV2ZW50cyA9IHt9OwogIHV0aWwubWl4KElPLCB7CiAgICBwcmVwcm9jZXNzb3JzOiBwcmVwcm9jZXNzb3JzLAogICAgZXZlbnRzOiBldmVudHMsCiAgICBhZGRQcmVwcm9jZXNzb3I6IGZ1bmN0aW9uICh0eXBlLCBjYWxsYmFjaykgewogICAgICB2YXIgY2FsbGJhY2tzID0gcHJlcHJvY2Vzc29yc1t0eXBlXSA9IHByZXByb2Nlc3NvcnNbdHlwZV0gfHwgW107CiAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTsKICAgICAgcmV0dXJuIElPOwogICAgfSwKICAgIGNhbGxQcmVwcm9jZXNzb3JzOiBmdW5jdGlvbiAodHlwZSwgaW5mbykgewogICAgICB2YXIgY2FsbGJhY2tzID0gKHByZXByb2Nlc3NvcnNbdHlwZV0gfHwgW10pLmNvbmNhdCgpOwogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGNhbGxiYWNrcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBjYWxsYmFja3NbaV0uY2FsbChJTywgaW5mbyk7CiAgICAgIH0KICAgIH0sCiAgICBvbjogZnVuY3Rpb24gKHR5cGUsIGNhbGxiYWNrKSB7CiAgICAgIHZhciBjYWxsYmFja3MgPSBldmVudHNbdHlwZV0gPSBldmVudHNbdHlwZV0gfHwgW107CiAgICAgIGNhbGxiYWNrcy5wdXNoKGNhbGxiYWNrKTsKICAgICAgcmV0dXJuIElPOwogICAgfSwKICAgIGRldGFjaDogZnVuY3Rpb24gKHR5cGUsIGNhbGxiYWNrKSB7CiAgICAgIGlmIChjYWxsYmFjaykgewogICAgICAgIHZhciBsaXN0ID0gZXZlbnRzW3R5cGVdOwogICAgICAgIGlmIChsaXN0KSB7CiAgICAgICAgICB2YXIgaW5kZXggPSB1dGlsLmluZGV4T2YoY2FsbGJhY2ssIGxpc3QpOwogICAgICAgICAgaWYgKGluZGV4ICE9PSAtMSkgewogICAgICAgICAgICBsaXN0LnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGV2ZW50c1t0eXBlXSA9IFtdOwogICAgICB9CiAgICB9LAogICAgZmlyZTogZnVuY3Rpb24gKHR5cGUsIGluZm8pIHsKICAgICAgdmFyIGNhbGxiYWNrcyA9IChldmVudHNbdHlwZV0gfHwgW10pLmNvbmNhdCgpOwogICAgICBpbmZvID0gaW5mbyB8fCB7fTsKICAgICAgaW5mby50eXBlID0gdHlwZTsKICAgICAgaW5mby50YXJnZXQgPSBpbmZvLmN1cnJlbnRUYXJnZXQgPSBJTzsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBjYWxsYmFja3MubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgY2FsbGJhY2tzW2ldLmNhbGwoSU8sIGluZm8pOwogICAgICB9CiAgICB9LAogICAgLyoqCiAgICAgKiB3aGV0aGVyIGN1cnJlbnQgYXBwbGljYXRpb24gaXMgYSBsb2NhbCBhcHBsaWNhdGlvbgogICAgICogKHByb3RvY29sIGlzIGZpbGU6Ly8sd2lkZ2V0Oi8vLGFib3V0Oi8vKQogICAgICogQHR5cGUge0Jvb2xlYW59CiAgICAgKiBAbWVtYmVyIElPCiAgICAgKiBAc3RhdGljCiAgICAgKi8KICAgIGlzTG9jYWw6IGlzTG9jYWwsCiAgICAvKioKICAgICAqIG5hbWUtdmFsdWUgb2JqZWN0IHRoYXQgc2V0IGRlZmF1bHQgY29uZmlnIHZhbHVlIGZvciBpbyBjbGFzcwogICAgICogQHBhcmFtIHtPYmplY3R9IHNldHRpbmcKICAgICAqIEBtZW1iZXIgSU8KICAgICAqIEBzdGF0aWMKICAgICAqLwogICAgc2V0dXBDb25maWc6IGZ1bmN0aW9uIChzZXR0aW5nKSB7CiAgICAgIHV0aWwubWl4KGRlZmF1bHRDb25maWcsIHNldHRpbmcsIHsgZGVlcDogdHJ1ZSB9KTsKICAgIH0sCiAgICAvKioKICAgICAqIEBwcml2YXRlCiAgICAgKiBAbWVtYmVyIElPCiAgICAgKiBAc3RhdGljCiAgICAgKi8KICAgIHNldHVwVHJhbnNwb3J0OiBmdW5jdGlvbiAobmFtZSwgZm4pIHsKICAgICAgdHJhbnNwb3J0c1tuYW1lXSA9IGZuOwogICAgfSwKICAgIC8qKgogICAgICogQHByaXZhdGUKICAgICAqIEBtZW1iZXIgSU8KICAgICAqIEBzdGF0aWMKICAgICAqLwogICAgZ2V0VHJhbnNwb3J0OiBmdW5jdGlvbiAobmFtZSkgewogICAgICByZXR1cm4gdHJhbnNwb3J0c1tuYW1lXTsKICAgIH0sCiAgICAvKioKICAgICAqIGdldCBkZWZhdWx0IGNvbmZpZyB2YWx1ZSBmb3IgaW8gcmVxdWVzdAogICAgICogQHJldHVybiB7T2JqZWN0fQogICAgICogQG1lbWJlciBJTwogICAgICogQHN0YXRpYwogICAgICovCiAgICBnZXRDb25maWc6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGRlZmF1bHRDb25maWc7CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IElPOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmlvQmFzZUxpYk1haW5VdGlscyA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZnVuY3Rpb24gYWRkRXZlbnQoZWwsIHR5cGUsIGNhbGxiYWNrKSB7CiAgICBpZiAoZWwuYWRkRXZlbnRMaXN0ZW5lcikgewogICAgICBlbC5hZGRFdmVudExpc3RlbmVyKHR5cGUsIGNhbGxiYWNrLCBmYWxzZSk7CiAgICB9IGVsc2UgaWYgKGVsLmF0dGFjaEV2ZW50KSB7CiAgICAgIGVsLmF0dGFjaEV2ZW50KCdvbicgKyB0eXBlLCBjYWxsYmFjayk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHJlbW92ZUV2ZW50KGVsLCB0eXBlLCBjYWxsYmFjaykgewogICAgaWYgKGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIpIHsKICAgICAgZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcih0eXBlLCBjYWxsYmFjaywgZmFsc2UpOwogICAgfSBlbHNlIGlmIChlbC5kZXRhY2hFdmVudCkgewogICAgICBlbC5kZXRhY2hFdmVudCgnb24nICsgdHlwZSwgY2FsbGJhY2spOwogICAgfQogIH0KICB2YXIgdXRpbHMgPSB7CiAgICBhZGRFdmVudDogYWRkRXZlbnQsCiAgICByZW1vdmVFdmVudDogcmVtb3ZlRXZlbnQKICB9OwogIGZ1bmN0aW9uIG51bWJlcmlmeShzKSB7CiAgICB2YXIgYyA9IDA7CiAgICByZXR1cm4gcGFyc2VGbG9hdChzLnJlcGxhY2UoL1wuL2csIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGMrKyA9PT0gMCA/ICcuJyA6ICcnOwogICAgfSkpOwogIH0KICB2YXIgbSwgdjsKICB2YXIgdWEgPSAod2luZG93Lm5hdmlnYXRvciB8fCB7fSkudXNlckFnZW50IHx8ICcnOwogIGlmICgobSA9IHVhLm1hdGNoKC9NU0lFIChbXjtdKil8VHJpZGVudC4qOyBydig/OlxzfDopPyhbMC05Ll0rKS8pKSAmJiAodiA9IG1bMV0gfHwgbVsyXSkpIHsKICAgIHV0aWxzLmllID0gbnVtYmVyaWZ5KHYpOwogICAgdXRpbHMuaWVNb2RlID0gZG9jdW1lbnQuZG9jdW1lbnRNb2RlIHx8IHV0aWxzLmllOwogIH0KICBleHBvcnRzID0gdXRpbHM7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKaW9CYXNlTGliTWFpblhoclRyYW5zcG9ydEJhc2UgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIHVybCA9IF91cmxfOwogIHZhciBxdWVyeXN0cmluZyA9IF9xdWVyeXN0cmluZ187CiAgdmFyIElPID0gaW9CYXNlTGliTWFpbkJhc2U7CiAgdmFyIGlvVXRpbCA9IGlvQmFzZUxpYk1haW5VdGlsczsKICB2YXIgT0tfQ09ERSA9IDIwMCwgc3VwcG9ydENPUlMsIHdpbiA9IHdpbmRvdywgWERvbWFpblJlcXVlc3RfID0gaW9VdGlsLmllTW9kZSA+IDcgJiYgd2luLlhEb21haW5SZXF1ZXN0LCBOT19DT05URU5UX0NPREUgPSAyMDQsIE5PVF9GT1VORF9DT0RFID0gNDA0LCBOT19DT05URU5UX0NPREUyID0gMTIyMywgWGhyVHJhbnNwb3J0QmFzZSA9IHsgcHJvdG86IHt9IH0sIGxhc3RNb2RpZmllZENhY2hlZCA9IHt9LCBlVGFnQ2FjaGVkID0ge307CiAgSU8uX19sYXN0TW9kaWZpZWRDYWNoZWQgPSBsYXN0TW9kaWZpZWRDYWNoZWQ7CiAgSU8uX19lVGFnQ2FjaGVkID0gZVRhZ0NhY2hlZDsKICBYaHJUcmFuc3BvcnRCYXNlLm5hdGl2ZVhociA9IHdpbi5BY3RpdmVYT2JqZWN0ID8gZnVuY3Rpb24gKGNyb3NzRG9tYWluLCByZWZXaW4pIHsKICAgIGlmICghc3VwcG9ydENPUlMgJiYgY3Jvc3NEb21haW4gJiYgWERvbWFpblJlcXVlc3RfKSB7CiAgICAgIHJldHVybiBuZXcgWERvbWFpblJlcXVlc3RfKCk7CiAgICB9CiAgICByZXR1cm4gIUlPLmlzTG9jYWwgJiYgY3JlYXRlU3RhbmRhcmRYSFIoY3Jvc3NEb21haW4sIHJlZldpbikgfHwgY3JlYXRlQWN0aXZlWEhSKGNyb3NzRG9tYWluLCByZWZXaW4pOwogIH0gOiBjcmVhdGVTdGFuZGFyZFhIUjsKICBzdXBwb3J0Q09SUyA9IFhoclRyYW5zcG9ydEJhc2Uuc3VwcG9ydENPUlMgPSAnd2l0aENyZWRlbnRpYWxzJyBpbiBYaHJUcmFuc3BvcnRCYXNlLm5hdGl2ZVhocigpOwogIGZ1bmN0aW9uIGNyZWF0ZVN0YW5kYXJkWEhSKF8sIHJlZldpbikgewogICAgdHJ5IHsKICAgICAgcmV0dXJuIG5ldyAocmVmV2luIHx8IHdpbikuWE1MSHR0cFJlcXVlc3QoKTsKICAgIH0gY2F0Y2ggKGUpIHsKICAgIH0KICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQogIGZ1bmN0aW9uIGNyZWF0ZUFjdGl2ZVhIUihfLCByZWZXaW4pIHsKICAgIHRyeSB7CiAgICAgIHJldHVybiBuZXcgKHJlZldpbiB8fCB3aW4pLkFjdGl2ZVhPYmplY3QoJ01pY3Jvc29mdC5YTUxIVFRQJyk7CiAgICB9IGNhdGNoIChlKSB7CiAgICB9CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KICBYaHJUcmFuc3BvcnRCYXNlLlhEb21haW5SZXF1ZXN0XyA9IFhEb21haW5SZXF1ZXN0XzsKICBmdW5jdGlvbiBpc0luc3RhbmNlT2ZYRG9tYWluUmVxdWVzdCh4aHIpIHsKICAgIHJldHVybiBYRG9tYWluUmVxdWVzdF8gJiYgeGhyIGluc3RhbmNlb2YgWERvbWFpblJlcXVlc3RfOwogIH0KICBmdW5jdGlvbiBnZXRJZk1vZGlmaWVkS2V5KGMpIHsKICAgIHZhciBpZk1vZGlmaWVkID0gYy5pZk1vZGlmaWVkLCBpZk1vZGlmaWVkS2V5OwogICAgaWYgKGlmTW9kaWZpZWQpIHsKICAgICAgaWZNb2RpZmllZEtleSA9IGMudXJpOwogICAgICBpZiAoYy5jYWNoZSA9PT0gZmFsc2UpIHsKICAgICAgICBpZk1vZGlmaWVkS2V5ID0gdXRpbC5jbG9uZShpZk1vZGlmaWVkS2V5KTsKICAgICAgICBkZWxldGUgaWZNb2RpZmllZEtleS5xdWVyeS5fa3NUUzsKICAgICAgfQogICAgICBpZk1vZGlmaWVkS2V5ID0gdXJsLnN0cmluZ2lmeShpZk1vZGlmaWVkS2V5KTsKICAgIH0KICAgIHJldHVybiBpZk1vZGlmaWVkS2V5OwogIH0KICB1dGlsLm1peChYaHJUcmFuc3BvcnRCYXNlLnByb3RvLCB7CiAgICBzZW5kSW50ZXJuYWw6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBpbyA9IHNlbGYuaW8sIGMgPSBpby5jb25maWcsIG5hdGl2ZVhociA9IHNlbGYubmF0aXZlWGhyLCBmaWxlcyA9IGMuZmlsZXMsIHR5cGUgPSBmaWxlcyA/ICdwb3N0JyA6IGMudHlwZSwgYXN5bmMgPSBjLmFzeW5jLCB1c2VybmFtZSwgbWltZVR5cGUgPSBpby5taW1lVHlwZSwgcmVxdWVzdEhlYWRlcnMgPSBpby5yZXF1ZXN0SGVhZGVycyB8fCB7fSwgdXJsID0gaW8uX2dldFVybEZvclNlbmQoKSwgeGhyRmllbGRzLCBpZk1vZGlmaWVkS2V5ID0gZ2V0SWZNb2RpZmllZEtleShjKSwgY2FjaGVWYWx1ZSwgaTsKICAgICAgaWYgKGlmTW9kaWZpZWRLZXkpIHsKICAgICAgICBpZiAoY2FjaGVWYWx1ZSA9IGxhc3RNb2RpZmllZENhY2hlZFtpZk1vZGlmaWVkS2V5XSkgewogICAgICAgICAgcmVxdWVzdEhlYWRlcnNbJ0lmLU1vZGlmaWVkLVNpbmNlJ10gPSBjYWNoZVZhbHVlOwogICAgICAgIH0KICAgICAgICBpZiAoY2FjaGVWYWx1ZSA9IGVUYWdDYWNoZWRbaWZNb2RpZmllZEtleV0pIHsKICAgICAgICAgIHJlcXVlc3RIZWFkZXJzWydJZi1Ob25lLU1hdGNoJ10gPSBjYWNoZVZhbHVlOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAodXNlcm5hbWUgPSBjLnVzZXJuYW1lKSB7CiAgICAgICAgbmF0aXZlWGhyLm9wZW4odHlwZSwgdXJsLCBhc3luYywgdXNlcm5hbWUsIGMucGFzc3dvcmQpOwogICAgICB9IGVsc2UgewogICAgICAgIG5hdGl2ZVhoci5vcGVuKHR5cGUsIHVybCwgYXN5bmMpOwogICAgICB9CiAgICAgIHhockZpZWxkcyA9IGMueGhyRmllbGRzIHx8IHt9OwogICAgICBpZiAoJ3dpdGhDcmVkZW50aWFscycgaW4geGhyRmllbGRzKSB7CiAgICAgICAgaWYgKCFzdXBwb3J0Q09SUykgewogICAgICAgICAgZGVsZXRlIHhockZpZWxkcy53aXRoQ3JlZGVudGlhbHM7CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoaSBpbiB4aHJGaWVsZHMpIHsKICAgICAgICB0cnkgewogICAgICAgICAgbmF0aXZlWGhyW2ldID0geGhyRmllbGRzW2ldOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKG1pbWVUeXBlICYmIG5hdGl2ZVhoci5vdmVycmlkZU1pbWVUeXBlKSB7CiAgICAgICAgbmF0aXZlWGhyLm92ZXJyaWRlTWltZVR5cGUobWltZVR5cGUpOwogICAgICB9CiAgICAgIHZhciB4UmVxdWVzdEhlYWRlciA9IHJlcXVlc3RIZWFkZXJzWydYLVJlcXVlc3RlZC1XaXRoJ107CiAgICAgIGlmICh4UmVxdWVzdEhlYWRlciA9PT0gZmFsc2UpIHsKICAgICAgICBkZWxldGUgcmVxdWVzdEhlYWRlcnNbJ1gtUmVxdWVzdGVkLVdpdGgnXTsKICAgICAgfQogICAgICBpZiAodHlwZW9mIG5hdGl2ZVhoci5zZXRSZXF1ZXN0SGVhZGVyICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIGZvciAoaSBpbiByZXF1ZXN0SGVhZGVycykgewogICAgICAgICAgbmF0aXZlWGhyLnNldFJlcXVlc3RIZWFkZXIoaSwgcmVxdWVzdEhlYWRlcnNbaV0pOwogICAgICAgIH0KICAgICAgfQogICAgICB2YXIgc2VuZENvbnRlbnQgPSBjLmhhc0NvbnRlbnQgJiYgYy5kYXRhIHx8IG51bGw7CiAgICAgIGlmIChmaWxlcykgewogICAgICAgIHZhciBvcmlnaW5hbFNlbnRDb250ZW50ID0gc2VuZENvbnRlbnQsIGRhdGEgPSB7fTsKICAgICAgICBpZiAob3JpZ2luYWxTZW50Q29udGVudCkgewogICAgICAgICAgZGF0YSA9IHF1ZXJ5c3RyaW5nLnBhcnNlKG9yaWdpbmFsU2VudENvbnRlbnQpOwogICAgICAgIH0KICAgICAgICBkYXRhID0gdXRpbC5taXgoZGF0YSwgZmlsZXMpOwogICAgICAgIHNlbmRDb250ZW50ID0gbmV3IEZvcm1EYXRhKCk7CiAgICAgICAgdXRpbC5lYWNoKGRhdGEsIGZ1bmN0aW9uICh2cywgaykgewogICAgICAgICAgaWYgKHV0aWwuaXNBcnJheSh2cykpIHsKICAgICAgICAgICAgdXRpbC5lYWNoKHZzLCBmdW5jdGlvbiAodikgewogICAgICAgICAgICAgIHNlbmRDb250ZW50LmFwcGVuZChrICsgKGMuc2VyaWFsaXplQXJyYXkgPyAnW10nIDogJycpLCB2KTsKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBzZW5kQ29udGVudC5hcHBlbmQoaywgdnMpOwogICAgICAgICAgfQogICAgICAgIH0pOwogICAgICB9CiAgICAgIG5hdGl2ZVhoci5zZW5kKHNlbmRDb250ZW50KTsKICAgICAgaWYgKCFhc3luYyB8fCBuYXRpdmVYaHIucmVhZHlTdGF0ZSA9PT0gNCkgewogICAgICAgIHNlbGYuX2NhbGxiYWNrKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGlzSW5zdGFuY2VPZlhEb21haW5SZXF1ZXN0KG5hdGl2ZVhocikpIHsKICAgICAgICAgIG5hdGl2ZVhoci5vbmxvYWQgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIG5hdGl2ZVhoci5yZWFkeVN0YXRlID0gNDsKICAgICAgICAgICAgbmF0aXZlWGhyLnN0YXR1cyA9IDIwMDsKICAgICAgICAgICAgc2VsZi5fY2FsbGJhY2soKTsKICAgICAgICAgIH07CiAgICAgICAgICBuYXRpdmVYaHIub25lcnJvciA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgbmF0aXZlWGhyLnJlYWR5U3RhdGUgPSA0OwogICAgICAgICAgICBuYXRpdmVYaHIuc3RhdHVzID0gNTAwOwogICAgICAgICAgICBzZWxmLl9jYWxsYmFjaygpOwogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgbmF0aXZlWGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgc2VsZi5fY2FsbGJhY2soKTsKICAgICAgICAgIH07CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYWJvcnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5fY2FsbGJhY2soMCwgMSk7CiAgICB9LAogICAgX2NhbGxiYWNrOiBmdW5jdGlvbiAoZXZlbnQsIGFib3J0KSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgbmF0aXZlWGhyID0gc2VsZi5uYXRpdmVYaHIsIGlvID0gc2VsZi5pbywgaWZNb2RpZmllZEtleSwgbGFzdE1vZGlmaWVkLCBlVGFnLCBzdGF0dXNUZXh0LCB4bWwsIGMgPSBpby5jb25maWc7CiAgICAgIHRyeSB7CiAgICAgICAgaWYgKGFib3J0IHx8IG5hdGl2ZVhoci5yZWFkeVN0YXRlID09PSA0KSB7CiAgICAgICAgICBpZiAoaXNJbnN0YW5jZU9mWERvbWFpblJlcXVlc3QobmF0aXZlWGhyKSkgewogICAgICAgICAgICBuYXRpdmVYaHIub25lcnJvciA9IHV0aWwubm9vcDsKICAgICAgICAgICAgbmF0aXZlWGhyLm9ubG9hZCA9IHV0aWwubm9vcDsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG5hdGl2ZVhoci5vbnJlYWR5c3RhdGVjaGFuZ2UgPSB1dGlsLm5vb3A7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoYWJvcnQpIHsKICAgICAgICAgICAgaWYgKG5hdGl2ZVhoci5yZWFkeVN0YXRlICE9PSA0KSB7CiAgICAgICAgICAgICAgbmF0aXZlWGhyLmFib3J0KCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGlmTW9kaWZpZWRLZXkgPSBnZXRJZk1vZGlmaWVkS2V5KGMpOwogICAgICAgICAgICB2YXIgc3RhdHVzID0gbmF0aXZlWGhyLnN0YXR1czsKICAgICAgICAgICAgaWYgKCFpc0luc3RhbmNlT2ZYRG9tYWluUmVxdWVzdChuYXRpdmVYaHIpKSB7CiAgICAgICAgICAgICAgaW8ucmVzcG9uc2VIZWFkZXJzU3RyaW5nID0gbmF0aXZlWGhyLmdldEFsbFJlc3BvbnNlSGVhZGVycygpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChpZk1vZGlmaWVkS2V5KSB7CiAgICAgICAgICAgICAgbGFzdE1vZGlmaWVkID0gbmF0aXZlWGhyLmdldFJlc3BvbnNlSGVhZGVyKCdMYXN0LU1vZGlmaWVkJyk7CiAgICAgICAgICAgICAgZVRhZyA9IG5hdGl2ZVhoci5nZXRSZXNwb25zZUhlYWRlcignRVRhZycpOwogICAgICAgICAgICAgIGlmIChsYXN0TW9kaWZpZWQpIHsKICAgICAgICAgICAgICAgIGxhc3RNb2RpZmllZENhY2hlZFtpZk1vZGlmaWVkS2V5XSA9IGxhc3RNb2RpZmllZDsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgICAgaWYgKGVUYWcpIHsKICAgICAgICAgICAgICAgIGVUYWdDYWNoZWRbZVRhZ10gPSBlVGFnOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICB4bWwgPSBuYXRpdmVYaHIucmVzcG9uc2VYTUw7CiAgICAgICAgICAgIGlmICh4bWwgJiYgeG1sLmRvY3VtZW50RWxlbWVudCkgewogICAgICAgICAgICAgIGlvLnJlc3BvbnNlWE1MID0geG1sOwogICAgICAgICAgICB9CiAgICAgICAgICAgIHZhciB0ZXh0ID0gaW8ucmVzcG9uc2VUZXh0ID0gbmF0aXZlWGhyLnJlc3BvbnNlVGV4dDsKICAgICAgICAgICAgaWYgKGMuZmlsZXMgJiYgdGV4dCkgewogICAgICAgICAgICAgIHZhciBib2R5SW5kZXgsIGxhc3RCb2R5SW5kZXg7CiAgICAgICAgICAgICAgaWYgKChib2R5SW5kZXggPSB0ZXh0LmluZGV4T2YoJzxib2R5PicpKSAhPT0gLTEpIHsKICAgICAgICAgICAgICAgIGxhc3RCb2R5SW5kZXggPSB0ZXh0Lmxhc3RJbmRleE9mKCc8L2JvZHk+Jyk7CiAgICAgICAgICAgICAgICBpZiAobGFzdEJvZHlJbmRleCA9PT0gLTEpIHsKICAgICAgICAgICAgICAgICAgbGFzdEJvZHlJbmRleCA9IHRleHQubGVuZ3RoOwogICAgICAgICAgICAgICAgfQogICAgICAgICAgICAgICAgdGV4dCA9IHRleHQuc2xpY2UoYm9keUluZGV4ICsgNiwgbGFzdEJvZHlJbmRleCk7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlvLnJlc3BvbnNlVGV4dCA9IHV0aWwudW5Fc2NhcGVIdG1sID8gdXRpbC51bkVzY2FwZUh0bWwodGV4dCkgOiB0ZXh0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgICAgc3RhdHVzVGV4dCA9IG5hdGl2ZVhoci5zdGF0dXNUZXh0OwogICAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICAgICAgc3RhdHVzVGV4dCA9ICcnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICghc3RhdHVzICYmIElPLmlzTG9jYWwgJiYgIWMuY3Jvc3NEb21haW4pIHsKICAgICAgICAgICAgICBzdGF0dXMgPSBpby5yZXNwb25zZVRleHQgPyBPS19DT0RFIDogTk9UX0ZPVU5EX0NPREU7CiAgICAgICAgICAgIH0gZWxzZSBpZiAoc3RhdHVzID09PSBOT19DT05URU5UX0NPREUyKSB7CiAgICAgICAgICAgICAgc3RhdHVzID0gTk9fQ09OVEVOVF9DT0RFOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlvLl9pb1JlYWR5KHN0YXR1cywgc3RhdHVzVGV4dCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgaWYgKCdAREVCVUdAJykgewogICAgICAgICAgY29uc29sZS5lcnJvcihlLnN0YWNrIHx8IGUpOwogICAgICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICB9LCAwKTsKICAgICAgICB9CiAgICAgICAgbmF0aXZlWGhyLm9ucmVhZHlzdGF0ZWNoYW5nZSA9IHV0aWwubm9vcDsKICAgICAgICBpZiAoIWFib3J0KSB7CiAgICAgICAgICBpby5faW9SZWFkeSgwIC0gMSwgZS5tZXNzYWdlIHx8ICdwcm9jZXNzIGVycm9yJyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IFhoclRyYW5zcG9ydEJhc2U7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKaW9CYXNlTGliTWFpblN1YkRvbWFpblRyYW5zcG9ydCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgaW9VdGlsID0gaW9CYXNlTGliTWFpblV0aWxzOwogIHZhciB1cmwgPSBfdXJsXzsKICB2YXIgRG9tID0gZG9tQmFzZTsKICB2YXIgWGhyVHJhbnNwb3J0QmFzZSA9IGlvQmFzZUxpYk1haW5YaHJUcmFuc3BvcnRCYXNlOwogIHZhciBQUk9YWV9QQUdFID0gJy9zdWJfZG9tYWluX3Byb3h5Lmh0bWwnOwogIHZhciBkb2MgPSBkb2N1bWVudDsKICB2YXIgaWZyYW1lTWFwID0ge307CiAgZnVuY3Rpb24gU3ViRG9tYWluVHJhbnNwb3J0KGlvKSB7CiAgICB2YXIgc2VsZiA9IHRoaXMsIGMgPSBpby5jb25maWc7CiAgICBzZWxmLmlvID0gaW87CiAgICBjLmNyb3NzRG9tYWluID0gZmFsc2U7CiAgICBzZWxmLl9vbkxvYWQgPSB1dGlsLmJpbmQob25Mb2FkLCBzZWxmKTsKICB9CiAgdXRpbC5hdWdtZW50KFN1YkRvbWFpblRyYW5zcG9ydCwgWGhyVHJhbnNwb3J0QmFzZS5wcm90bywgewogICAgc2VuZDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGMgPSBzZWxmLmlvLmNvbmZpZywgdXJpID0gYy51cmksIGhvc3RuYW1lID0gdXJpLmhvc3RuYW1lLCBpZnJhbWUsIGlmcmFtZVVyaSwgaWZyYW1lRGVzYyA9IGlmcmFtZU1hcFtob3N0bmFtZV07CiAgICAgIHZhciBwcm94eSA9IFBST1hZX1BBR0U7CiAgICAgIGlmIChjLnhkciAmJiBjLnhkci5zdWJEb21haW4gJiYgYy54ZHIuc3ViRG9tYWluLnByb3h5KSB7CiAgICAgICAgcHJveHkgPSBjLnhkci5zdWJEb21haW4ucHJveHk7CiAgICAgIH0KICAgICAgaWYgKGlmcmFtZURlc2MgJiYgaWZyYW1lRGVzYy5yZWFkeSkgewogICAgICAgIHNlbGYubmF0aXZlWGhyID0gWGhyVHJhbnNwb3J0QmFzZS5uYXRpdmVYaHIoMCwgaWZyYW1lRGVzYy5pZnJhbWUuY29udGVudFdpbmRvdyk7CiAgICAgICAgaWYgKHNlbGYubmF0aXZlWGhyKSB7CiAgICAgICAgICBzZWxmLnNlbmRJbnRlcm5hbCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdpbzogZG9jdW1lbnQuZG9tYWluIG5vdCBzZXQgY29ycmVjdGx5IScpOwogICAgICAgIH0KICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCFpZnJhbWVEZXNjKSB7CiAgICAgICAgaWZyYW1lRGVzYyA9IGlmcmFtZU1hcFtob3N0bmFtZV0gPSB7fTsKICAgICAgICBpZnJhbWUgPSBpZnJhbWVEZXNjLmlmcmFtZSA9IGRvYy5jcmVhdGVFbGVtZW50KCdpZnJhbWUnKTsKICAgICAgICBEb20uY3NzKGlmcmFtZSwgewogICAgICAgICAgcG9zaXRpb246ICdhYnNvbHV0ZScsCiAgICAgICAgICBsZWZ0OiAnLTk5OTlweCcsCiAgICAgICAgICB0b3A6ICctOTk5OXB4JwogICAgICAgIH0pOwogICAgICAgIERvbS5wcmVwZW5kKGlmcmFtZSwgZG9jLmJvZHkgfHwgZG9jLmRvY3VtZW50RWxlbWVudCk7CiAgICAgICAgaWZyYW1lVXJpID0ge307CiAgICAgICAgaWZyYW1lVXJpLnByb3RvY29sID0gdXJpLnByb3RvY29sOwogICAgICAgIGlmcmFtZVVyaS5ob3N0ID0gdXJpLmhvc3Q7CiAgICAgICAgaWZyYW1lVXJpLnBhdGhuYW1lID0gcHJveHk7CiAgICAgICAgaWZyYW1lLnNyYyA9IHVybC5zdHJpbmdpZnkoaWZyYW1lVXJpKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZnJhbWUgPSBpZnJhbWVEZXNjLmlmcmFtZTsKICAgICAgfQogICAgICBpb1V0aWwuYWRkRXZlbnQoaWZyYW1lLCAnbG9hZCcsIHNlbGYuX29uTG9hZCk7CiAgICB9CiAgfSk7CiAgZnVuY3Rpb24gb25Mb2FkKCkgewogICAgdmFyIHNlbGYgPSB0aGlzLCBjID0gc2VsZi5pby5jb25maWcsIHVyaSA9IGMudXJpLCBob3N0bmFtZSA9IHVyaS5ob3N0bmFtZSwgaWZyYW1lRGVzYyA9IGlmcmFtZU1hcFtob3N0bmFtZV07CiAgICBpZnJhbWVEZXNjLnJlYWR5ID0gMTsKICAgIGlvVXRpbC5yZW1vdmVFdmVudChpZnJhbWVEZXNjLmlmcmFtZSwgJ2xvYWQnLCBzZWxmLl9vbkxvYWQpOwogICAgc2VsZi5zZW5kKCk7CiAgfQogIGV4cG9ydHMgPSBTdWJEb21haW5UcmFuc3BvcnQ7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKaW9CYXNlTGliTWFpblNjcmlwdFRyYW5zcG9ydCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgSU8gPSBpb0Jhc2VMaWJNYWluQmFzZTsKICB2YXIgT0tfQ09ERSA9IDIwMCwgRVJST1JfQ09ERSA9IDUwMDsKICBJTy5zZXR1cENvbmZpZyh7CiAgICBhY2NlcHRzOiB7IHNjcmlwdDogJ3RleHQvamF2YXNjcmlwdCwgJyArICdhcHBsaWNhdGlvbi9qYXZhc2NyaXB0LCAnICsgJ2FwcGxpY2F0aW9uL2VjbWFzY3JpcHQsICcgKyAnYXBwbGljYXRpb24veC1lY21hc2NyaXB0JyB9LAogICAgY29udGVudHM6IHsgc2NyaXB0OiAvamF2YXNjcmlwdHxlY21hc2NyaXB0LyB9LAogICAgY29udmVydGVyczogewogICAgICB0ZXh0OiB7CiAgICAgICAgc2NyaXB0OiBmdW5jdGlvbiAodGV4dCkgewogICAgICAgICAgdXRpbC5nbG9iYWxFdmFsKHRleHQpOwogICAgICAgICAgcmV0dXJuIHRleHQ7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CiAgZnVuY3Rpb24gU2NyaXB0VHJhbnNwb3J0KGlvKSB7CiAgICB2YXIgY29uZmlnID0gaW8uY29uZmlnLCBzZWxmID0gdGhpczsKICAgIGlmICghY29uZmlnLmNyb3NzRG9tYWluKSB7CiAgICAgIHJldHVybiBuZXcgKElPLmdldFRyYW5zcG9ydCgnKicpKShpbyk7CiAgICB9CiAgICBzZWxmLmlvID0gaW87CiAgICByZXR1cm4gc2VsZjsKICB9CiAgdXRpbC5hdWdtZW50KFNjcmlwdFRyYW5zcG9ydCwgewogICAgc2VuZDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGlvID0gc2VsZi5pbywgYyA9IGlvLmNvbmZpZzsKICAgICAgc2VsZi5zY3JpcHQgPSBJTy5nZXRTY3JpcHQoaW8uX2dldFVybEZvclNlbmQoKSwgewogICAgICAgIGNoYXJzZXQ6IGMuc2NyaXB0Q2hhcnNldCwKICAgICAgICBzdWNjZXNzOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgICBzZWxmLl9jYWxsYmFjaygnc3VjY2VzcycpOwogICAgICAgIH0sCiAgICAgICAgZXJyb3I6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHNlbGYuX2NhbGxiYWNrKCdlcnJvcicpOwogICAgICAgIH0KICAgICAgfSk7CiAgICB9LAogICAgX2NhbGxiYWNrOiBmdW5jdGlvbiAoZXZlbnQsIGFib3J0KSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgc2NyaXB0ID0gc2VsZi5zY3JpcHQsIGlvID0gc2VsZi5pbzsKICAgICAgaWYgKCFzY3JpcHQpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgc2VsZi5zY3JpcHQgPSB1bmRlZmluZWQ7CiAgICAgIGlmIChhYm9ydCkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoZXZlbnQgIT09ICdlcnJvcicpIHsKICAgICAgICBpby5faW9SZWFkeShPS19DT0RFLCAnc3VjY2VzcycpOwogICAgICB9IGVsc2UgaWYgKGV2ZW50ID09PSAnZXJyb3InKSB7CiAgICAgICAgaW8uX2lvUmVhZHkoRVJST1JfQ09ERSwgJ3NjcmlwdCBlcnJvcicpOwogICAgICB9CiAgICB9LAogICAgYWJvcnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5fY2FsbGJhY2soMCwgMSk7CiAgICB9CiAgfSk7CiAgSU8uc2V0dXBUcmFuc3BvcnQoJ3NjcmlwdCcsIFNjcmlwdFRyYW5zcG9ydCk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKaW9CYXNlTGliTWFpbkpzb25wID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBJTyA9IGlvQmFzZUxpYk1haW5CYXNlOwogIHZhciB3aW4gPSB3aW5kb3c7CiAgSU8uc2V0dXBDb25maWcoewogICAganNvbnA6ICdjYWxsYmFjaycsCiAgICBqc29ucENhbGxiYWNrOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB1dGlsLmd1aWQoJ2pzb25wJyk7CiAgICB9CiAgfSk7CiAgSU8uYWRkUHJlcHJvY2Vzc29yKCdzdGFydCcsIGZ1bmN0aW9uIChlKSB7CiAgICB2YXIgaW8gPSBlLmlvLCBjID0gaW8uY29uZmlnLCBkYXRhVHlwZSA9IGMuZGF0YVR5cGU7CiAgICBpZiAoZGF0YVR5cGVbMF0gPT09ICdqc29ucCcpIHsKICAgICAgZGVsZXRlIGMuY29udGVudFR5cGU7CiAgICAgIHZhciByZXNwb25zZSwgY0pzb25wQ2FsbGJhY2sgPSBjLmpzb25wQ2FsbGJhY2ssIGNvbnZlcnRlcnMsIGpzb25wQ2FsbGJhY2sgPSB0eXBlb2YgY0pzb25wQ2FsbGJhY2sgPT09ICdmdW5jdGlvbicgPyBjSnNvbnBDYWxsYmFjaygpIDogY0pzb25wQ2FsbGJhY2ssIHByZXZpb3VzID0gd2luW2pzb25wQ2FsbGJhY2tdOwogICAgICBjLnVyaS5xdWVyeVtjLmpzb25wXSA9IGpzb25wQ2FsbGJhY2s7CiAgICAgIHdpbltqc29ucENhbGxiYWNrXSA9IGZ1bmN0aW9uIChyKSB7CiAgICAgICAgaWYgKGFyZ3VtZW50cy5sZW5ndGggPiAxKSB7CiAgICAgICAgICByID0gdXRpbC5tYWtlQXJyYXkoYXJndW1lbnRzKTsKICAgICAgICB9CiAgICAgICAgcmVzcG9uc2UgPSBbcl07CiAgICAgIH07CiAgICAgIGlvLmZpbihmdW5jdGlvbiAoKSB7CiAgICAgICAgd2luW2pzb25wQ2FsbGJhY2tdID0gcHJldmlvdXM7CiAgICAgICAgaWYgKHByZXZpb3VzID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGRlbGV0ZSB3aW5banNvbnBDYWxsYmFja107CiAgICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIGlmIChyZXNwb25zZSkgewogICAgICAgICAgcHJldmlvdXMocmVzcG9uc2VbMF0pOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGNvbnZlcnRlcnMgPSBjLmNvbnZlcnRlcnM7CiAgICAgIGNvbnZlcnRlcnMuc2NyaXB0ID0gY29udmVydGVycy5zY3JpcHQgfHwge307CiAgICAgIGNvbnZlcnRlcnMuc2NyaXB0Lmpzb24gPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKCFyZXNwb25zZSkgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKCdub3QgY2FsbCBqc29ucENhbGxiYWNrOiAnICsganNvbnBDYWxsYmFjayk7CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXNwb25zZVswXTsKICAgICAgfTsKICAgICAgZGF0YVR5cGUubGVuZ3RoID0gMjsKICAgICAgZGF0YVR5cGVbMF0gPSAnc2NyaXB0JzsKICAgICAgZGF0YVR5cGVbMV0gPSAnanNvbic7CiAgICB9CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKaW9CYXNlTGliTWFpbk1ldGhvZHMgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIFhQcm9taXNlID0gcHJvbWlzZTsKICB2YXIgSU8gPSBpb0Jhc2VMaWJNYWluQmFzZTsKICB2YXIgdXJsID0gX3VybF87CiAgdmFyIE9LX0NPREUgPSAyMDAsIE1VTFRJUExFX0NIT0lDRVMgPSAzMDAsIE5PVF9NT0RJRklFRCA9IDMwNCwgSEVBREVSX1JFRyA9IC9eKC4qPyk6WyBcdF0qKFteXHJcbl0qKVxyPyQvZ207CiAgZnVuY3Rpb24gaGFuZGxlUmVzcG9uc2VEYXRhKGlvKSB7CiAgICB2YXIgdGV4dCA9IGlvLnJlc3BvbnNlVGV4dCwgeG1sID0gaW8ucmVzcG9uc2VYTUwsIGMgPSBpby5jb25maWcsIGNvbnZlcnRzID0gYy5jb252ZXJ0ZXJzLCB0eXBlLCBjb250ZW50VHlwZSwgcmVzcG9uc2VEYXRhLCBjb250ZW50cyA9IGMuY29udGVudHMsIGRhdGFUeXBlID0gYy5kYXRhVHlwZTsKICAgIGlmICh0ZXh0IHx8IHhtbCkgewogICAgICBjb250ZW50VHlwZSA9IGlvLm1pbWVUeXBlIHx8IGlvLmdldFJlc3BvbnNlSGVhZGVyKCdDb250ZW50LVR5cGUnKTsKICAgICAgd2hpbGUgKGRhdGFUeXBlWzBdID09PSAnKicpIHsKICAgICAgICBkYXRhVHlwZS5zaGlmdCgpOwogICAgICB9CiAgICAgIGlmICghZGF0YVR5cGUubGVuZ3RoKSB7CiAgICAgICAgZm9yICh0eXBlIGluIGNvbnRlbnRzKSB7CiAgICAgICAgICBpZiAoY29udGVudHNbdHlwZV0udGVzdChjb250ZW50VHlwZSkpIHsKICAgICAgICAgICAgaWYgKGRhdGFUeXBlWzBdICE9PSB0eXBlKSB7CiAgICAgICAgICAgICAgZGF0YVR5cGUudW5zaGlmdCh0eXBlKTsKICAgICAgICAgICAgfQogICAgICAgICAgICBicmVhazsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgZGF0YVR5cGVbMF0gPSBkYXRhVHlwZVswXSB8fCAndGV4dCc7CiAgICAgIGZvciAodmFyIGRhdGFUeXBlSW5kZXggPSAwOyBkYXRhVHlwZUluZGV4IDwgZGF0YVR5cGUubGVuZ3RoOyBkYXRhVHlwZUluZGV4KyspIHsKICAgICAgICBpZiAoZGF0YVR5cGVbZGF0YVR5cGVJbmRleF0gPT09ICd0ZXh0JyAmJiB0ZXh0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHJlc3BvbnNlRGF0YSA9IHRleHQ7CiAgICAgICAgICBicmVhazsKICAgICAgICB9IGVsc2UgaWYgKGRhdGFUeXBlW2RhdGFUeXBlSW5kZXhdID09PSAneG1sJyAmJiB4bWwgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgcmVzcG9uc2VEYXRhID0geG1sOwogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmICghcmVzcG9uc2VEYXRhKSB7CiAgICAgICAgdmFyIHJhd0RhdGEgPSB7CiAgICAgICAgICB0ZXh0OiB0ZXh0LAogICAgICAgICAgeG1sOiB4bWwKICAgICAgICB9OwogICAgICAgIHV0aWwuZWFjaChbCiAgICAgICAgICAndGV4dCcsCiAgICAgICAgICAneG1sJwogICAgICAgIF0sIGZ1bmN0aW9uIChwcmV2VHlwZSkgewogICAgICAgICAgdmFyIHR5cGUgPSBkYXRhVHlwZVswXSwgY29udmVydGVyID0gY29udmVydHNbcHJldlR5cGVdICYmIGNvbnZlcnRzW3ByZXZUeXBlXVt0eXBlXTsKICAgICAgICAgIGlmIChjb252ZXJ0ZXIgJiYgcmF3RGF0YVtwcmV2VHlwZV0pIHsKICAgICAgICAgICAgZGF0YVR5cGUudW5zaGlmdChwcmV2VHlwZSk7CiAgICAgICAgICAgIHJlc3BvbnNlRGF0YSA9IHByZXZUeXBlID09PSAndGV4dCcgPyB0ZXh0IDogeG1sOwogICAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0pOwogICAgICB9CiAgICB9CiAgICB2YXIgcHJldlR5cGUgPSBkYXRhVHlwZVswXTsKICAgIGZvciAodmFyIGkgPSAxOyBpIDwgZGF0YVR5cGUubGVuZ3RoOyBpKyspIHsKICAgICAgdHlwZSA9IGRhdGFUeXBlW2ldOwogICAgICB2YXIgY29udmVydGVyID0gY29udmVydHNbcHJldlR5cGVdICYmIGNvbnZlcnRzW3ByZXZUeXBlXVt0eXBlXTsKICAgICAgaWYgKCFjb252ZXJ0ZXIpIHsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoJ25vIGNvdmVydCBmb3IgJyArIHByZXZUeXBlICsgJyA9PiAnICsgdHlwZSk7CiAgICAgIH0KICAgICAgcmVzcG9uc2VEYXRhID0gY29udmVydGVyKHJlc3BvbnNlRGF0YSk7CiAgICAgIHByZXZUeXBlID0gdHlwZTsKICAgIH0KICAgIGlvLnJlc3BvbnNlRGF0YSA9IHJlc3BvbnNlRGF0YTsKICB9CiAgdXRpbC5leHRlbmQoSU8sIFhQcm9taXNlLCB7CiAgICBzZXRSZXF1ZXN0SGVhZGVyOiBmdW5jdGlvbiAobmFtZSwgdmFsdWUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBzZWxmLnJlcXVlc3RIZWFkZXJzW25hbWVdID0gdmFsdWU7CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIGdldEFsbFJlc3BvbnNlSGVhZGVyczogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHJldHVybiBzZWxmLnN0YXRlID09PSAyID8gc2VsZi5yZXNwb25zZUhlYWRlcnNTdHJpbmcgOiBudWxsOwogICAgfSwKICAgIGdldFJlc3BvbnNlSGVhZGVyOiBmdW5jdGlvbiAobmFtZSkgewogICAgICB2YXIgbWF0Y2gsIHJlc3BvbnNlSGVhZGVycywgc2VsZiA9IHRoaXM7CiAgICAgIG5hbWUgPSBuYW1lLnRvTG93ZXJDYXNlKCk7CiAgICAgIGlmIChzZWxmLnN0YXRlID09PSAyKSB7CiAgICAgICAgaWYgKCEocmVzcG9uc2VIZWFkZXJzID0gc2VsZi5yZXNwb25zZUhlYWRlcnMpKSB7CiAgICAgICAgICByZXNwb25zZUhlYWRlcnMgPSBzZWxmLnJlc3BvbnNlSGVhZGVycyA9IHt9OwogICAgICAgICAgd2hpbGUgKG1hdGNoID0gSEVBREVSX1JFRy5leGVjKHNlbGYucmVzcG9uc2VIZWFkZXJzU3RyaW5nKSkgewogICAgICAgICAgICByZXNwb25zZUhlYWRlcnNbbWF0Y2hbMV0udG9Mb3dlckNhc2UoKV0gPSBtYXRjaFsyXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgbWF0Y2ggPSByZXNwb25zZUhlYWRlcnNbbmFtZV07CiAgICAgIH0KICAgICAgcmV0dXJuIG1hdGNoID09PSB1bmRlZmluZWQgPyBudWxsIDogbWF0Y2g7CiAgICB9LAogICAgb3ZlcnJpZGVNaW1lVHlwZTogZnVuY3Rpb24gKHR5cGUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAoIXNlbGYuc3RhdGUpIHsKICAgICAgICBzZWxmLm1pbWVUeXBlID0gdHlwZTsKICAgICAgfQogICAgICByZXR1cm4gc2VsZjsKICAgIH0sCiAgICBhYm9ydDogZnVuY3Rpb24gKHN0YXR1c1RleHQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBzdGF0dXNUZXh0ID0gc3RhdHVzVGV4dCB8fCAnYWJvcnQnOwogICAgICBpZiAoc2VsZi50cmFuc3BvcnQpIHsKICAgICAgICBzZWxmLnRyYW5zcG9ydC5hYm9ydChzdGF0dXNUZXh0KTsKICAgICAgfQogICAgICBzZWxmLl9pb1JlYWR5KDAsIHN0YXR1c1RleHQpOwogICAgICByZXR1cm4gc2VsZjsKICAgIH0sCiAgICBnZXROYXRpdmVYaHI6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHRyYW5zcG9ydCA9IHRoaXMudHJhbnNwb3J0OwogICAgICBpZiAodHJhbnNwb3J0KSB7CiAgICAgICAgcmV0dXJuIHRyYW5zcG9ydC5uYXRpdmVYaHI7CiAgICAgIH0KICAgICAgcmV0dXJuIG51bGw7CiAgICB9LAogICAgX2lvUmVhZHk6IGZ1bmN0aW9uIChzdGF0dXMsIHN0YXR1c1RleHQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAoc2VsZi5zdGF0ZSA9PT0gMikgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBzZWxmLnN0YXRlID0gMjsKICAgICAgc2VsZi5yZWFkeVN0YXRlID0gNDsKICAgICAgdmFyIGlzU3VjY2VzczsKICAgICAgaWYgKHN0YXR1cyA+PSBPS19DT0RFICYmIHN0YXR1cyA8IE1VTFRJUExFX0NIT0lDRVMgfHwgc3RhdHVzID09PSBOT1RfTU9ESUZJRUQpIHsKICAgICAgICBpZiAoc3RhdHVzID09PSBOT1RfTU9ESUZJRUQpIHsKICAgICAgICAgIHN0YXR1c1RleHQgPSAnbm90IG1vZGlmaWVkJzsKICAgICAgICAgIGlzU3VjY2VzcyA9IHRydWU7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHRyeSB7CiAgICAgICAgICAgIGhhbmRsZVJlc3BvbnNlRGF0YShzZWxmKTsKICAgICAgICAgICAgc3RhdHVzVGV4dCA9ICdzdWNjZXNzJzsKICAgICAgICAgICAgaXNTdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgaWYgKCdAREVCVUdAJykgewogICAgICAgICAgICAgIGNvbnNvbGUuZXJyb3IoZS5zdGFjayB8fCBlKTsKICAgICAgICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgICAgICAgIHRocm93IGU7CiAgICAgICAgICAgICAgfSwgMCk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgc3RhdHVzVGV4dCA9IGUubWVzc2FnZSB8fCAncGFyc2VyIGVycm9yJzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKHN0YXR1cyA8IDApIHsKICAgICAgICAgIHN0YXR1cyA9IDA7CiAgICAgICAgfQogICAgICB9CiAgICAgIHNlbGYuc3RhdHVzID0gc3RhdHVzOwogICAgICBzZWxmLnN0YXR1c1RleHQgPSBzdGF0dXNUZXh0OwogICAgICB2YXIgZGVmZXIgPSBzZWxmLmRlZmVyLCBjb25maWcgPSBzZWxmLmNvbmZpZywgdGltZW91dFRpbWVyOwogICAgICBpZiAodGltZW91dFRpbWVyID0gc2VsZi50aW1lb3V0VGltZXIpIHsKICAgICAgICBjbGVhclRpbWVvdXQodGltZW91dFRpbWVyKTsKICAgICAgICBzZWxmLnRpbWVvdXRUaW1lciA9IDA7CiAgICAgIH0KICAgICAgdmFyIGhhbmRsZXIgPSBpc1N1Y2Nlc3MgPyAnc3VjY2VzcycgOiAnZXJyb3InLCBoLCB2ID0gWwogICAgICAgICAgc2VsZi5yZXNwb25zZURhdGEsCiAgICAgICAgICBzdGF0dXNUZXh0LAogICAgICAgICAgc2VsZgogICAgICAgIF0sIGNvbnRleHQgPSBjb25maWcuY29udGV4dCwgZXZlbnRPYmplY3QgPSB7IGlvOiBzZWxmIH07CiAgICAgIGlmIChoID0gY29uZmlnW2hhbmRsZXJdKSB7CiAgICAgICAgaC5hcHBseShjb250ZXh0LCB2KTsKICAgICAgfQogICAgICBpZiAoaCA9IGNvbmZpZy5jb21wbGV0ZSkgewogICAgICAgIGguYXBwbHkoY29udGV4dCwgdik7CiAgICAgIH0KICAgICAgSU8uZmlyZShoYW5kbGVyLCBldmVudE9iamVjdCk7CiAgICAgIElPLmZpcmUoJ2NvbXBsZXRlJywgZXZlbnRPYmplY3QpOwogICAgICBkZWZlcltpc1N1Y2Nlc3MgPyAncmVzb2x2ZScgOiAncmVqZWN0J10odik7CiAgICB9LAogICAgX2dldFVybEZvclNlbmQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGMgPSB0aGlzLmNvbmZpZywgdXJpID0gYy51cmk7CiAgICAgIHZhciBzZWFyY2ggPSB1cmkuc2VhcmNoIHx8ICcnOwogICAgICBkZWxldGUgdXJpLnNlYXJjaDsKICAgICAgaWYgKHNlYXJjaCAmJiAhdXRpbC5pc0VtcHR5T2JqZWN0KHVyaS5xdWVyeSkpIHsKICAgICAgICBzZWFyY2ggPSAnJicgKyBzZWFyY2guc3Vic3RyaW5nKDEpOwogICAgICB9CiAgICAgIHJldHVybiB1cmwuc3RyaW5naWZ5KHVyaSwgYy5zZXJpYWxpemVBcnJheSkgKyBzZWFyY2g7CiAgICB9CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKaW9CYXNlTGliTWFpbklvID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgSU8gPSBpb0Jhc2VMaWJNYWluQmFzZTsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBnZXRTY3JpcHQgPSBpb1NjcmlwdDsKICBmdW5jdGlvbiBnZXQodXJsLCBkYXRhLCBjYWxsYmFjaywgZGF0YVR5cGUsIHR5cGUpIHsKICAgIGlmICh0eXBlb2YgZGF0YSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICBkYXRhVHlwZSA9IGNhbGxiYWNrOwogICAgICBjYWxsYmFjayA9IGRhdGE7CiAgICAgIGRhdGEgPSB1bmRlZmluZWQ7CiAgICB9CiAgICByZXR1cm4gSU8oewogICAgICB0eXBlOiB0eXBlIHx8ICdnZXQnLAogICAgICB1cmw6IHVybCwKICAgICAgZGF0YTogZGF0YSwKICAgICAgY29tcGxldGU6IGNhbGxiYWNrLAogICAgICBkYXRhVHlwZTogZGF0YVR5cGUKICAgIH0pOwogIH0KICB1dGlsLm1peChJTywgewogICAgZ2V0U2NyaXB0OiBnZXRTY3JpcHQsCiAgICBnZXQ6IGdldCwKICAgIHBvc3Q6IGZ1bmN0aW9uICh1cmwsIGRhdGEsIGNhbGxiYWNrLCBkYXRhVHlwZSkgewogICAgICBpZiAodHlwZW9mIGRhdGEgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICBkYXRhVHlwZSA9IGNhbGxiYWNrOwogICAgICAgIGNhbGxiYWNrID0gZGF0YTsKICAgICAgICBkYXRhID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIHJldHVybiBnZXQodXJsLCBkYXRhLCBjYWxsYmFjaywgZGF0YVR5cGUsICdwb3N0Jyk7CiAgICB9LAogICAganNvbnA6IGZ1bmN0aW9uICh1cmwsIGRhdGEsIGNhbGxiYWNrKSB7CiAgICAgIGlmICh1dGlsLmlzUGxhaW5PYmplY3QodXJsKSkgewogICAgICAgIHZhciBjb25maWcgPSB1cmw7CiAgICAgICAgdXJsID0gY29uZmlnLnVybDsKICAgICAgICBkYXRhID0gY29uZmlnLmRhdGE7CiAgICAgICAgY2FsbGJhY2sgPSBjb25maWcuc3VjY2VzczsKICAgICAgfSBlbHNlIGlmICh0eXBlb2YgZGF0YSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICAgIGNhbGxiYWNrID0gZGF0YTsKICAgICAgICBkYXRhID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIHJldHVybiBnZXQodXJsLCBkYXRhLCBjYWxsYmFjaywgJ2pzb25wJyk7CiAgICB9LAogICAgZ2V0SlNPTjogZnVuY3Rpb24gKHVybCwgZGF0YSwgY2FsbGJhY2spIHsKICAgICAgaWYgKHR5cGVvZiBkYXRhID09PSAnZnVuY3Rpb24nKSB7CiAgICAgICAgY2FsbGJhY2sgPSBkYXRhOwogICAgICAgIGRhdGEgPSB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgcmV0dXJuIGdldCh1cmwsIGRhdGEsIGNhbGxiYWNrLCAnanNvbicpOwogICAgfQogIH0pOwogIGV4cG9ydHMgPSBJTzsKICByZXR1cm4gZXhwb3J0czsKfSgpOwppb0Jhc2VMaWJNYWluWGhyVHJhbnNwb3J0ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBJTyA9IGlvQmFzZUxpYk1haW5CYXNlLCBYaHJUcmFuc3BvcnRCYXNlID0gaW9CYXNlTGliTWFpblhoclRyYW5zcG9ydEJhc2UsIFN1YkRvbWFpblRyYW5zcG9ydCA9IGlvQmFzZUxpYk1haW5TdWJEb21haW5UcmFuc3BvcnQ7CiAgdmFyIGRvYyA9IGRvY3VtZW50OwogIGZ1bmN0aW9uIGlzU3ViRG9tYWluKGhvc3RuYW1lKSB7CiAgICByZXR1cm4gZG9jLmRvbWFpbiAmJiB1dGlsLmVuZHNXaXRoKGhvc3RuYW1lLCBkb2MuZG9tYWluKTsKICB9CiAgZnVuY3Rpb24gWGhyVHJhbnNwb3J0KGlvKSB7CiAgICB2YXIgYyA9IGlvLmNvbmZpZywgY3Jvc3NEb21haW4gPSBjLmNyb3NzRG9tYWluLCBzZWxmID0gdGhpcywgeGhyLCB4ZHJDZmcgPSBjLnhkciB8fCB7fSwgc3ViRG9tYWluID0geGRyQ2ZnLnN1YkRvbWFpbiA9IHhkckNmZy5zdWJEb21haW4gfHwge307CiAgICBzZWxmLmlvID0gaW87CiAgICBpZiAoY3Jvc3NEb21haW4gJiYgIVhoclRyYW5zcG9ydEJhc2Uuc3VwcG9ydENPUlMpIHsKICAgICAgaWYgKGlzU3ViRG9tYWluKGMudXJpLmhvc3RuYW1lKSkgewogICAgICAgIGlmIChzdWJEb21haW4ucHJveHkgIT09IGZhbHNlKSB7CiAgICAgICAgICByZXR1cm4gbmV3IFN1YkRvbWFpblRyYW5zcG9ydChpbyk7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICB4aHIgPSBzZWxmLm5hdGl2ZVhociA9IFhoclRyYW5zcG9ydEJhc2UubmF0aXZlWGhyKGNyb3NzRG9tYWluKTsKICAgIHJldHVybiBzZWxmOwogIH0KICB1dGlsLmF1Z21lbnQoWGhyVHJhbnNwb3J0LCBYaHJUcmFuc3BvcnRCYXNlLnByb3RvLCB7CiAgICBzZW5kOiBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuc2VuZEludGVybmFsKCk7CiAgICB9CiAgfSk7CiAgSU8uc2V0dXBUcmFuc3BvcnQoJyonLCBYaHJUcmFuc3BvcnQpOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmlvQmFzZUxpYk1haW4gPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBJTyA9IGlvQmFzZUxpYk1haW5JbzsKICB2YXIgaW9VdGlsID0gaW9CYXNlTGliTWFpblV0aWxzOwogIGlvQmFzZUxpYk1haW5YaHJUcmFuc3BvcnQ7CiAgaW9CYXNlTGliTWFpblNjcmlwdFRyYW5zcG9ydDsKICBpb0Jhc2VMaWJNYWluSnNvbnA7CiAgaW9CYXNlTGliTWFpbk1ldGhvZHM7CiAgSU8uX3V0aWwgPSBpb1V0aWw7CiAgZXhwb3J0cyA9IElPOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmlvQmFzZUluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICBleHBvcnRzID0gaW9CYXNlTGliTWFpbjsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gaW9CYXNlSW5kZXg7Cn0pO2RlZmluZSgicHJvbWlzZSIsIFtdLCBmdW5jdGlvbihyZXF1aXJlKSB7CgovLyEgQ29weXJpZ2h0IDIwMTUsIHByb21pc2VANi4xLjEgTUlUIExpY2Vuc2VkLCBidWlsZCB0aW1lOiBUaHUsIDI5IE9jdCAyMDE1IDEyOjI5OjQyIEdNVCAKLyoKY29tYmluZWQgbW9kdWxlczoKcHJvbWlzZQpwcm9taXNlL2xpYi9wcm9taXNlCiovCnZhciBwcm9taXNlTGliUHJvbWlzZSwgcHJvbWlzZUluZGV4Owpwcm9taXNlTGliUHJvbWlzZSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgLyoqCiAgICogQGlnbm9yZQogICAqIGltcGxlbWVudCBQcm9taXNlIHNwZWNpZmljYXRpb24KICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbQogICAqLwogIHZhciBQUk9NSVNFX1ZBTFVFID0gJ19fcHJvbWlzZV92YWx1ZSc7CiAgdmFyIFBST01JU0VfU1RBVFVTID0gJ19fcHJvbWlzZV9zdGF0dXMnOwogIHZhciBQUk9NSVNFX1BST0dSRVNTX0xJU1RFTkVSUyA9ICdfX3Byb21pc2VfcHJvZ3Jlc3NfbGlzdGVuZXJzJzsKICB2YXIgUFJPTUlTRV9QRU5ESU5HUyA9ICdfX3Byb21pc2VfcGVuZGluZ3MnOwogIHZhciBQRU5ESU5HID0gJ1BlbmRpbmcnOwogIHZhciBGVUxGSUxMRUQgPSAnRnVsZmlsbGVkJzsKICB2YXIgUkVKRUNURUQgPSAnUmVqZWN0ZWQnOwogIGZ1bmN0aW9uIGVhY2goYXJyLCBmbikgewogICAgaWYgKGFycikgewogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGFyci5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBpZiAoZm4oYXJyW2ldLCBpKSA9PT0gZmFsc2UpIHsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0KICBmdW5jdGlvbiBtaXgociwgcykgewogICAgZm9yICh2YXIgcCBpbiBzKSB7CiAgICAgIHJbcF0gPSBzW3BdOwogICAgfQogIH0KICBmdW5jdGlvbiBpc1RoZW5hYmxlKHYpIHsKICAgIHJldHVybiB2ICYmIHR5cGVvZiB2LnRoZW4gPT09ICdmdW5jdGlvbic7CiAgfQogIC8qCiAgIHR3byBlZmZlY3RzOgogICAxLiBjYWxsIGZ1bGZpbGxlZCB3aXRoIGltbWVkaWF0ZSB2YWx1ZQogICAyLiBwdXNoIGZ1bGZpbGxlZCBpbiByaWdodCBwcm9taXNlCiAgICovCiAgZnVuY3Rpb24gcHJvbWlzZVdoZW4ocHJvbWlzZSwgZnVsZmlsbGVkLCByZWplY3RlZCkgewogICAgLy8gc2ltcGx5IGNhbGwgcmVqZWN0ZWQKICAgIGlmIChwcm9taXNlIGluc3RhbmNlb2YgUmVqZWN0KSB7CiAgICAgIC8vIGlmIHRoZXJlIGlzIGEgcmVqZWN0ZWQgLCBzaG91bGQgYWx3YXlzIGhhcyEgc2VlIHdoZW4oKQogICAgICByZWplY3RlZC5jYWxsKHByb21pc2UsIHByb21pc2UucmVhc29uKTsKICAgIH0gZWxzZSBpZiAoIShwcm9taXNlIGluc3RhbmNlb2YgUHJvbWlzZSkgJiYgaXNUaGVuYWJsZShwcm9taXNlKSkgewogICAgICAvLyBmbGF0dGVuCiAgICAgIHByb21pc2UudGhlbihmdWxmaWxsZWQsIHJlamVjdGVkKTsKICAgIH0gZWxzZSB7CiAgICAgIHZhciB2ID0gcHJvbWlzZVtQUk9NSVNFX1ZBTFVFXTsKICAgICAgaWYgKGlzVGhlbmFibGUodikgfHwgdiBpbnN0YW5jZW9mIFJlamVjdCkgewogICAgICAgIC8vIHJlamVjdGVkIG9yIG5lc3RlZCBwcm9taXNlCiAgICAgICAgcHJvbWlzZVdoZW4odiwgZnVsZmlsbGVkLCByZWplY3RlZCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGlmIChwcm9taXNlW1BST01JU0VfU1RBVFVTXSA9PT0gUEVORElORykgewogICAgICAgIC8vIGZsYXR0ZW4KICAgICAgICBwcm9taXNlW1BST01JU0VfUEVORElOR1NdLnB1c2goWwogICAgICAgICAgZnVsZmlsbGVkLAogICAgICAgICAgcmVqZWN0ZWQKICAgICAgICBdKTsKICAgICAgfSBlbHNlIHsKICAgICAgICAvLyBmdWxmaWxsZWQgdmFsdWUKICAgICAgICAvLyBub3JtYWwgdmFsdWUgcmVwcmVzZW50cyBvawogICAgICAgIC8vIG5lZWQgcmV0dXJuIHVzZXIncyByZXR1cm4gdmFsdWUKICAgICAgICAvLyBpZiByZXR1cm4gcHJvbWlzZSB0aGVuIGZvcndhcmQKICAgICAgICBpZiAoZnVsZmlsbGVkKSB7CiAgICAgICAgICBmdWxmaWxsZWQuY2FsbChwcm9taXNlLCB2KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgLyoqCiAgICogQGNsYXNzIERlZmVyCiAgICogRGVmZXIgY29uc3RydWN0b3IgRm9yIEtJU1NZLCBpbXBsZW1lbnQgUHJvbWlzZSBzcGVjaWZpY2F0aW9uLgogICAqLwogIGZ1bmN0aW9uIERlZmVyKHByb21pc2UpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIGlmICghKHNlbGYgaW5zdGFuY2VvZiBEZWZlcikpIHsKICAgICAgcmV0dXJuIG5ldyBEZWZlcihwcm9taXNlKTsKICAgIH0KICAgIC8vIGh0dHA6Ly9lbi53aWtpcGVkaWEub3JnL3dpa2kvT2JqZWN0LWNhcGFiaWxpdHlfbW9kZWwKICAgIC8vIHByaW5jaXBhbCBvZiBsZWFzdCBhdXRob3JpdHkKICAgIC8qKgogICAgICogZGVmZXIgb2JqZWN0J3MgcHJvbWlzZQogICAgICogQHR5cGUge1Byb21pc2V9CiAgICAgKi8KICAgIHNlbGYucHJvbWlzZSA9IHByb21pc2UgfHwgbmV3IFByb21pc2UoKTsKICAgIHNlbGYucHJvbWlzZS5kZWZlciA9IHNlbGY7CiAgfQogIERlZmVyLnByb3RvdHlwZSA9IHsKICAgIGNvbnN0cnVjdG9yOiBEZWZlciwKICAgIC8qKgogICAgICogZnVsZmlsbCBkZWZlciBvYmplY3QncyBwcm9taXNlCiAgICAgKiBub3RlOiBjYW4gb25seSBiZSBjYWxsZWQgb25jZQogICAgICogQHBhcmFtIHZhbHVlIGRlZmVyIG9iamVjdCdzIHZhbHVlCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBkZWZlciBvYmplY3QncyBwcm9taXNlCiAgICAgKi8KICAgIHJlc29sdmU6IGZ1bmN0aW9uICh2YWx1ZSkgewogICAgICB2YXIgcHJvbWlzZSA9IHRoaXMucHJvbWlzZTsKICAgICAgaWYgKHByb21pc2VbUFJPTUlTRV9TVEFUVVNdICE9PSBQRU5ESU5HKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgcHJvbWlzZVtQUk9NSVNFX1NUQVRVU10gPSB2YWx1ZSBpbnN0YW5jZW9mIFJlamVjdCA/IFJFSkVDVEVEIDogRlVMRklMTEVEOwogICAgICAvLyBzZXQgY3VycmVudCBwcm9taXNlICdzIHJlc29sdmVkIHZhbHVlCiAgICAgIC8vIG1heWJlIGEgcHJvbWlzZSBvciBpbnN0YW50IHZhbHVlCiAgICAgIHByb21pc2VbUFJPTUlTRV9WQUxVRV0gPSB2YWx1ZTsKICAgICAgdmFyIHBlbmRpbmdzID0gcHJvbWlzZVtQUk9NSVNFX1BFTkRJTkdTXTsKICAgICAgZWFjaChwZW5kaW5ncywgZnVuY3Rpb24gKHApIHsKICAgICAgICBwcm9taXNlV2hlbihwcm9taXNlLCBwWzBdLCBwWzFdKTsKICAgICAgfSk7CiAgICAgIHByb21pc2VbUFJPTUlTRV9QRU5ESU5HU10gPSBbXTsKICAgICAgcHJvbWlzZVtQUk9NSVNFX1BST0dSRVNTX0xJU1RFTkVSU10gPSBbXTsKICAgICAgcmV0dXJuIHRoaXMucHJvbWlzZTsKICAgIH0sCiAgICAvKioKICAgICAqIHJlamVjdCBkZWZlciBvYmplY3QncyBwcm9taXNlCiAgICAgKiBAcGFyYW0gcmVhc29uCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBkZWZlciBvYmplY3QncyBwcm9taXNlCiAgICAgKi8KICAgIHJlamVjdDogZnVuY3Rpb24gKHJlYXNvbikgewogICAgICByZXR1cm4gdGhpcy5yZXNvbHZlKG5ldyBSZWplY3QocmVhc29uKSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBub3RpZnkgcHJvbWlzZSAncyBwcm9ncmVzcyBsaXN0ZW5lcnMKICAgICAqIEBwYXJhbSBtZXNzYWdlCiAgICAgKi8KICAgIG5vdGlmeTogZnVuY3Rpb24gKG1lc3NhZ2UpIHsKICAgICAgaWYgKHRoaXMucHJvbWlzZVtQUk9NSVNFX1NUQVRVU10gIT09IFBFTkRJTkcpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICBlYWNoKHRoaXMucHJvbWlzZVtQUk9NSVNFX1BST0dSRVNTX0xJU1RFTkVSU10sIGZ1bmN0aW9uIChsaXN0ZW5lcikgewogICAgICAgIGxpc3RlbmVyKG1lc3NhZ2UpOwogICAgICB9KTsKICAgIH0KICB9OwogIGZ1bmN0aW9uIGlzUHJvbWlzZShvYmopIHsKICAgIHJldHVybiBvYmogJiYgb2JqIGluc3RhbmNlb2YgUHJvbWlzZTsKICB9CiAgZnVuY3Rpb24gYmluZChmbiwgY29udGV4dCkgewogICAgcmV0dXJuIGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuIGZuLmFwcGx5KGNvbnRleHQsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0KICAvKioKICAgKiBAY2xhc3MgUHJvbWlzZQogICAqIFByb21pc2UgY29uc3RydWN0b3IuCiAgICogVGhpcyBjbGFzcyBzaG91bGQgbm90IGJlIGluc3RhbnRpYXRlZCBtYW51YWxseS4KICAgKiBJbnN0YW5jZXMgd2lsbCBiZSBjcmVhdGVkIGFuZCByZXR1cm5lZCBhcyBuZWVkZWQgYnkge0BsaW5rIERlZmVyI3Byb21pc2V9CiAgICogQHBhcmFtIFt2XSBwcm9taXNlICdzIHJlc29sdmVkIHZhbHVlCiAgICovCiAgZnVuY3Rpb24gUHJvbWlzZSh2KSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICBzZWxmW1BST01JU0VfUEVORElOR1NdID0gW107CiAgICBzZWxmW1BST01JU0VfUFJPR1JFU1NfTElTVEVORVJTXSA9IFtdOwogICAgaWYgKCF2KSB7CiAgICAgIHNlbGZbUFJPTUlTRV9TVEFUVVNdID0gUEVORElORzsKICAgIH0gZWxzZSBpZiAodHlwZW9mIHYgPT09ICdmdW5jdGlvbicpIHsKICAgICAgc2VsZltQUk9NSVNFX1NUQVRVU10gPSBQRU5ESU5HOwogICAgICB2YXIgZGVmZXIgPSBuZXcgRGVmZXIoc2VsZik7CiAgICAgIHZhciByZXNvbHZlID0gYmluZChkZWZlci5yZXNvbHZlLCBkZWZlcik7CiAgICAgIHZhciByZWplY3QgPSBiaW5kKGRlZmVyLnJlamVjdCwgZGVmZXIpOwogICAgICB0cnkgewogICAgICAgIHYocmVzb2x2ZSwgcmVqZWN0KTsKICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgIHJlamVjdChlKTsKICAgICAgICB0aHJvdyBuZXcgRXJyb3IoZS5zdGFjayB8fCBlKTsKICAgICAgfQogICAgfSBlbHNlIHsKICAgICAgc2VsZltQUk9NSVNFX1NUQVRVU10gPSBGVUxGSUxMRUQ7CiAgICB9CiAgfQogIFByb21pc2UucHJvdG90eXBlID0gewogICAgY29uc3RydWN0b3I6IFByb21pc2UsCiAgICAvKioKICAgICAqIHJlZ2lzdGVyIGNhbGxiYWNrcyB3aGVuIHRoaXMgcHJvbWlzZSBvYmplY3QgaXMgcmVzb2x2ZWQKICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bGZpbGxlZCBjYWxsZWQgd2hlbiByZXNvbHZlZCBzdWNjZXNzZnVsbHkscGFzcyBhIHJlc29sdmVkIHZhbHVlIHRvIHRoaXMgZnVuY3Rpb24gYW5kCiAgICAgKiByZXR1cm4gYSB2YWx1ZSAoY291bGQgYmUgcHJvbWlzZSBvYmplY3QpIGZvciB0aGUgbmV3IHByb21pc2UgJ3MgcmVzb2x2ZWQgdmFsdWUuCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVqZWN0ZWRdIGNhbGxlZCB3aGVuIGVycm9yIG9jY3VycyxwYXNzIGVycm9yIHJlYXNvbiB0byB0aGlzIGZ1bmN0aW9uIGFuZAogICAgICogcmV0dXJuIGEgbmV3IHJlYXNvbiBmb3IgdGhlIG5ldyBwcm9taXNlICdzIGVycm9yIHJlYXNvbgogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3Byb2dyZXNzTGlzdGVuZXJdIHByb2dyZXNzIGxpc3RlbmVyCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBhIG5ldyBwcm9taXNlIG9iamVjdAogICAgICovCiAgICB0aGVuOiBmdW5jdGlvbiAoZnVsZmlsbGVkLCByZWplY3RlZCwgcHJvZ3Jlc3NMaXN0ZW5lcikgewogICAgICBpZiAocHJvZ3Jlc3NMaXN0ZW5lcikgewogICAgICAgIHRoaXMucHJvZ3Jlc3MocHJvZ3Jlc3NMaXN0ZW5lcik7CiAgICAgIH0KICAgICAgcmV0dXJuIHdoZW4odGhpcywgZnVsZmlsbGVkLCByZWplY3RlZCk7CiAgICB9LAogICAgLyoqCiAgICAgKiBjYWxsIHByb2dyZXNzIGxpc3RlbmVyIHdoZW4gZGVmZXIubm90aWZ5IGlzIGNhbGxlZAogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3Byb2dyZXNzTGlzdGVuZXJdIHByb2dyZXNzIGxpc3RlbmVyCiAgICAgKi8KICAgIHByb2dyZXNzOiBmdW5jdGlvbiAocHJvZ3Jlc3NMaXN0ZW5lcikgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHZhciBsaXN0ZW5lcnMgPSBzZWxmW1BST01JU0VfUFJPR1JFU1NfTElTVEVORVJTXTsKICAgICAgaWYgKHNlbGZbUFJPTUlTRV9TVEFUVVNdICE9PSBQRU5ESU5HKSB7CiAgICAgICAgcmV0dXJuIHNlbGY7CiAgICAgIH0KICAgICAgaWYgKCFsaXN0ZW5lcnMpIHsKICAgICAgICBsaXN0ZW5lcnMgPSBzZWxmW1BST01JU0VfUFJPR1JFU1NfTElTVEVORVJTXSA9IFtdOwogICAgICB9CiAgICAgIGxpc3RlbmVycy5wdXNoKHByb2dyZXNzTGlzdGVuZXIpOwogICAgICByZXR1cm4gc2VsZjsKICAgIH0sCiAgICAvKioKICAgICAqIGNhbGwgcmVqZWN0ZWQgY2FsbGJhY2sgd2hlbiB0aGlzIHByb21pc2Ugb2JqZWN0IGlzIHJlamVjdGVkCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSByZWplY3RlZCBjYWxsZWQgd2l0aCByZWplY3RlZCByZWFzb24KICAgICAqIEByZXR1cm4ge1Byb21pc2V9IGEgbmV3IHByb21pc2Ugb2JqZWN0CiAgICAgKi8KICAgIGZhaWw6IGZ1bmN0aW9uIChyZWplY3RlZCkgewogICAgICByZXR1cm4gdGhpcy50aGVuKDAsIHJlamVjdGVkKTsKICAgIH0sCiAgICAvKioKICAgICAqIGNhbGwgY2FsbGJhY2sgd2hlbiB0aGlzIHByb21pc2Ugb2JqZWN0IGlzIHJlamVjdGVkIG9yIHJlc29sdmVkCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBjYWxsYmFjayB0aGUgc2Vjb25kIHBhcmFtZXRlciBpcwogICAgICogdHJ1ZSB3aGVuIHJlc29sdmVkIGFuZCBmYWxzZSB3aGVuIHJlamVjdGVkCiAgICAgKiBAQHJldHVybiB7UHJvbWlzZX0gYSBuZXcgcHJvbWlzZSBvYmplY3QKICAgICAqLwogICAgZmluOiBmdW5jdGlvbiAoY2FsbGJhY2spIHsKICAgICAgcmV0dXJuIHRoaXMudGhlbihmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICByZXR1cm4gY2FsbGJhY2sodmFsdWUsIHRydWUpOwogICAgICB9LCBmdW5jdGlvbiAocmVhc29uKSB7CiAgICAgICAgcmV0dXJuIGNhbGxiYWNrKHJlYXNvbiwgZmFsc2UpOwogICAgICB9KTsKICAgIH0sCiAgICAvKioKICAgICAqIHJlZ2lzdGVyIGNhbGxiYWNrcyB3aGVuIHRoaXMgcHJvbWlzZSBvYmplY3QgaXMgcmVzb2x2ZWQsCiAgICAgKiBhbmQgdGhyb3cgZXJyb3IgYXQgbmV4dCBldmVudCBsb29wIGlmIHByb21pc2UKICAgICAqIChjdXJyZW50IGluc3RhbmNlIGlmIG5vIGZ1bGZpbGxlZCBhbmQgcmVqZWN0ZWQgcGFyYW1ldGVyIG9yCiAgICAgKiBuZXcgaW5zdGFuY2UgY2F1c2VkIGJ5IGNhbGwgdGhpcy50aGVuKGZ1bGZpbGxlZCwgcmVqZWN0ZWQpKQogICAgICogZmFpbHMuCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbZnVsZmlsbGVkXSBjYWxsZWQgd2hlbiByZXNvbHZlZCBzdWNjZXNzZnVsbHkscGFzcyBhIHJlc29sdmVkIHZhbHVlIHRvIHRoaXMgZnVuY3Rpb24gYW5kCiAgICAgKiByZXR1cm4gYSB2YWx1ZSAoY291bGQgYmUgcHJvbWlzZSBvYmplY3QpIGZvciB0aGUgbmV3IHByb21pc2UgJ3MgcmVzb2x2ZWQgdmFsdWUuCiAgICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbcmVqZWN0ZWRdIGNhbGxlZCB3aGVuIGVycm9yIG9jY3VycyxwYXNzIGVycm9yIHJlYXNvbiB0byB0aGlzIGZ1bmN0aW9uIGFuZAogICAgICogcmV0dXJuIGEgbmV3IHJlYXNvbiBmb3IgdGhlIG5ldyBwcm9taXNlICdzIGVycm9yIHJlYXNvbgogICAgICovCiAgICBkb25lOiBmdW5jdGlvbiAoZnVsZmlsbGVkLCByZWplY3RlZCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIHZhciBvblVuaGFuZGxlZEVycm9yID0gZnVuY3Rpb24gKGUpIHsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHRocm93IGU7CiAgICAgICAgfSwgMCk7CiAgICAgIH07CiAgICAgIHZhciBwcm9taXNlVG9IYW5kbGUgPSBmdWxmaWxsZWQgfHwgcmVqZWN0ZWQgPyBzZWxmLnRoZW4oZnVsZmlsbGVkLCByZWplY3RlZCkgOiBzZWxmOwogICAgICBwcm9taXNlVG9IYW5kbGUuZmFpbChvblVuaGFuZGxlZEVycm9yKTsKICAgIH0sCiAgICAvKioKICAgICAqIHdoZXRoZXIgdGhlIGdpdmVuIG9iamVjdCBpcyBhIHJlc29sdmVkIHByb21pc2UKICAgICAqIGlmIGl0IGlzIHJlc29sdmVkIHdpdGggYW5vdGhlciBwcm9taXNlLAogICAgICogdGhlbiB0aGF0IHByb21pc2UgbmVlZHMgdG8gYmUgcmVzb2x2ZWQgYXMgd2VsbC4KICAgICAqIEBtZW1iZXIgUHJvbWlzZQogICAgICovCiAgICBpc1Jlc29sdmVkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBpc1Jlc29sdmVkKHRoaXMpOwogICAgfSwKICAgIC8qKgogICAgICogd2hldGhlciB0aGUgZ2l2ZW4gb2JqZWN0IGlzIGEgcmVqZWN0ZWQgcHJvbWlzZQogICAgICovCiAgICBpc1JlamVjdGVkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBpc1JlamVjdGVkKHRoaXMpOwogICAgfQogIH07CiAgLyoqCiAgICogU3VnYXIgZm9yIHByb21pc2UudGhlbih1bmRlZmluZWQsIG9uUmVqZWN0ZWQpCiAgICogQG1ldGhvZCBjYXRjaAogICAqIEBtZW1iZXIge1Byb21pc2V9CiAgICovCiAgLyogZXNsaW50LWRpc2FibGUgKi8KICBQcm9taXNlLnByb3RvdHlwZVsnY2F0Y2gnXSA9IFByb21pc2UucHJvdG90eXBlLmZhaWw7CiAgLyogZXNsaW50LWVuYWJsZSAqLwogIC8qKgogICAqIFJlamVjdCBwcm9taXNlCiAgICogQHBhcmFtIHtTdHJpbmd8UHJvbWlzZS5SZWplY3R9IHJlYXNvbiByZWplY3QgcmVhc29uCiAgICogQGNsYXNzIFByb21pc2UuUmVqZWN0CiAgICogQGV4dGVuZCBQcm9taXNlCiAgICogQHByaXZhdGUKICAgKi8KICBmdW5jdGlvbiBSZWplY3QocmVhc29uKSB7CiAgICBpZiAocmVhc29uIGluc3RhbmNlb2YgUmVqZWN0KSB7CiAgICAgIHJldHVybiByZWFzb247CiAgICB9CiAgICB0aGlzLnJlYXNvbiA9IHJlYXNvbjsKICB9CiAgLy8gd3JhcCBmb3IgcHJvbWlzZVdoZW4KICBmdW5jdGlvbiB3aGVuKHZhbHVlLCBmdWxmaWxsZWQsIHJlamVjdGVkKSB7CiAgICB2YXIgZGVmZXIgPSBuZXcgRGVmZXIoKTsKICAgIHZhciBkb25lID0gMDsKICAgIC8vIHdyYXAgdXNlcidzIGNhbGxiYWNrIHRvIGNhdGNoIGV4Y2VwdGlvbgogICAgZnVuY3Rpb24gX2Z1bGZpbGxlZCh2YWwpIHsKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gZnVsZmlsbGVkID8gZnVsZmlsbGVkLmNhbGwodGhpcywgdmFsKSA6IC8qIHByb3BhZ2F0ZSAqLwogICAgICAgIHZhbDsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAvLyBjYW4gbm90IHVzZSBsb2dnZXIuZXJyb3IKICAgICAgICAvLyBtdXN0IGV4cG9zZSB0byB1c2VyCiAgICAgICAgLy8gcHJpbnQgc3RhY2sgaW5mbyBmb3IgZmlyZWZveC9jaHJvbWUKICAgICAgICAvKiBlc2xpbnQtZGlzYWJsZSAqLwogICAgICAgIGlmICh3aW5kb3cuY29uc29sZSkgewogICAgICAgICAgY29uc29sZS5lcnJvcihleC5zdGFjayB8fCBleCk7CiAgICAgICAgfQogICAgICAgIC8qIGVzbGludC1lbmFibGUgKi8KICAgICAgICByZXR1cm4gbmV3IFJlamVjdChleCk7CiAgICAgIH0KICAgIH0KICAgIGZ1bmN0aW9uIF9yZWplY3RlZChyZWFzb24pIHsKICAgICAgdHJ5IHsKICAgICAgICByZXR1cm4gcmVqZWN0ZWQgPyAvKiBlcnJvciByZWNvdmVyeSAqLwogICAgICAgIHJlamVjdGVkLmNhbGwodGhpcywgcmVhc29uKSA6IC8qIHByb3BhZ2F0ZSAqLwogICAgICAgIG5ldyBSZWplY3QocmVhc29uKTsKICAgICAgfSBjYXRjaCAoZXgpIHsKICAgICAgICAvLyBwcmludCBzdGFjayBpbmZvIGZvciBmaXJlZm94L2Nocm9tZQogICAgICAgIC8qIGVzbGludC1kaXNhYmxlICovCiAgICAgICAgaWYgKHdpbmRvdy5jb25zb2xlKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKGV4LnN0YWNrIHx8IGV4KTsKICAgICAgICB9CiAgICAgICAgLyogZXNsaW50LWVuYWJsZSAqLwogICAgICAgIHJldHVybiBuZXcgUmVqZWN0KGV4KTsKICAgICAgfQogICAgfQogICAgZnVuY3Rpb24gZmluYWxGdWxmaWxsKHZhbCkgewogICAgICBpZiAoZG9uZSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBkb25lID0gMTsKICAgICAgZGVmZXIucmVzb2x2ZShfZnVsZmlsbGVkLmNhbGwodGhpcywgdmFsKSk7CiAgICB9CiAgICBpZiAoaXNUaGVuYWJsZSh2YWx1ZSkpIHsKICAgICAgcHJvbWlzZVdoZW4odmFsdWUsIGZpbmFsRnVsZmlsbCwgZnVuY3Rpb24gKHJlYXNvbikgewogICAgICAgIGlmIChkb25lKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGRvbmUgPSAxOwogICAgICAgIC8vIF9yZWplY3QgbWF5IHJldHVybiBub24tUmVqZWN0IG9iamVjdCBmb3IgZXJyb3IgcmVjb3ZlcnkKICAgICAgICBkZWZlci5yZXNvbHZlKF9yZWplY3RlZC5jYWxsKHRoaXMsIHJlYXNvbikpOwogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGZpbmFsRnVsZmlsbCh2YWx1ZSk7CiAgICB9CiAgICAvLyBjaGFpbmVkIGFuZCBsZXZlbGVkCiAgICAvLyB3YWl0IGZvciB2YWx1ZSdzIHJlc29sdmUKICAgIHJldHVybiBkZWZlci5wcm9taXNlOwogIH0KICBmdW5jdGlvbiBpc1Jlc29sdmVkKG9iaikgewogICAgLy8gZXhjbHVkZSBSZWplY3QgYXQgZmlyc3QKICAgIHJldHVybiBvYmogJiYgb2JqW1BST01JU0VfU1RBVFVTXSA9PT0gRlVMRklMTEVEOwogIH0KICBmdW5jdGlvbiBpc1JlamVjdGVkKG9iaikgewogICAgLy8gaW1wbGljaXQgYnkgb2JqW1BST01JU0VfVkFMVUVdCiAgICAvLyBpc1Byb21pc2Uob2JqKSAmJgogICAgcmV0dXJuIG9iaiAmJiBvYmpbUFJPTUlTRV9TVEFUVVNdID09PSBSRUpFQ1RFRDsKICB9CiAgUHJvbWlzZS5EZWZlciA9IERlZmVyOwogIG1peChQcm9taXNlLCB7CiAgICAvKioKICAgICAqIHJlZ2lzdGVyIGNhbGxiYWNrcyB3aGVuIG9iaiBhcyBhIHByb21pc2UgaXMgcmVzb2x2ZWQKICAgICAqIG9yIGNhbGwgZnVsZmlsbGVkIGNhbGxiYWNrIGRpcmVjdGx5IHdoZW4gb2JqIGlzIG5vdCBhIHByb21pc2Ugb2JqZWN0CiAgICAgKiBAcGFyYW0ge1Byb21pc2V8Kn0gb2JqIGEgcHJvbWlzZSBvYmplY3Qgb3IgdmFsdWUgb2YgYW55IHR5cGUKICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZ1bGZpbGxlZCBjYWxsZWQgd2hlbiBvYmogcmVzb2x2ZWQgc3VjY2Vzc2Z1bGx5LHBhc3MgYSByZXNvbHZlZCB2YWx1ZSB0byB0aGlzIGZ1bmN0aW9uIGFuZAogICAgICogcmV0dXJuIGEgdmFsdWUgKGNvdWxkIGJlIHByb21pc2Ugb2JqZWN0KSBmb3IgdGhlIG5ldyBwcm9taXNlICdzIHJlc29sdmVkIHZhbHVlLgogICAgICogQHBhcmFtIHtGdW5jdGlvbn0gW3JlamVjdGVkXSBjYWxsZWQgd2hlbiBlcnJvciBvY2N1cnMgaW4gb2JqLHBhc3MgZXJyb3IgcmVhc29uIHRvIHRoaXMgZnVuY3Rpb24gYW5kCiAgICAgKiByZXR1cm4gYSBuZXcgcmVhc29uIGZvciB0aGUgbmV3IHByb21pc2UgJ3MgZXJyb3IgcmVhc29uCiAgICAgKiBAcmV0dXJuIHtQcm9taXNlfSBhIG5ldyBwcm9taXNlIG9iamVjdAogICAgICoKICAgICAqIGZvciBleGFtcGxlOgogICAgICogQGV4YW1wbGUKICAgICAqIGZ1bmN0aW9uIGNoZWNrKHApIHsKICAgICogICBQcm9taXNlLndoZW4ocCwgZnVuY3Rpb24odil7CiAgICAqICAgICBhbGVydCh2ID09PSAxKTsKICAgICogICB9KTsKICAgICogfQogICAgICoKICAgICAqIHZhciBkZWZlciA9IFMuRGVmZXIoKTsKICAgICAqIGRlZmVyLnJlc29sdmUoMSk7CiAgICAgKgogICAgICogY2hlY2soMSk7IC8vID0+IGFsZXJ0KHRydWUpCiAgICAgKgogICAgICogY2hlY2soZGVmZXIucHJvbWlzZSk7IC8vPT4gYWxlcnQodHJ1ZSk7CiAgICAgKgogICAgICogQHN0YXRpYwogICAgICogQG1ldGhvZAogICAgICogQG1lbWJlciBQcm9taXNlCiAgICAgKi8KICAgIHdoZW46IHdoZW4sCiAgICAvKioKICAgICAqIFJldHVybnMgcHJvbWlzZSAob25seSBpZiBwcm9taXNlLmNvbnN0cnVjdG9yID09IFByb21pc2UpCiAgICAgKiBvcgogICAgICogTWFrZSBhIHByb21pc2UgdGhhdCBmdWxmaWxscyB0byBvYmouCiAgICAgKi8KICAgIGNhc3Q6IGZ1bmN0aW9uIChvYmopIHsKICAgICAgaWYgKG9iaiBpbnN0YW5jZW9mIFByb21pc2UpIHsKICAgICAgICByZXR1cm4gb2JqOwogICAgICB9CiAgICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSkgewogICAgICAgIHJlc29sdmUob2JqKTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBNYWtlIGEgcHJvbWlzZSB0aGF0IGZ1bGZpbGxzIHRvIG9iai4KICAgICAqLwogICAgcmVzb2x2ZTogZnVuY3Rpb24gKG9iaikgewogICAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUpIHsKICAgICAgICByZXNvbHZlKG9iaik7CiAgICAgIH0pOwogICAgfSwKICAgIC8qKgogICAgICogTWFrZSBhIHByb21pc2UgdGhhdCByZWplY3RzIHRvIG9iai4gRm9yIGNvbnNpc3RlbmN5IGFuZCBkZWJ1Z2dpbmcgKGUuZy4gc3RhY2sgdHJhY2VzKSwgb2JqIHNob3VsZCBiZSBhbiBpbnN0YW5jZW9mIEVycm9yLgogICAgICogQHBhcmFtIHJlYXNvbgogICAgICogQHJldHVybnMge1Byb21pc2UuUmVqZWN0fQogICAgICovCiAgICByZWplY3Q6IGZ1bmN0aW9uIChyZWFzb24pIHsKICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKGZ1bmN0aW9uIChyZXNvbHZlLCByZWplY3QpIHsKICAgICAgICByZWplY3QocmVhc29uKTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqCiAgICAgKiB3aGV0aGVyIHRoZSBnaXZlbiBvYmplY3QgaXMgYSBwcm9taXNlCiAgICAgKiBAbWV0aG9kCiAgICAgKiBAc3RhdGljCiAgICAgKiBAcGFyYW0gb2JqIHRoZSB0ZXN0ZWQgb2JqZWN0CiAgICAgKiBAcmV0dXJuIHtCb29sZWFufQogICAgICogQG1lbWJlciBQcm9taXNlCiAgICAgKi8KICAgIGlzUHJvbWlzZTogaXNQcm9taXNlLAogICAgLyoqCiAgICAgKiB3aGV0aGVyIHRoZSBnaXZlbiBvYmplY3QgaXMgYSByZXNvbHZlZCBwcm9taXNlCiAgICAgKiBAbWV0aG9kCiAgICAgKiBAc3RhdGljCiAgICAgKiBAcGFyYW0gb2JqIHRoZSB0ZXN0ZWQgb2JqZWN0CiAgICAgKiBAcmV0dXJuIHtCb29sZWFufQogICAgICogQG1lbWJlciBQcm9taXNlCiAgICAgKi8KICAgIGlzUmVzb2x2ZWQ6IGlzUmVzb2x2ZWQsCiAgICAvKioKICAgICAqIHdoZXRoZXIgdGhlIGdpdmVuIG9iamVjdCBpcyBhIHJlamVjdGVkIHByb21pc2UKICAgICAqIEBtZXRob2QKICAgICAqIEBzdGF0aWMKICAgICAqIEBwYXJhbSBvYmogdGhlIHRlc3RlZCBvYmplY3QKICAgICAqIEByZXR1cm4ge0Jvb2xlYW59CiAgICAgKiBAbWVtYmVyIFByb21pc2UKICAgICAqLwogICAgaXNSZWplY3RlZDogaXNSZWplY3RlZCwKICAgIC8qKgogICAgICogcmV0dXJuIGEgbmV3IHByb21pc2UKICAgICAqIHdoaWNoIGlzIHJlc29sdmVkIHdoZW4gYWxsIHByb21pc2VzIGlzIHJlc29sdmVkCiAgICAgKiBhbmQgcmVqZWN0ZWQgd2hlbiBhbnkgb25lIG9mIHByb21pc2VzIGlzIHJlamVjdGVkCiAgICAgKiBAcGFyYW0ge1Byb21pc2VbXX0gcHJvbWlzZXMgbGlzdCBvZiBwcm9taXNlcwogICAgICogQHN0YXRpYwogICAgICogQHJldHVybiB7UHJvbWlzZX0KICAgICAqIEBtZW1iZXIgUHJvbWlzZQogICAgICovCiAgICBhbGw6IGZ1bmN0aW9uIChwcm9taXNlcykgewogICAgICB2YXIgY291bnQgPSBwcm9taXNlcy5sZW5ndGg7CiAgICAgIGlmICghY291bnQpIHsKICAgICAgICByZXR1cm4gbnVsbDsKICAgICAgfQogICAgICB2YXIgZGVmZXIgPSBuZXcgRGVmZXIoKTsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBwcm9taXNlcy5sZW5ndGg7IGkrKykgewogICAgICAgIC8qanNoaW50IGxvb3BmdW5jOnRydWUqLwogICAgICAgIChmdW5jdGlvbiAocHJvbWlzZSwgaikgewogICAgICAgICAgd2hlbihwcm9taXNlLCBmdW5jdGlvbiAodmFsdWUpIHsKICAgICAgICAgICAgcHJvbWlzZXNbal0gPSB2YWx1ZTsKICAgICAgICAgICAgaWYgKC0tY291bnQgPT09IDApIHsKICAgICAgICAgICAgICAvLyBpZiBhbGwgaXMgcmVzb2x2ZWQKICAgICAgICAgICAgICAvLyB0aGVuIHJlc29sdmUgZmluYWwgcmV0dXJuZWQgcHJvbWlzZSB3aXRoIGFsbCB2YWx1ZQogICAgICAgICAgICAgIGRlZmVyLnJlc29sdmUocHJvbWlzZXMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9LCBmdW5jdGlvbiAocikgewogICAgICAgICAgICAvLyBpZiBhbnkgb25lIGlzIHJlamVjdGVkCiAgICAgICAgICAgIC8vIHRoZW4gcmVqZWN0IGZpbmFsIHJldHVybiBwcm9taXNlIHdpdGggZmlyc3QgcmVhc29uCiAgICAgICAgICAgIGRlZmVyLnJlamVjdChyKTsKICAgICAgICAgIH0pOwogICAgICAgIH0ocHJvbWlzZXNbaV0sIGkpKTsKICAgICAgfQogICAgICByZXR1cm4gZGVmZXIucHJvbWlzZTsKICAgIH0sCiAgICAvKioKICAgICAqIHByb3ZpZGUgZXM2IGdlbmVyYXRvcgogICAgICogQHBhcmFtIGdlbmVyYXRvckZ1bmMgZXM2IGdlbmVyYXRvciBmdW5jdGlvbiB3aGljaCBoYXMgeWllbGRlZCBwcm9taXNlCiAgICAgKi8KICAgIGFzeW5jOiBmdW5jdGlvbiAoZ2VuZXJhdG9yRnVuYykgewogICAgICByZXR1cm4gZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBnZW5lcmF0b3IgPSBnZW5lcmF0b3JGdW5jLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgICAgZnVuY3Rpb24gZG9BY3Rpb24oYWN0aW9uLCBhcmcpIHsKICAgICAgICAgIHZhciByZXN1bHQ7CiAgICAgICAgICByZXN1bHQgPSBnZW5lcmF0b3JbYWN0aW9uXShhcmcpOwogICAgICAgICAgaWYgKHJlc3VsdC5kb25lKSB7CiAgICAgICAgICAgIHJldHVybiByZXN1bHQudmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gd2hlbihyZXN1bHQudmFsdWUsIG5leHQsIHRocm93RXgpOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiBuZXh0KHYpIHsKICAgICAgICAgIHJldHVybiBkb0FjdGlvbignbmV4dCcsIHYpOwogICAgICAgIH0KICAgICAgICBmdW5jdGlvbiB0aHJvd0V4KGV4KSB7CiAgICAgICAgICByZXR1cm4gZG9BY3Rpb24oJ3Rocm93JywgZXgpOwogICAgICAgIH0KICAgICAgICB0cnkgewogICAgICAgICAgcmV0dXJuIG5leHQoKTsKICAgICAgICB9IGNhdGNoIChleCkgewogICAgICAgICAgcmV0dXJuIFByb21pc2UucmVqZWN0KGV4KTsKICAgICAgICB9CiAgICAgIH07CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IFByb21pc2U7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcHJvbWlzZUluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICBleHBvcnRzID0gcHJvbWlzZUxpYlByb21pc2U7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIHByb21pc2VJbmRleDsKfSk7ZGVmaW5lKCJkb20tYmFzZSIsIFsndXRpbCcsImlvLXNjcmlwdCIsImZlYXR1cmUiLCdxdWVyeS1zZWxlY3RvciddLCBmdW5jdGlvbihyZXF1aXJlKSB7CnZhciB1dGlsQmFzZSA9IHJlcXVpcmUoJ3V0aWwnKTsKdmFyIGlvU2NyaXB0ID0gcmVxdWlyZSgiaW8tc2NyaXB0Iik7CnZhciBmZWF0dXJlID0gcmVxdWlyZSgiZmVhdHVyZSIpOwp2YXIgcXVlcnlTZWxlY3RvckJhc2UgPSByZXF1aXJlKCdxdWVyeS1zZWxlY3RvcicpOwovLyEgQ29weXJpZ2h0IDIwMTUsIGRvbS1iYXNlQDYuMS4yIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogV2VkLCAxNiBEZWMgMjAxNSAwODowNzo1MyBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmRvbS1iYXNlCmRvbS1iYXNlL2xpYi9tYWluCmRvbS1iYXNlL2xpYi9tYWluL2FwaQpkb20tYmFzZS9saWIvbWFpbi9hdHRyCmRvbS1iYXNlL2xpYi9tYWluL2NsYXNzCmRvbS1iYXNlL2xpYi9tYWluL2NyZWF0ZQpkb20tYmFzZS9saWIvbWFpbi9kYXRhCmRvbS1iYXNlL2xpYi9tYWluL2luc2VydGlvbgpkb20tYmFzZS9saWIvbWFpbi9vZmZzZXQKZG9tLWJhc2UvbGliL21haW4vc3R5bGUKZG9tLWJhc2UvbGliL21haW4vc2VsZWN0b3IKZG9tLWJhc2UvbGliL21haW4vdHJhdmVyc2FsCiovCnZhciBkb21CYXNlTGliTWFpbkFwaSwgZG9tQmFzZUxpYk1haW5BdHRyLCBkb21CYXNlTGliTWFpbkNsYXNzLCBkb21CYXNlTGliTWFpbkNyZWF0ZSwgZG9tQmFzZUxpYk1haW5EYXRhLCBkb21CYXNlTGliTWFpbkluc2VydGlvbiwgZG9tQmFzZUxpYk1haW5PZmZzZXQsIGRvbUJhc2VMaWJNYWluU3R5bGUsIGRvbUJhc2VMaWJNYWluU2VsZWN0b3IsIGRvbUJhc2VMaWJNYWluVHJhdmVyc2FsLCBkb21CYXNlTGliTWFpbiwgZG9tQmFzZUluZGV4Owpkb21CYXNlTGliTWFpbkFwaSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgLyoqCiAgICogQGlnbm9yZQogICAqIGRvbQogICAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tLCBsaWZlc2luZ2VyQGdtYWlsLmNvbQogICAqLwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIFdJTkRPVyA9IHdpbmRvdzsKICB2YXIgRE9DVU1FTlQgPSBXSU5ET1cuZG9jdW1lbnQ7CiAgdmFyIFJFX05VTSA9IC9bXC0rXT8oPzpcZCpcLnwpXGQrKD86W2VFXVtcLStdP1xkK3wpLy5zb3VyY2U7CiAgLyoqCiAgICogRG9tIEVsZW1lbnQgbm9kZSB0eXBlLgogICAqIEBlbnVtIHtOdW1iZXJ9IEtJU1NZLkRPTS5Ob2RlVHlwZQogICAqLwogIHZhciBOb2RlVHlwZSA9IHsKICAgIC8qKgogICAgICogZWxlbWVudCB0eXBlCiAgICAgKi8KICAgIEVMRU1FTlRfTk9ERTogMSwKICAgIC8qKgogICAgICogYXR0cmlidXRlIG5vZGUgdHlwZQogICAgICovCiAgICBBVFRSSUJVVEVfTk9ERTogMiwKICAgIC8qKgogICAgICogdGV4dCBub2RlIHR5cGUKICAgICAqLwogICAgVEVYVF9OT0RFOiAzLAogICAgLyoqCiAgICAgKiBjZGF0YSBub2RlIHR5cGUKICAgICAqLwogICAgQ0RBVEFfU0VDVElPTl9OT0RFOiA0LAogICAgLyoqCiAgICAgKiBlbnRpdHkgcmVmZXJlbmNlIG5vZGUgdHlwZQogICAgICovCiAgICBFTlRJVFlfUkVGRVJFTkNFX05PREU6IDUsCiAgICAvKioKICAgICAqIGVudGl0eSBub2RlIHR5cGUKICAgICAqLwogICAgRU5USVRZX05PREU6IDYsCiAgICAvKioKICAgICAqIHByb2Nlc3NpbmcgaW5zdHJ1Y3Rpb24gbm9kZSB0eXBlCiAgICAgKi8KICAgIFBST0NFU1NJTkdfSU5TVFJVQ1RJT05fTk9ERTogNywKICAgIC8qKgogICAgICogY29tbWVudCBub2RlIHR5cGUKICAgICAqLwogICAgQ09NTUVOVF9OT0RFOiA4LAogICAgLyoqCiAgICAgKiBkb2N1bWVudCBub2RlIHR5cGUKICAgICAqLwogICAgRE9DVU1FTlRfTk9ERTogOSwKICAgIC8qKgogICAgICogZG9jdW1lbnQgdHlwZQogICAgICovCiAgICBET0NVTUVOVF9UWVBFX05PREU6IDEwLAogICAgLyoqCiAgICAgKiBkb2N1bWVudCBmcmFnbWVudCB0eXBlCiAgICAgKi8KICAgIERPQ1VNRU5UX0ZSQUdNRU5UX05PREU6IDExLAogICAgLyoqCiAgICAgKiBub3RhdGlvbiB0eXBlCiAgICAgKi8KICAgIE5PVEFUSU9OX05PREU6IDEyCiAgfTsKICAvKioKICAgKiBLSVNTWSBEb20gVXRpbHMuCiAgICogUHJvdmlkZXMgRG9tIGhlbHBlciBtZXRob2RzLgogICAqIEBjbGFzcyBLSVNTWS5ET00KICAgKiBAc2luZ2xldG9uCiAgICovCiAgdmFyIERvbSA9IGV4cG9ydHMgPSB7CiAgICBpc0N1c3RvbURvbWFpbjogZnVuY3Rpb24gKHdpbikgewogICAgICB3aW4gPSB3aW4gfHwgV0lORE9XOwogICAgICB3aW4gPSBEb20uZ2V0KHdpbik7CiAgICAgIHZhciBkb21haW4gPSB3aW4uZG9jdW1lbnQuZG9tYWluOwogICAgICB2YXIgaG9zdG5hbWUgPSB3aW4ubG9jYXRpb24uaG9zdG5hbWU7CiAgICAgIHJldHVybiBkb21haW4gIT09IGhvc3RuYW1lICYmIGRvbWFpbiAhPT0gJ1snICsgaG9zdG5hbWUgKyAnXSc7CiAgICB9LAogICAgZ2V0RW1wdHlJZnJhbWVTcmM6IGZ1bmN0aW9uICgpIHsKICAgICAgcmV0dXJuICcnOwogICAgfSwKICAgIE5vZGVUeXBlOiBOb2RlVHlwZSwKICAgIGdldFdpbmRvdzogZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgZWxlbSA9IERvbS5nZXQoZWxlbSk7CiAgICAgIGlmICghZWxlbSB8fCAhZWxlbS5ub2RlVHlwZSkgewogICAgICAgIHJldHVybiBXSU5ET1c7CiAgICAgIH0KICAgICAgaWYgKHV0aWwuaXNXaW5kb3coZWxlbSkpIHsKICAgICAgICByZXR1cm4gZWxlbTsKICAgICAgfQogICAgICB2YXIgZG9jID0gZWxlbTsKICAgICAgaWYgKGRvYy5ub2RlVHlwZSAhPT0gTm9kZVR5cGUuRE9DVU1FTlRfTk9ERSkgewogICAgICAgIGRvYyA9IGVsZW0ub3duZXJEb2N1bWVudDsKICAgICAgfQogICAgICByZXR1cm4gZG9jLmRlZmF1bHRWaWV3IHx8IGRvYy5wYXJlbnRXaW5kb3c7CiAgICB9LAogICAgZ2V0RG9jdW1lbnQ6IGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIGlmICghZWxlbSkgewogICAgICAgIHJldHVybiBET0NVTUVOVDsKICAgICAgfQogICAgICBlbGVtID0gRG9tLmdldChlbGVtKTsKICAgICAgcmV0dXJuIHV0aWwuaXNXaW5kb3coZWxlbSkgPyBlbGVtLmRvY3VtZW50IDogZWxlbS5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuRE9DVU1FTlRfTk9ERSA/IGVsZW0gOiBlbGVtLm93bmVyRG9jdW1lbnQ7CiAgICB9LAogICAgaXNEb21Ob2RlTGlzdDogZnVuY3Rpb24gKG8pIHsKICAgICAgcmV0dXJuIG8gJiYgIW8ubm9kZVR5cGUgJiYgby5pdGVtICYmICFvLnNldFRpbWVvdXQ7CiAgICB9LAogICAgbm9kZU5hbWU6IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICB2YXIgZWwgPSBEb20uZ2V0KHNlbGVjdG9yKTsKICAgICAgdmFyIG5vZGVOYW1lID0gZWwubm9kZU5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgdmFyIHNjb3BlTmFtZSA9IGVsLnNjb3BlTmFtZTsKICAgICAgaWYgKHNjb3BlTmFtZSAmJiBzY29wZU5hbWUgIT09ICdIVE1MJykgewogICAgICAgIG5vZGVOYW1lID0gc2NvcGVOYW1lLnRvTG93ZXJDYXNlKCkgKyAnOicgKyBub2RlTmFtZTsKICAgICAgfQogICAgICByZXR1cm4gbm9kZU5hbWU7CiAgICB9LAogICAgX1JFX05VTV9OT19QWDogbmV3IFJlZ0V4cCgnXignICsgUkVfTlVNICsgJykoPyFweClbYS16JV0rJCcsICdpJykKICB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmRvbUJhc2VMaWJNYWluQXR0ciA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIE5vZGVUeXBlID0gRG9tLk5vZGVUeXBlOwogIHZhciBFTVBUWSA9ICcnOwogIHZhciBub2RlTmFtZSA9IERvbS5ub2RlTmFtZTsKICB2YXIgUl9CT09MRUFOID0gL14oPzphdXRvZm9jdXN8YXV0b3BsYXl8YXN5bmN8Y2hlY2tlZHxjb250cm9sc3xkZWZlcnxkaXNhYmxlZHxoaWRkZW58bG9vcHxtdWx0aXBsZXxvcGVufHJlYWRvbmx5fHJlcXVpcmVkfHNjb3BlZHxzZWxlY3RlZCkkL2k7CiAgdmFyIFJfRk9DVVNBQkxFID0gL14oPzpidXR0b258aW5wdXR8b2JqZWN0fHNlbGVjdHx0ZXh0YXJlYSkkL2k7CiAgdmFyIFJfQ0xJQ0tBQkxFID0gL15hKD86cmVhKT8kL2k7CiAgdmFyIFJfSU5WQUxJRF9DSEFSID0gLzp8Xm9uLzsKICB2YXIgUl9SRVRVUk4gPSAvXHIvZzsKICB2YXIgYXR0ckZpeCA9IHt9OwogIHZhciBhdHRyRm4gPSB7CiAgICB2YWw6IDEsCiAgICBjc3M6IDEsCiAgICBodG1sOiAxLAogICAgdGV4dDogMSwKICAgIGRhdGE6IDEsCiAgICB3aWR0aDogMSwKICAgIGhlaWdodDogMSwKICAgIG9mZnNldDogMSwKICAgIHNjcm9sbFRvcDogMSwKICAgIHNjcm9sbExlZnQ6IDEKICB9OwogIHZhciBhdHRySG9va3MgPSB7CiAgICB0YWJpbmRleDogewogICAgICBnZXQ6IGZ1bmN0aW9uIChlbCkgewogICAgICAgIHZhciBhdHRyaWJ1dGVOb2RlID0gZWwuZ2V0QXR0cmlidXRlTm9kZSgndGFiaW5kZXgnKTsKICAgICAgICByZXR1cm4gYXR0cmlidXRlTm9kZSAmJiBhdHRyaWJ1dGVOb2RlLnNwZWNpZmllZCA/IHBhcnNlSW50KGF0dHJpYnV0ZU5vZGUudmFsdWUsIDEwKSA6IFJfRk9DVVNBQkxFLnRlc3QoZWwubm9kZU5hbWUpIHx8IFJfQ0xJQ0tBQkxFLnRlc3QoZWwubm9kZU5hbWUpICYmIGVsLmhyZWYgPyAwIDogdW5kZWZpbmVkOwogICAgICB9CiAgICB9CiAgfTsKICB2YXIgcHJvcEZpeCA9IHsKICAgIGhpZGVmb2N1czogJ2hpZGVGb2N1cycsCiAgICB0YWJpbmRleDogJ3RhYkluZGV4JywKICAgIHJlYWRvbmx5OiAncmVhZE9ubHknLAogICAgJ2Zvcic6ICdodG1sRm9yJywKICAgICdjbGFzcyc6ICdjbGFzc05hbWUnLAogICAgbWF4bGVuZ3RoOiAnbWF4TGVuZ3RoJywKICAgIGNlbGxzcGFjaW5nOiAnY2VsbFNwYWNpbmcnLAogICAgY2VsbHBhZGRpbmc6ICdjZWxsUGFkZGluZycsCiAgICByb3dzcGFuOiAncm93U3BhbicsCiAgICBjb2xzcGFuOiAnY29sU3BhbicsCiAgICB1c2VtYXA6ICd1c2VNYXAnLAogICAgZnJhbWVib3JkZXI6ICdmcmFtZUJvcmRlcicsCiAgICBjb250ZW50ZWRpdGFibGU6ICdjb250ZW50RWRpdGFibGUnCiAgfTsKICB2YXIgYm9vbEhvb2sgPSB7CiAgICBnZXQ6IGZ1bmN0aW9uIChlbGVtLCBuYW1lKSB7CiAgICAgIHJldHVybiBEb20ucHJvcChlbGVtLCBuYW1lKSA/IG5hbWUudG9Mb3dlckNhc2UoKSA6IHVuZGVmaW5lZDsKICAgIH0sCiAgICBzZXQ6IGZ1bmN0aW9uIChlbGVtLCB2YWx1ZSwgbmFtZSkgewogICAgICB2YXIgcHJvcE5hbWU7CiAgICAgIGlmICh2YWx1ZSA9PT0gZmFsc2UpIHsKICAgICAgICBEb20ucmVtb3ZlQXR0cihlbGVtLCBuYW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBwcm9wTmFtZSA9IHByb3BGaXhbbmFtZV0gfHwgbmFtZTsKICAgICAgICBpZiAocHJvcE5hbWUgaW4gZWxlbSkgewogICAgICAgICAgZWxlbVtwcm9wTmFtZV0gPSB0cnVlOwogICAgICAgIH0KICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZShuYW1lLCBuYW1lLnRvTG93ZXJDYXNlKCkpOwogICAgICB9CiAgICAgIHJldHVybiBuYW1lOwogICAgfQogIH07CiAgdmFyIHByb3BIb29rcyA9IHt9OwogIHZhciBhdHRyTm9kZUhvb2sgPSB7fTsKICB2YXIgdmFsSG9va3MgPSB7CiAgICBzZWxlY3Q6IHsKICAgICAgZ2V0OiBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIHZhciBpbmRleCA9IGVsZW0uc2VsZWN0ZWRJbmRleDsKICAgICAgICB2YXIgb3B0aW9ucyA9IGVsZW0ub3B0aW9uczsKICAgICAgICB2YXIgcmV0OwogICAgICAgIHZhciBpOwogICAgICAgIHZhciBsZW47CiAgICAgICAgdmFyIG9uZSA9IFN0cmluZyhlbGVtLnR5cGUpID09PSAnc2VsZWN0LW9uZSc7CiAgICAgICAgaWYgKGluZGV4IDwgMCkgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfSBlbHNlIGlmIChvbmUpIHsKICAgICAgICAgIHJldHVybiBEb20udmFsKG9wdGlvbnNbaW5kZXhdKTsKICAgICAgICB9CiAgICAgICAgcmV0ID0gW107CiAgICAgICAgaSA9IDA7CiAgICAgICAgbGVuID0gb3B0aW9ucy5sZW5ndGg7CiAgICAgICAgZm9yICg7IGkgPCBsZW47ICsraSkgewogICAgICAgICAgaWYgKG9wdGlvbnNbaV0uc2VsZWN0ZWQpIHsKICAgICAgICAgICAgcmV0LnB1c2goRG9tLnZhbChvcHRpb25zW2ldKSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH0sCiAgICAgIHNldDogZnVuY3Rpb24gKGVsZW0sIHZhbHVlKSB7CiAgICAgICAgdmFyIHZhbHVlcyA9IHV0aWwubWFrZUFycmF5KHZhbHVlKTsKICAgICAgICB2YXIgb3B0cyA9IGVsZW0ub3B0aW9uczsKICAgICAgICB1dGlsLmVhY2gob3B0cywgZnVuY3Rpb24gKG9wdCkgewogICAgICAgICAgb3B0LnNlbGVjdGVkID0gdXRpbC5pbkFycmF5KERvbS52YWwob3B0KSwgdmFsdWVzKTsKICAgICAgICB9KTsKICAgICAgICBpZiAoIXZhbHVlcy5sZW5ndGgpIHsKICAgICAgICAgIGVsZW0uc2VsZWN0ZWRJbmRleCA9IC0xOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdmFsdWVzOwogICAgICB9CiAgICB9CiAgfTsKICB1dGlsLmVhY2goWwogICAgJ3JhZGlvJywKICAgICdjaGVja2JveCcKICBdLCBmdW5jdGlvbiAocikgewogICAgdmFsSG9va3Nbcl0gPSB7CiAgICAgIGdldDogZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICByZXR1cm4gZWxlbS5nZXRBdHRyaWJ1dGUoJ3ZhbHVlJykgPT09IG51bGwgPyAnb24nIDogZWxlbS52YWx1ZTsKICAgICAgfSwKICAgICAgc2V0OiBmdW5jdGlvbiAoZWxlbSwgdmFsdWUpIHsKICAgICAgICBpZiAodXRpbC5pc0FycmF5KHZhbHVlKSkgewogICAgICAgICAgZWxlbS5jaGVja2VkID0gdXRpbC5pbkFycmF5KERvbS52YWwoZWxlbSksIHZhbHVlKTsKICAgICAgICAgIHJldHVybiAxOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CiAgICB9OwogIH0pOwogIGF0dHJIb29rcy5zdHlsZSA9IHsKICAgIGdldDogZnVuY3Rpb24gKGVsKSB7CiAgICAgIHJldHVybiBlbC5zdHlsZS5jc3NUZXh0OwogICAgfQogIH07CiAgZnVuY3Rpb24gdG9TdHIodmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZSA9PSBudWxsID8gJycgOiB2YWx1ZSArICcnOwogIH0KICBmdW5jdGlvbiBnZXRQcm9wKGVsZW0sIG5hbWUpIHsKICAgIG5hbWUgPSBwcm9wRml4W25hbWVdIHx8IG5hbWU7CiAgICB2YXIgaG9vayA9IHByb3BIb29rc1tuYW1lXTsKICAgIGlmIChob29rICYmIGhvb2suZ2V0KSB7CiAgICAgIHJldHVybiBob29rLmdldChlbGVtLCBuYW1lKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBlbGVtW25hbWVdOwogICAgfQogIH0KICB1dGlsLm1peChEb20sIHsKICAgIF92YWxIb29rczogdmFsSG9va3MsCiAgICBfcHJvcEZpeDogcHJvcEZpeCwKICAgIF9hdHRySG9va3M6IGF0dHJIb29rcywKICAgIF9wcm9wSG9va3M6IHByb3BIb29rcywKICAgIF9hdHRyTm9kZUhvb2s6IGF0dHJOb2RlSG9vaywKICAgIF9hdHRyRml4OiBhdHRyRml4LAogICAgcHJvcDogZnVuY3Rpb24gKHNlbGVjdG9yLCBuYW1lLCB2YWx1ZSkgewogICAgICB2YXIgZWxlbXMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICB2YXIgaTsKICAgICAgdmFyIGVsZW07CiAgICAgIHZhciBob29rOwogICAgICBpZiAodHlwZW9mIG5hbWUgPT09ICdvYmplY3QnKSB7CiAgICAgICAgdXRpbC5lYWNoKG5hbWUsIGZ1bmN0aW9uICh2LCBrKSB7CiAgICAgICAgICBEb20ucHJvcChlbGVtcywgaywgdik7CiAgICAgICAgfSk7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgICBuYW1lID0gcHJvcEZpeFtuYW1lXSB8fCBuYW1lOwogICAgICBob29rID0gcHJvcEhvb2tzW25hbWVdOwogICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGZvciAoaSA9IGVsZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICBlbGVtID0gZWxlbXNbaV07CiAgICAgICAgICBpZiAoaG9vayAmJiBob29rLnNldCkgewogICAgICAgICAgICBob29rLnNldChlbGVtLCB2YWx1ZSwgbmFtZSk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICBlbGVtW25hbWVdID0gdmFsdWU7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGlmIChlbGVtcy5sZW5ndGgpIHsKICAgICAgICAgIHJldHVybiBnZXRQcm9wKGVsZW1zWzBdLCBuYW1lKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0sCiAgICByZW1vdmVQcm9wOiBmdW5jdGlvbiAoc2VsZWN0b3IsIG5hbWUpIHsKICAgICAgbmFtZSA9IHByb3BGaXhbbmFtZV0gfHwgbmFtZTsKICAgICAgdmFyIGVsZW1zID0gRG9tLnF1ZXJ5KHNlbGVjdG9yKTsKICAgICAgdmFyIGk7CiAgICAgIHZhciBlbDsKICAgICAgZm9yIChpID0gZWxlbXMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBlbCA9IGVsZW1zW2ldOwogICAgICAgIHRyeSB7CiAgICAgICAgICBlbFtuYW1lXSA9IHVuZGVmaW5lZDsKICAgICAgICAgIGRlbGV0ZSBlbFtuYW1lXTsKICAgICAgICB9IGNhdGNoIChlKSB7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYXR0cjogZnVuY3Rpb24gKHNlbGVjdG9yLCBuYW1lLCB2YWwsIHBhc3MpIHsKICAgICAgdmFyIGVscyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIHZhciBlbCA9IGVsc1swXTsKICAgICAgdmFyIGF0dHJOb3JtYWxpemVyOwogICAgICB2YXIgaTsKICAgICAgdmFyIHJldDsKICAgICAgaWYgKHR5cGVvZiBuYW1lID09PSAnb2JqZWN0JykgewogICAgICAgIHBhc3MgPSB2YWw7CiAgICAgICAgZm9yICh2YXIgayBpbiBuYW1lKSB7CiAgICAgICAgICBEb20uYXR0cihlbHMsIGssIG5hbWVba10sIHBhc3MpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIGlmIChwYXNzICYmIGF0dHJGbltuYW1lXSkgewogICAgICAgIHJldHVybiBEb21bbmFtZV0oc2VsZWN0b3IsIHZhbCk7CiAgICAgIH0KICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgaWYgKHBhc3MgJiYgYXR0ckZuW25hbWVdKSB7CiAgICAgICAgcmV0dXJuIERvbVtuYW1lXShzZWxlY3RvciwgdmFsKTsKICAgICAgfQogICAgICBuYW1lID0gYXR0ckZpeFtuYW1lXSB8fCBuYW1lOwogICAgICBpZiAoUl9CT09MRUFOLnRlc3QobmFtZSkpIHsKICAgICAgICBhdHRyTm9ybWFsaXplciA9IGJvb2xIb29rOwogICAgICB9IGVsc2UgaWYgKFJfSU5WQUxJRF9DSEFSLnRlc3QobmFtZSkpIHsKICAgICAgICBhdHRyTm9ybWFsaXplciA9IGF0dHJOb2RlSG9vazsKICAgICAgfSBlbHNlIHsKICAgICAgICBhdHRyTm9ybWFsaXplciA9IGF0dHJIb29rc1tuYW1lXTsKICAgICAgfQogICAgICBpZiAodmFsID09PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAoZWwgJiYgZWwubm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSkgewogICAgICAgICAgaWYgKG5vZGVOYW1lKGVsKSA9PT0gJ2Zvcm0nKSB7CiAgICAgICAgICAgIGF0dHJOb3JtYWxpemVyID0gYXR0ck5vZGVIb29rOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGF0dHJOb3JtYWxpemVyICYmIGF0dHJOb3JtYWxpemVyLmdldCkgewogICAgICAgICAgICByZXR1cm4gYXR0ck5vcm1hbGl6ZXIuZ2V0KGVsLCBuYW1lKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldCA9IGVsLmdldEF0dHJpYnV0ZShuYW1lKTsKICAgICAgICAgIGlmIChyZXQgPT09ICcnKSB7CiAgICAgICAgICAgIHZhciBhdHRyTm9kZSA9IGVsLmdldEF0dHJpYnV0ZU5vZGUobmFtZSk7CiAgICAgICAgICAgIGlmICghYXR0ck5vZGUgfHwgIWF0dHJOb2RlLnNwZWNpZmllZCkgewogICAgICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiByZXQgPT09IG51bGwgPyB1bmRlZmluZWQgOiByZXQ7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoaSA9IGVscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgZWwgPSBlbHNbaV07CiAgICAgICAgICBpZiAoZWwgJiYgZWwubm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSkgewogICAgICAgICAgICBpZiAobm9kZU5hbWUoZWwpID09PSAnZm9ybScpIHsKICAgICAgICAgICAgICBhdHRyTm9ybWFsaXplciA9IGF0dHJOb2RlSG9vazsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoYXR0ck5vcm1hbGl6ZXIgJiYgYXR0ck5vcm1hbGl6ZXIuc2V0KSB7CiAgICAgICAgICAgICAgYXR0ck5vcm1hbGl6ZXIuc2V0KGVsLCB2YWwsIG5hbWUpOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVsLnNldEF0dHJpYnV0ZShuYW1lLCBFTVBUWSArIHZhbCk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0sCiAgICByZW1vdmVBdHRyOiBmdW5jdGlvbiAoc2VsZWN0b3IsIG5hbWUpIHsKICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgbmFtZSA9IGF0dHJGaXhbbmFtZV0gfHwgbmFtZTsKICAgICAgdmFyIGVscyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIHZhciBwcm9wTmFtZTsKICAgICAgdmFyIGVsOwogICAgICB2YXIgaTsKICAgICAgZm9yIChpID0gZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgZWwgPSBlbHNbaV07CiAgICAgICAgaWYgKGVsLm5vZGVUeXBlID09PSBOb2RlVHlwZS5FTEVNRU5UX05PREUpIHsKICAgICAgICAgIGVsLnJlbW92ZUF0dHJpYnV0ZShuYW1lKTsKICAgICAgICAgIGlmIChSX0JPT0xFQU4udGVzdChuYW1lKSAmJiAocHJvcE5hbWUgPSBwcm9wRml4W25hbWVdIHx8IG5hbWUpIGluIGVsKSB7CiAgICAgICAgICAgIGVsW3Byb3BOYW1lXSA9IGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHZhbDogZnVuY3Rpb24gKHNlbGVjdG9yLCB2YWx1ZSkgewogICAgICB2YXIgaG9vazsKICAgICAgdmFyIHJldDsKICAgICAgdmFyIGVsZW07CiAgICAgIHZhciBlbHM7CiAgICAgIHZhciBpOwogICAgICB2YXIgdmFsOwogICAgICBpZiAodmFsdWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGVsZW0gPSBEb20uZ2V0KHNlbGVjdG9yKTsKICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgaG9vayA9IHZhbEhvb2tzW25vZGVOYW1lKGVsZW0pXSB8fCB2YWxIb29rc1tlbGVtLnR5cGVdOwogICAgICAgICAgaWYgKGhvb2sgJiYgJ2dldCcgaW4gaG9vayAmJiAocmV0ID0gaG9vay5nZXQoZWxlbSwgJ3ZhbHVlJykpICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICAgIH0KICAgICAgICAgIHJldCA9IGVsZW0udmFsdWU7CiAgICAgICAgICByZXR1cm4gdHlwZW9mIHJldCA9PT0gJ3N0cmluZycgPyByZXQucmVwbGFjZShSX1JFVFVSTiwgJycpIDogcmV0ID09IG51bGwgPyAnJyA6IHJldDsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgICBlbHMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICBmb3IgKGkgPSBlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBlbGVtID0gZWxzW2ldOwogICAgICAgIGlmIChlbGVtLm5vZGVUeXBlICE9PSAxKSB7CiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0KICAgICAgICB2YWwgPSB2YWx1ZTsKICAgICAgICBpZiAodmFsID09IG51bGwpIHsKICAgICAgICAgIHZhbCA9ICcnOwogICAgICAgIH0gZWxzZSBpZiAodHlwZW9mIHZhbCA9PT0gJ251bWJlcicpIHsKICAgICAgICAgIHZhbCArPSAnJzsKICAgICAgICB9IGVsc2UgaWYgKHV0aWwuaXNBcnJheSh2YWwpKSB7CiAgICAgICAgICB2YWwgPSB1dGlsLm1hcCh2YWwsIHRvU3RyKTsKICAgICAgICB9CiAgICAgICAgaG9vayA9IHZhbEhvb2tzW25vZGVOYW1lKGVsZW0pXSB8fCB2YWxIb29rc1tlbGVtLnR5cGVdOwogICAgICAgIHZhciBob29rSGFzU2V0ID0gaG9vayAmJiAnc2V0JyBpbiBob29rOwogICAgICAgIGlmICghaG9va0hhc1NldCB8fCBob29rLnNldChlbGVtLCB2YWwsICd2YWx1ZScpID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGVsZW0udmFsdWUgPSB2YWw7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9LAogICAgdGV4dDogZnVuY3Rpb24gKHNlbGVjdG9yLCB2YWwpIHsKICAgICAgdmFyIGVsOwogICAgICB2YXIgZWxzOwogICAgICB2YXIgaTsKICAgICAgdmFyIG5vZGVUeXBlOwogICAgICBpZiAodmFsID09PSB1bmRlZmluZWQpIHsKICAgICAgICBlbCA9IERvbS5nZXQoc2VsZWN0b3IpOwogICAgICAgIHJldHVybiBEb20uX2dldFRleHQoZWwpOwogICAgICB9IGVsc2UgewogICAgICAgIGVscyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgICAgZm9yIChpID0gZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICBlbCA9IGVsc1tpXTsKICAgICAgICAgIG5vZGVUeXBlID0gZWwubm9kZVR5cGU7CiAgICAgICAgICBpZiAobm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSkgewogICAgICAgICAgICBEb20uY2xlYW5EYXRhKGVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKCcqJykpOwogICAgICAgICAgICBpZiAoJ3RleHRDb250ZW50JyBpbiBlbCkgewogICAgICAgICAgICAgIGVsLnRleHRDb250ZW50ID0gdmFsOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGVsLmlubmVyVGV4dCA9IHZhbDsKICAgICAgICAgICAgfQogICAgICAgICAgfSBlbHNlIGlmIChub2RlVHlwZSA9PT0gTm9kZVR5cGUuVEVYVF9OT0RFIHx8IG5vZGVUeXBlID09PSBOb2RlVHlwZS5DREFUQV9TRUNUSU9OX05PREUpIHsKICAgICAgICAgICAgZWwubm9kZVZhbHVlID0gdmFsOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSwKICAgIF9nZXRUZXh0OiBmdW5jdGlvbiAoZWwpIHsKICAgICAgcmV0dXJuIGVsLnRleHRDb250ZW50OwogICAgfSwKICAgIF9nZXRQcm9wOiBnZXRQcm9wCiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tQmFzZUxpYk1haW5DbGFzcyA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIHNsaWNlID0gW10uc2xpY2U7CiAgdmFyIE5vZGVUeXBlID0gRG9tLk5vZGVUeXBlOwogIHZhciBSRV9TUExJVCA9IC9bXC5cc11ccypcLj8vOwogIGZ1bmN0aW9uIHN0clRvQXJyYXkoc3RyKSB7CiAgICBzdHIgPSB1dGlsLnRyaW0oc3RyIHx8ICcnKTsKICAgIHZhciBhcnIgPSBzdHIuc3BsaXQoUkVfU1BMSVQpOwogICAgdmFyIG5ld0FyciA9IFtdOwogICAgdmFyIHY7CiAgICB2YXIgbCA9IGFyci5sZW5ndGg7CiAgICB2YXIgaSA9IDA7CiAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICBpZiAodiA9IGFycltpXSkgewogICAgICAgIG5ld0Fyci5wdXNoKHYpOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gbmV3QXJyOwogIH0KICBmdW5jdGlvbiBiYXRjaENsYXNzTGlzdChtZXRob2QpIHsKICAgIHJldHVybiBmdW5jdGlvbiAoZWxlbSwgY2xhc3NOYW1lcykgewogICAgICB2YXIgaTsKICAgICAgdmFyIGw7CiAgICAgIHZhciBjbGFzc05hbWU7CiAgICAgIHZhciBjbGFzc0xpc3QgPSBlbGVtLmNsYXNzTGlzdDsKICAgICAgdmFyIGV4dHJhQXJncyA9IHNsaWNlLmNhbGwoYXJndW1lbnRzLCAyKTsKICAgICAgZm9yIChpID0gMCwgbCA9IGNsYXNzTmFtZXMubGVuZ3RoOyBpIDwgbDsgaSsrKSB7CiAgICAgICAgaWYgKGNsYXNzTmFtZSA9IGNsYXNzTmFtZXNbaV0pIHsKICAgICAgICAgIGNsYXNzTGlzdFttZXRob2RdLmFwcGx5KGNsYXNzTGlzdCwgW2NsYXNzTmFtZV0uY29uY2F0KGV4dHJhQXJncykpOwogICAgICAgIH0KICAgICAgfQogICAgfTsKICB9CiAgZnVuY3Rpb24gYmF0Y2hFbHMobWV0aG9kKSB7CiAgICByZXR1cm4gZnVuY3Rpb24gKHNlbGVjdG9yLCBjbGFzc05hbWUpIHsKICAgICAgdmFyIGNsYXNzTmFtZXMgPSBzdHJUb0FycmF5KGNsYXNzTmFtZSk7CiAgICAgIHZhciBleHRyYUFyZ3MgPSBzbGljZS5jYWxsKGFyZ3VtZW50cywgMik7CiAgICAgIERvbS5xdWVyeShzZWxlY3RvcikuZWFjaChmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIGlmIChlbGVtLm5vZGVUeXBlID09PSBOb2RlVHlwZS5FTEVNRU5UX05PREUpIHsKICAgICAgICAgIERvbVttZXRob2RdLmFwcGx5KERvbSwgWwogICAgICAgICAgICBlbGVtLAogICAgICAgICAgICBjbGFzc05hbWVzCiAgICAgICAgICBdLmNvbmNhdChleHRyYUFyZ3MpKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfTsKICB9CiAgdXRpbC5taXgoRG9tLCB7CiAgICBfaGFzQ2xhc3M6IGZ1bmN0aW9uIChlbGVtLCBjbGFzc05hbWVzKSB7CiAgICAgIHZhciBpOwogICAgICB2YXIgbDsKICAgICAgdmFyIGNsYXNzTmFtZTsKICAgICAgdmFyIGNsYXNzTGlzdCA9IGVsZW0uY2xhc3NMaXN0OwogICAgICBpZiAoY2xhc3NMaXN0Lmxlbmd0aCkgewogICAgICAgIGZvciAoaSA9IDAsIGwgPSBjbGFzc05hbWVzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgICAgY2xhc3NOYW1lID0gY2xhc3NOYW1lc1tpXTsKICAgICAgICAgIGlmIChjbGFzc05hbWUgJiYgIWNsYXNzTGlzdC5jb250YWlucyhjbGFzc05hbWUpKSB7CiAgICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIF9hZGRDbGFzczogYmF0Y2hDbGFzc0xpc3QoJ2FkZCcpLAogICAgX3JlbW92ZUNsYXNzOiBiYXRjaENsYXNzTGlzdCgncmVtb3ZlJyksCiAgICBfdG9nZ2xlQ2xhc3M6IGJhdGNoQ2xhc3NMaXN0KCd0b2dnbGUnKSwKICAgIGhhc0NsYXNzOiBmdW5jdGlvbiAoc2VsZWN0b3IsIGNsYXNzTmFtZSkgewogICAgICB2YXIgcmV0ID0gZmFsc2U7CiAgICAgIGNsYXNzTmFtZSA9IHN0clRvQXJyYXkoY2xhc3NOYW1lKTsKICAgICAgRG9tLnF1ZXJ5KHNlbGVjdG9yKS5lYWNoKGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSAmJiBEb20uX2hhc0NsYXNzKGVsZW0sIGNsYXNzTmFtZSkpIHsKICAgICAgICAgIHJldCA9IHRydWU7CiAgICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0pOwogICAgICByZXR1cm4gcmV0OwogICAgfSwKICAgIHJlcGxhY2VDbGFzczogZnVuY3Rpb24gKHNlbGVjdG9yLCBvbGRDbGFzc05hbWUsIG5ld0NsYXNzTmFtZSkgewogICAgICBEb20ucmVtb3ZlQ2xhc3Moc2VsZWN0b3IsIG9sZENsYXNzTmFtZSk7CiAgICAgIERvbS5hZGRDbGFzcyhzZWxlY3RvciwgbmV3Q2xhc3NOYW1lKTsKICAgIH0sCiAgICBhZGRDbGFzczogYmF0Y2hFbHMoJ19hZGRDbGFzcycpLAogICAgcmVtb3ZlQ2xhc3M6IGJhdGNoRWxzKCdfcmVtb3ZlQ2xhc3MnKSwKICAgIHRvZ2dsZUNsYXNzOiBiYXRjaEVscygnX3RvZ2dsZUNsYXNzJykKICB9KTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpkb21CYXNlTGliTWFpbkNyZWF0ZSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIHVuZGVmOwogIHZhciBkb2MgPSBkb2N1bWVudDsKICB2YXIgTm9kZVR5cGUgPSBEb20uTm9kZVR5cGU7CiAgdmFyIERJViA9ICdkaXYnOwogIHZhciBQQVJFTlRfTk9ERSA9ICdwYXJlbnROb2RlJzsKICB2YXIgREVGQVVMVF9ESVYgPSBkb2MgJiYgZG9jLmNyZWF0ZUVsZW1lbnQoRElWKTsKICB2YXIgUl9YSFRNTF9UQUcgPSAvPCg/IWFyZWF8YnJ8Y29sfGVtYmVkfGhyfGltZ3xpbnB1dHxsaW5rfG1ldGF8cGFyYW0pKChbXHc6XSspW14+XSopXC8+L2dpOwogIHZhciBSRV9UQUcgPSAvPChbXHc6XSspLzsKICB2YXIgUl9MRUFESU5HX1dISVRFU1BBQ0UgPSAvXlxzKy87CiAgdmFyIFJfVEFJTF9XSElURVNQQUNFID0gL1xzKyQvOwogIHZhciBvbGRJRSA9IGZ1bmN0aW9uICh1YSkgewogICAgdmFyIG07CiAgICB2YXIgdjsKICAgIGlmICgobSA9IHVhLm1hdGNoKC9NU0lFIChbXjtdKil8VHJpZGVudC4qOyBydig/OlxzfDopPyhbMC05Ll0rKS8pKSAmJiAodiA9IG1bMV0gfHwgbVsyXSkpIHsKICAgICAgcmV0dXJuIHBhcnNlRmxvYXQodikgPCA5OwogICAgfQogICAgcmV0dXJuIGZhbHNlOwogIH0obmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgdmFyIGxvc3RMZWFkaW5nVGFpbFdoaXRlc3BhY2UgPSBvbGRJRTsKICB2YXIgUl9IVE1MID0gLzx8JiM/XHcrOy87CiAgdmFyIFJFX1NJTVBMRV9UQUcgPSAvXjwoXHcrKVxzKlwvPz4oPzo8XC9cMT4pPyQvOwogIHZhciBjcmVhdG9ycyA9IERvbS5fY3JlYXRvcnMgPSB7IGRpdjogZGVmYXVsdENyZWF0b3IgfTsKICB2YXIgY3JlYXRvcnNNYXAgPSB7CiAgICBhcmVhOiAnbWFwJywKICAgIHRoZWFkOiAndGFibGUnLAogICAgdGQ6ICd0cicsCiAgICB0aDogJ3RyJywKICAgIHRyOiAndGJvZHknLAogICAgdGJvZHk6ICd0YWJsZScsCiAgICB0Zm9vdDogJ3RhYmxlJywKICAgIGNhcHRpb246ICd0YWJsZScsCiAgICBjb2xncm91cDogJ3RhYmxlJywKICAgIGNvbDogJ2NvbGdyb3VwJywKICAgIGxlZ2VuZDogJ2ZpZWxkc2V0JwogIH07CiAgdmFyIHA7CiAgdmFyIHRhZ1RwbCA9ICc8e3RhZ30+e2h0bWx9PC97dGFnfT4nOwogIGZvciAocCBpbiBjcmVhdG9yc01hcCkgewogICAgKGZ1bmN0aW9uICh0YWcpIHsKICAgICAgY3JlYXRvcnNbcF0gPSBmdW5jdGlvbiAoaHRtbCwgb3duZXJEb2MpIHsKICAgICAgICByZXR1cm4gRG9tLmNyZWF0ZSh1dGlsLnN1YnN0aXR1dGUodGFnVHBsLCB7CiAgICAgICAgICB0YWc6IHRhZywKICAgICAgICAgIGh0bWw6IGh0bWwKICAgICAgICB9KSwgdW5kZWYsIG93bmVyRG9jKTsKICAgICAgfTsKICAgIH0oY3JlYXRvcnNNYXBbcF0pKTsKICB9CiAgY3JlYXRvcnMub3B0aW9uID0gY3JlYXRvcnMub3B0Z3JvdXAgPSBmdW5jdGlvbiAoaHRtbCwgb3duZXJEb2MpIHsKICAgIHJldHVybiBEb20uY3JlYXRlKCc8c2VsZWN0IG11bHRpcGxlPSJtdWx0aXBsZSI+JyArIGh0bWwgKyAnPC9zZWxlY3Q+JywgdW5kZWZpbmVkLCBvd25lckRvYyk7CiAgfTsKICBjcmVhdG9yc01hcC5vcHRpb24gPSBjcmVhdG9yc01hcC5vcHRncm91cCA9IDE7CiAgZnVuY3Rpb24gZ2V0RWxlbWVudHNCeVRhZ05hbWUoZWwsIHRhZykgewogICAgcmV0dXJuIGVsLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZyk7CiAgfQogIGZ1bmN0aW9uIGdldEhvbGRlckRpdihvd25lckRvYywgY2xlYXIpIHsKICAgIHZhciBob2xkZXIgPSBvd25lckRvYyAmJiBvd25lckRvYyAhPT0gZG9jID8gb3duZXJEb2MuY3JlYXRlRWxlbWVudChESVYpIDogREVGQVVMVF9ESVY7CiAgICBpZiAoY2xlYXIgJiYgaG9sZGVyID09PSBERUZBVUxUX0RJVikgewogICAgICBob2xkZXIuaW5uZXJIVE1MID0gJyc7CiAgICB9CiAgICByZXR1cm4gaG9sZGVyOwogIH0KICBmdW5jdGlvbiBkZWZhdWx0Q3JlYXRvcihodG1sLCBvd25lckRvYykgewogICAgdmFyIGZyYWcgPSBnZXRIb2xkZXJEaXYob3duZXJEb2MpOwogICAgZnJhZy5pbm5lckhUTUwgPSAnbTxkaXY+JyArIGh0bWwgKyAnPCcgKyAnL2Rpdj4nOwogICAgcmV0dXJuIGZyYWcubGFzdENoaWxkOwogIH0KICBmdW5jdGlvbiBfZW1wdHkobm9kZSkgewogICAgdHJ5IHsKICAgICAgbm9kZS5pbm5lckhUTUwgPSAnJzsKICAgICAgcmV0dXJuOwogICAgfSBjYXRjaCAoZSkgewogICAgfQogICAgd2hpbGUgKG5vZGUubGFzdENoaWxkKSB7CiAgICAgIF9kZXN0cm95KG5vZGUubGFzdENoaWxkLCBub2RlKTsKICAgIH0KICB9CiAgZnVuY3Rpb24gX2Rlc3Ryb3kobm9kZSwgcGFyZW50KSB7CiAgICBpZiAocGFyZW50KSB7CiAgICAgIGlmIChvbGRJRSAmJiBwYXJlbnQuY2FuSGF2ZUNoaWxkcmVuICYmICdyZW1vdmVOb2RlJyBpbiBub2RlKSB7CiAgICAgICAgaWYgKG5vZGUuZmlyc3RDaGlsZCkgewogICAgICAgICAgX2VtcHR5KG5vZGUpOwogICAgICAgIH0KICAgICAgICBub2RlLnJlbW92ZU5vZGUoZmFsc2UpOwogICAgICB9IGVsc2UgewogICAgICAgIHBhcmVudC5yZW1vdmVDaGlsZChub2RlKTsKICAgICAgfQogICAgfQogIH0KICB1dGlsLm1peChEb20sIHsKICAgIGNyZWF0ZTogZnVuY3Rpb24gKGh0bWwsIGF0dHJzLCBvd25lckRvYywgX3RyaW0pIHsKICAgICAgdmFyIHJldCA9IG51bGw7CiAgICAgIGlmICghaHRtbCkgewogICAgICAgIHJldHVybiByZXQ7CiAgICAgIH0KICAgICAgaWYgKGh0bWwubm9kZVR5cGUpIHsKICAgICAgICByZXR1cm4gRG9tLmNsb25lKGh0bWwpOwogICAgICB9CiAgICAgIGlmICh0eXBlb2YgaHRtbCAhPT0gJ3N0cmluZycpIHsKICAgICAgICByZXR1cm4gcmV0OwogICAgICB9CiAgICAgIGlmIChfdHJpbSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgX3RyaW0gPSB0cnVlOwogICAgICB9CiAgICAgIGlmIChfdHJpbSkgewogICAgICAgIGh0bWwgPSB1dGlsLnRyaW0oaHRtbCk7CiAgICAgIH0KICAgICAgdmFyIGhvbGRlcjsKICAgICAgdmFyIHdoaXRlc3BhY2VNYXRjaDsKICAgICAgdmFyIGNvbnRleHQgPSBvd25lckRvYyB8fCBkb2M7CiAgICAgIHZhciBtOwogICAgICB2YXIgdGFnID0gRElWOwogICAgICB2YXIgazsKICAgICAgdmFyIG5vZGVzOwogICAgICBpZiAoIVJfSFRNTC50ZXN0KGh0bWwpKSB7CiAgICAgICAgcmV0ID0gY29udGV4dC5jcmVhdGVUZXh0Tm9kZShodG1sKTsKICAgICAgfSBlbHNlIGlmIChtID0gUkVfU0lNUExFX1RBRy5leGVjKGh0bWwpKSB7CiAgICAgICAgcmV0ID0gY29udGV4dC5jcmVhdGVFbGVtZW50KG1bMV0pOwogICAgICB9IGVsc2UgewogICAgICAgIGh0bWwgPSBodG1sLnJlcGxhY2UoUl9YSFRNTF9UQUcsICc8JDE+PCcgKyAnLyQyPicpOwogICAgICAgIGlmICgobSA9IFJFX1RBRy5leGVjKGh0bWwpKSAmJiAoayA9IG1bMV0pKSB7CiAgICAgICAgICB0YWcgPSBrLnRvTG93ZXJDYXNlKCk7CiAgICAgICAgfQogICAgICAgIGhvbGRlciA9IChjcmVhdG9yc1t0YWddIHx8IGRlZmF1bHRDcmVhdG9yKShodG1sLCBjb250ZXh0KTsKICAgICAgICBpZiAobG9zdExlYWRpbmdUYWlsV2hpdGVzcGFjZSAmJiAod2hpdGVzcGFjZU1hdGNoID0gaHRtbC5tYXRjaChSX0xFQURJTkdfV0hJVEVTUEFDRSkpKSB7CiAgICAgICAgICBob2xkZXIuaW5zZXJ0QmVmb3JlKGNvbnRleHQuY3JlYXRlVGV4dE5vZGUod2hpdGVzcGFjZU1hdGNoWzBdKSwgaG9sZGVyLmZpcnN0Q2hpbGQpOwogICAgICAgIH0KICAgICAgICBpZiAobG9zdExlYWRpbmdUYWlsV2hpdGVzcGFjZSAmJiAvXFMvLnRlc3QoaHRtbCkgJiYgKHdoaXRlc3BhY2VNYXRjaCA9IGh0bWwubWF0Y2goUl9UQUlMX1dISVRFU1BBQ0UpKSkgewogICAgICAgICAgaG9sZGVyLmFwcGVuZENoaWxkKGNvbnRleHQuY3JlYXRlVGV4dE5vZGUod2hpdGVzcGFjZU1hdGNoWzBdKSk7CiAgICAgICAgfQogICAgICAgIG5vZGVzID0gaG9sZGVyLmNoaWxkTm9kZXM7CiAgICAgICAgaWYgKG5vZGVzLmxlbmd0aCA9PT0gMSkgewogICAgICAgICAgcmV0ID0gbm9kZXNbMF1bUEFSRU5UX05PREVdLnJlbW92ZUNoaWxkKG5vZGVzWzBdKTsKICAgICAgICB9IGVsc2UgaWYgKG5vZGVzLmxlbmd0aCkgewogICAgICAgICAgcmV0ID0gbm9kZUxpc3RUb0ZyYWdtZW50KG5vZGVzKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdGhyb3cgbmV3IEVycm9yKGh0bWwgKyAnIDogY3JlYXRlIG5vZGUgZXJyb3InKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGF0dHJzID8gc2V0QXR0cmlidXRlcyhyZXQsIGF0dHJzKSA6IHJldDsKICAgIH0sCiAgICBfZml4Q2xvbmVBdHRyaWJ1dGVzOiBmdW5jdGlvbiAoc3JjLCBkZXN0KSB7CiAgICAgIHZhciBub2RlTmFtZSA9IHNyYy5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICB2YXIgdHlwZSA9IChzcmMudHlwZSB8fCAnJykudG9Mb3dlckNhc2UoKTsKICAgICAgdmFyIHNyY1ZhbHVlOwogICAgICB2YXIgc3JjQ2hlY2tlZDsKICAgICAgaWYgKG5vZGVOYW1lID09PSAndGV4dGFyZWEnKSB7CiAgICAgICAgZGVzdC5kZWZhdWx0VmFsdWUgPSBzcmMuZGVmYXVsdFZhbHVlOwogICAgICAgIGRlc3QudmFsdWUgPSBzcmMudmFsdWU7CiAgICAgIH0gZWxzZSBpZiAobm9kZU5hbWUgPT09ICdpbnB1dCcgJiYgKHR5cGUgPT09ICdjaGVja2JveCcgfHwgdHlwZSA9PT0gJ3JhZGlvJykpIHsKICAgICAgICBzcmNDaGVja2VkID0gc3JjLmNoZWNrZWQ7CiAgICAgICAgaWYgKHNyY0NoZWNrZWQpIHsKICAgICAgICAgIGRlc3QuZGVmYXVsdENoZWNrZWQgPSBkZXN0LmNoZWNrZWQgPSBzcmNDaGVja2VkOwogICAgICAgIH0KICAgICAgICBzcmNWYWx1ZSA9IHNyYy52YWx1ZTsKICAgICAgICBpZiAoZGVzdC52YWx1ZSAhPT0gc3JjVmFsdWUpIHsKICAgICAgICAgIGRlc3QudmFsdWUgPSBzcmNWYWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICBfZGVmYXVsdENyZWF0b3I6IGRlZmF1bHRDcmVhdG9yLAogICAgaHRtbDogZnVuY3Rpb24gKHNlbGVjdG9yLCBodG1sU3RyaW5nLCBsb2FkU2NyaXB0cykgewogICAgICB2YXIgZWxzID0gRG9tLnF1ZXJ5KHNlbGVjdG9yKTsKICAgICAgdmFyIGVsID0gZWxzWzBdOwogICAgICB2YXIgc3VjY2VzcyA9IGZhbHNlOwogICAgICB2YXIgdmFsTm9kZTsKICAgICAgdmFyIGk7CiAgICAgIHZhciBlbGVtOwogICAgICBpZiAoIWVsKSB7CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgICBpZiAoaHRtbFN0cmluZyA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKGVsLm5vZGVUeXBlID09PSBOb2RlVHlwZS5FTEVNRU5UX05PREUpIHsKICAgICAgICAgIHJldHVybiBlbC5pbm5lckhUTUw7CiAgICAgICAgfSBlbHNlIGlmIChlbC5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSkgewogICAgICAgICAgdmFyIGhvbGRlciA9IGdldEhvbGRlckRpdihlbC5vd25lckRvY3VtZW50LCAxKTsKICAgICAgICAgIGhvbGRlci5hcHBlbmRDaGlsZChlbCk7CiAgICAgICAgICByZXR1cm4gaG9sZGVyLmlubmVySFRNTDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGh0bWxTdHJpbmcgKz0gJyc7CiAgICAgICAgaWYgKCFodG1sU3RyaW5nLm1hdGNoKC88KD86c2NyaXB0fHN0eWxlfGxpbmspL2kpICYmICghbG9zdExlYWRpbmdUYWlsV2hpdGVzcGFjZSB8fCAhaHRtbFN0cmluZy5tYXRjaChSX0xFQURJTkdfV0hJVEVTUEFDRSkpICYmICFjcmVhdG9yc01hcFsoaHRtbFN0cmluZy5tYXRjaChSRV9UQUcpIHx8IFsKICAgICAgICAgICAgJycsCiAgICAgICAgICAgICcnCiAgICAgICAgICBdKVsxXS50b0xvd2VyQ2FzZSgpXSkgewogICAgICAgICAgdHJ5IHsKICAgICAgICAgICAgZm9yIChpID0gZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgICAgZWxlbSA9IGVsc1tpXTsKICAgICAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgICAgICAgICBEb20uY2xlYW5EYXRhKGdldEVsZW1lbnRzQnlUYWdOYW1lKGVsZW0sICcqJykpOwogICAgICAgICAgICAgICAgZWxlbS5pbm5lckhUTUwgPSBodG1sU3RyaW5nOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBzdWNjZXNzID0gdHJ1ZTsKICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKCFzdWNjZXNzKSB7CiAgICAgICAgICB2YWxOb2RlID0gRG9tLmNyZWF0ZShodG1sU3RyaW5nLCAwLCBlbC5vd25lckRvY3VtZW50LCAwKTsKICAgICAgICAgIERvbS5lbXB0eShlbHMpOwogICAgICAgICAgRG9tLmFwcGVuZCh2YWxOb2RlLCBlbHMsIGxvYWRTY3JpcHRzKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0sCiAgICByZW1vdmU6IGZ1bmN0aW9uIChzZWxlY3Rvciwga2VlcERhdGEsIERPTUV2ZW50KSB7CiAgICAgIHZhciBlbDsKICAgICAgdmFyIGVscyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIHZhciBhbGw7CiAgICAgIHZhciBpOwogICAgICBmb3IgKGkgPSBlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBlbCA9IGVsc1tpXTsKICAgICAgICBpZiAoIWtlZXBEYXRhICYmIGVsLm5vZGVUeXBlID09PSBOb2RlVHlwZS5FTEVNRU5UX05PREUpIHsKICAgICAgICAgIGFsbCA9IHV0aWwubWFrZUFycmF5KGdldEVsZW1lbnRzQnlUYWdOYW1lKGVsLCAnKicpKTsKICAgICAgICAgIGFsbC5wdXNoKGVsKTsKICAgICAgICAgIERvbS5yZW1vdmVEYXRhKGFsbCk7CiAgICAgICAgICBpZiAoRE9NRXZlbnQpIHsKICAgICAgICAgICAgRE9NRXZlbnQuZGV0YWNoKGFsbCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIF9kZXN0cm95KGVsLCBlbC5wYXJlbnROb2RlKTsKICAgICAgfQogICAgfSwKICAgIGNsb25lOiBmdW5jdGlvbiAoc2VsZWN0b3IsIGRlZXAsIHdpdGhEYXRhQW5kRXZlbnQsIGRlZXBXaXRoRGF0YUFuZEV2ZW50LCBET01FdmVudCkgewogICAgICBpZiAodHlwZW9mIGRlZXAgPT09ICdvYmplY3QnKSB7CiAgICAgICAgZGVlcFdpdGhEYXRhQW5kRXZlbnQgPSBkZWVwLmRlZXBXaXRoRGF0YUFuZEV2ZW50OwogICAgICAgIHdpdGhEYXRhQW5kRXZlbnQgPSBkZWVwLndpdGhEYXRhQW5kRXZlbnQ7CiAgICAgICAgZGVlcCA9IGRlZXAuZGVlcDsKICAgICAgfQogICAgICB2YXIgZWxlbSA9IERvbS5nZXQoc2VsZWN0b3IpOwogICAgICB2YXIgY2xvbmU7CiAgICAgIHZhciBfZml4Q2xvbmVBdHRyaWJ1dGVzID0gRG9tLl9maXhDbG9uZUF0dHJpYnV0ZXM7CiAgICAgIHZhciBlbGVtTm9kZVR5cGU7CiAgICAgIGlmICghZWxlbSkgewogICAgICAgIHJldHVybiBudWxsOwogICAgICB9CiAgICAgIGVsZW1Ob2RlVHlwZSA9IGVsZW0ubm9kZVR5cGU7CiAgICAgIGNsb25lID0gZWxlbS5jbG9uZU5vZGUoZGVlcCk7CiAgICAgIGlmIChlbGVtTm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSB8fCBlbGVtTm9kZVR5cGUgPT09IE5vZGVUeXBlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREUpIHsKICAgICAgICBpZiAoX2ZpeENsb25lQXR0cmlidXRlcyAmJiBlbGVtTm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSkgewogICAgICAgICAgX2ZpeENsb25lQXR0cmlidXRlcyhlbGVtLCBjbG9uZSk7CiAgICAgICAgfQogICAgICAgIGlmIChkZWVwICYmIF9maXhDbG9uZUF0dHJpYnV0ZXMpIHsKICAgICAgICAgIHByb2Nlc3NBbGwoX2ZpeENsb25lQXR0cmlidXRlcywgZWxlbSwgY2xvbmUpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAod2l0aERhdGFBbmRFdmVudCkgewogICAgICAgIGNsb25lV2l0aERhdGFBbmRFdmVudChlbGVtLCBjbG9uZSwgRE9NRXZlbnQpOwogICAgICAgIGlmIChkZWVwICYmIGRlZXBXaXRoRGF0YUFuZEV2ZW50KSB7CiAgICAgICAgICBwcm9jZXNzQWxsKGNsb25lV2l0aERhdGFBbmRFdmVudCwgZWxlbSwgY2xvbmUpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gY2xvbmU7CiAgICB9LAogICAgZW1wdHk6IGZ1bmN0aW9uIChzZWxlY3RvciwgRE9NRXZlbnQpIHsKICAgICAgdmFyIGVscyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIHZhciBlbDsKICAgICAgdmFyIGk7CiAgICAgIGZvciAoaSA9IGVscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGVsID0gZWxzW2ldOwogICAgICAgIERvbS5yZW1vdmUoZWwuY2hpbGROb2RlcywgZmFsc2UsIERPTUV2ZW50KTsKICAgICAgfQogICAgfSwKICAgIF9ub2RlTGlzdFRvRnJhZ21lbnQ6IG5vZGVMaXN0VG9GcmFnbWVudCwKICAgIF9nZXRIb2xkZXJEaXY6IGdldEhvbGRlckRpdgogIH0pOwogIGZ1bmN0aW9uIHByb2Nlc3NBbGwoZm4sIGVsZW0sIGNsb25lKSB7CiAgICB2YXIgZWxlbU5vZGVUeXBlID0gZWxlbS5ub2RlVHlwZTsKICAgIGlmIChlbGVtTm9kZVR5cGUgPT09IE5vZGVUeXBlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREUpIHsKICAgICAgdmFyIGVDcyA9IGVsZW0uY2hpbGROb2RlczsKICAgICAgdmFyIGNsb25lQ3MgPSBjbG9uZS5jaGlsZE5vZGVzOwogICAgICB2YXIgZkluZGV4ID0gMDsKICAgICAgd2hpbGUgKGVDc1tmSW5kZXhdKSB7CiAgICAgICAgaWYgKGNsb25lQ3NbZkluZGV4XSkgewogICAgICAgICAgcHJvY2Vzc0FsbChmbiwgZUNzW2ZJbmRleF0sIGNsb25lQ3NbZkluZGV4XSk7CiAgICAgICAgfQogICAgICAgIGZJbmRleCsrOwogICAgICB9CiAgICB9IGVsc2UgaWYgKGVsZW1Ob2RlVHlwZSA9PT0gTm9kZVR5cGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgIHZhciBlbGVtQ2hpbGRyZW4gPSBnZXRFbGVtZW50c0J5VGFnTmFtZShlbGVtLCAnKicpOwogICAgICB2YXIgY2xvbmVDaGlsZHJlbiA9IGdldEVsZW1lbnRzQnlUYWdOYW1lKGNsb25lLCAnKicpOwogICAgICB2YXIgY0luZGV4ID0gMDsKICAgICAgd2hpbGUgKGVsZW1DaGlsZHJlbltjSW5kZXhdKSB7CiAgICAgICAgaWYgKGNsb25lQ2hpbGRyZW5bY0luZGV4XSkgewogICAgICAgICAgZm4oZWxlbUNoaWxkcmVuW2NJbmRleF0sIGNsb25lQ2hpbGRyZW5bY0luZGV4XSk7CiAgICAgICAgfQogICAgICAgIGNJbmRleCsrOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNsb25lV2l0aERhdGFBbmRFdmVudChzcmMsIGRlc3QsIERPTUV2ZW50KSB7CiAgICB2YXIgc3JjRGF0YTsKICAgIHZhciBkOwogICAgaWYgKGRlc3Qubm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBzcmNEYXRhID0gRG9tLmRhdGEoc3JjKTsKICAgIGZvciAoZCBpbiBzcmNEYXRhKSB7CiAgICAgIERvbS5kYXRhKGRlc3QsIGQsIHNyY0RhdGFbZF0pOwogICAgfQogICAgaWYgKERPTUV2ZW50KSB7CiAgICAgIERPTUV2ZW50LmNsb25lKHNyYywgZGVzdCk7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNldEF0dHJpYnV0ZXMoZWxlbSwgYXR0cnMpIHsKICAgIHZhciBub2RlVHlwZSA9IGVsZW0ubm9kZVR5cGU7CiAgICBpZiAobm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSkgewogICAgICBEb20uYXR0cihlbGVtLCBhdHRycywgdHJ1ZSk7CiAgICB9IGVsc2UgaWYgKG5vZGVUeXBlID09PSBOb2RlVHlwZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7CiAgICAgIERvbS5hdHRyKGVsZW0uY2hpbGROb2RlcywgYXR0cnMsIHRydWUpOwogICAgfQogICAgcmV0dXJuIGVsZW07CiAgfQogIGZ1bmN0aW9uIG5vZGVMaXN0VG9GcmFnbWVudChub2RlcykgewogICAgdmFyIHJldCA9IG51bGw7CiAgICB2YXIgaTsKICAgIHZhciBvd25lckRvYzsKICAgIHZhciBsZW47CiAgICBpZiAobm9kZXMgJiYgKG5vZGVzLnB1c2ggfHwgbm9kZXMuaXRlbSkgJiYgbm9kZXNbMF0pIHsKICAgICAgb3duZXJEb2MgPSBub2Rlc1swXS5vd25lckRvY3VtZW50OwogICAgICByZXQgPSBvd25lckRvYy5jcmVhdGVEb2N1bWVudEZyYWdtZW50KCk7CiAgICAgIG5vZGVzID0gdXRpbC5tYWtlQXJyYXkobm9kZXMpOwogICAgICBmb3IgKGkgPSAwLCBsZW4gPSBub2Rlcy5sZW5ndGg7IGkgPCBsZW47IGkrKykgewogICAgICAgIHJldC5hcHBlbmRDaGlsZChub2Rlc1tpXSk7CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignVW5hYmxlIHRvIGNvbnZlcnQgJyArIG5vZGVzICsgJyB0byBmcmFnbWVudC4nKTsKICAgIH0KICAgIHJldHVybiByZXQ7CiAgfQogIHJldHVybiBleHBvcnRzOwp9KCk7CmRvbUJhc2VMaWJNYWluRGF0YSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIHdpbiA9IHdpbmRvdzsKICB2YXIgRVhQQU5ETyA9ICdfa3NfZGF0YV8nICsgdXRpbC5ub3coKTsKICB2YXIgZGF0YUNhY2hlID0ge307CiAgdmFyIHdpbkRhdGFDYWNoZSA9IHt9OwogIHZhciBub0RhdGEgPSB7CiAgICBhcHBsZXQ6IDEsCiAgICBvYmplY3Q6IDEsCiAgICBlbWJlZDogMQogIH07CiAgdmFyIG9iamVjdE9wcyA9IHsKICAgIGRhdGE6IGZ1bmN0aW9uIChvYiwgbmFtZSwgdmFsdWUpIHsKICAgICAgaWYgKG9iID09IHdpbikgewogICAgICAgIHJldHVybiBvYmplY3RPcHMuZGF0YSh3aW5EYXRhQ2FjaGUsIG5hbWUsIHZhbHVlKTsKICAgICAgfQogICAgICB2YXIgY2FjaGUgPSBvYltFWFBBTkRPXTsKICAgICAgaWYgKHZhbHVlICE9PSB1bmRlZmluZWQpIHsKICAgICAgICBjYWNoZSA9IG9iW0VYUEFORE9dID0gb2JbRVhQQU5ET10gfHwge307CiAgICAgICAgY2FjaGVbbmFtZV0gPSB2YWx1ZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICByZXR1cm4gY2FjaGUgJiYgY2FjaGVbbmFtZV07CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIGNhY2hlID0gb2JbRVhQQU5ET10gPSBvYltFWFBBTkRPXSB8fCB7fTsKICAgICAgICAgIHJldHVybiBjYWNoZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICByZW1vdmVEYXRhOiBmdW5jdGlvbiAob2IsIG5hbWUpIHsKICAgICAgaWYgKG9iID09IHdpbikgewogICAgICAgIHJldHVybiBvYmplY3RPcHMucmVtb3ZlRGF0YSh3aW5EYXRhQ2FjaGUsIG5hbWUpOwogICAgICB9CiAgICAgIHZhciBjYWNoZSA9IG9iW0VYUEFORE9dOwogICAgICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgZGVsZXRlIGNhY2hlW25hbWVdOwogICAgICAgIGlmICh1dGlsLmlzRW1wdHlPYmplY3QoY2FjaGUpKSB7CiAgICAgICAgICBvYmplY3RPcHMucmVtb3ZlRGF0YShvYik7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHRyeSB7CiAgICAgICAgICBkZWxldGUgb2JbRVhQQU5ET107CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgb2JbRVhQQU5ET10gPSB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfTsKICB2YXIgZG9tT3BzID0gewogICAgZGF0YTogZnVuY3Rpb24gKGVsZW0sIG5hbWUsIHZhbHVlKSB7CiAgICAgIGlmIChub0RhdGFbZWxlbS5ub2RlTmFtZS50b0xvd2VyQ2FzZSgpXSkgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgdmFyIGtleSA9IGVsZW1bRVhQQU5ET107CiAgICAgIHZhciBjYWNoZTsKICAgICAgaWYgKCFrZXkpIHsKICAgICAgICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkICYmIHZhbHVlID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICAgIGtleSA9IGVsZW1bRVhQQU5ET10gPSB1dGlsLmd1aWQoKTsKICAgICAgfQogICAgICBjYWNoZSA9IGRhdGFDYWNoZVtrZXldOwogICAgICBpZiAodmFsdWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGNhY2hlID0gZGF0YUNhY2hlW2tleV0gPSBkYXRhQ2FjaGVba2V5XSB8fCB7fTsKICAgICAgICBjYWNoZVtuYW1lXSA9IHZhbHVlOwogICAgICB9IGVsc2UgewogICAgICAgIGlmIChuYW1lICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHJldHVybiBjYWNoZSAmJiBjYWNoZVtuYW1lXTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgY2FjaGUgPSBkYXRhQ2FjaGVba2V5XSA9IGRhdGFDYWNoZVtrZXldIHx8IHt9OwogICAgICAgICAgcmV0dXJuIGNhY2hlOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHJlbW92ZURhdGE6IGZ1bmN0aW9uIChlbGVtLCBuYW1lKSB7CiAgICAgIHZhciBrZXkgPSBlbGVtW0VYUEFORE9dOwogICAgICBpZiAoIWtleSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgY2FjaGUgPSBkYXRhQ2FjaGVba2V5XTsKICAgICAgaWYgKG5hbWUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGRlbGV0ZSBjYWNoZVtuYW1lXTsKICAgICAgICBpZiAodXRpbC5pc0VtcHR5T2JqZWN0KGNhY2hlKSkgewogICAgICAgICAgZG9tT3BzLnJlbW92ZURhdGEoZWxlbSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGRlbGV0ZSBkYXRhQ2FjaGVba2V5XTsKICAgICAgICB0cnkgewogICAgICAgICAgZGVsZXRlIGVsZW1bRVhQQU5ET107CiAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgZWxlbVtFWFBBTkRPXSA9IHVuZGVmaW5lZDsKICAgICAgICB9CiAgICAgICAgaWYgKGVsZW0ucmVtb3ZlQXR0cmlidXRlKSB7CiAgICAgICAgICBlbGVtLnJlbW92ZUF0dHJpYnV0ZShFWFBBTkRPKTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9OwogIHV0aWwubWl4KERvbSwgewogICAgX19FWFBBTkRPOiBFWFBBTkRPLAogICAgX2RhdGFDYWNoZTogZGF0YUNhY2hlLAogICAgX3dpbkRhdGFDYWNoZTogd2luRGF0YUNhY2hlLAogICAgZGF0YTogZnVuY3Rpb24gKHNlbGVjdG9yLCBuYW1lLCBkYXRhKSB7CiAgICAgIHZhciBlbGVtcyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIHZhciBlbGVtID0gZWxlbXNbMF07CiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHsKICAgICAgICBmb3IgKHZhciBrIGluIG5hbWUpIHsKICAgICAgICAgIERvbS5kYXRhKGVsZW1zLCBrLCBuYW1lW2tdKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgICBpZiAoZGF0YSA9PT0gdW5kZWZpbmVkKSB7CiAgICAgICAgaWYgKGVsZW0pIHsKICAgICAgICAgIGlmIChlbGVtLm5vZGVUeXBlKSB7CiAgICAgICAgICAgIHJldHVybiBkb21PcHMuZGF0YShlbGVtLCBuYW1lKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHJldHVybiBvYmplY3RPcHMuZGF0YShlbGVtLCBuYW1lKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yICh2YXIgaSA9IGVsZW1zLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICBlbGVtID0gZWxlbXNbaV07CiAgICAgICAgICBpZiAoZWxlbS5ub2RlVHlwZSkgewogICAgICAgICAgICBkb21PcHMuZGF0YShlbGVtLCBuYW1lLCBkYXRhKTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIG9iamVjdE9wcy5kYXRhKGVsZW0sIG5hbWUsIGRhdGEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSwKICAgIHJlbW92ZURhdGE6IGZ1bmN0aW9uIChzZWxlY3RvciwgbmFtZSkgewogICAgICB2YXIgZWxzID0gRG9tLnF1ZXJ5KHNlbGVjdG9yKTsKICAgICAgdmFyIGVsZW07CiAgICAgIHZhciBpOwogICAgICBmb3IgKGkgPSBlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBlbGVtID0gZWxzW2ldOwogICAgICAgIGlmIChlbGVtLm5vZGVUeXBlKSB7CiAgICAgICAgICBkb21PcHMucmVtb3ZlRGF0YShlbGVtLCBuYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgb2JqZWN0T3BzLnJlbW92ZURhdGEoZWxlbSwgbmFtZSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgY2xlYW5EYXRhOiBmdW5jdGlvbiAoc2VsZWN0b3IsIGRlZXAsIERPTUV2ZW50KSB7CiAgICAgIHZhciBlbHMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICB2YXIgZWxlbTsKICAgICAgdmFyIGk7CiAgICAgIGZvciAoaSA9IGVscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGVsZW0gPSBlbHNbaV07CiAgICAgICAgaWYgKGVsZW0ubm9kZVR5cGUpIHsKICAgICAgICAgIHZhciBkZXNjZW5kYW50cyA9IGRlZXAgJiYgdXRpbC5tYWtlQXJyYXkoZWxlbS5nZXRFbGVtZW50c0J5VGFnTmFtZSgnKicpKSB8fCBbXTsKICAgICAgICAgIGRlc2NlbmRhbnRzLnB1c2goZWxlbSk7CiAgICAgICAgICBmb3IgKHZhciBqID0gMCwgbGVuID0gZGVzY2VuZGFudHMubGVuZ3RoOyBqIDwgbGVuOyBqKyspIHsKICAgICAgICAgICAgZG9tT3BzLnJlbW92ZURhdGEoZGVzY2VuZGFudHNbal0pOwogICAgICAgICAgfQogICAgICAgICAgaWYgKERPTUV2ZW50KSB7CiAgICAgICAgICAgIERPTUV2ZW50LmRldGFjaChkZXNjZW5kYW50cyk7CiAgICAgICAgICB9CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIG9iamVjdE9wcy5yZW1vdmVEYXRhKGVsZW0pOwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0pOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmRvbUJhc2VMaWJNYWluSW5zZXJ0aW9uID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBnZXRTY3JpcHQgPSBpb1NjcmlwdDsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIFBBUkVOVF9OT0RFID0gJ3BhcmVudE5vZGUnOwogIHZhciBOb2RlVHlwZSA9IERvbS5Ob2RlVHlwZTsKICB2YXIgUkVfRk9STV9FTCA9IC9eKD86YnV0dG9ufGlucHV0fG9iamVjdHxzZWxlY3R8dGV4dGFyZWEpJC9pOwogIHZhciBnZXROb2RlTmFtZSA9IERvbS5ub2RlTmFtZTsKICB2YXIgbWFrZUFycmF5ID0gdXRpbC5tYWtlQXJyYXk7CiAgdmFyIHNwbGljZSA9IFtdLnNwbGljZTsKICB2YXIgTkVYVF9TSUJMSU5HID0gJ25leHRTaWJsaW5nJzsKICB2YXIgUl9TQ1JJUFRfVFlQRSA9IC9cLyhqYXZhfGVjbWEpc2NyaXB0L2k7CiAgZnVuY3Rpb24gaXNKcyhlbCkgewogICAgcmV0dXJuICFlbC50eXBlIHx8IFJfU0NSSVBUX1RZUEUudGVzdChlbC50eXBlKTsKICB9CiAgZnVuY3Rpb24gZmlsdGVyU2NyaXB0cyhub2Rlcywgc2NyaXB0cykgewogICAgdmFyIHJldCA9IFtdOwogICAgdmFyIGk7CiAgICB2YXIgZWw7CiAgICB2YXIgbm9kZU5hbWU7CiAgICBmb3IgKGkgPSAwOyBub2Rlc1tpXTsgaSsrKSB7CiAgICAgIGVsID0gbm9kZXNbaV07CiAgICAgIG5vZGVOYW1lID0gZ2V0Tm9kZU5hbWUoZWwpOwogICAgICBpZiAoZWwubm9kZVR5cGUgPT09IE5vZGVUeXBlLkRPQ1VNRU5UX0ZSQUdNRU5UX05PREUpIHsKICAgICAgICByZXQucHVzaC5hcHBseShyZXQsIGZpbHRlclNjcmlwdHMobWFrZUFycmF5KGVsLmNoaWxkTm9kZXMpLCBzY3JpcHRzKSk7CiAgICAgIH0gZWxzZSBpZiAobm9kZU5hbWUgPT09ICdzY3JpcHQnICYmIGlzSnMoZWwpKSB7CiAgICAgICAgaWYgKGVsLnBhcmVudE5vZGUpIHsKICAgICAgICAgIGVsLnBhcmVudE5vZGUucmVtb3ZlQ2hpbGQoZWwpOwogICAgICAgIH0KICAgICAgICBpZiAoc2NyaXB0cykgewogICAgICAgICAgc2NyaXB0cy5wdXNoKGVsKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGVsLm5vZGVUeXBlID09PSBOb2RlVHlwZS5FTEVNRU5UX05PREUgJiYgIVJFX0ZPUk1fRUwudGVzdChub2RlTmFtZSkpIHsKICAgICAgICAgIHZhciB0bXAgPSBbXTsKICAgICAgICAgIHZhciBzOwogICAgICAgICAgdmFyIGo7CiAgICAgICAgICB2YXIgc3MgPSBlbC5nZXRFbGVtZW50c0J5VGFnTmFtZSgnc2NyaXB0Jyk7CiAgICAgICAgICBmb3IgKGogPSAwOyBqIDwgc3MubGVuZ3RoOyBqKyspIHsKICAgICAgICAgICAgcyA9IHNzW2pdOwogICAgICAgICAgICBpZiAoaXNKcyhzKSkgewogICAgICAgICAgICAgIHRtcC5wdXNoKHMpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICBzcGxpY2UuYXBwbHkobm9kZXMsIFsKICAgICAgICAgICAgaSArIDEsCiAgICAgICAgICAgIDAKICAgICAgICAgIF0uY29uY2F0KHRtcCkpOwogICAgICAgIH0KICAgICAgICByZXQucHVzaChlbCk7CiAgICAgIH0KICAgIH0KICAgIHJldHVybiByZXQ7CiAgfQogIGZ1bmN0aW9uIGV2YWxTY3JpcHQoZWwpIHsKICAgIGlmIChlbC5zcmMpIHsKICAgICAgZ2V0U2NyaXB0KGVsLnNyYyk7CiAgICB9IGVsc2UgewogICAgICB2YXIgY29kZSA9IHV0aWwudHJpbShlbC50ZXh0IHx8IGVsLnRleHRDb250ZW50IHx8IGVsLmlubmVySFRNTCB8fCAnJyk7CiAgICAgIGlmIChjb2RlKSB7CiAgICAgICAgdXRpbC5nbG9iYWxFdmFsKGNvZGUpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGluc2VydGlvbihuZXdOb2RlcywgcmVmTm9kZXMsIGZuLCBzY3JpcHRzKSB7CiAgICBuZXdOb2RlcyA9IERvbS5xdWVyeShuZXdOb2Rlcyk7CiAgICBpZiAoc2NyaXB0cykgewogICAgICBzY3JpcHRzID0gW107CiAgICB9CiAgICBuZXdOb2RlcyA9IGZpbHRlclNjcmlwdHMobmV3Tm9kZXMsIHNjcmlwdHMpOwogICAgaWYgKERvbS5fZml4SW5zZXJ0aW9uQ2hlY2tlZCkgewogICAgICBEb20uX2ZpeEluc2VydGlvbkNoZWNrZWQobmV3Tm9kZXMpOwogICAgfQogICAgcmVmTm9kZXMgPSBEb20ucXVlcnkocmVmTm9kZXMpOwogICAgdmFyIG5ld05vZGVzTGVuZ3RoID0gbmV3Tm9kZXMubGVuZ3RoOwogICAgdmFyIG5ld05vZGU7CiAgICB2YXIgaTsKICAgIHZhciByZWZOb2RlOwogICAgdmFyIG5vZGU7CiAgICB2YXIgY2xvbmVkTm9kZTsKICAgIHZhciByZWZOb2Rlc0xlbmd0aCA9IHJlZk5vZGVzLmxlbmd0aDsKICAgIGlmICghbmV3Tm9kZXNMZW5ndGggJiYgKCFzY3JpcHRzIHx8ICFzY3JpcHRzLmxlbmd0aCkgfHwgIXJlZk5vZGVzTGVuZ3RoKSB7CiAgICAgIHJldHVybjsKICAgIH0KICAgIG5ld05vZGUgPSBEb20uX25vZGVMaXN0VG9GcmFnbWVudChuZXdOb2Rlcyk7CiAgICBpZiAocmVmTm9kZXNMZW5ndGggPiAxKSB7CiAgICAgIGNsb25lZE5vZGUgPSBEb20uY2xvbmUobmV3Tm9kZSwgdHJ1ZSk7CiAgICAgIHJlZk5vZGVzID0gdXRpbC5tYWtlQXJyYXkocmVmTm9kZXMpOwogICAgfQogICAgZm9yIChpID0gMDsgaSA8IHJlZk5vZGVzTGVuZ3RoOyBpKyspIHsKICAgICAgcmVmTm9kZSA9IHJlZk5vZGVzW2ldOwogICAgICBpZiAobmV3Tm9kZSkgewogICAgICAgIG5vZGUgPSBpID4gMCA/IERvbS5jbG9uZShjbG9uZWROb2RlLCB0cnVlKSA6IG5ld05vZGU7CiAgICAgICAgZm4obm9kZSwgcmVmTm9kZSk7CiAgICAgIH0KICAgICAgaWYgKHNjcmlwdHMgJiYgc2NyaXB0cy5sZW5ndGgpIHsKICAgICAgICB1dGlsLmVhY2goc2NyaXB0cywgZXZhbFNjcmlwdCk7CiAgICAgIH0KICAgIH0KICB9CiAgdXRpbC5taXgoRG9tLCB7CiAgICBfZml4SW5zZXJ0aW9uQ2hlY2tlZDogbnVsbCwKICAgIGluc2VydEJlZm9yZTogZnVuY3Rpb24gKG5ld05vZGVzLCByZWZOb2RlcywgbG9hZFNjcmlwdHMpIHsKICAgICAgaW5zZXJ0aW9uKG5ld05vZGVzLCByZWZOb2RlcywgZnVuY3Rpb24gKG5ld05vZGUsIHJlZk5vZGUpIHsKICAgICAgICBpZiAocmVmTm9kZVtQQVJFTlRfTk9ERV0pIHsKICAgICAgICAgIHJlZk5vZGVbUEFSRU5UX05PREVdLmluc2VydEJlZm9yZShuZXdOb2RlLCByZWZOb2RlKTsKICAgICAgICB9CiAgICAgIH0sIGxvYWRTY3JpcHRzKTsKICAgIH0sCiAgICBpbnNlcnRBZnRlcjogZnVuY3Rpb24gKG5ld05vZGVzLCByZWZOb2RlcywgbG9hZFNjcmlwdHMpIHsKICAgICAgaW5zZXJ0aW9uKG5ld05vZGVzLCByZWZOb2RlcywgZnVuY3Rpb24gKG5ld05vZGUsIHJlZk5vZGUpIHsKICAgICAgICBpZiAocmVmTm9kZVtQQVJFTlRfTk9ERV0pIHsKICAgICAgICAgIHJlZk5vZGVbUEFSRU5UX05PREVdLmluc2VydEJlZm9yZShuZXdOb2RlLCByZWZOb2RlW05FWFRfU0lCTElOR10pOwogICAgICAgIH0KICAgICAgfSwgbG9hZFNjcmlwdHMpOwogICAgfSwKICAgIGFwcGVuZFRvOiBmdW5jdGlvbiAobmV3Tm9kZXMsIHBhcmVudHMsIGxvYWRTY3JpcHRzKSB7CiAgICAgIGluc2VydGlvbihuZXdOb2RlcywgcGFyZW50cywgZnVuY3Rpb24gKG5ld05vZGUsIHBhcmVudCkgewogICAgICAgIHBhcmVudC5hcHBlbmRDaGlsZChuZXdOb2RlKTsKICAgICAgfSwgbG9hZFNjcmlwdHMpOwogICAgfSwKICAgIHByZXBlbmRUbzogZnVuY3Rpb24gKG5ld05vZGVzLCBwYXJlbnRzLCBsb2FkU2NyaXB0cykgewogICAgICBpbnNlcnRpb24obmV3Tm9kZXMsIHBhcmVudHMsIGZ1bmN0aW9uIChuZXdOb2RlLCBwYXJlbnQpIHsKICAgICAgICBwYXJlbnQuaW5zZXJ0QmVmb3JlKG5ld05vZGUsIHBhcmVudC5maXJzdENoaWxkKTsKICAgICAgfSwgbG9hZFNjcmlwdHMpOwogICAgfSwKICAgIHJlcGxhY2VXaXRoOiBmdW5jdGlvbiAoc2VsZWN0b3IsIG5ld05vZGVzKSB7CiAgICAgIHZhciBub2RlcyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIG5ld05vZGVzID0gRG9tLnF1ZXJ5KG5ld05vZGVzKTsKICAgICAgRG9tLnJlbW92ZShuZXdOb2RlcywgdHJ1ZSk7CiAgICAgIERvbS5pbnNlcnRCZWZvcmUobmV3Tm9kZXMsIG5vZGVzKTsKICAgICAgRG9tLnJlbW92ZShub2Rlcyk7CiAgICB9CiAgfSk7CiAgdXRpbC5lYWNoKHsKICAgIHByZXBlbmQ6ICdwcmVwZW5kVG8nLAogICAgYXBwZW5kOiAnYXBwZW5kVG8nLAogICAgYmVmb3JlOiAnaW5zZXJ0QmVmb3JlJywKICAgIGFmdGVyOiAnaW5zZXJ0QWZ0ZXInCiAgfSwgZnVuY3Rpb24gKHZhbHVlLCBrZXkpIHsKICAgIERvbVtrZXldID0gRG9tW3ZhbHVlXTsKICB9KTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpkb21CYXNlTGliTWFpbk9mZnNldCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIHdpbiA9IHdpbmRvdzsKICB2YXIgZG9jID0gd2luLmRvY3VtZW50OwogIHZhciBOb2RlVHlwZSA9IERvbS5Ob2RlVHlwZTsKICB2YXIgZG9jRWxlbSA9IGRvYyAmJiBkb2MuZG9jdW1lbnRFbGVtZW50OwogIHZhciBnZXRXaW5kb3cgPSBEb20uZ2V0V2luZG93OwogIHZhciBDU1MxQ29tcGF0ID0gJ0NTUzFDb21wYXQnOwogIHZhciBjb21wYXRNb2RlID0gJ2NvbXBhdE1vZGUnOwogIHZhciBtYXggPSBNYXRoLm1heDsKICB2YXIgUE9TSVRJT04gPSAncG9zaXRpb24nOwogIHZhciBSRUxBVElWRSA9ICdyZWxhdGl2ZSc7CiAgdmFyIERPQ1VNRU5UID0gJ2RvY3VtZW50JzsKICB2YXIgQk9EWSA9ICdib2R5JzsKICB2YXIgRE9DX0VMRU1FTlQgPSAnZG9jdW1lbnRFbGVtZW50JzsKICB2YXIgVklFV1BPUlQgPSAndmlld3BvcnQnOwogIHZhciBTQ1JPTEwgPSAnc2Nyb2xsJzsKICB2YXIgQ0xJRU5UID0gJ2NsaWVudCc7CiAgdmFyIExFRlQgPSAnbGVmdCc7CiAgdmFyIFRPUCA9ICd0b3AnOwogIHZhciBTQ1JPTExfTEVGVCA9IFNDUk9MTCArICdMZWZ0JzsKICB2YXIgU0NST0xMX1RPUCA9IFNDUk9MTCArICdUb3AnOwogIHZhciBtb2JpbGUgPSAvQW5kcm9pZHx3ZWJPU3xpUGhvbmV8aVBhZHxpUG9kfEJsYWNrQmVycnl8SUVNb2JpbGV8T3BlcmEgTWluaS9pLnRlc3QobmF2aWdhdG9yLnVzZXJBZ2VudCk7CiAgdXRpbC5taXgoRG9tLCB7CiAgICBvZmZzZXQ6IGZ1bmN0aW9uIChzZWxlY3RvciwgY29vcmRpbmF0ZXMsIHJlbGF0aXZlV2luKSB7CiAgICAgIHZhciBlbGVtOwogICAgICBpZiAoY29vcmRpbmF0ZXMgPT09IHVuZGVmaW5lZCkgewogICAgICAgIGVsZW0gPSBEb20uZ2V0KHNlbGVjdG9yKTsKICAgICAgICB2YXIgcmV0OwogICAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgICByZXQgPSBnZXRPZmZzZXQoZWxlbSwgcmVsYXRpdmVXaW4pOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0OwogICAgICB9CiAgICAgIHZhciBlbHMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICB2YXIgaTsKICAgICAgZm9yIChpID0gZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgZWxlbSA9IGVsc1tpXTsKICAgICAgICBzZXRPZmZzZXQoZWxlbSwgY29vcmRpbmF0ZXMpOwogICAgICB9CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9LAogICAgZG9jV2lkdGg6IDAsCiAgICBkb2NIZWlnaHQ6IDAsCiAgICB2aWV3cG9ydEhlaWdodDogMCwKICAgIHZpZXdwb3J0V2lkdGg6IDAsCiAgICBzY3JvbGxUb3A6IDAsCiAgICBzY3JvbGxMZWZ0OiAwCiAgfSk7CiAgdXRpbC5lYWNoKFsKICAgICdMZWZ0JywKICAgICdUb3AnCiAgXSwgZnVuY3Rpb24gKG5hbWUsIGkpIHsKICAgIHZhciBtZXRob2QgPSBTQ1JPTEwgKyBuYW1lOwogICAgRG9tW21ldGhvZF0gPSBmdW5jdGlvbiAoZWxlbSwgdikgewogICAgICBpZiAodHlwZW9mIGVsZW0gPT09ICdudW1iZXInKSB7CiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5jYWxsZWUod2luLCBlbGVtKTsKICAgICAgfQogICAgICBlbGVtID0gRG9tLmdldChlbGVtKTsKICAgICAgdmFyIHJldDsKICAgICAgdmFyIGxlZnQ7CiAgICAgIHZhciB0b3A7CiAgICAgIHZhciB3OwogICAgICB2YXIgZDsKICAgICAgaWYgKGVsZW0gJiYgZWxlbS5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgaWYgKHYgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgZWxlbVttZXRob2RdID0gcGFyc2VGbG9hdCh2KTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgcmV0ID0gZWxlbVttZXRob2RdOwogICAgICAgIH0KICAgICAgfSBlbHNlIHsKICAgICAgICB3ID0gZ2V0V2luZG93KGVsZW0pOwogICAgICAgIGlmICh2ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHYgPSBwYXJzZUZsb2F0KHYpOwogICAgICAgICAgbGVmdCA9IG5hbWUgPT09ICdMZWZ0JyA/IHYgOiBEb20uc2Nyb2xsTGVmdCh3KTsKICAgICAgICAgIHRvcCA9IG5hbWUgPT09ICdUb3AnID8gdiA6IERvbS5zY3JvbGxUb3Aodyk7CiAgICAgICAgICB3LnNjcm9sbFRvKGxlZnQsIHRvcCk7CiAgICAgICAgfSBlbHNlIHsKICAgICAgICAgIHJldCA9IHdbJ3BhZ2UnICsgKGkgPyAnWScgOiAnWCcpICsgJ09mZnNldCddOwogICAgICAgICAgaWYgKHR5cGVvZiByZXQgIT09ICdudW1iZXInKSB7CiAgICAgICAgICAgIGQgPSB3W0RPQ1VNRU5UXTsKICAgICAgICAgICAgcmV0ID0gZFtET0NfRUxFTUVOVF1bbWV0aG9kXTsKICAgICAgICAgICAgaWYgKHR5cGVvZiByZXQgIT09ICdudW1iZXInKSB7CiAgICAgICAgICAgICAgcmV0ID0gZFtCT0RZXVttZXRob2RdOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiByZXQ7CiAgICB9OwogIH0pOwogIHV0aWwuZWFjaChbCiAgICAnV2lkdGgnLAogICAgJ0hlaWdodCcKICBdLCBmdW5jdGlvbiAobmFtZSkgewogICAgRG9tWydkb2MnICsgbmFtZV0gPSBmdW5jdGlvbiAocmVmV2luKSB7CiAgICAgIHJlZldpbiA9IERvbS5nZXQocmVmV2luKTsKICAgICAgdmFyIGQgPSBEb20uZ2V0RG9jdW1lbnQocmVmV2luKTsKICAgICAgcmV0dXJuIG1heChkW0RPQ19FTEVNRU5UXVtTQ1JPTEwgKyBuYW1lXSwgZFtCT0RZXVtTQ1JPTEwgKyBuYW1lXSwgRG9tW1ZJRVdQT1JUICsgbmFtZV0oZCkpOwogICAgfTsKICAgIERvbVtWSUVXUE9SVCArIG5hbWVdID0gZnVuY3Rpb24gKHJlZldpbikgewogICAgICByZWZXaW4gPSBEb20uZ2V0KHJlZldpbik7CiAgICAgIHZhciByZWZXaW5kb3cgPSBnZXRXaW5kb3cocmVmV2luKTsKICAgICAgdmFyIHJldCA9IHJlZldpbmRvd1snaW5uZXInICsgbmFtZV07CiAgICAgIGlmIChtb2JpbGUgJiYgcmV0KSB7CiAgICAgICAgcmV0dXJuIHJldDsKICAgICAgfQogICAgICB2YXIgcHJvcCA9IENMSUVOVCArIG5hbWU7CiAgICAgIHZhciByZWZEb2MgPSByZWZXaW5kb3dbRE9DVU1FTlRdOwogICAgICB2YXIgYm9keSA9IHJlZkRvY1tCT0RZXTsKICAgICAgdmFyIGRvY3VtZW50RWxlbWVudCA9IHJlZkRvY1tET0NfRUxFTUVOVF07CiAgICAgIHZhciBkb2N1bWVudEVsZW1lbnRQcm9wID0gZG9jdW1lbnRFbGVtZW50W3Byb3BdOwogICAgICByZXR1cm4gcmVmRG9jW2NvbXBhdE1vZGVdID09PSBDU1MxQ29tcGF0ICYmIGRvY3VtZW50RWxlbWVudFByb3AgfHwgYm9keSAmJiBib2R5W3Byb3BdIHx8IGRvY3VtZW50RWxlbWVudFByb3A7CiAgICB9OwogIH0pOwogIGZ1bmN0aW9uIGdldENsaWVudFBvc2l0aW9uKGVsZW0pIHsKICAgIHZhciBib3g7CiAgICB2YXIgeDsKICAgIHZhciB5OwogICAgdmFyIG93bmVyRG9jID0gZWxlbS5vd25lckRvY3VtZW50OwogICAgdmFyIGJvZHkgPSBvd25lckRvYy5ib2R5OwogICAgaWYgKCFlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCkgewogICAgICByZXR1cm4gewogICAgICAgIGxlZnQ6IDAsCiAgICAgICAgdG9wOiAwCiAgICAgIH07CiAgICB9CiAgICBib3ggPSBlbGVtLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgeCA9IGJveFtMRUZUXTsKICAgIHkgPSBib3hbVE9QXTsKICAgIHggLT0gZG9jRWxlbS5jbGllbnRMZWZ0IHx8IGJvZHkuY2xpZW50TGVmdCB8fCAwOwogICAgeSAtPSBkb2NFbGVtLmNsaWVudFRvcCB8fCBib2R5LmNsaWVudFRvcCB8fCAwOwogICAgcmV0dXJuIHsKICAgICAgbGVmdDogeCwKICAgICAgdG9wOiB5CiAgICB9OwogIH0KICBmdW5jdGlvbiBnZXRQYWdlT2Zmc2V0KGVsKSB7CiAgICB2YXIgcG9zID0gZ2V0Q2xpZW50UG9zaXRpb24oZWwpOwogICAgdmFyIHcgPSBnZXRXaW5kb3coZWwpOwogICAgcG9zLmxlZnQgKz0gRG9tW1NDUk9MTF9MRUZUXSh3KTsKICAgIHBvcy50b3AgKz0gRG9tW1NDUk9MTF9UT1BdKHcpOwogICAgcmV0dXJuIHBvczsKICB9CiAgZnVuY3Rpb24gZ2V0T2Zmc2V0KGVsLCByZWxhdGl2ZVdpbikgewogICAgdmFyIHBvc2l0aW9uID0gewogICAgICBsZWZ0OiAwLAogICAgICB0b3A6IDAKICAgIH07CiAgICB2YXIgY3VycmVudFdpbiA9IGdldFdpbmRvdyhlbCk7CiAgICB2YXIgb2Zmc2V0OwogICAgdmFyIGN1cnJlbnRFbCA9IGVsOwogICAgcmVsYXRpdmVXaW4gPSByZWxhdGl2ZVdpbiB8fCBjdXJyZW50V2luOwogICAgZG8gewogICAgICBvZmZzZXQgPSBjdXJyZW50V2luID09IHJlbGF0aXZlV2luID8gZ2V0UGFnZU9mZnNldChjdXJyZW50RWwpIDogZ2V0Q2xpZW50UG9zaXRpb24oY3VycmVudEVsKTsKICAgICAgcG9zaXRpb24ubGVmdCArPSBvZmZzZXQubGVmdDsKICAgICAgcG9zaXRpb24udG9wICs9IG9mZnNldC50b3A7CiAgICB9IHdoaWxlIChjdXJyZW50V2luICYmIGN1cnJlbnRXaW4gIT0gcmVsYXRpdmVXaW4gJiYgKGN1cnJlbnRFbCA9IGN1cnJlbnRXaW4uZnJhbWVFbGVtZW50KSAmJiAoY3VycmVudFdpbiA9IGN1cnJlbnRXaW4ucGFyZW50KSk7CiAgICByZXR1cm4gcG9zaXRpb247CiAgfQogIGZ1bmN0aW9uIHNldE9mZnNldChlbGVtLCBvZmZzZXQpIHsKICAgIGlmIChEb20uY3NzKGVsZW0sIFBPU0lUSU9OKSA9PT0gJ3N0YXRpYycpIHsKICAgICAgZWxlbS5zdHlsZVtQT1NJVElPTl0gPSBSRUxBVElWRTsKICAgIH0KICAgIHZhciBvbGQgPSBnZXRPZmZzZXQoZWxlbSk7CiAgICB2YXIgcmV0ID0ge307CiAgICB2YXIgY3VycmVudDsKICAgIHZhciBrZXk7CiAgICBmb3IgKGtleSBpbiBvZmZzZXQpIHsKICAgICAgY3VycmVudCA9IHBhcnNlRmxvYXQoRG9tLmNzcyhlbGVtLCBrZXkpKSB8fCAwOwogICAgICByZXRba2V5XSA9IGN1cnJlbnQgKyBvZmZzZXRba2V5XSAtIG9sZFtrZXldOwogICAgfQogICAgRG9tLmNzcyhlbGVtLCByZXQpOwogIH0KICByZXR1cm4gZXhwb3J0czsKfSgpOwpkb21CYXNlTGliTWFpblN0eWxlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBGZWF0dXJlID0gZmVhdHVyZTsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIGdsb2JhbFdpbmRvdyA9IHdpbmRvdzsKICB2YXIgZ2V0Q3NzVmVuZG9ySW5mbyA9IEZlYXR1cmUuZ2V0Q3NzVmVuZG9ySW5mbzsKICB2YXIgQk9YX01PREVMUyA9IFsKICAgICdtYXJnaW4nLAogICAgJ2JvcmRlcicsCiAgICAncGFkZGluZycKICBdOwogIHZhciBDT05URU5UX0lOREVYID0gLTE7CiAgdmFyIFBBRERJTkdfSU5ERVggPSAyOwogIHZhciBCT1JERVJfSU5ERVggPSAxOwogIHZhciBNQVJHSU5fSU5ERVggPSAwOwogIHZhciBkb2MgPSBnbG9iYWxXaW5kb3cuZG9jdW1lbnQgfHwge307CiAgdmFyIFJFX01BUkdJTiA9IC9ebWFyZ2luLzsKICB2YXIgV0lEVEggPSAnd2lkdGgnOwogIHZhciBIRUlHSFQgPSAnaGVpZ2h0JzsKICB2YXIgRElTUExBWSA9ICdkaXNwbGF5JzsKICB2YXIgT0xEX0RJU1BMQVkgPSBESVNQTEFZICsgdXRpbC5ub3coKTsKICB2YXIgTk9ORSA9ICdub25lJzsKICB2YXIgY3NzTnVtYmVyID0gewogICAgZmlsbE9wYWNpdHk6IDEsCiAgICBmb250V2VpZ2h0OiAxLAogICAgbGluZUhlaWdodDogMSwKICAgIG9wYWNpdHk6IDEsCiAgICBvcnBoYW5zOiAxLAogICAgd2lkb3dzOiAxLAogICAgekluZGV4OiAxLAogICAgem9vbTogMQogIH07CiAgdmFyIEVNUFRZID0gJyc7CiAgdmFyIERFRkFVTFRfVU5JVCA9ICdweCc7CiAgdmFyIE5PX1BYX1JFRyA9IC9cZCg/IXB4KVthLXolXSskL2k7CiAgdmFyIGNzc0hvb2tzID0ge307CiAgdmFyIGNzc1Byb3BzID0geyAnZmxvYXQnOiAnY3NzRmxvYXQnIH07CiAgdmFyIGRlZmF1bHREaXNwbGF5ID0ge307CiAgdmFyIGNhbWVsQ2FzZSA9IHV0aWwuY2FtZWxDYXNlOwogIGZ1bmN0aW9uIG5vcm1hbGl6ZUNzc1Byb3BOYW1lKG5hbWUpIHsKICAgIGlmIChjc3NQcm9wc1tuYW1lXSkgewogICAgICByZXR1cm4gY3NzUHJvcHNbbmFtZV07CiAgICB9CiAgICB2YXIgdmVuZG9yID0gZ2V0Q3NzVmVuZG9ySW5mbyhuYW1lKTsKICAgIHJldHVybiB2ZW5kb3IgJiYgdmVuZG9yLnByb3BlcnR5TmFtZSB8fCBuYW1lOwogIH0KICBmdW5jdGlvbiBnZXREZWZhdWx0RGlzcGxheSh0YWdOYW1lKSB7CiAgICB2YXIgYm9keTsKICAgIHZhciBvbGREaXNwbGF5ID0gZGVmYXVsdERpc3BsYXlbdGFnTmFtZV07CiAgICB2YXIgZWxlbTsKICAgIGlmICghZGVmYXVsdERpc3BsYXlbdGFnTmFtZV0pIHsKICAgICAgYm9keSA9IGRvYy5ib2R5IHx8IGRvYy5kb2N1bWVudEVsZW1lbnQ7CiAgICAgIGVsZW0gPSBkb2MuY3JlYXRlRWxlbWVudCh0YWdOYW1lKTsKICAgICAgRG9tLnByZXBlbmQoZWxlbSwgYm9keSk7CiAgICAgIG9sZERpc3BsYXkgPSBEb20uY3NzKGVsZW0sICdkaXNwbGF5Jyk7CiAgICAgIGJvZHkucmVtb3ZlQ2hpbGQoZWxlbSk7CiAgICAgIGRlZmF1bHREaXNwbGF5W3RhZ05hbWVdID0gb2xkRGlzcGxheTsKICAgIH0KICAgIHJldHVybiBvbGREaXNwbGF5OwogIH0KICB1dGlsLm1peChEb20sIHsKICAgIF9jc3NIb29rczogY3NzSG9va3MsCiAgICBfY3NzUHJvcHM6IGNzc1Byb3BzLAogICAgX2dldENvbXB1dGVkU3R5bGU6IGZ1bmN0aW9uIChlbGVtLCBuYW1lLCBjb21wdXRlZFN0eWxlKSB7CiAgICAgIHZhciB2YWwgPSAnJzsKICAgICAgdmFyIHdpZHRoOwogICAgICB2YXIgbWluV2lkdGg7CiAgICAgIHZhciBtYXhXaWR0aDsKICAgICAgdmFyIGVsU3R5bGU7CiAgICAgIHZhciBkID0gZWxlbS5vd25lckRvY3VtZW50OwogICAgICBuYW1lID0gbm9ybWFsaXplQ3NzUHJvcE5hbWUobmFtZSk7CiAgICAgIGlmIChjb21wdXRlZFN0eWxlID0gY29tcHV0ZWRTdHlsZSB8fCBkLmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWxlbSwgbnVsbCkpIHsKICAgICAgICB2YWwgPSBjb21wdXRlZFN0eWxlLmdldFByb3BlcnR5VmFsdWUobmFtZSkgfHwgY29tcHV0ZWRTdHlsZVtuYW1lXTsKICAgICAgfQogICAgICBpZiAodmFsID09PSAnJyAmJiAhRG9tLmNvbnRhaW5zKGQsIGVsZW0pKSB7CiAgICAgICAgdmFsID0gZWxlbS5zdHlsZVtuYW1lXTsKICAgICAgfQogICAgICBpZiAoRG9tLl9SRV9OVU1fTk9fUFgudGVzdCh2YWwpICYmIFJFX01BUkdJTi50ZXN0KG5hbWUpKSB7CiAgICAgICAgZWxTdHlsZSA9IGVsZW0uc3R5bGU7CiAgICAgICAgd2lkdGggPSBlbFN0eWxlLndpZHRoOwogICAgICAgIG1pbldpZHRoID0gZWxTdHlsZS5taW5XaWR0aDsKICAgICAgICBtYXhXaWR0aCA9IGVsU3R5bGUubWF4V2lkdGg7CiAgICAgICAgZWxTdHlsZS5taW5XaWR0aCA9IGVsU3R5bGUubWF4V2lkdGggPSBlbFN0eWxlLndpZHRoID0gdmFsOwogICAgICAgIHZhbCA9IGNvbXB1dGVkU3R5bGUud2lkdGg7CiAgICAgICAgZWxTdHlsZS53aWR0aCA9IHdpZHRoOwogICAgICAgIGVsU3R5bGUubWluV2lkdGggPSBtaW5XaWR0aDsKICAgICAgICBlbFN0eWxlLm1heFdpZHRoID0gbWF4V2lkdGg7CiAgICAgIH0KICAgICAgcmV0dXJuIHZhbDsKICAgIH0sCiAgICBfc3R5bGU6IHN0eWxlLAogICAgY3NzOiBmdW5jdGlvbiAoc2VsZWN0b3IsIG5hbWUsIHZhbCkgewogICAgICB2YXIgZWxzID0gRG9tLnF1ZXJ5KHNlbGVjdG9yKTsKICAgICAgdmFyIGVsZW0gPSBlbHNbMF07CiAgICAgIHZhciBrOwogICAgICB2YXIgaG9vazsKICAgICAgdmFyIHJldDsKICAgICAgdmFyIGk7CiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHsKICAgICAgICBmb3IgKGsgaW4gbmFtZSkgewogICAgICAgICAgZm9yIChpID0gZWxzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIHN0eWxlKGVsc1tpXSwgaywgbmFtZVtrXSk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgbmFtZSA9IGNhbWVsQ2FzZShuYW1lKTsKICAgICAgaG9vayA9IGNzc0hvb2tzW25hbWVdOwogICAgICBpZiAodmFsID09PSB1bmRlZmluZWQpIHsKICAgICAgICByZXQgPSAnJzsKICAgICAgICBpZiAoZWxlbSkgewogICAgICAgICAgaWYgKCEoaG9vayAmJiAnZ2V0JyBpbiBob29rICYmIChyZXQgPSBob29rLmdldChlbGVtLCB0cnVlKSkgIT09IHVuZGVmaW5lZCkpIHsKICAgICAgICAgICAgcmV0ID0gRG9tLl9nZXRDb21wdXRlZFN0eWxlKGVsZW0sIG5hbWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdHlwZW9mIHJldCA9PT0gJ3VuZGVmaW5lZCcgPyAnJyA6IHJldDsKICAgICAgfSBlbHNlIHsKICAgICAgICBmb3IgKGkgPSBlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgIHN0eWxlKGVsc1tpXSwgbmFtZSwgdmFsLCAxKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0sCiAgICBzaG93OiBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgdmFyIGVscyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIHZhciB0YWdOYW1lOwogICAgICB2YXIgb2xkOwogICAgICB2YXIgZWxlbTsKICAgICAgdmFyIGk7CiAgICAgIGZvciAoaSA9IGVscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGVsZW0gPSBlbHNbaV07CiAgICAgICAgZWxlbS5zdHlsZVtESVNQTEFZXSA9IERvbS5kYXRhKGVsZW0sIE9MRF9ESVNQTEFZKSB8fCBFTVBUWTsKICAgICAgICBpZiAoRG9tLmNzcyhlbGVtLCBESVNQTEFZKSA9PT0gTk9ORSkgewogICAgICAgICAgdGFnTmFtZSA9IGVsZW0udGFnTmFtZS50b0xvd2VyQ2FzZSgpOwogICAgICAgICAgb2xkID0gZ2V0RGVmYXVsdERpc3BsYXkodGFnTmFtZSk7CiAgICAgICAgICBEb20uZGF0YShlbGVtLCBPTERfRElTUExBWSwgb2xkKTsKICAgICAgICAgIGVsZW0uc3R5bGVbRElTUExBWV0gPSBvbGQ7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgaGlkZTogZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgIHZhciBlbHMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICB2YXIgZWxlbTsKICAgICAgdmFyIGk7CiAgICAgIGZvciAoaSA9IGVscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgIGVsZW0gPSBlbHNbaV07CiAgICAgICAgdmFyIGVsU3R5bGUgPSBlbGVtLnN0eWxlOwogICAgICAgIHZhciBvbGQgPSBlbFN0eWxlW0RJU1BMQVldOwogICAgICAgIGlmIChvbGQgIT09IE5PTkUpIHsKICAgICAgICAgIGlmIChvbGQpIHsKICAgICAgICAgICAgRG9tLmRhdGEoZWxlbSwgT0xEX0RJU1BMQVksIG9sZCk7CiAgICAgICAgICB9CiAgICAgICAgICBlbFN0eWxlW0RJU1BMQVldID0gTk9ORTsKICAgICAgICB9CiAgICAgIH0KICAgIH0sCiAgICB0b2dnbGU6IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICB2YXIgZWxzID0gRG9tLnF1ZXJ5KHNlbGVjdG9yKTsKICAgICAgdmFyIGVsZW07CiAgICAgIHZhciBpOwogICAgICBmb3IgKGkgPSBlbHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICBlbGVtID0gZWxzW2ldOwogICAgICAgIGlmIChEb20uY3NzKGVsZW0sIERJU1BMQVkpID09PSBOT05FKSB7CiAgICAgICAgICBEb20uc2hvdyhlbGVtKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgRG9tLmhpZGUoZWxlbSk7CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgYWRkU3R5bGVTaGVldDogZnVuY3Rpb24gKHJlZldpbiwgY3NzVGV4dCwgaWQpIHsKICAgICAgaWYgKHR5cGVvZiByZWZXaW4gPT09ICdzdHJpbmcnKSB7CiAgICAgICAgaWQgPSBjc3NUZXh0OwogICAgICAgIGNzc1RleHQgPSByZWZXaW47CiAgICAgICAgcmVmV2luID0gZ2xvYmFsV2luZG93OwogICAgICB9CiAgICAgIHZhciByZWZEb2MgPSBEb20uZ2V0RG9jdW1lbnQocmVmV2luKTsKICAgICAgdmFyIGVsZW07CiAgICAgIGlmIChpZCAmJiAoaWQgPSBpZC5yZXBsYWNlKCcjJywgRU1QVFkpKSkgewogICAgICAgIGVsZW0gPSBEb20uZ2V0KCcjJyArIGlkLCByZWZEb2MpOwogICAgICB9CiAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGVsZW0gPSBEb20uY3JlYXRlKCc8c3R5bGU+JywgeyBpZDogaWQgfSwgcmVmRG9jKTsKICAgICAgRG9tLmdldCgnaGVhZCcsIHJlZkRvYykuYXBwZW5kQ2hpbGQoZWxlbSk7CiAgICAgIGlmIChlbGVtLnN0eWxlU2hlZXQpIHsKICAgICAgICBlbGVtLnN0eWxlU2hlZXQuY3NzVGV4dCA9IGNzc1RleHQ7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZWxlbS5hcHBlbmRDaGlsZChyZWZEb2MuY3JlYXRlVGV4dE5vZGUoY3NzVGV4dCkpOwogICAgICB9CiAgICB9LAogICAgaW5uZXJXaWR0aDogMCwKICAgIGlubmVySGVpZ2h0OiAwLAogICAgb3V0ZXJXaWR0aDogMCwKICAgIG91dGVySGVpZ2h0OiAwLAogICAgd2lkdGg6IDAsCiAgICBoZWlnaHQ6IDAKICB9KTsKICB1dGlsLmVhY2goWwogICAgV0lEVEgsCiAgICBIRUlHSFQKICBdLCBmdW5jdGlvbiAobmFtZSkgewogICAgRG9tWydpbm5lcicgKyB1dGlsLnVjZmlyc3QobmFtZSldID0gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgIHZhciBlbCA9IERvbS5nZXQoc2VsZWN0b3IpOwogICAgICByZXR1cm4gZWwgJiYgZ2V0V0hJZ25vcmVEaXNwbGF5KGVsLCBuYW1lLCBQQURESU5HX0lOREVYKTsKICAgIH07CiAgICBEb21bJ291dGVyJyArIHV0aWwudWNmaXJzdChuYW1lKV0gPSBmdW5jdGlvbiAoc2VsZWN0b3IsIGluY2x1ZGVNYXJnaW4pIHsKICAgICAgdmFyIGVsID0gRG9tLmdldChzZWxlY3Rvcik7CiAgICAgIHJldHVybiBlbCAmJiBnZXRXSElnbm9yZURpc3BsYXkoZWwsIG5hbWUsIGluY2x1ZGVNYXJnaW4gPyBNQVJHSU5fSU5ERVggOiBCT1JERVJfSU5ERVgpOwogICAgfTsKICAgIHZhciB3aGljaCA9IG5hbWUgPT09IFdJRFRIID8gWwogICAgICAnTGVmdCcsCiAgICAgICdSaWdodCcKICAgIF0gOiBbCiAgICAgICdUb3AnLAogICAgICAnQm90dG9tJwogICAgXTsKICAgIERvbVtuYW1lXSA9IGZ1bmN0aW9uIChzZWxlY3RvciwgdmFsKSB7CiAgICAgIHZhciBlbGVtID0gRG9tLmdldChzZWxlY3Rvcik7CiAgICAgIGlmICh2YWwgIT09IHVuZGVmaW5lZCkgewogICAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgICB2YXIgY29tcHV0ZWRTdHlsZSA9IGdldENvbXB1dGVkU3R5bGUoZWxlbSk7CiAgICAgICAgICB2YXIgaXNCb3JkZXJCb3ggPSBpc0JvcmRlckJveEZuKGVsZW0sIGNvbXB1dGVkU3R5bGUpOwogICAgICAgICAgaWYgKGlzQm9yZGVyQm94KSB7CiAgICAgICAgICAgIHZhbCArPSBnZXRQQk1XaWR0aChlbGVtLCBbCiAgICAgICAgICAgICAgJ3BhZGRpbmcnLAogICAgICAgICAgICAgICdib3JkZXInCiAgICAgICAgICAgIF0sIHdoaWNoLCBjb21wdXRlZFN0eWxlKTsKICAgICAgICAgIH0KICAgICAgICAgIHJldHVybiBEb20uY3NzKHNlbGVjdG9yLCBuYW1lLCB2YWwpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIHJldHVybiBlbGVtICYmIGdldFdISWdub3JlRGlzcGxheShlbGVtLCBuYW1lLCBDT05URU5UX0lOREVYKTsKICAgIH07CiAgICBjc3NIb29rc1tuYW1lXSA9IHsKICAgICAgZ2V0OiBmdW5jdGlvbiAoZWxlbSwgY29tcHV0ZWQpIHsKICAgICAgICB2YXIgdmFsOwogICAgICAgIGlmIChjb21wdXRlZCkgewogICAgICAgICAgdmFsID0gZ2V0V0hJZ25vcmVEaXNwbGF5KGVsZW0sIG5hbWUpICsgJ3B4JzsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHZhbDsKICAgICAgfQogICAgfTsKICB9KTsKICB2YXIgY3NzU2hvdyA9IHsKICAgIHBvc2l0aW9uOiAnYWJzb2x1dGUnLAogICAgdmlzaWJpbGl0eTogJ2hpZGRlbicsCiAgICBkaXNwbGF5OiAnYmxvY2snCiAgfTsKICB1dGlsLmVhY2goWwogICAgJ2xlZnQnLAogICAgJ3RvcCcKICBdLCBmdW5jdGlvbiAobmFtZSkgewogICAgY3NzSG9va3NbbmFtZV0gPSB7CiAgICAgIGdldDogZnVuY3Rpb24gKGVsLCBjb21wdXRlZCkgewogICAgICAgIHZhciB2YWw7CiAgICAgICAgdmFyIGlzQXV0b1Bvc2l0aW9uOwogICAgICAgIHZhciBwb3NpdGlvbjsKICAgICAgICBpZiAoY29tcHV0ZWQpIHsKICAgICAgICAgIHBvc2l0aW9uID0gRG9tLmNzcyhlbCwgJ3Bvc2l0aW9uJyk7CiAgICAgICAgICBpZiAocG9zaXRpb24gPT09ICdzdGF0aWMnKSB7CiAgICAgICAgICAgIHJldHVybiAnYXV0byc7CiAgICAgICAgICB9CiAgICAgICAgICB2YWwgPSBEb20uX2dldENvbXB1dGVkU3R5bGUoZWwsIG5hbWUpOwogICAgICAgICAgaXNBdXRvUG9zaXRpb24gPSB2YWwgPT09ICdhdXRvJzsKICAgICAgICAgIGlmIChpc0F1dG9Qb3NpdGlvbiAmJiBwb3NpdGlvbiA9PT0gJ3JlbGF0aXZlJykgewogICAgICAgICAgICByZXR1cm4gJzBweCc7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoaXNBdXRvUG9zaXRpb24gfHwgTk9fUFhfUkVHLnRlc3QodmFsKSkgewogICAgICAgICAgICB2YWwgPSBnZXRQb3NpdGlvbihlbClbbmFtZV0gKyAncHgnOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdmFsOwogICAgICB9CiAgICB9OwogIH0pOwogIGZ1bmN0aW9uIHN3YXAoZWxlbSwgb3B0aW9ucywgY2FsbGJhY2spIHsKICAgIHZhciBvbGQgPSB7fTsKICAgIHZhciBlbFN0eWxlID0gZWxlbS5zdHlsZTsKICAgIHZhciBuYW1lOwogICAgZm9yIChuYW1lIGluIG9wdGlvbnMpIHsKICAgICAgb2xkW25hbWVdID0gZWxTdHlsZVtuYW1lXTsKICAgICAgZWxTdHlsZVtuYW1lXSA9IG9wdGlvbnNbbmFtZV07CiAgICB9CiAgICBjYWxsYmFjay5jYWxsKGVsZW0pOwogICAgZm9yIChuYW1lIGluIG9wdGlvbnMpIHsKICAgICAgZWxTdHlsZVtuYW1lXSA9IG9sZFtuYW1lXTsKICAgIH0KICB9CiAgZnVuY3Rpb24gc3R5bGUoZWxlbSwgbmFtZSwgdmFsLCBjYW1lbENhc2VkKSB7CiAgICB2YXIgZWxTdHlsZTsKICAgIHZhciByZXQ7CiAgICB2YXIgaG9vazsKICAgIGlmICghKGVsU3R5bGUgPSBlbGVtLnN0eWxlKSkgewogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfQogICAgbmFtZSA9IGNhbWVsQ2FzZWQgPyBuYW1lIDogY2FtZWxDYXNlKG5hbWUpOwogICAgaG9vayA9IGNzc0hvb2tzW25hbWVdOwogICAgbmFtZSA9IG5vcm1hbGl6ZUNzc1Byb3BOYW1lKG5hbWUpOwogICAgaWYgKHZhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIGlmICh2YWwgPT09IG51bGwgfHwgdmFsID09PSBFTVBUWSkgewogICAgICAgIHZhbCA9IEVNUFRZOwogICAgICB9IGVsc2UgaWYgKCFpc05hTihOdW1iZXIodmFsKSkgJiYgIWNzc051bWJlcltuYW1lXSkgewogICAgICAgIHZhbCArPSBERUZBVUxUX1VOSVQ7CiAgICAgIH0KICAgICAgaWYgKGhvb2sgJiYgaG9vay5zZXQpIHsKICAgICAgICB2YWwgPSBob29rLnNldChlbGVtLCB2YWwpOwogICAgICB9CiAgICAgIGlmICh2YWwgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBlbFN0eWxlW25hbWVdID0gdmFsOwogICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICB9CiAgICAgICAgaWYgKHZhbCA9PT0gRU1QVFkgJiYgZWxTdHlsZS5yZW1vdmVBdHRyaWJ1dGUpIHsKICAgICAgICAgIGVsU3R5bGUucmVtb3ZlQXR0cmlidXRlKG5hbWUpOwogICAgICAgIH0KICAgICAgfQogICAgICBpZiAoIWVsU3R5bGUuY3NzVGV4dCkgewogICAgICAgIGVsZW0ucmVtb3ZlQXR0cmlidXRlKCdzdHlsZScpOwogICAgICB9CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9IGVsc2UgewogICAgICBpZiAoIShob29rICYmICdnZXQnIGluIGhvb2sgJiYgKHJldCA9IGhvb2suZ2V0KGVsZW0sIGZhbHNlKSkgIT09IHVuZGVmaW5lZCkpIHsKICAgICAgICByZXQgPSBlbFN0eWxlW25hbWVdOwogICAgICB9CiAgICAgIHJldHVybiByZXQgPT09IHVuZGVmaW5lZCA/ICcnIDogcmV0OwogICAgfQogIH0KICBmdW5jdGlvbiBnZXRXSElnbm9yZURpc3BsYXkoZWxlbSkgewogICAgdmFyIHZhbDsKICAgIHZhciBhcmdzID0gYXJndW1lbnRzOwogICAgaWYgKGVsZW0ub2Zmc2V0V2lkdGggIT09IDApIHsKICAgICAgdmFsID0gZ2V0V0guYXBwbHkodW5kZWZpbmVkLCBhcmdzKTsKICAgIH0gZWxzZSB7CiAgICAgIHN3YXAoZWxlbSwgY3NzU2hvdywgZnVuY3Rpb24gKCkgewogICAgICAgIHZhbCA9IGdldFdILmFwcGx5KHVuZGVmaW5lZCwgYXJncyk7CiAgICAgIH0pOwogICAgfQogICAgcmV0dXJuIHZhbDsKICB9CiAgZnVuY3Rpb24gZ2V0UEJNV2lkdGgoZWxlbSwgcHJvcHMsIHdoaWNoLCBjb21wdXRlZFN0eWxlKSB7CiAgICB2YXIgdmFsdWUgPSAwOwogICAgdmFyIHByb3A7CiAgICB2YXIgajsKICAgIHZhciBpOwogICAgZm9yIChqID0gMDsgaiA8IHByb3BzLmxlbmd0aDsgaisrKSB7CiAgICAgIHByb3AgPSBwcm9wc1tqXTsKICAgICAgaWYgKHByb3ApIHsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgd2hpY2gubGVuZ3RoOyBpKyspIHsKICAgICAgICAgIHZhciBjc3NQcm9wOwogICAgICAgICAgaWYgKHByb3AgPT09ICdib3JkZXInKSB7CiAgICAgICAgICAgIGNzc1Byb3AgPSBwcm9wICsgd2hpY2hbaV0gKyAnV2lkdGgnOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgY3NzUHJvcCA9IHByb3AgKyB3aGljaFtpXTsKICAgICAgICAgIH0KICAgICAgICAgIHZhbHVlICs9IHBhcnNlRmxvYXQoRG9tLl9nZXRDb21wdXRlZFN0eWxlKGVsZW0sIGNzc1Byb3AsIGNvbXB1dGVkU3R5bGUpKSB8fCAwOwogICAgICAgIH0KICAgICAgfQogICAgfQogICAgcmV0dXJuIHZhbHVlOwogIH0KICBmdW5jdGlvbiBpc0JvcmRlckJveEZuKGVsZW0sIGNvbXB1dGVkU3R5bGUpIHsKICAgIHJldHVybiBEb20uX2dldENvbXB1dGVkU3R5bGUoZWxlbSwgJ2JveFNpemluZycsIGNvbXB1dGVkU3R5bGUpID09PSAnYm9yZGVyLWJveCc7CiAgfQogIGZ1bmN0aW9uIGdldENvbXB1dGVkU3R5bGUoZWxlbSkgewogICAgdmFyIG93bmVyRG9jID0gZWxlbS5vd25lckRvY3VtZW50OwogICAgdmFyIGNvbXB1dGVkU3R5bGU7CiAgICBpZiAob3duZXJEb2MuZGVmYXVsdFZpZXcpIHsKICAgICAgY29tcHV0ZWRTdHlsZSA9IG93bmVyRG9jLmRlZmF1bHRWaWV3LmdldENvbXB1dGVkU3R5bGUoZWxlbSwgbnVsbCk7CiAgICB9CiAgICByZXR1cm4gY29tcHV0ZWRTdHlsZTsKICB9CiAgZnVuY3Rpb24gZ2V0V0goZWxlbSwgbmFtZSwgZXh0cmEpIHsKICAgIGlmICh1dGlsLmlzV2luZG93KGVsZW0pKSB7CiAgICAgIHJldHVybiBuYW1lID09PSBXSURUSCA/IERvbS52aWV3cG9ydFdpZHRoKGVsZW0pIDogRG9tLnZpZXdwb3J0SGVpZ2h0KGVsZW0pOwogICAgfSBlbHNlIGlmIChlbGVtLm5vZGVUeXBlID09PSA5KSB7CiAgICAgIHJldHVybiBuYW1lID09PSBXSURUSCA/IERvbS5kb2NXaWR0aChlbGVtKSA6IERvbS5kb2NIZWlnaHQoZWxlbSk7CiAgICB9CiAgICB2YXIgd2hpY2ggPSBuYW1lID09PSBXSURUSCA/IFsKICAgICAgJ0xlZnQnLAogICAgICAnUmlnaHQnCiAgICBdIDogWwogICAgICAnVG9wJywKICAgICAgJ0JvdHRvbScKICAgIF07CiAgICB2YXIgYm9yZGVyQm94VmFsdWUgPSBuYW1lID09PSBXSURUSCA/IGVsZW0ub2Zmc2V0V2lkdGggOiBlbGVtLm9mZnNldEhlaWdodDsKICAgIHZhciBjb21wdXRlZFN0eWxlID0gZ2V0Q29tcHV0ZWRTdHlsZShlbGVtKTsKICAgIHZhciBpc0JvcmRlckJveCA9IGlzQm9yZGVyQm94Rm4oZWxlbSwgY29tcHV0ZWRTdHlsZSk7CiAgICB2YXIgY3NzQm94VmFsdWUgPSAwOwogICAgaWYgKGJvcmRlckJveFZhbHVlID09IG51bGwgfHwgYm9yZGVyQm94VmFsdWUgPD0gMCkgewogICAgICBib3JkZXJCb3hWYWx1ZSA9IHVuZGVmaW5lZDsKICAgICAgY3NzQm94VmFsdWUgPSBEb20uX2dldENvbXB1dGVkU3R5bGUoZWxlbSwgbmFtZSwgY29tcHV0ZWRTdHlsZSk7CiAgICAgIGlmIChjc3NCb3hWYWx1ZSA9PSBudWxsIHx8IE51bWJlcihjc3NCb3hWYWx1ZSkgPCAwKSB7CiAgICAgICAgY3NzQm94VmFsdWUgPSBlbGVtLnN0eWxlW25hbWVdIHx8IDA7CiAgICAgIH0KICAgICAgY3NzQm94VmFsdWUgPSBwYXJzZUZsb2F0KGNzc0JveFZhbHVlKSB8fCAwOwogICAgfQogICAgaWYgKGV4dHJhID09PSB1bmRlZmluZWQpIHsKICAgICAgZXh0cmEgPSBpc0JvcmRlckJveCA/IEJPUkRFUl9JTkRFWCA6IENPTlRFTlRfSU5ERVg7CiAgICB9CiAgICB2YXIgYm9yZGVyQm94VmFsdWVPcklzQm9yZGVyQm94ID0gYm9yZGVyQm94VmFsdWUgIT09IHVuZGVmaW5lZCB8fCBpc0JvcmRlckJveDsKICAgIHZhciB2YWwgPSBib3JkZXJCb3hWYWx1ZSB8fCBjc3NCb3hWYWx1ZTsKICAgIGlmIChleHRyYSA9PT0gQ09OVEVOVF9JTkRFWCkgewogICAgICBpZiAoYm9yZGVyQm94VmFsdWVPcklzQm9yZGVyQm94KSB7CiAgICAgICAgcmV0dXJuIHZhbCAtIGdldFBCTVdpZHRoKGVsZW0sIFsKICAgICAgICAgICdib3JkZXInLAogICAgICAgICAgJ3BhZGRpbmcnCiAgICAgICAgXSwgd2hpY2gsIGNvbXB1dGVkU3R5bGUpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldHVybiBjc3NCb3hWYWx1ZTsKICAgICAgfQogICAgfSBlbHNlIGlmIChib3JkZXJCb3hWYWx1ZU9ySXNCb3JkZXJCb3gpIHsKICAgICAgcmV0dXJuIHZhbCArIChleHRyYSA9PT0gQk9SREVSX0lOREVYID8gMCA6IGV4dHJhID09PSBQQURESU5HX0lOREVYID8gLWdldFBCTVdpZHRoKGVsZW0sIFsnYm9yZGVyJ10sIHdoaWNoLCBjb21wdXRlZFN0eWxlKSA6IGdldFBCTVdpZHRoKGVsZW0sIFsnbWFyZ2luJ10sIHdoaWNoLCBjb21wdXRlZFN0eWxlKSk7CiAgICB9IGVsc2UgewogICAgICByZXR1cm4gY3NzQm94VmFsdWUgKyBnZXRQQk1XaWR0aChlbGVtLCBCT1hfTU9ERUxTLnNsaWNlKGV4dHJhKSwgd2hpY2gsIGNvbXB1dGVkU3R5bGUpOwogICAgfQogIH0KICB2YXIgUk9PVF9SRUcgPSAvXig/OmJvZHl8aHRtbCkkL2k7CiAgZnVuY3Rpb24gZ2V0UG9zaXRpb24oZWwpIHsKICAgIHZhciBvZmZzZXRQYXJlbnQ7CiAgICB2YXIgb2Zmc2V0OwogICAgdmFyIHBhcmVudE9mZnNldCA9IHsKICAgICAgdG9wOiAwLAogICAgICBsZWZ0OiAwCiAgICB9OwogICAgaWYgKERvbS5jc3MoZWwsICdwb3NpdGlvbicpID09PSAnZml4ZWQnKSB7CiAgICAgIG9mZnNldCA9IGVsLmdldEJvdW5kaW5nQ2xpZW50UmVjdCgpOwogICAgfSBlbHNlIHsKICAgICAgb2Zmc2V0UGFyZW50ID0gZ2V0T2Zmc2V0UGFyZW50KGVsKTsKICAgICAgb2Zmc2V0ID0gRG9tLm9mZnNldChlbCk7CiAgICAgIHBhcmVudE9mZnNldCA9IERvbS5vZmZzZXQob2Zmc2V0UGFyZW50KTsKICAgICAgcGFyZW50T2Zmc2V0LnRvcCArPSBwYXJzZUZsb2F0KERvbS5jc3Mob2Zmc2V0UGFyZW50LCAnYm9yZGVyVG9wV2lkdGgnKSkgfHwgMDsKICAgICAgcGFyZW50T2Zmc2V0LmxlZnQgKz0gcGFyc2VGbG9hdChEb20uY3NzKG9mZnNldFBhcmVudCwgJ2JvcmRlckxlZnRXaWR0aCcpKSB8fCAwOwogICAgfQogICAgb2Zmc2V0LnRvcCAtPSBwYXJzZUZsb2F0KERvbS5jc3MoZWwsICdtYXJnaW5Ub3AnKSkgfHwgMDsKICAgIG9mZnNldC5sZWZ0IC09IHBhcnNlRmxvYXQoRG9tLmNzcyhlbCwgJ21hcmdpbkxlZnQnKSkgfHwgMDsKICAgIHJldHVybiB7CiAgICAgIHRvcDogb2Zmc2V0LnRvcCAtIHBhcmVudE9mZnNldC50b3AsCiAgICAgIGxlZnQ6IG9mZnNldC5sZWZ0IC0gcGFyZW50T2Zmc2V0LmxlZnQKICAgIH07CiAgfQogIGZ1bmN0aW9uIGdldE9mZnNldFBhcmVudChlbCkgewogICAgdmFyIG9mZnNldFBhcmVudCA9IGVsLm9mZnNldFBhcmVudCB8fCAoZWwub3duZXJEb2N1bWVudCB8fCBkb2MpLmJvZHk7CiAgICB3aGlsZSAob2Zmc2V0UGFyZW50ICYmICFST09UX1JFRy50ZXN0KG9mZnNldFBhcmVudC5ub2RlTmFtZSkgJiYgRG9tLmNzcyhvZmZzZXRQYXJlbnQsICdwb3NpdGlvbicpID09PSAnc3RhdGljJykgewogICAgICBvZmZzZXRQYXJlbnQgPSBvZmZzZXRQYXJlbnQub2Zmc2V0UGFyZW50OwogICAgfQogICAgcmV0dXJuIG9mZnNldFBhcmVudDsKICB9CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tQmFzZUxpYk1haW5TZWxlY3RvciA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIERvbSA9IGRvbUJhc2VMaWJNYWluQXBpOwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIHF1ZXJ5U2VsZWN0b3JBbGwgPSBxdWVyeVNlbGVjdG9yQmFzZTsKICB2YXIgZG9jID0gZG9jdW1lbnQ7CiAgdmFyIGRvY0VsZW0gPSBkb2MuZG9jdW1lbnRFbGVtZW50OwogIHZhciBtYXRjaGVzID0gZG9jRWxlbS5tYXRjaGVzIHx8IGRvY0VsZW0ud2Via2l0TWF0Y2hlc1NlbGVjdG9yIHx8IGRvY0VsZW0ubW96TWF0Y2hlc1NlbGVjdG9yIHx8IGRvY0VsZW0ub01hdGNoZXNTZWxlY3RvciB8fCBkb2NFbGVtLm1zTWF0Y2hlc1NlbGVjdG9yOwogIHZhciBzdXBwb3J0R2V0RWxlbWVudHNCeUNsYXNzTmFtZSA9ICdnZXRFbGVtZW50c0J5Q2xhc3NOYW1lJyBpbiBkb2M7CiAgdmFyIGlzQXJyYXkgPSB1dGlsLmlzQXJyYXk7CiAgdmFyIGdldEVsZW1lbnRzQnlDbGFzc05hbWU7CiAgdmFyIG1ha2VBcnJheSA9IHV0aWwubWFrZUFycmF5OwogIHZhciBpc0RvbU5vZGVMaXN0ID0gRG9tLmlzRG9tTm9kZUxpc3Q7CiAgdmFyIFNQQUNFID0gJyAnOwogIHZhciBwdXNoID0gQXJyYXkucHJvdG90eXBlLnB1c2g7CiAgdmFyIHJDbGFzc1NlbGVjdG9yID0gL15cLihbXHctXSspJC87CiAgdmFyIHJJZFNlbGVjdG9yID0gL14jKFtcdy1dKykkLzsKICB2YXIgclRhZ1NlbGVjdG9yID0gL14oW1x3LV0pKyQvOwogIHZhciByVGFnSWRTZWxlY3RvciA9IC9eKFtcdy1dKykjKFtcdy1dKykkLzsKICB2YXIgclNpbXBsZVNlbGVjdG9yID0gL14oPzojKFtcdy1dKykpP1xzKihbXHctXSt8XCopP1wuPyhbXHctXSspPyQvOwogIHZhciB0cmltID0gdXRpbC50cmltOwogIGlmICghc3VwcG9ydEdldEVsZW1lbnRzQnlDbGFzc05hbWUpIHsKICAgIGdldEVsZW1lbnRzQnlDbGFzc05hbWUgPSBmdW5jdGlvbiAoZWwsIG1hdGNoKSB7CiAgICAgIHZhciByZXN1bHQgPSBbXTsKICAgICAgdmFyIGVsZW1lbnRzID0gZWwuZ2V0RWxlbWVudHNCeVRhZ05hbWUoJyonKTsKICAgICAgdmFyIGk7CiAgICAgIHZhciBlbGVtOwogICAgICBtYXRjaCA9ICcgJyArIG1hdGNoICsgJyAnOwogICAgICBmb3IgKGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlbGVtID0gZWxlbWVudHNbaV07CiAgICAgICAgaWYgKCgnICcgKyAoZWxlbS5jbGFzc05hbWUgfHwgZWxlbS5nZXRBdHRyaWJ1dGUoJ2NsYXNzJykpICsgJyAnKS5pbmRleE9mKG1hdGNoKSA+IC0xKSB7CiAgICAgICAgICByZXN1bHQucHVzaChlbGVtKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJlc3VsdDsKICAgIH07CiAgfSBlbHNlIHsKICAgIGdldEVsZW1lbnRzQnlDbGFzc05hbWUgPSBmdW5jdGlvbiAoZWwsIG1hdGNoKSB7CiAgICAgIHJldHVybiBlbC5nZXRFbGVtZW50c0J5Q2xhc3NOYW1lKG1hdGNoKTsKICAgIH07CiAgfQogIGZ1bmN0aW9uIHF1ZXJ5RWFjaChmKSB7CiAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICB2YXIgbCA9IHNlbGYubGVuZ3RoOwogICAgdmFyIGk7CiAgICBmb3IgKGkgPSAwOyBpIDwgbDsgaSsrKSB7CiAgICAgIGlmIChmKHNlbGZbaV0sIGkpID09PSBmYWxzZSkgewogICAgICAgIGJyZWFrOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGNoZWNrU2VsZWN0b3JBbmRSZXR1cm4oc2VsZWN0b3IpIHsKICAgIHZhciBuYW1lID0gc2VsZWN0b3Iuc3Vic3RyKDEpOwogICAgaWYgKCFuYW1lKSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignQW4gaW52YWxpZCBvciBpbGxlZ2FsIHN0cmluZyB3YXMgc3BlY2lmaWVkIGZvciBzZWxlY3Rvci4nKTsKICAgIH0KICAgIHJldHVybiBuYW1lOwogIH0KICBmdW5jdGlvbiBtYWtlTWF0Y2goc2VsZWN0b3IpIHsKICAgIHZhciBzID0gc2VsZWN0b3IuY2hhckF0KDApOwogICAgaWYgKHMgPT09ICcjJykgewogICAgICByZXR1cm4gbWFrZUlkTWF0Y2goY2hlY2tTZWxlY3RvckFuZFJldHVybihzZWxlY3RvcikpOwogICAgfSBlbHNlIGlmIChzID09PSAnLicpIHsKICAgICAgcmV0dXJuIG1ha2VDbGFzc01hdGNoKGNoZWNrU2VsZWN0b3JBbmRSZXR1cm4oc2VsZWN0b3IpKTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBtYWtlVGFnTWF0Y2goc2VsZWN0b3IpOwogICAgfQogIH0KICBmdW5jdGlvbiBtYWtlSWRNYXRjaChpZCkgewogICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIHZhciBtYXRjaCA9IERvbS5fZ2V0RWxlbWVudEJ5SWQoaWQsIGRvYyk7CiAgICAgIHJldHVybiBtYXRjaCAmJiBEb20uX2NvbnRhaW5zKGVsZW0sIG1hdGNoKSA/IFttYXRjaF0gOiBbXTsKICAgIH07CiAgfQogIGZ1bmN0aW9uIG1ha2VDbGFzc01hdGNoKGNsYXNzTmFtZSkgewogICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIHJldHVybiBnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGVsZW0sIGNsYXNzTmFtZSk7CiAgICB9OwogIH0KICBmdW5jdGlvbiBtYWtlVGFnTWF0Y2godGFnTmFtZSkgewogICAgcmV0dXJuIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgIHJldHVybiBlbGVtLmdldEVsZW1lbnRzQnlUYWdOYW1lKHRhZ05hbWUpOwogICAgfTsKICB9CiAgZnVuY3Rpb24gaXNTaW1wbGVTZWxlY3RvcihzZWxlY3RvcikgewogICAgdmFyIGNvbXBsZXhSZWcgPSAvLHxcK3w9fH58XFt8XF18Onw+fFx8fFwkfFxefFwqfFwofFwpfFtcdy1dK1wuW1x3LV0rfFtcdy1dKyNbXHctXSsvOwogICAgcmV0dXJuICFzZWxlY3Rvci5tYXRjaChjb21wbGV4UmVnKTsKICB9CiAgZnVuY3Rpb24gcXVlcnkoc2VsZWN0b3IsIGNvbnRleHQpIHsKICAgIHZhciByZXQ7CiAgICB2YXIgaTsKICAgIHZhciBlbDsKICAgIHZhciBzaW1wbGVDb250ZXh0OwogICAgdmFyIGlzU2VsZWN0b3JTdHJpbmcgPSB0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnOwogICAgdmFyIGNvbnRleHRzID0gY29udGV4dCAhPT0gdW5kZWZpbmVkID8gcXVlcnkoY29udGV4dCkgOiAoc2ltcGxlQ29udGV4dCA9IDEpICYmIFtkb2NdOwogICAgdmFyIGNvbnRleHRzTGVuID0gY29udGV4dHMubGVuZ3RoOwogICAgaWYgKCFzZWxlY3RvcikgewogICAgICByZXQgPSBbXTsKICAgIH0gZWxzZSBpZiAoaXNTZWxlY3RvclN0cmluZykgewogICAgICBzZWxlY3RvciA9IHRyaW0oc2VsZWN0b3IpOwogICAgICBpZiAoc2ltcGxlQ29udGV4dCkgewogICAgICAgIGlmIChzZWxlY3RvciA9PT0gJ2JvZHknKSB7CiAgICAgICAgICByZXQgPSBbZG9jLmJvZHldOwogICAgICAgIH0gZWxzZSBpZiAockNsYXNzU2VsZWN0b3IudGVzdChzZWxlY3RvcikpIHsKICAgICAgICAgIHJldCA9IG1ha2VBcnJheShnZXRFbGVtZW50c0J5Q2xhc3NOYW1lKGRvYywgUmVnRXhwLiQxKSk7CiAgICAgICAgfSBlbHNlIGlmIChyVGFnSWRTZWxlY3Rvci50ZXN0KHNlbGVjdG9yKSkgewogICAgICAgICAgZWwgPSBEb20uX2dldEVsZW1lbnRCeUlkKFJlZ0V4cC4kMiwgZG9jKTsKICAgICAgICAgIHJldCA9IGVsICYmIGVsLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IFJlZ0V4cC4kMSA/IFtlbF0gOiBbXTsKICAgICAgICB9IGVsc2UgaWYgKHJJZFNlbGVjdG9yLnRlc3Qoc2VsZWN0b3IpKSB7CiAgICAgICAgICBlbCA9IERvbS5fZ2V0RWxlbWVudEJ5SWQoc2VsZWN0b3Iuc3Vic3RyKDEpLCBkb2MpOwogICAgICAgICAgcmV0ID0gZWwgPyBbZWxdIDogW107CiAgICAgICAgfSBlbHNlIGlmIChyVGFnU2VsZWN0b3IudGVzdChzZWxlY3RvcikpIHsKICAgICAgICAgIHJldCA9IG1ha2VBcnJheShkb2MuZ2V0RWxlbWVudHNCeVRhZ05hbWUoc2VsZWN0b3IpKTsKICAgICAgICB9IGVsc2UgaWYgKGlzU2ltcGxlU2VsZWN0b3Ioc2VsZWN0b3IpKSB7CiAgICAgICAgICB2YXIgcGFydHMgPSBzZWxlY3Rvci5zcGxpdCgvXHMrLyk7CiAgICAgICAgICB2YXIgcGFydHNMZW47CiAgICAgICAgICB2YXIgcGFyZW50cyA9IGNvbnRleHRzOwogICAgICAgICAgdmFyIHBhcmVudEluZGV4OwogICAgICAgICAgdmFyIHBhcmVudHNMZW47CiAgICAgICAgICBmb3IgKGkgPSAwLCBwYXJ0c0xlbiA9IHBhcnRzLmxlbmd0aDsgaSA8IHBhcnRzTGVuOyBpKyspIHsKICAgICAgICAgICAgcGFydHNbaV0gPSBtYWtlTWF0Y2gocGFydHNbaV0pOwogICAgICAgICAgfQogICAgICAgICAgZm9yIChpID0gMCwgcGFydHNMZW4gPSBwYXJ0cy5sZW5ndGg7IGkgPCBwYXJ0c0xlbjsgaSsrKSB7CiAgICAgICAgICAgIHZhciBwYXJ0ID0gcGFydHNbaV07CiAgICAgICAgICAgIHZhciBuZXdQYXJlbnRzID0gW107CiAgICAgICAgICAgIHZhciBwYXJNYXRjaGVzOwogICAgICAgICAgICBmb3IgKHBhcmVudEluZGV4ID0gMCwgcGFyZW50c0xlbiA9IHBhcmVudHMubGVuZ3RoOyBwYXJlbnRJbmRleCA8IHBhcmVudHNMZW47IHBhcmVudEluZGV4KyspIHsKICAgICAgICAgICAgICBwYXJNYXRjaGVzID0gcGFydChwYXJlbnRzW3BhcmVudEluZGV4XSk7CiAgICAgICAgICAgICAgbmV3UGFyZW50cy5wdXNoLmFwcGx5KG5ld1BhcmVudHMsIG1ha2VBcnJheShwYXJNYXRjaGVzKSk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcGFyZW50cyA9IG5ld1BhcmVudHM7CiAgICAgICAgICAgIGlmICghcGFyZW50cy5sZW5ndGgpIHsKICAgICAgICAgICAgICBicmVhazsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgICAgcmV0ID0gcGFyZW50cyAmJiBwYXJlbnRzLmxlbmd0aCA+IDEgPyBEb20udW5pcXVlKHBhcmVudHMpIDogcGFyZW50czsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKCFyZXQpIHsKICAgICAgICByZXQgPSBbXTsKICAgICAgICBmb3IgKGkgPSAwOyBpIDwgY29udGV4dHNMZW47IGkrKykgewogICAgICAgICAgcHVzaC5hcHBseShyZXQsIERvbS5fc2VsZWN0SW50ZXJuYWwoc2VsZWN0b3IsIGNvbnRleHRzW2ldKSk7CiAgICAgICAgfQogICAgICAgIGlmIChyZXQubGVuZ3RoID4gMSAmJiBjb250ZXh0c0xlbiA+IDEpIHsKICAgICAgICAgIERvbS51bmlxdWUocmV0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSB7CiAgICAgIGlmIChzZWxlY3Rvci5ub2RlVHlwZSB8fCB1dGlsLmlzV2luZG93KHNlbGVjdG9yKSkgewogICAgICAgIHJldCA9IFtzZWxlY3Rvcl07CiAgICAgIH0gZWxzZSBpZiAoc2VsZWN0b3IuZ2V0RE9NTm9kZXMpIHsKICAgICAgICByZXQgPSBzZWxlY3Rvci5nZXRET01Ob2RlcygpOwogICAgICB9IGVsc2UgaWYgKGlzQXJyYXkoc2VsZWN0b3IpKSB7CiAgICAgICAgcmV0ID0gc2VsZWN0b3I7CiAgICAgIH0gZWxzZSBpZiAoaXNEb21Ob2RlTGlzdChzZWxlY3RvcikpIHsKICAgICAgICByZXQgPSBtYWtlQXJyYXkoc2VsZWN0b3IpOwogICAgICB9IGVsc2UgewogICAgICAgIHJldCA9IFtzZWxlY3Rvcl07CiAgICAgIH0KICAgICAgaWYgKCFzaW1wbGVDb250ZXh0KSB7CiAgICAgICAgdmFyIHRtcCA9IHJldDsKICAgICAgICB2YXIgY2k7CiAgICAgICAgdmFyIGxlbiA9IHRtcC5sZW5ndGg7CiAgICAgICAgcmV0ID0gW107CiAgICAgICAgZm9yIChpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgICBmb3IgKGNpID0gMDsgY2kgPCBjb250ZXh0c0xlbjsgY2krKykgewogICAgICAgICAgICBpZiAoRG9tLl9jb250YWlucyhjb250ZXh0c1tjaV0sIHRtcFtpXSkpIHsKICAgICAgICAgICAgICByZXQucHVzaCh0bXBbaV0pOwogICAgICAgICAgICAgIGJyZWFrOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgICByZXQuZWFjaCA9IHF1ZXJ5RWFjaDsKICAgIHJldHVybiByZXQ7CiAgfQogIGZ1bmN0aW9uIGhhc1NpbmdsZUNsYXNzKGVsLCBjbHMpIHsKICAgIHZhciBjbGFzc05hbWUgPSBlbCAmJiBnZXRBdHRyKGVsLCAnY2xhc3MnKTsKICAgIHJldHVybiBjbGFzc05hbWUgJiYgKGNsYXNzTmFtZSA9IGNsYXNzTmFtZS5yZXBsYWNlKC9bXHJcdFxuXS9nLCBTUEFDRSkpICYmIChTUEFDRSArIGNsYXNzTmFtZSArIFNQQUNFKS5pbmRleE9mKFNQQUNFICsgY2xzICsgU1BBQ0UpID4gLTE7CiAgfQogIGZ1bmN0aW9uIGdldEF0dHIoZWwsIG5hbWUpIHsKICAgIHZhciByZXQgPSBlbCAmJiBlbC5nZXRBdHRyaWJ1dGVOb2RlKG5hbWUpOwogICAgaWYgKHJldCAmJiByZXQuc3BlY2lmaWVkKSB7CiAgICAgIHJldHVybiAndmFsdWUnIGluIHJldCA/IHJldC52YWx1ZSA6IHJldC5ub2RlVmFsdWU7CiAgICB9CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KICBmdW5jdGlvbiBpc1RhZyhlbCwgdmFsdWUpIHsKICAgIHJldHVybiB2YWx1ZSA9PT0gJyonIHx8IGVsLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09IHZhbHVlLnRvTG93ZXJDYXNlKCk7CiAgfQogIHZhciBjb21wYXJlTm9kZU9yZGVyID0gJ3NvdXJjZUluZGV4JyBpbiBkb2NFbGVtID8gZnVuY3Rpb24gKGEsIGIpIHsKICAgIHJldHVybiBhLnNvdXJjZUluZGV4IC0gYi5zb3VyY2VJbmRleDsKICB9IDogZnVuY3Rpb24gKGEsIGIpIHsKICAgIGlmICghYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiB8fCAhYi5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbikgewogICAgICByZXR1cm4gYS5jb21wYXJlRG9jdW1lbnRQb3NpdGlvbiA/IC0xIDogMTsKICAgIH0KICAgIHZhciBiaXQgPSBhLmNvbXBhcmVEb2N1bWVudFBvc2l0aW9uKGIpICYgNDsKICAgIHJldHVybiBiaXQgPyAtMSA6IDE7CiAgfTsKICB2YXIgbWF0Y2hlc0ludGVybmFsID0gcXVlcnlTZWxlY3RvckFsbCAmJiBxdWVyeVNlbGVjdG9yQWxsLm1hdGNoZXMgPyBxdWVyeVNlbGVjdG9yQWxsLm1hdGNoZXMgOiBmdW5jdGlvbiAoc3RyLCBzZWVkcykgewogICAgdmFyIHJldCA9IFtdOwogICAgdmFyIGkgPSAwOwogICAgdmFyIG47CiAgICB2YXIgbGVuID0gc2VlZHMubGVuZ3RoOwogICAgZm9yICg7IGkgPCBsZW47IGkrKykgewogICAgICBuID0gc2VlZHNbaV07CiAgICAgIGlmIChtYXRjaGVzLmNhbGwobiwgc3RyKSkgewogICAgICAgIHJldC5wdXNoKG4pOwogICAgICB9CiAgICB9CiAgICByZXR1cm4gcmV0OwogIH07CiAgdXRpbC5taXgoRG9tLCB7CiAgICBfZ2V0RWxlbWVudHNCeVRhZ05hbWU6IGZ1bmN0aW9uIChuYW1lLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiBtYWtlQXJyYXkoY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKG5hbWUpKTsKICAgIH0sCiAgICBfZ2V0RWxlbWVudEJ5SWQ6IGZ1bmN0aW9uIChpZCwgcm9vdERvYykgewogICAgICByZXR1cm4gcm9vdERvYy5nZXRFbGVtZW50QnlJZChpZCk7CiAgICB9LAogICAgX2dldFNpbXBsZUF0dHI6IGdldEF0dHIsCiAgICBfaXNUYWc6IGlzVGFnLAogICAgX2hhc1NpbmdsZUNsYXNzOiBoYXNTaW5nbGVDbGFzcywKICAgIF9zZWxlY3RJbnRlcm5hbDogcXVlcnlTZWxlY3RvckFsbCB8fCBmdW5jdGlvbiAoc3RyLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiBtYWtlQXJyYXkoY29udGV4dC5xdWVyeVNlbGVjdG9yQWxsKHN0cikpOwogICAgfSwKICAgIHF1ZXJ5OiBxdWVyeSwKICAgIGdldDogZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiBxdWVyeShzZWxlY3RvciwgY29udGV4dClbMF0gfHwgbnVsbDsKICAgIH0sCiAgICB1bmlxdWU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGhhc0R1cGxpY2F0ZTsKICAgICAgdmFyIGJhc2VIYXNEdXBsaWNhdGUgPSB0cnVlOwogICAgICBbCiAgICAgICAgMCwKICAgICAgICAwCiAgICAgIF0uc29ydChmdW5jdGlvbiAoKSB7CiAgICAgICAgYmFzZUhhc0R1cGxpY2F0ZSA9IGZhbHNlOwogICAgICAgIHJldHVybiAwOwogICAgICB9KTsKICAgICAgZnVuY3Rpb24gc29ydE9yZGVyKGEsIGIpIHsKICAgICAgICBpZiAoYSA9PT0gYikgewogICAgICAgICAgaGFzRHVwbGljYXRlID0gdHJ1ZTsKICAgICAgICAgIHJldHVybiAwOwogICAgICAgIH0KICAgICAgICByZXR1cm4gY29tcGFyZU5vZGVPcmRlcihhLCBiKTsKICAgICAgfQogICAgICByZXR1cm4gZnVuY3Rpb24gKGVsZW1lbnRzKSB7CiAgICAgICAgaGFzRHVwbGljYXRlID0gYmFzZUhhc0R1cGxpY2F0ZTsKICAgICAgICBlbGVtZW50cy5zb3J0KHNvcnRPcmRlcik7CiAgICAgICAgaWYgKGhhc0R1cGxpY2F0ZSkgewogICAgICAgICAgdmFyIGkgPSAxOwogICAgICAgICAgdmFyIGxlbiA9IGVsZW1lbnRzLmxlbmd0aDsKICAgICAgICAgIHdoaWxlIChpIDwgbGVuKSB7CiAgICAgICAgICAgIGlmIChlbGVtZW50c1tpXSA9PT0gZWxlbWVudHNbaSAtIDFdKSB7CiAgICAgICAgICAgICAgZWxlbWVudHMuc3BsaWNlKGksIDEpOwogICAgICAgICAgICAgIC0tbGVuOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIGkrKzsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gZWxlbWVudHM7CiAgICAgIH07CiAgICB9KCksCiAgICBmaWx0ZXI6IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyLCBjb250ZXh0KSB7CiAgICAgIHZhciBlbGVtcyA9IHF1ZXJ5KHNlbGVjdG9yLCBjb250ZXh0KTsKICAgICAgdmFyIGlkOwogICAgICB2YXIgdGFnOwogICAgICB2YXIgbWF0Y2g7CiAgICAgIHZhciBjbHM7CiAgICAgIHZhciByZXQgPSBbXTsKICAgICAgaWYgKHR5cGVvZiBmaWx0ZXIgPT09ICdzdHJpbmcnICYmIChmaWx0ZXIgPSB0cmltKGZpbHRlcikpICYmIChtYXRjaCA9IHJTaW1wbGVTZWxlY3Rvci5leGVjKGZpbHRlcikpKSB7CiAgICAgICAgaWQgPSBtYXRjaFsxXTsKICAgICAgICB0YWcgPSBtYXRjaFsyXTsKICAgICAgICBjbHMgPSBtYXRjaFszXTsKICAgICAgICBpZiAoIWlkKSB7CiAgICAgICAgICBmaWx0ZXIgPSBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgICAgICB2YXIgdGFnUmUgPSB0cnVlOwogICAgICAgICAgICB2YXIgY2xzUmUgPSB0cnVlOwogICAgICAgICAgICBpZiAodGFnKSB7CiAgICAgICAgICAgICAgdGFnUmUgPSBpc1RhZyhlbGVtLCB0YWcpOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmIChjbHMpIHsKICAgICAgICAgICAgICBjbHNSZSA9IGhhc1NpbmdsZUNsYXNzKGVsZW0sIGNscyk7CiAgICAgICAgICAgIH0KICAgICAgICAgICAgcmV0dXJuIGNsc1JlICYmIHRhZ1JlOwogICAgICAgICAgfTsKICAgICAgICB9IGVsc2UgaWYgKGlkICYmICF0YWcgJiYgIWNscykgewogICAgICAgICAgZmlsdGVyID0gZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICAgICAgcmV0dXJuIGdldEF0dHIoZWxlbSwgJ2lkJykgPT09IGlkOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKHR5cGVvZiBmaWx0ZXIgPT09ICdmdW5jdGlvbicpIHsKICAgICAgICByZXQgPSB1dGlsLmZpbHRlcihlbGVtcywgZmlsdGVyKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXQgPSBtYXRjaGVzSW50ZXJuYWwoZmlsdGVyLCBlbGVtcyk7CiAgICAgIH0KICAgICAgcmV0dXJuIHJldDsKICAgIH0sCiAgICB0ZXN0OiBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlciwgY29udGV4dCkgewogICAgICB2YXIgZWxlbWVudHMgPSBxdWVyeShzZWxlY3RvciwgY29udGV4dCk7CiAgICAgIHJldHVybiBlbGVtZW50cy5sZW5ndGggJiYgRG9tLmZpbHRlcihlbGVtZW50cywgZmlsdGVyLCBjb250ZXh0KS5sZW5ndGggPT09IGVsZW1lbnRzLmxlbmd0aDsKICAgIH0KICB9KTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpkb21CYXNlTGliTWFpblRyYXZlcnNhbCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tQmFzZUxpYk1haW5BcGk7CiAgdmFyIE5vZGVUeXBlID0gRG9tLk5vZGVUeXBlOwogIHZhciBDT05UQUlOX01BU0sgPSAxNjsKICB1dGlsLm1peChEb20sIHsKICAgIF9jb250YWluczogZnVuY3Rpb24gKGEsIGIpIHsKICAgICAgcmV0dXJuICEhKGEuY29tcGFyZURvY3VtZW50UG9zaXRpb24oYikgJiBDT05UQUlOX01BU0spOwogICAgfSwKICAgIGNsb3Nlc3Q6IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyLCBjb250ZXh0LCBhbGxvd1RleHROb2RlKSB7CiAgICAgIHJldHVybiBudGgoc2VsZWN0b3IsIGZpbHRlciwgJ3BhcmVudE5vZGUnLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIHJldHVybiBlbGVtLm5vZGVUeXBlICE9PSBOb2RlVHlwZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFOwogICAgICB9LCBjb250ZXh0LCB0cnVlLCBhbGxvd1RleHROb2RlKTsKICAgIH0sCiAgICBwYXJlbnQ6IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiBudGgoc2VsZWN0b3IsIGZpbHRlciwgJ3BhcmVudE5vZGUnLCBmdW5jdGlvbiAoZWxlbSkgewogICAgICAgIHJldHVybiBlbGVtLm5vZGVUeXBlICE9PSBOb2RlVHlwZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFOwogICAgICB9LCBjb250ZXh0LCB1bmRlZmluZWQpOwogICAgfSwKICAgIGZpcnN0OiBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlciwgYWxsb3dUZXh0Tm9kZSkgewogICAgICB2YXIgZWxlbSA9IERvbS5nZXQoc2VsZWN0b3IpOwogICAgICByZXR1cm4gbnRoKGVsZW0gJiYgZWxlbS5maXJzdENoaWxkLCBmaWx0ZXIsICduZXh0U2libGluZycsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0cnVlLCBhbGxvd1RleHROb2RlKTsKICAgIH0sCiAgICBsYXN0OiBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlciwgYWxsb3dUZXh0Tm9kZSkgewogICAgICB2YXIgZWxlbSA9IERvbS5nZXQoc2VsZWN0b3IpOwogICAgICByZXR1cm4gbnRoKGVsZW0gJiYgZWxlbS5sYXN0Q2hpbGQsIGZpbHRlciwgJ3ByZXZpb3VzU2libGluZycsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB0cnVlLCBhbGxvd1RleHROb2RlKTsKICAgIH0sCiAgICBuZXh0OiBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlciwgYWxsb3dUZXh0Tm9kZSkgewogICAgICByZXR1cm4gbnRoKHNlbGVjdG9yLCBmaWx0ZXIsICduZXh0U2libGluZycsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGFsbG93VGV4dE5vZGUpOwogICAgfSwKICAgIHByZXY6IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyLCBhbGxvd1RleHROb2RlKSB7CiAgICAgIHJldHVybiBudGgoc2VsZWN0b3IsIGZpbHRlciwgJ3ByZXZpb3VzU2libGluZycsIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGFsbG93VGV4dE5vZGUpOwogICAgfSwKICAgIHNpYmxpbmdzOiBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlciwgYWxsb3dUZXh0Tm9kZSkgewogICAgICByZXR1cm4gZ2V0U2libGluZ3Moc2VsZWN0b3IsIGZpbHRlciwgdHJ1ZSwgYWxsb3dUZXh0Tm9kZSk7CiAgICB9LAogICAgY2hpbGRyZW46IGZ1bmN0aW9uIChzZWxlY3RvciwgZmlsdGVyKSB7CiAgICAgIHJldHVybiBnZXRTaWJsaW5ncyhzZWxlY3RvciwgZmlsdGVyLCB1bmRlZmluZWQpOwogICAgfSwKICAgIGNvbnRlbnRzOiBmdW5jdGlvbiAoc2VsZWN0b3IsIGZpbHRlcikgewogICAgICByZXR1cm4gZ2V0U2libGluZ3Moc2VsZWN0b3IsIGZpbHRlciwgdW5kZWZpbmVkLCAxKTsKICAgIH0sCiAgICBjb250YWluczogZnVuY3Rpb24gKGNvbnRhaW5lciwgY29udGFpbmVkKSB7CiAgICAgIGNvbnRhaW5lciA9IERvbS5nZXQoY29udGFpbmVyKTsKICAgICAgY29udGFpbmVkID0gRG9tLmdldChjb250YWluZWQpOwogICAgICBpZiAoY29udGFpbmVyICYmIGNvbnRhaW5lZCkgewogICAgICAgIHJldHVybiBEb20uX2NvbnRhaW5zKGNvbnRhaW5lciwgY29udGFpbmVkKTsKICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9LAogICAgaW5kZXg6IGZ1bmN0aW9uIChzZWxlY3RvciwgczIpIHsKICAgICAgdmFyIGVscyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIHZhciBjOwogICAgICB2YXIgbiA9IDA7CiAgICAgIHZhciBwOwogICAgICB2YXIgZWxzMjsKICAgICAgdmFyIGVsID0gZWxzWzBdOwogICAgICBpZiAoIXMyKSB7CiAgICAgICAgcCA9IGVsICYmIGVsLnBhcmVudE5vZGU7CiAgICAgICAgaWYgKCFwKSB7CiAgICAgICAgICByZXR1cm4gLTE7CiAgICAgICAgfQogICAgICAgIGMgPSBlbDsKICAgICAgICB3aGlsZSAoYyA9IGMucHJldmlvdXNTaWJsaW5nKSB7CiAgICAgICAgICBpZiAoYy5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgICAgIG4rKzsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG47CiAgICAgIH0KICAgICAgZWxzMiA9IERvbS5xdWVyeShzMik7CiAgICAgIGlmICh0eXBlb2YgczIgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgcmV0dXJuIHV0aWwuaW5kZXhPZihlbCwgZWxzMik7CiAgICAgIH0KICAgICAgcmV0dXJuIHV0aWwuaW5kZXhPZihlbHMyWzBdLCBlbHMpOwogICAgfSwKICAgIGVxdWFsczogZnVuY3Rpb24gKG4xLCBuMikgewogICAgICBuMSA9IERvbS5xdWVyeShuMSk7CiAgICAgIG4yID0gRG9tLnF1ZXJ5KG4yKTsKICAgICAgaWYgKG4xLmxlbmd0aCAhPT0gbjIubGVuZ3RoKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIGZvciAodmFyIGkgPSBuMS5sZW5ndGg7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgaWYgKG4xW2ldICE9PSBuMltpXSkgewogICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICB9KTsKICBmdW5jdGlvbiBudGgoZWxlbSwgZmlsdGVyLCBkaXJlY3Rpb24sIGV4dHJhRmlsdGVyLCBjb250ZXh0LCBpbmNsdWRlU2VmLCBhbGxvd1RleHROb2RlKSB7CiAgICBpZiAoIShlbGVtID0gRG9tLmdldChlbGVtKSkpIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBpZiAoZmlsdGVyID09PSAwKSB7CiAgICAgIHJldHVybiBlbGVtOwogICAgfQogICAgaWYgKCFpbmNsdWRlU2VmKSB7CiAgICAgIGVsZW0gPSBlbGVtW2RpcmVjdGlvbl07CiAgICB9CiAgICBpZiAoIWVsZW0pIHsKICAgICAgcmV0dXJuIG51bGw7CiAgICB9CiAgICBjb250ZXh0ID0gY29udGV4dCAmJiBEb20uZ2V0KGNvbnRleHQpIHx8IG51bGw7CiAgICBpZiAoZmlsdGVyID09PSB1bmRlZmluZWQpIHsKICAgICAgZmlsdGVyID0gMTsKICAgIH0KICAgIHZhciByZXQgPSBbXTsKICAgIHZhciBpc0FycmF5ID0gdXRpbC5pc0FycmF5KGZpbHRlcik7CiAgICB2YXIgZmk7CiAgICB2YXIgZmlsdGVyTGVuZ3RoOwogICAgaWYgKHR5cGVvZiBmaWx0ZXIgPT09ICdudW1iZXInKSB7CiAgICAgIGZpID0gMDsKICAgICAgZmlsdGVyTGVuZ3RoID0gZmlsdGVyOwogICAgICBmaWx0ZXIgPSBmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuICsrZmkgPT09IGZpbHRlckxlbmd0aDsKICAgICAgfTsKICAgIH0KICAgIHdoaWxlIChlbGVtICYmIGVsZW0gIT09IGNvbnRleHQpIHsKICAgICAgaWYgKChlbGVtLm5vZGVUeXBlID09PSBOb2RlVHlwZS5FTEVNRU5UX05PREUgfHwgZWxlbS5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuVEVYVF9OT0RFICYmIGFsbG93VGV4dE5vZGUpICYmIHRlc3RGaWx0ZXIoZWxlbSwgZmlsdGVyKSAmJiAoIWV4dHJhRmlsdGVyIHx8IGV4dHJhRmlsdGVyKGVsZW0pKSkgewogICAgICAgIHJldC5wdXNoKGVsZW0pOwogICAgICAgIGlmICghaXNBcnJheSkgewogICAgICAgICAgYnJlYWs7CiAgICAgICAgfQogICAgICB9CiAgICAgIGVsZW0gPSBlbGVtW2RpcmVjdGlvbl07CiAgICB9CiAgICByZXR1cm4gaXNBcnJheSA/IHJldCA6IHJldFswXSB8fCBudWxsOwogIH0KICBmdW5jdGlvbiB0ZXN0RmlsdGVyKGVsZW0sIGZpbHRlcikgewogICAgaWYgKCFmaWx0ZXIpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBpZiAodXRpbC5pc0FycmF5KGZpbHRlcikpIHsKICAgICAgdmFyIGk7CiAgICAgIHZhciBsID0gZmlsdGVyLmxlbmd0aDsKICAgICAgaWYgKCFsKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgICAgZm9yIChpID0gMDsgaSA8IGw7IGkrKykgewogICAgICAgIGlmIChEb20udGVzdChlbGVtLCBmaWx0ZXJbaV0pKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoRG9tLnRlc3QoZWxlbSwgZmlsdGVyKSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CiAgZnVuY3Rpb24gZ2V0U2libGluZ3Moc2VsZWN0b3IsIGZpbHRlciwgcGFyZW50LCBhbGxvd1RleHQpIHsKICAgIHZhciByZXQgPSBbXTsKICAgIHZhciB0bXA7CiAgICB2YXIgaTsKICAgIHZhciBlbDsKICAgIHZhciBlbGVtID0gRG9tLmdldChzZWxlY3Rvcik7CiAgICB2YXIgcGFyZW50Tm9kZSA9IGVsZW07CiAgICBpZiAoZWxlbSAmJiBwYXJlbnQpIHsKICAgICAgcGFyZW50Tm9kZSA9IGVsZW0ucGFyZW50Tm9kZTsKICAgIH0KICAgIGlmIChwYXJlbnROb2RlKSB7CiAgICAgIHRtcCA9IHV0aWwubWFrZUFycmF5KHBhcmVudE5vZGUuY2hpbGROb2Rlcyk7CiAgICAgIGZvciAoaSA9IDA7IGkgPCB0bXAubGVuZ3RoOyBpKyspIHsKICAgICAgICBlbCA9IHRtcFtpXTsKICAgICAgICBpZiAoIWFsbG93VGV4dCAmJiBlbC5ub2RlVHlwZSAhPT0gTm9kZVR5cGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgaWYgKGVsID09PSBlbGVtKSB7CiAgICAgICAgICBjb250aW51ZTsKICAgICAgICB9CiAgICAgICAgcmV0LnB1c2goZWwpOwogICAgICB9CiAgICAgIGlmIChmaWx0ZXIpIHsKICAgICAgICByZXQgPSBEb20uZmlsdGVyKHJldCwgZmlsdGVyKTsKICAgICAgfQogICAgfQogICAgcmV0dXJuIHJldDsKICB9CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tQmFzZUxpYk1haW4gPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBEb20gPSBkb21CYXNlTGliTWFpbkFwaTsKICBkb21CYXNlTGliTWFpbkF0dHI7CiAgZG9tQmFzZUxpYk1haW5DbGFzczsKICBkb21CYXNlTGliTWFpbkNyZWF0ZTsKICBkb21CYXNlTGliTWFpbkRhdGE7CiAgZG9tQmFzZUxpYk1haW5JbnNlcnRpb247CiAgZG9tQmFzZUxpYk1haW5PZmZzZXQ7CiAgZG9tQmFzZUxpYk1haW5TdHlsZTsKICBkb21CYXNlTGliTWFpblNlbGVjdG9yOwogIGRvbUJhc2VMaWJNYWluVHJhdmVyc2FsOwogIGV4cG9ydHMgPSBEb207CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tQmFzZUluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICBleHBvcnRzID0gZG9tQmFzZUxpYk1haW47CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGRvbUJhc2VJbmRleDsKfSk7ZGVmaW5lKCJxdWVyeS1zZWxlY3Rvci1iYXNlIiwgW10sIGZ1bmN0aW9uKHJlcXVpcmUpIHsKCi8vISBDb3B5cmlnaHQgMjAxNSwgcXVlcnktc2VsZWN0b3ItYmFzZUA2LjEuMiBNSVQgTGljZW5zZWQsIGJ1aWxkIHRpbWU6IFRodSwgMjkgT2N0IDIwMTUgMTI6MzE6MDIgR01UIAovKgpjb21iaW5lZCBtb2R1bGVzOgpxdWVyeS1zZWxlY3Rvci1iYXNlCiovCnZhciBxdWVyeVNlbGVjdG9yQmFzZUluZGV4OwpxdWVyeVNlbGVjdG9yQmFzZUluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICBleHBvcnRzID0gbnVsbDsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gcXVlcnlTZWxlY3RvckJhc2VJbmRleDsKfSk7ZGVmaW5lKCJkb20tZXh0cmEiLCBbImRvbS1iYXNlIiwndXRpbCcsImZlYXR1cmUiXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgZG9tQmFzZSA9IHJlcXVpcmUoImRvbS1iYXNlIik7CnZhciB1dGlsQmFzZSA9IHJlcXVpcmUoJ3V0aWwnKTsKdmFyIGZlYXR1cmUgPSByZXF1aXJlKCJmZWF0dXJlIik7Ci8vISBDb3B5cmlnaHQgMjAxNSwgZG9tLWV4dHJhQDYuMS4yIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAwOTo0NDo0OCBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmRvbS1leHRyYQpkb20tZXh0cmEvbGliL2V4dHJhCmRvbS1leHRyYS9saWIvZXh0cmEvYXBpCmRvbS1leHRyYS9saWIvZXh0cmEvYXR0cgpkb20tZXh0cmEvbGliL2V4dHJhL2NyZWF0ZQpkb20tZXh0cmEvbGliL2V4dHJhL2RhdGEKZG9tLWV4dHJhL2xpYi9leHRyYS9pbnNlcnRpb24KZG9tLWV4dHJhL2xpYi9leHRyYS9vZmZzZXQKZG9tLWV4dHJhL2xpYi9leHRyYS9zdHlsZQoqLwp2YXIgZG9tRXh0cmFMaWJFeHRyYUFwaSwgZG9tRXh0cmFMaWJFeHRyYUF0dHIsIGRvbUV4dHJhTGliRXh0cmFDcmVhdGUsIGRvbUV4dHJhTGliRXh0cmFEYXRhLCBkb21FeHRyYUxpYkV4dHJhSW5zZXJ0aW9uLCBkb21FeHRyYUxpYkV4dHJhT2Zmc2V0LCBkb21FeHRyYUxpYkV4dHJhU3R5bGUsIGRvbUV4dHJhTGliRXh0cmEsIGRvbUV4dHJhSW5kZXg7CmRvbUV4dHJhTGliRXh0cmFBcGkgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBEb20gPSBkb21CYXNlOwogIGV4cG9ydHMgPSBEb207CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tRXh0cmFMaWJFeHRyYUF0dHIgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIERvbSA9IGRvbUV4dHJhTGliRXh0cmFBcGk7CiAgdmFyIGRvYyA9IGRvY3VtZW50OwogIHZhciBkb2NFbGVtZW50ID0gZG9jICYmIGRvYy5kb2N1bWVudEVsZW1lbnQ7CiAgdmFyIGdldFByb3AgPSBEb20uX2dldFByb3A7CiAgdXRpbC5taXgoRG9tLCB7CiAgICAvKioKICAgICAqIFdoZXRoZXIgb25lIG9mIHRoZSBtYXRjaGVkIGVsZW1lbnRzIGhhcyBzcGVjaWZpZWQgYXR0cmlidXRlCiAgICAgKiBAbWV0aG9kCiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50W118U3RyaW5nfSBzZWxlY3RvciBtYXRjaGVkIGVsZW1lbnRzCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gbmFtZSBUaGUgYXR0cmlidXRlIHRvIGJlIHRlc3RlZAogICAgICogQHJldHVybiB7Qm9vbGVhbn0KICAgICAqLwogICAgaGFzQXR0cjogZG9jRWxlbWVudCAmJiAhZG9jRWxlbWVudC5oYXNBdHRyaWJ1dGUgPyBmdW5jdGlvbiAoc2VsZWN0b3IsIG5hbWUpIHsKICAgICAgbmFtZSA9IG5hbWUudG9Mb3dlckNhc2UoKTsKICAgICAgdmFyIGVsZW1zID0gRG9tLnF1ZXJ5KHNlbGVjdG9yKTsKICAgICAgdmFyIGksIGVsLCBhdHRyTm9kZTsKICAgICAgLy8gZnJvbSBwcGsgOmh0dHA6Ly93d3cucXVpcmtzbW9kZS5vcmcvZG9tL3czY19jb3JlLmh0bWwKICAgICAgLy8gSUU1LTcgZG9lc24ndCByZXR1cm4gdGhlIHZhbHVlIG9mIGEgc3R5bGUgYXR0cmlidXRlLgogICAgICAvLyB2YXIgJGF0dHIgPSBlbC5hdHRyaWJ1dGVzW25hbWVdOwogICAgICBmb3IgKGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBlbCA9IGVsZW1zW2ldOwogICAgICAgIGF0dHJOb2RlID0gZWwuZ2V0QXR0cmlidXRlTm9kZShuYW1lKTsKICAgICAgICBpZiAoYXR0ck5vZGUgJiYgYXR0ck5vZGUuc3BlY2lmaWVkKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSA6IGZ1bmN0aW9uIChzZWxlY3RvciwgbmFtZSkgewogICAgICB2YXIgZWxlbXMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICB2YXIgbGVuID0gZWxlbXMubGVuZ3RoOwogICAgICBmb3IgKHZhciBpID0gMDsgaSA8IGxlbjsgaSsrKSB7CiAgICAgICAgLy/kvb/nlKjljp/nlJ/lrp7njrAKICAgICAgICBpZiAoZWxlbXNbaV0uaGFzQXR0cmlidXRlKG5hbWUpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfSwKICAgIC8qKgogICAgICogV2hldGhlciBvbmUgb2YgdGhlIG1hdGNoZWQgZWxlbWVudHMgaGFzIHNwZWNpZmllZCBwcm9wZXJ0eSBuYW1lCiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50W118U3RyaW5nfEhUTUxFbGVtZW50fSBzZWxlY3RvciDlhYPntKAKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBuYW1lIFRoZSBuYW1lIG9mIHByb3BlcnR5IHRvIHRlc3QKICAgICAqIEByZXR1cm4ge0Jvb2xlYW59CiAgICAgKi8KICAgIGhhc1Byb3A6IGZ1bmN0aW9uIChzZWxlY3RvciwgbmFtZSkgewogICAgICB2YXIgZWxlbXMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICB2YXIgaSwgZWw7CiAgICAgIHZhciBsZW4gPSBlbGVtcy5sZW5ndGg7CiAgICAgIGZvciAoaSA9IDA7IGkgPCBsZW47IGkrKykgewogICAgICAgIGVsID0gZWxlbXNbaV07CiAgICAgICAgaWYgKGdldFByb3AoZWwsIG5hbWUpICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tRXh0cmFMaWJFeHRyYUNyZWF0ZSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tRXh0cmFMaWJFeHRyYUFwaTsKICB2YXIgZG9jID0gZG9jdW1lbnQsIHN1cHBvcnRPdXRlckhUTUwgPSBkb2MgJiYgJ291dGVySFRNTCcgaW4gZG9jLmRvY3VtZW50RWxlbWVudCwgTm9kZVR5cGUgPSBEb20uTm9kZVR5cGUsIGdldEhvbGRlckRpdiA9IERvbS5fZ2V0SG9sZGVyRGl2OwogIHV0aWwubWl4KERvbSwgewogICAgLyoqCiAgICAgKiBHZXQgdGhlIG91dGVySFRNTCBvZiB0aGUgZmlyc3QgZWxlbWVudCBpbiB0aGUgc2V0IG9mIG1hdGNoZWQgZWxlbWVudHMuCiAgICAgKiBvcgogICAgICogU2V0IHRoZSBvdXRlckhUTUwgb2YgZWFjaCBlbGVtZW50IGluIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cy4KICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8U3RyaW5nfEhUTUxFbGVtZW50W119IHNlbGVjdG9yIG1hdGNoZWQgZWxlbWVudHMKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBbaHRtbFN0cmluZ10gIEEgc3RyaW5nIG9mIEhUTUwgdG8gc2V0IGFzIG91dGVySFRNTCBvZiBlYWNoIG1hdGNoZWQgZWxlbWVudC4KICAgICAqIEBwYXJhbSB7Qm9vbGVhbn0gW2xvYWRTY3JpcHRzPWZhbHNlXSBUcnVlIHRvIGxvb2sgZm9yIGFuZCBwcm9jZXNzIHNjcmlwdHMKICAgICAqIEBwYXJhbSB7T2JqZWN0fSBbRE9NRXZlbnRdIFBhc3MgdGhlIEtpc3N5J3MgRE9NLUV2ZW50IE9iamVjdCB0byByZW1vdmUgYWxsIGV2ZW50IGxpc3RlbmVycyBhdHRhY2hlZCBvbiBlbGVtZW50cwogICAgICovCiAgICBvdXRlckh0bWw6IGZ1bmN0aW9uIChzZWxlY3RvciwgaHRtbFN0cmluZywgbG9hZFNjcmlwdHMsIERPTUV2ZW50KSB7CiAgICAgIHZhciBlbHMgPSBEb20ucXVlcnkoc2VsZWN0b3IpLCBob2xkZXIsIGksIHZhbE5vZGUsIGxlbmd0aCA9IGVscy5sZW5ndGgsIGVsID0gZWxzWzBdOwogICAgICBpZiAoIWVsKSB7CiAgICAgICAgcmV0dXJuIG51bGw7CiAgICAgIH0KICAgICAgLy8gZ2V0dGVyCiAgICAgIGlmIChodG1sU3RyaW5nID09PSB1bmRlZmluZWQpIHsKICAgICAgICBpZiAoc3VwcG9ydE91dGVySFRNTCAmJiBlbC5ub2RlVHlwZSAhPT0gTm9kZVR5cGUuRE9DVU1FTlRfRlJBR01FTlRfTk9ERSkgewogICAgICAgICAgcmV0dXJuIGVsLm91dGVySFRNTDsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgaG9sZGVyID0gZ2V0SG9sZGVyRGl2KGVsLm93bmVyRG9jdW1lbnQsIDEpOwogICAgICAgICAgaG9sZGVyLmFwcGVuZENoaWxkKERvbS5jbG9uZShlbCwgdHJ1ZSkpOwogICAgICAgICAgcmV0dXJuIGhvbGRlci5pbm5lckhUTUw7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGh0bWxTdHJpbmcgKz0gJyc7CiAgICAgICAgaWYgKCFodG1sU3RyaW5nLm1hdGNoKC88KD86c2NyaXB0fHN0eWxlfGxpbmspL2kpICYmIHN1cHBvcnRPdXRlckhUTUwpIHsKICAgICAgICAgIGZvciAoaSA9IGxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICAgIGVsID0gZWxzW2ldOwogICAgICAgICAgICBpZiAoZWwubm9kZVR5cGUgPT09IE5vZGVUeXBlLkVMRU1FTlRfTk9ERSkgewogICAgICAgICAgICAgIERvbS5jbGVhbkRhdGEoZWwsIDEpOwogICAgICAgICAgICAgIGVsLm91dGVySFRNTCA9IGh0bWxTdHJpbmc7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFsTm9kZSA9IERvbS5jcmVhdGUoaHRtbFN0cmluZywgMCwgZWwub3duZXJEb2N1bWVudCwgMCk7CiAgICAgICAgICBEb20uaW5zZXJ0QmVmb3JlKHZhbE5vZGUsIGVscywgbG9hZFNjcmlwdHMpOwogICAgICAgICAgRG9tLnJlbW92ZShlbHMsIGZhbHNlLCBET01FdmVudCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CiAgfSk7CiAgLy8gY29tcGF0aWJpbGl0eQogIERvbS5vdXRlckhUTUwgPSBEb20ub3V0ZXJIdG1sOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmRvbUV4dHJhTGliRXh0cmFEYXRhID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21FeHRyYUxpYkV4dHJhQXBpOwogIHZhciB3aW4gPSB3aW5kb3csIEVYUEFORE8gPSBEb20uX19FWFBBTkRPLAogICAgLy8g6K6p5q+P5LiA5Lu9IGtpc3N5IOeahCBleHBhbmRvIOmDveS4jeWQjAogICAgZGF0YUNhY2hlID0gRG9tLl9kYXRhQ2FjaGUsCiAgICAvLyDlrZjlgqggbm9kZSDoioLngrnnmoQgZGF0YQogICAgd2luRGF0YUNhY2hlID0gRG9tLl93aW5EYXRhQ2FjaGU7CiAgLy8g6YG/5YWN5rGh5p+T5YWo5bGACiAgdmFyIGNvbW1vbk9wcyA9IHsKICAgIGhhc0RhdGE6IGZ1bmN0aW9uIChjYWNoZSwgbmFtZSkgewogICAgICBpZiAoY2FjaGUpIHsKICAgICAgICBpZiAobmFtZSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICBpZiAobmFtZSBpbiBjYWNoZSkgewogICAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgaWYgKCF1dGlsLmlzRW1wdHlPYmplY3QoY2FjaGUpKSB7CiAgICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogIH07CiAgdmFyIG9iamVjdE9wcyA9IHsKICAgIGhhc0RhdGE6IGZ1bmN0aW9uIChvYiwgbmFtZSkgewogICAgICAvLyDlj6rliKTmlq3lvZPliY3nqpflj6PvvIxpZnJhbWUg56qX5Y+j5YaF5pWw5o2u55u05o6l5pS+5YWl5YWo5bGA5Y+Y6YePCiAgICAgIGlmIChvYiA9PT0gd2luKSB7CiAgICAgICAgcmV0dXJuIG9iamVjdE9wcy5oYXNEYXRhKHdpbkRhdGFDYWNoZSwgbmFtZSk7CiAgICAgIH0KICAgICAgLy8g55u05o6l5bu656uL5Zyo5a+56LGh5YaFCiAgICAgIHZhciB0aGlzQ2FjaGUgPSBvYltFWFBBTkRPXTsKICAgICAgcmV0dXJuIGNvbW1vbk9wcy5oYXNEYXRhKHRoaXNDYWNoZSwgbmFtZSk7CiAgICB9CiAgfTsKICB2YXIgZG9tT3BzID0gewogICAgaGFzRGF0YTogZnVuY3Rpb24gKGVsZW0sIG5hbWUpIHsKICAgICAgdmFyIGtleSA9IGVsZW1bRVhQQU5ET107CiAgICAgIGlmICgha2V5KSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9CiAgICAgIHZhciB0aGlzQ2FjaGUgPSBkYXRhQ2FjaGVba2V5XTsKICAgICAgcmV0dXJuIGNvbW1vbk9wcy5oYXNEYXRhKHRoaXNDYWNoZSwgbmFtZSk7CiAgICB9CiAgfTsKICB1dGlsLm1peChEb20sIHsKICAgIC8qKgogICAgICogRGV0ZXJtaW5lIHdoZXRoZXIgYW4gZWxlbWVudCBoYXMgYW55IGRhdGEgb3Igc3BlY2lmaWVkIGRhdGEgbmFtZSBhc3NvY2lhdGVkIHdpdGggaXQuCiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50W118U3RyaW5nfEhUTUxFbGVtZW50fSBzZWxlY3RvciBNYXRjaGVkIGVsZW1lbnRzCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gW25hbWVdIEEgc3RyaW5nIG5hbWluZyB0aGUgcGllY2Ugb2YgZGF0YSB0byBzZXQuCiAgICAgKiBAcmV0dXJuIHtCb29sZWFufQogICAgICovCiAgICBoYXNEYXRhOiBmdW5jdGlvbiAoc2VsZWN0b3IsIG5hbWUpIHsKICAgICAgdmFyIHJldCA9IGZhbHNlLCBlbGVtcyA9IERvbS5xdWVyeShzZWxlY3Rvcik7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbXMubGVuZ3RoOyBpKyspIHsKICAgICAgICB2YXIgZWxlbSA9IGVsZW1zW2ldOwogICAgICAgIGlmIChlbGVtLm5vZGVUeXBlKSB7CiAgICAgICAgICByZXQgPSBkb21PcHMuaGFzRGF0YShlbGVtLCBuYW1lKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgLy8gd2luZG93CiAgICAgICAgICByZXQgPSBvYmplY3RPcHMuaGFzRGF0YShlbGVtLCBuYW1lKTsKICAgICAgICB9CiAgICAgICAgaWYgKHJldCkgewogICAgICAgICAgcmV0dXJuIHJldDsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHJldDsKICAgIH0KICB9KTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpkb21FeHRyYUxpYkV4dHJhSW5zZXJ0aW9uID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21FeHRyYUxpYkV4dHJhQXBpOwogIHV0aWwubWl4KERvbSwgewogICAgLyoqCiAgICAgKiBXcmFwIGEgbm9kZSBhcm91bmQgYWxsIGVsZW1lbnRzIGluIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cwogICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxIVE1MRWxlbWVudFtdfFN0cmluZ30gd3JhcHBlZE5vZGVzIHNldCBvZiBtYXRjaGVkIGVsZW1lbnRzCiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fFN0cmluZ30gd3JhcHBlck5vZGUgaHRtbCBub2RlIG9yIHNlbGVjdG9yIHRvIGdldCB0aGUgbm9kZSB3cmFwcGVyCiAgICAgKi8KICAgIHdyYXBBbGw6IGZ1bmN0aW9uICh3cmFwcGVkTm9kZXMsIHdyYXBwZXJOb2RlKSB7CiAgICAgIC8vIGRlZXAgY2xvbmUKICAgICAgd3JhcHBlck5vZGUgPSBEb20uY2xvbmUoRG9tLmdldCh3cmFwcGVyTm9kZSksIHRydWUpOwogICAgICB3cmFwcGVkTm9kZXMgPSBEb20ucXVlcnkod3JhcHBlZE5vZGVzKTsKICAgICAgaWYgKHdyYXBwZWROb2Rlc1swXS5wYXJlbnROb2RlKSB7CiAgICAgICAgRG9tLmluc2VydEJlZm9yZSh3cmFwcGVyTm9kZSwgd3JhcHBlZE5vZGVzWzBdKTsKICAgICAgfQogICAgICB2YXIgYzsKICAgICAgd2hpbGUgKChjID0gd3JhcHBlck5vZGUuZmlyc3RDaGlsZCkgJiYgYy5ub2RlVHlwZSA9PT0gMSkgewogICAgICAgIHdyYXBwZXJOb2RlID0gYzsKICAgICAgfQogICAgICBEb20uYXBwZW5kVG8od3JhcHBlZE5vZGVzLCB3cmFwcGVyTm9kZSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBXcmFwIGEgbm9kZSBhcm91bmQgZWFjaCBlbGVtZW50IGluIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cwogICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxIVE1MRWxlbWVudFtdfFN0cmluZ30gd3JhcHBlZE5vZGVzIHNldCBvZiBtYXRjaGVkIGVsZW1lbnRzCiAgICAgKiBAcGFyYW0ge0hUTUxFbGVtZW50fFN0cmluZ30gd3JhcHBlck5vZGUgaHRtbCBub2RlIG9yIHNlbGVjdG9yIHRvIGdldCB0aGUgbm9kZSB3cmFwcGVyCiAgICAgKi8KICAgIHdyYXA6IGZ1bmN0aW9uICh3cmFwcGVkTm9kZXMsIHdyYXBwZXJOb2RlKSB7CiAgICAgIHdyYXBwZWROb2RlcyA9IERvbS5xdWVyeSh3cmFwcGVkTm9kZXMpOwogICAgICB3cmFwcGVyTm9kZSA9IERvbS5nZXQod3JhcHBlck5vZGUpOwogICAgICB1dGlsLmVhY2god3JhcHBlZE5vZGVzLCBmdW5jdGlvbiAodykgewogICAgICAgIERvbS53cmFwQWxsKHcsIHdyYXBwZXJOb2RlKTsKICAgICAgfSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBXcmFwIGEgbm9kZSBhcm91bmQgdGhlIGNoaWxkTm9kZXMgb2YgZWFjaCBlbGVtZW50IGluIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cy4KICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnR8SFRNTEVsZW1lbnRbXXxTdHJpbmd9IHdyYXBwZWROb2RlcyBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cwogICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxTdHJpbmd9IHdyYXBwZXJOb2RlIGh0bWwgbm9kZSBvciBzZWxlY3RvciB0byBnZXQgdGhlIG5vZGUgd3JhcHBlcgogICAgICovCiAgICB3cmFwSW5uZXI6IGZ1bmN0aW9uICh3cmFwcGVkTm9kZXMsIHdyYXBwZXJOb2RlKSB7CiAgICAgIHdyYXBwZWROb2RlcyA9IERvbS5xdWVyeSh3cmFwcGVkTm9kZXMpOwogICAgICB3cmFwcGVyTm9kZSA9IERvbS5nZXQod3JhcHBlck5vZGUpOwogICAgICB1dGlsLmVhY2god3JhcHBlZE5vZGVzLCBmdW5jdGlvbiAodykgewogICAgICAgIHZhciBjb250ZW50cyA9IHcuY2hpbGROb2RlczsKICAgICAgICBpZiAoY29udGVudHMubGVuZ3RoKSB7CiAgICAgICAgICBEb20ud3JhcEFsbChjb250ZW50cywgd3JhcHBlck5vZGUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB3LmFwcGVuZENoaWxkKHdyYXBwZXJOb2RlKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfSwKICAgIC8qKgogICAgICogUmVtb3ZlIHRoZSBwYXJlbnRzIG9mIHRoZSBzZXQgb2YgbWF0Y2hlZCBlbGVtZW50cyBmcm9tIHRoZSBEb20sCiAgICAgKiBsZWF2aW5nIHRoZSBtYXRjaGVkIGVsZW1lbnRzIGluIHRoZWlyIHBsYWNlLgogICAgICogQHBhcmFtIHtIVE1MRWxlbWVudHxIVE1MRWxlbWVudFtdfFN0cmluZ30gd3JhcHBlZE5vZGVzIHNldCBvZiBtYXRjaGVkIGVsZW1lbnRzCiAgICAgKi8KICAgIHVud3JhcDogZnVuY3Rpb24gKHdyYXBwZWROb2RlcykgewogICAgICB3cmFwcGVkTm9kZXMgPSBEb20ucXVlcnkod3JhcHBlZE5vZGVzKTsKICAgICAgdXRpbC5lYWNoKHdyYXBwZWROb2RlcywgZnVuY3Rpb24gKHcpIHsKICAgICAgICB2YXIgcCA9IHcucGFyZW50Tm9kZTsKICAgICAgICBEb20ucmVwbGFjZVdpdGgocCwgcC5jaGlsZE5vZGVzKTsKICAgICAgfSk7CiAgICB9CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tRXh0cmFMaWJFeHRyYU9mZnNldCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tID0gZG9tRXh0cmFMaWJFeHRyYUFwaTsKICB2YXIgZ2V0V2luZG93ID0gRG9tLmdldFdpbmRvdywgTm9kZVR5cGUgPSBEb20uTm9kZVR5cGUsIExFRlQgPSAnbGVmdCcsIFRPUCA9ICd0b3AnOwogIHV0aWwubWl4KERvbSwgewogICAgLyoqCiAgICAgKiBzY3JvbGxzIHRoZSBmaXJzdCBvZiBtYXRjaGVkIGVsZW1lbnRzIGludG8gY29udGFpbmVyIHZpZXcKICAgICAqIEBwYXJhbSB7SFRNTEVsZW1lbnRbXXxTdHJpbmd8SFRNTEVsZW1lbnR9IHNlbGVjdG9yIE1hdGNoZWQgZWxlbWVudHMKICAgICAqIEBwYXJhbSB7U3RyaW5nfEhUTUxFbGVtZW50fEhUTUxEb2N1bWVudH0gW2NvbnRhaW5lcj13aW5kb3ddIENvbnRhaW5lciBlbGVtZW50CiAgICAgKiBAcGFyYW0ge0Jvb2xlYW58T2JqZWN0fSBbYWxpZ25XaXRoVG9wPXRydWVdSWYgdHJ1ZSwgdGhlIHNjcm9sbGVkIGVsZW1lbnQgaXMgYWxpZ25lZCB3aXRoIHRoZSB0b3Agb2YgdGhlIHNjcm9sbCBhcmVhLgogICAgICogSWYgZmFsc2UsIGl0IGlzIGFsaWduZWQgd2l0aCB0aGUgYm90dG9tLgogICAgICogQHBhcmFtIHtCb29sZWFufSBbYWxpZ25XaXRoVG9wLmFsbG93SG9yaXpvbnRhbFNjcm9sbD10cnVlXSBXaGV0aGVyIHRyaWdnZXIgaG9yaXpvbnRhbCBzY3JvbGwuCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFthbGlnbldpdGhUb3Aub25seVNjcm9sbElmTmVlZGVkPWZhbHNlXSBzY3JvbGxJbnRvVmlldyB3aGVuIGVsZW1lbnQgaXMgb3V0IG9mIHZpZXcKICAgICAqIGFuZCBzZXQgdG9wIHRvIGZhbHNlIG9yIHRydWUgYXV0b21hdGljYWxseSBpZiB0b3AgaXMgdW5kZWZpbmVkCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFthbGxvd0hvcml6b250YWxTY3JvbGw9dHJ1ZV0gV2hldGhlciB0cmlnZ2VyIGhvcml6b250YWwgc2Nyb2xsLgogICAgICogcmVmZXI6IGh0dHA6Ly93d3cudzMub3JnL1RSLzIwMDkvV0QtaHRtbDUtMjAwOTA0MjMvZWRpdGluZy5odG1sI3Njcm9sbEludG9WaWV3CiAgICAgKiAgICAgICAgaHR0cDovL3d3dy5zZW5jaGEuY29tL2RlcGxveS9kZXYvZG9jcy9zb3VyY2UvRWxlbWVudC5zY3JvbGwtbW9yZS5odG1sI3Njcm9sbEludG9WaWV3CiAgICAgKiAgICAgICAgaHR0cDovL3lpbWluZ2hlLmphdmFleWUuY29tL2Jsb2cvMzkwNzMyCiAgICAgKi8KICAgIHNjcm9sbEludG9WaWV3OiBmdW5jdGlvbiAoc2VsZWN0b3IsIGNvbnRhaW5lciwgYWxpZ25XaXRoVG9wLCBhbGxvd0hvcml6b250YWxTY3JvbGwpIHsKICAgICAgdmFyIGVsZW0sIG9ubHlTY3JvbGxJZk5lZWRlZDsKICAgICAgaWYgKCEoZWxlbSA9IERvbS5nZXQoc2VsZWN0b3IpKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoY29udGFpbmVyKSB7CiAgICAgICAgY29udGFpbmVyID0gRG9tLmdldChjb250YWluZXIpOwogICAgICB9CiAgICAgIGlmICghY29udGFpbmVyKSB7CiAgICAgICAgY29udGFpbmVyID0gZWxlbS5vd25lckRvY3VtZW50OwogICAgICB9CiAgICAgIC8vIGRvY3VtZW50IOW9kuS4gOWMluWIsCB3aW5kb3cKICAgICAgaWYgKGNvbnRhaW5lci5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuRE9DVU1FTlRfTk9ERSkgewogICAgICAgIGNvbnRhaW5lciA9IGdldFdpbmRvdyhjb250YWluZXIpOwogICAgICB9CiAgICAgIGlmICh0eXBlb2YgYWxpZ25XaXRoVG9wID09PSAnb2JqZWN0JykgewogICAgICAgIGFsbG93SG9yaXpvbnRhbFNjcm9sbCA9IGFsaWduV2l0aFRvcC5hbGxvd0hvcml6b250YWxTY3JvbGw7CiAgICAgICAgb25seVNjcm9sbElmTmVlZGVkID0gYWxpZ25XaXRoVG9wLm9ubHlTY3JvbGxJZk5lZWRlZDsKICAgICAgICBhbGlnbldpdGhUb3AgPSBhbGlnbldpdGhUb3AuYWxpZ25XaXRoVG9wOwogICAgICB9CiAgICAgIGFsbG93SG9yaXpvbnRhbFNjcm9sbCA9IGFsbG93SG9yaXpvbnRhbFNjcm9sbCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6IGFsbG93SG9yaXpvbnRhbFNjcm9sbDsKICAgICAgdmFyIGlzV2luID0gdXRpbC5pc1dpbmRvdyhjb250YWluZXIpLCBlbGVtT2Zmc2V0ID0gRG9tLm9mZnNldChlbGVtKSwgZWggPSBEb20ub3V0ZXJIZWlnaHQoZWxlbSksIGV3ID0gRG9tLm91dGVyV2lkdGgoZWxlbSksIGNvbnRhaW5lck9mZnNldCwgY2gsIGN3LCBjb250YWluZXJTY3JvbGwsIGRpZmZUb3AsIGRpZmZCb3R0b20sIHdpbiwgd2luU2Nyb2xsLCB3dywgd2g7CiAgICAgIGlmIChpc1dpbikgewogICAgICAgIHdpbiA9IGNvbnRhaW5lcjsKICAgICAgICB3aCA9IERvbS5oZWlnaHQod2luKTsKICAgICAgICB3dyA9IERvbS53aWR0aCh3aW4pOwogICAgICAgIHdpblNjcm9sbCA9IHsKICAgICAgICAgIGxlZnQ6IERvbS5zY3JvbGxMZWZ0KHdpbiksCiAgICAgICAgICB0b3A6IERvbS5zY3JvbGxUb3Aod2luKQogICAgICAgIH07CiAgICAgICAgLy8gZWxlbSDnm7jlr7kgY29udGFpbmVyIOWPr+inhuinhueql+eahOi3neemuwogICAgICAgIGRpZmZUb3AgPSB7CiAgICAgICAgICBsZWZ0OiBlbGVtT2Zmc2V0W0xFRlRdIC0gd2luU2Nyb2xsW0xFRlRdLAogICAgICAgICAgdG9wOiBlbGVtT2Zmc2V0W1RPUF0gLSB3aW5TY3JvbGxbVE9QXQogICAgICAgIH07CiAgICAgICAgZGlmZkJvdHRvbSA9IHsKICAgICAgICAgIGxlZnQ6IGVsZW1PZmZzZXRbTEVGVF0gKyBldyAtICh3aW5TY3JvbGxbTEVGVF0gKyB3dyksCiAgICAgICAgICB0b3A6IGVsZW1PZmZzZXRbVE9QXSArIGVoIC0gKHdpblNjcm9sbFtUT1BdICsgd2gpCiAgICAgICAgfTsKICAgICAgICBjb250YWluZXJTY3JvbGwgPSB3aW5TY3JvbGw7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgY29udGFpbmVyT2Zmc2V0ID0gRG9tLm9mZnNldChjb250YWluZXIpOwogICAgICAgIGNoID0gY29udGFpbmVyLmNsaWVudEhlaWdodDsKICAgICAgICBjdyA9IGNvbnRhaW5lci5jbGllbnRXaWR0aDsKICAgICAgICBjb250YWluZXJTY3JvbGwgPSB7CiAgICAgICAgICBsZWZ0OiBEb20uc2Nyb2xsTGVmdChjb250YWluZXIpLAogICAgICAgICAgdG9wOiBEb20uc2Nyb2xsVG9wKGNvbnRhaW5lcikKICAgICAgICB9OwogICAgICAgIC8vIGVsZW0g55u45a+5IGNvbnRhaW5lciDlj6/op4bop4bnqpfnmoTot53nprsKICAgICAgICAvLyDms6jmhI/ovrnmoYYgLCBvZmZzZXQg5piv6L655qGG5Yiw5qC56IqC54K5CiAgICAgICAgZGlmZlRvcCA9IHsKICAgICAgICAgIGxlZnQ6IGVsZW1PZmZzZXRbTEVGVF0gLSAoY29udGFpbmVyT2Zmc2V0W0xFRlRdICsgKHBhcnNlRmxvYXQoRG9tLmNzcyhjb250YWluZXIsICdib3JkZXJMZWZ0V2lkdGgnKSkgfHwgMCkpLAogICAgICAgICAgdG9wOiBlbGVtT2Zmc2V0W1RPUF0gLSAoY29udGFpbmVyT2Zmc2V0W1RPUF0gKyAocGFyc2VGbG9hdChEb20uY3NzKGNvbnRhaW5lciwgJ2JvcmRlclRvcFdpZHRoJykpIHx8IDApKQogICAgICAgIH07CiAgICAgICAgZGlmZkJvdHRvbSA9IHsKICAgICAgICAgIGxlZnQ6IGVsZW1PZmZzZXRbTEVGVF0gKyBldyAtIChjb250YWluZXJPZmZzZXRbTEVGVF0gKyBjdyArIChwYXJzZUZsb2F0KERvbS5jc3MoY29udGFpbmVyLCAnYm9yZGVyUmlnaHRXaWR0aCcpKSB8fCAwKSksCiAgICAgICAgICB0b3A6IGVsZW1PZmZzZXRbVE9QXSArIGVoIC0gKGNvbnRhaW5lck9mZnNldFtUT1BdICsgY2ggKyAocGFyc2VGbG9hdChEb20uY3NzKGNvbnRhaW5lciwgJ2JvcmRlckJvdHRvbVdpZHRoJykpIHx8IDApKQogICAgICAgIH07CiAgICAgIH0KICAgICAgaWYgKG9ubHlTY3JvbGxJZk5lZWRlZCkgewogICAgICAgIGlmIChkaWZmVG9wLnRvcCA8IDAgfHwgZGlmZkJvdHRvbS50b3AgPiAwKSB7CiAgICAgICAgICAvLyDlvLrliLblkJHkuIoKICAgICAgICAgIGlmIChhbGlnbldpdGhUb3AgPT09IHRydWUpIHsKICAgICAgICAgICAgRG9tLnNjcm9sbFRvcChjb250YWluZXIsIGNvbnRhaW5lclNjcm9sbC50b3AgKyBkaWZmVG9wLnRvcCk7CiAgICAgICAgICB9IGVsc2UgaWYgKGFsaWduV2l0aFRvcCA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgRG9tLnNjcm9sbFRvcChjb250YWluZXIsIGNvbnRhaW5lclNjcm9sbC50b3AgKyBkaWZmQm90dG9tLnRvcCk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAvLyDoh6rliqjosIPmlbQKICAgICAgICAgICAgaWYgKGRpZmZUb3AudG9wIDwgMCkgewogICAgICAgICAgICAgIERvbS5zY3JvbGxUb3AoY29udGFpbmVyLCBjb250YWluZXJTY3JvbGwudG9wICsgZGlmZlRvcC50b3ApOwogICAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICAgIERvbS5zY3JvbGxUb3AoY29udGFpbmVyLCBjb250YWluZXJTY3JvbGwudG9wICsgZGlmZkJvdHRvbS50b3ApOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGFsaWduV2l0aFRvcCA9IGFsaWduV2l0aFRvcCA9PT0gdW5kZWZpbmVkID8gdHJ1ZSA6ICEhYWxpZ25XaXRoVG9wOwogICAgICAgIGlmIChhbGlnbldpdGhUb3ApIHsKICAgICAgICAgIERvbS5zY3JvbGxUb3AoY29udGFpbmVyLCBjb250YWluZXJTY3JvbGwudG9wICsgZGlmZlRvcC50b3ApOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBEb20uc2Nyb2xsVG9wKGNvbnRhaW5lciwgY29udGFpbmVyU2Nyb2xsLnRvcCArIGRpZmZCb3R0b20udG9wKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgaWYgKGFsbG93SG9yaXpvbnRhbFNjcm9sbCkgewogICAgICAgIGlmIChvbmx5U2Nyb2xsSWZOZWVkZWQpIHsKICAgICAgICAgIGlmIChkaWZmVG9wLmxlZnQgPCAwIHx8IGRpZmZCb3R0b20ubGVmdCA+IDApIHsKICAgICAgICAgICAgLy8g5by65Yi25ZCR5LiKCiAgICAgICAgICAgIGlmIChhbGlnbldpdGhUb3AgPT09IHRydWUpIHsKICAgICAgICAgICAgICBEb20uc2Nyb2xsTGVmdChjb250YWluZXIsIGNvbnRhaW5lclNjcm9sbC5sZWZ0ICsgZGlmZlRvcC5sZWZ0KTsKICAgICAgICAgICAgfSBlbHNlIGlmIChhbGlnbldpdGhUb3AgPT09IGZhbHNlKSB7CiAgICAgICAgICAgICAgRG9tLnNjcm9sbExlZnQoY29udGFpbmVyLCBjb250YWluZXJTY3JvbGwubGVmdCArIGRpZmZCb3R0b20ubGVmdCk7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgLy8g6Ieq5Yqo6LCD5pW0CiAgICAgICAgICAgICAgaWYgKGRpZmZUb3AubGVmdCA8IDApIHsKICAgICAgICAgICAgICAgIERvbS5zY3JvbGxMZWZ0KGNvbnRhaW5lciwgY29udGFpbmVyU2Nyb2xsLmxlZnQgKyBkaWZmVG9wLmxlZnQpOwogICAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgICBEb20uc2Nyb2xsTGVmdChjb250YWluZXIsIGNvbnRhaW5lclNjcm9sbC5sZWZ0ICsgZGlmZkJvdHRvbS5sZWZ0KTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgYWxpZ25XaXRoVG9wID0gYWxpZ25XaXRoVG9wID09PSB1bmRlZmluZWQgPyB0cnVlIDogISFhbGlnbldpdGhUb3A7CiAgICAgICAgICBpZiAoYWxpZ25XaXRoVG9wKSB7CiAgICAgICAgICAgIERvbS5zY3JvbGxMZWZ0KGNvbnRhaW5lciwgY29udGFpbmVyU2Nyb2xsLmxlZnQgKyBkaWZmVG9wLmxlZnQpOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgRG9tLnNjcm9sbExlZnQoY29udGFpbmVyLCBjb250YWluZXJTY3JvbGwubGVmdCArIGRpZmZCb3R0b20ubGVmdCk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tRXh0cmFMaWJFeHRyYVN0eWxlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBGZWF0dXJlID0gZmVhdHVyZTsKICB2YXIgRG9tID0gZG9tRXh0cmFMaWJFeHRyYUFwaTsKICB2YXIgY2FtZWxDYXNlID0gdXRpbC5jYW1lbENhc2UsIHN0eWxlID0gRG9tLl9zdHlsZSwgZ2V0Tm9kZU5hbWUgPSBEb20ubm9kZU5hbWUsIGdldENzc1ZlbmRvckluZm8gPSBGZWF0dXJlLmdldENzc1ZlbmRvckluZm8sIHVzZXJTZWxlY3RWZW5kb3JJbmZvID0gZ2V0Q3NzVmVuZG9ySW5mbygndXNlclNlbGVjdCcpLCB1c2VyU2VsZWN0UHJvcGVydHkgPSB1c2VyU2VsZWN0VmVuZG9ySW5mbyAmJiB1c2VyU2VsZWN0VmVuZG9ySW5mby5wcm9wZXJ0eU5hbWU7CiAgdXRpbC5taXgoRG9tLCB7CiAgICAvKioKICAgICAqICBHZXQgaW5saW5lIHN0eWxlIHByb3BlcnR5IGZyb20gdGhlIGZpcnN0IGVsZW1lbnQgb2YgbWF0Y2hlZCBlbGVtZW50cwogICAgICogIG9yCiAgICAgKiAgU2V0IG9uZSBvciBtb3JlIENTUyBwcm9wZXJ0aWVzIGZvciB0aGUgc2V0IG9mIG1hdGNoZWQgZWxlbWVudHMuCiAgICAgKiAgQHBhcmFtIHtIVE1MRWxlbWVudFtdfFN0cmluZ3xIVE1MRWxlbWVudH0gc2VsZWN0b3IgTWF0Y2hlZCBlbGVtZW50cwogICAgICogIEBwYXJhbSB7U3RyaW5nfE9iamVjdH0gbmFtZSBBIENTUyBwcm9wZXJ0eS4gb3IgQSBtYXAgb2YgcHJvcGVydHktdmFsdWUgcGFpcnMgdG8gc2V0LgogICAgICogIEBwYXJhbSBbdmFsXSBBIHZhbHVlIHRvIHNldCBmb3IgdGhlIHByb3BlcnR5LgogICAgICogIEByZXR1cm4ge3VuZGVmaW5lZHxTdHJpbmd9CiAgICAgKi8KICAgIHN0eWxlOiBmdW5jdGlvbiAoc2VsZWN0b3IsIG5hbWUsIHZhbCkgewogICAgICB2YXIgZWxzID0gRG9tLnF1ZXJ5KHNlbGVjdG9yKSwgaywgcmV0LCBlbGVtID0gZWxzWzBdLCBpOwogICAgICAvLyBzdXBwb3J0cyBoYXNoCiAgICAgIGlmICh0eXBlb2YgbmFtZSA9PT0gJ29iamVjdCcpIHsKICAgICAgICBmb3IgKGsgaW4gbmFtZSkgewogICAgICAgICAgayA9IGNhbWVsQ2FzZShrKTsKICAgICAgICAgIGZvciAoaSA9IGVscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgICBzdHlsZShlbHNbaV0sIGssIG5hbWVba10sIDEpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIG5hbWUgPSBjYW1lbENhc2UobmFtZSk7CiAgICAgIGlmICh2YWwgPT09IHVuZGVmaW5lZCkgewogICAgICAgIHJldCA9ICcnOwogICAgICAgIGlmIChlbGVtKSB7CiAgICAgICAgICByZXQgPSBzdHlsZShlbGVtLCBuYW1lLCB2YWwsIDEpOwogICAgICAgIH0KICAgICAgICByZXR1cm4gcmV0OwogICAgICB9IGVsc2UgewogICAgICAgIGZvciAoaSA9IGVscy5sZW5ndGggLSAxOyBpID49IDA7IGktLSkgewogICAgICAgICAgc3R5bGUoZWxzW2ldLCBuYW1lLCB2YWwsIDEpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSwKICAgIC8qKgogICAgICogTWFrZSBtYXRjaGVkIGVsZW1lbnRzIHVuc2VsZWN0YWJsZQogICAgICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfFN0cmluZ3xIVE1MRWxlbWVudH0gc2VsZWN0b3IgIE1hdGNoZWQgZWxlbWVudHMuCiAgICAgKi8KICAgIHVuc2VsZWN0YWJsZTogdXNlclNlbGVjdFByb3BlcnR5ID8gZnVuY3Rpb24gKHNlbGVjdG9yKSB7CiAgICAgIHZhciBlbHMgPSBEb20ucXVlcnkoc2VsZWN0b3IpOwogICAgICBmb3IgKHZhciBqID0gZWxzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgZWxzW2pdLnN0eWxlW3VzZXJTZWxlY3RQcm9wZXJ0eV0gPSAnbm9uZSc7CiAgICAgIH0KICAgIH0gOiBmdW5jdGlvbiAoc2VsZWN0b3IpIHsKICAgICAgdmFyIF9lbHMgPSBEb20ucXVlcnkoc2VsZWN0b3IpLCBlbGVtLCBqLCBlLCBpID0gMCwgZXhjbHVkZXMsIHN0eWxlLCBlbHM7CiAgICAgIGV4Y2x1ZGVzID0gWwogICAgICAgICdpZnJhbWUnLAogICAgICAgICd0ZXh0YXJlYScsCiAgICAgICAgJ2lucHV0JywKICAgICAgICAnc2VsZWN0JwogICAgICBdOwogICAgICBmb3IgKGogPSBfZWxzLmxlbmd0aCAtIDE7IGogPj0gMDsgai0tKSB7CiAgICAgICAgZWxlbSA9IF9lbHNbal07CiAgICAgICAgc3R5bGUgPSBlbGVtLnN0eWxlOwogICAgICAgIGVscyA9IGVsZW0uZ2V0RWxlbWVudHNCeVRhZ05hbWUoJyonKTsKICAgICAgICBlbGVtLnNldEF0dHJpYnV0ZSgndW5zZWxlY3RhYmxlJywgJ29uJyk7CiAgICAgICAgd2hpbGUgKGUgPSBlbHNbaSsrXSkgewogICAgICAgICAgaWYgKCF1dGlsLmluQXJyYXkoZ2V0Tm9kZU5hbWUoZSksIGV4Y2x1ZGVzKSkgewogICAgICAgICAgICBlLnNldEF0dHJpYnV0ZSgndW5zZWxlY3RhYmxlJywgJ29uJyk7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tRXh0cmFMaWJFeHRyYSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIERvbSA9IGRvbUV4dHJhTGliRXh0cmFBcGk7CiAgZG9tRXh0cmFMaWJFeHRyYUF0dHI7CiAgZG9tRXh0cmFMaWJFeHRyYUNyZWF0ZTsKICBkb21FeHRyYUxpYkV4dHJhRGF0YTsKICBkb21FeHRyYUxpYkV4dHJhSW5zZXJ0aW9uOwogIGRvbUV4dHJhTGliRXh0cmFPZmZzZXQ7CiAgZG9tRXh0cmFMaWJFeHRyYVN0eWxlOwogIGV4cG9ydHMgPSBEb207CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZG9tRXh0cmFJbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZXhwb3J0cyA9IGRvbUV4dHJhTGliRXh0cmE7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGRvbUV4dHJhSW5kZXg7Cn0pO2RlZmluZSgiaW8tZm9ybSIsIFsndXRpbCcsJ2RvbScsInF1ZXJ5c3RyaW5nIiwiaW8tYmFzZSJdLCBmdW5jdGlvbihyZXF1aXJlKSB7CnZhciB1dGlsQmFzZSA9IHJlcXVpcmUoJ3V0aWwnKTsKdmFyIGRvbUJhc2UgPSByZXF1aXJlKCdkb20nKTsKdmFyIF9xdWVyeXN0cmluZ18gPSByZXF1aXJlKCJxdWVyeXN0cmluZyIpOwp2YXIgaW9CYXNlID0gcmVxdWlyZSgiaW8tYmFzZSIpOwovLyEgQ29weXJpZ2h0IDIwMTUsIGlvLWZvcm1ANi4xLjIgTUlUIExpY2Vuc2VkLCBidWlsZCB0aW1lOiBUdWUsIDAzIE5vdiAyMDE1IDA2OjMxOjE1IEdNVCAKLyoKY29tYmluZWQgbW9kdWxlczoKaW8tZm9ybQppby1mb3JtL2xpYi9mb3JtCmlvLWZvcm0vbGliL2Zvcm0tc2VyaWFsaXplcgoqLwp2YXIgaW9Gb3JtTGliRm9ybVNlcmlhbGl6ZXIsIGlvRm9ybUxpYkZvcm0sIGlvRm9ybUluZGV4Owppb0Zvcm1MaWJGb3JtU2VyaWFsaXplciA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgLyoqCiAgICogQGlnbm9yZQogICAqIGZvcm0gZGF0YSAgc2VyaWFsaXphdGlvbiB1dGlsCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBxdWVyeXN0cmluZyA9IF9xdWVyeXN0cmluZ187CiAgdmFyIHJzZWxlY3RUZXh0YXJlYSA9IC9eKD86c2VsZWN0fHRleHRhcmVhKS9pLCByQ1JMRiA9IC9ccj9cbi9nLCBGb3JtU2VyaWFsaXplciwgcmlucHV0ID0gL14oPzpjb2xvcnxkYXRlfGRhdGV0aW1lfGVtYWlsfGhpZGRlbnxtb250aHxudW1iZXJ8cGFzc3dvcmR8cmFuZ2V8c2VhcmNofHRlbHx0ZXh0fHRpbWV8dXJsfHdlZWspJC9pOwogIGZ1bmN0aW9uIG5vcm1hbGl6ZUNSTEYodikgewogICAgcmV0dXJuIHYucmVwbGFjZShyQ1JMRiwgJ1xyXG4nKTsKICB9CiAgRm9ybVNlcmlhbGl6ZXIgPSB7CiAgICAvKioKICAgICAqIGZvcm0gc2VyaWFsaXphdGlvbgogICAgICogQG1ldGhvZAogICAgICogQHBhcmFtIHtIVE1MRWxlbWVudFtdfEhUTUxFbGVtZW50fE5vZGV9IGZvcm1zIGZvcm0gZWxlbWVudHMKICAgICAqIEByZXR1cm4ge1N0cmluZ30gc2VyaWFsaXplZCBzdHJpbmcgcmVwcmVzZW50IGZvcm0gZWxlbWVudHMKICAgICAqIEBwYXJhbSB7Qm9vbGVhbn1bc2VyaWFsaXplQXJyYXk9ZmFsc2VdIFNlZSB7QGxpbmsgS0lTU1kjbWV0aG9kLXBhcmFtfSDlkIzlkI3lj4LmlbAKICAgICAqIEBtZW1iZXIgSU8KICAgICAqIEBzdGF0aWMKICAgICAqLwogICAgc2VyaWFsaXplOiBmdW5jdGlvbiAoZm9ybXMsIHNlcmlhbGl6ZUFycmF5KSB7CiAgICAgIC8vIOWQjeWAvOmUruWAvOWvueW6j+WIl+WMlizmlbDnu4TlhYPntKDlkI3lrZfliY3kuI3liqAgW10KICAgICAgcmV0dXJuIHF1ZXJ5c3RyaW5nLnN0cmluZ2lmeShGb3JtU2VyaWFsaXplci5nZXRGb3JtRGF0YShmb3JtcyksIHVuZGVmaW5lZCwgdW5kZWZpbmVkLCBzZXJpYWxpemVBcnJheSB8fCBmYWxzZSk7CiAgICB9LAogICAgZ2V0Rm9ybURhdGE6IGZ1bmN0aW9uIChmb3JtcykgewogICAgICB2YXIgZWxlbWVudHMgPSBbXSwgZGF0YSA9IHt9OwogICAgICB1dGlsLmVhY2goRG9tLnF1ZXJ5KGZvcm1zKSwgZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgLy8gZm9ybSDlj5blhbbooajljZXlhYPntKDpm4blkIgKICAgICAgICAvLyDlhbbku5bnm7TmjqXlj5boh6rouqsKICAgICAgICB2YXIgc3VicyA9IGVsLmVsZW1lbnRzID8gZWxlbWVudHNUb0FycmF5KGVsLmVsZW1lbnRzKSA6IFtlbF07CiAgICAgICAgZWxlbWVudHMucHVzaC5hcHBseShlbGVtZW50cywgc3Vicyk7CiAgICAgIH0pOwogICAgICAvLyDlr7nooajljZXlhYPntKDov5vooYzov4fmu6TvvIzlhbflpIfmnInmlYjlgLznmoTmiY3kv53nlZkKICAgICAgZWxlbWVudHMgPSB1dGlsLmZpbHRlcihlbGVtZW50cywgZnVuY3Rpb24gKGVsKSB7CiAgICAgICAgLy8g5pyJ5ZCN5a2XCiAgICAgICAgcmV0dXJuIGVsLm5hbWUgJiYgLy8g5LiN6KKr56aB55SoCiAgICAgICAgIWVsLmRpc2FibGVkICYmIC8vIHJhZGlvLGNoZWNrYm94IOiiq+mAieaLqeS6hgogICAgICAgIChlbC5jaGVja2VkIHx8IC8vIHNlbGVjdCDmiJbogIUgdGV4dGFyZWEKICAgICAgICByc2VsZWN0VGV4dGFyZWEudGVzdChlbC5ub2RlTmFtZSkgfHwgLy8gaW5wdXQg57G75Z6LCiAgICAgICAgcmlucHV0LnRlc3QoZWwudHlwZSkpOwogICAgICB9KTsKICAgICAgdXRpbC5lYWNoKGVsZW1lbnRzLCBmdW5jdGlvbiAoZWwpIHsKICAgICAgICB2YXIgdmFsID0gRG9tLnZhbChlbCksIHZzOwogICAgICAgIC8vIDxzZWxlY3Q+PC9zZWxlY3Q+IHNlbGVjdCBub3RoaW5nIQogICAgICAgIC8vICMyOTcKICAgICAgICBpZiAodmFsID09PSBudWxsKSB7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIC8vIOWtl+espuS4suaNouihjOW5s+WPsOW9kuS4gOWMlgogICAgICAgIGlmICh1dGlsLmlzQXJyYXkodmFsKSkgewogICAgICAgICAgdmFsID0gdXRpbC5tYXAodmFsLCBub3JtYWxpemVDUkxGKTsKICAgICAgICB9IGVsc2UgewogICAgICAgICAgdmFsID0gbm9ybWFsaXplQ1JMRih2YWwpOwogICAgICAgIH0KICAgICAgICB2cyA9IGRhdGFbZWwubmFtZV07CiAgICAgICAgaWYgKHZzID09PSB1bmRlZmluZWQpIHsKICAgICAgICAgIGRhdGFbZWwubmFtZV0gPSB2YWw7CiAgICAgICAgICByZXR1cm47CiAgICAgICAgfQogICAgICAgIGlmICghdXRpbC5pc0FycmF5KHZzKSkgewogICAgICAgICAgLy8g5aSa5Liq5YWD57Sg6YeN5ZCN5pe25pCe5oiQ5pWw57uECiAgICAgICAgICB2cyA9IGRhdGFbZWwubmFtZV0gPSBbdnNdOwogICAgICAgIH0KICAgICAgICB2cy5wdXNoLmFwcGx5KHZzLCB1dGlsLm1ha2VBcnJheSh2YWwpKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBkYXRhOwogICAgfQogIH07CiAgLy8gZG8gbm90IHBhc3MgZm9ybS5lbGVtZW50cyB0byBTLm1ha2VBcnJheSBpZTY3OCBidWcKICBmdW5jdGlvbiBlbGVtZW50c1RvQXJyYXkoZWxlbWVudHMpIHsKICAgIHZhciByZXQgPSBbXTsKICAgIGZvciAodmFyIGkgPSAwOyBpIDwgZWxlbWVudHMubGVuZ3RoOyBpKyspIHsKICAgICAgcmV0LnB1c2goZWxlbWVudHNbaV0pOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9CiAgZXhwb3J0cyA9IEZvcm1TZXJpYWxpemVyOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmlvRm9ybUxpYkZvcm0gPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIElPID0gaW9CYXNlOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBxdWVyeXN0cmluZyA9IF9xdWVyeXN0cmluZ187CiAgdmFyIEZvcm1TZXJpYWxpemVyID0gaW9Gb3JtTGliRm9ybVNlcmlhbGl6ZXI7CiAgdmFyIHdpbiA9IHdpbmRvdywgc2xpY2UgPSBBcnJheS5wcm90b3R5cGUuc2xpY2UsIEZvcm1EYXRhID0gd2luLkZvcm1EYXRhOwogIElPLmFkZFByZXByb2Nlc3Nvcignc3RhcnQnLCBmdW5jdGlvbiAoZSkgewogICAgdmFyIGlvID0gZS5pbywgZm9ybSwgZCwgZGF0YVR5cGUsIGZvcm1QYXJhbSwgZGF0YSwgYyA9IGlvLmNvbmZpZywgdG1wRm9ybSA9IGMuZm9ybTsKICAgIGlmICh0bXBGb3JtKSB7CiAgICAgIGZvcm0gPSBEb20uZ2V0KHRtcEZvcm0pOwogICAgICBkYXRhID0gYy5kYXRhOwogICAgICB2YXIgaXNVcGxvYWQgPSBmYWxzZTsKICAgICAgdmFyIGZpbGVzID0ge307CiAgICAgIHZhciBpbnB1dHMgPSBEb20ucXVlcnkoJ2lucHV0JywgZm9ybSk7CiAgICAgIGZvciAodmFyIGkgPSAwLCBsID0gaW5wdXRzLmxlbmd0aDsgaSA8IGw7IGkrKykgewogICAgICAgIHZhciBpbnB1dCA9IGlucHV0c1tpXTsKICAgICAgICBpZiAoaW5wdXQudHlwZS50b0xvd2VyQ2FzZSgpID09PSAnZmlsZScpIHsKICAgICAgICAgIGlzVXBsb2FkID0gdHJ1ZTsKICAgICAgICAgIGlmICghRm9ybURhdGEpIHsKICAgICAgICAgICAgYnJlYWs7CiAgICAgICAgICB9CiAgICAgICAgICB2YXIgc2VsZWN0ZWQgPSBzbGljZS5jYWxsKGlucHV0LmZpbGVzLCAwKTsKICAgICAgICAgIGZpbGVzW0RvbS5hdHRyKGlucHV0LCAnbmFtZScpXSA9IHNlbGVjdGVkLmxlbmd0aCA+IDEgPyBzZWxlY3RlZCA6IHNlbGVjdGVkWzBdIHx8IG51bGw7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChpc1VwbG9hZCAmJiBGb3JtRGF0YSkgewogICAgICAgIGMuZmlsZXMgPSBjLmZpbGVzIHx8IHt9OwogICAgICAgIHV0aWwubWl4KGMuZmlsZXMsIGZpbGVzKTsKICAgICAgICBkZWxldGUgYy5jb250ZW50VHlwZTsKICAgICAgfQogICAgICBpZiAoIWlzVXBsb2FkIHx8IEZvcm1EYXRhKSB7CiAgICAgICAgZm9ybVBhcmFtID0gRm9ybVNlcmlhbGl6ZXIuZ2V0Rm9ybURhdGEoZm9ybSk7CiAgICAgICAgaWYgKGMuaGFzQ29udGVudCkgewogICAgICAgICAgZm9ybVBhcmFtID0gcXVlcnlzdHJpbmcuc3RyaW5naWZ5KGZvcm1QYXJhbSwgdW5kZWZpbmVkLCB1bmRlZmluZWQsIGMuc2VyaWFsaXplQXJyYXkpOwogICAgICAgICAgaWYgKGRhdGEpIHsKICAgICAgICAgICAgYy5kYXRhICs9ICcmJyArIGZvcm1QYXJhbTsKICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIGMuZGF0YSA9IGZvcm1QYXJhbTsKICAgICAgICAgIH0KICAgICAgICB9IGVsc2UgewogICAgICAgICAgdXRpbC5taXgoYy51cmkucXVlcnksIGZvcm1QYXJhbSk7CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIGRhdGFUeXBlID0gYy5kYXRhVHlwZTsKICAgICAgICBkID0gZGF0YVR5cGVbMF07CiAgICAgICAgaWYgKGQgPT09ICcqJykgewogICAgICAgICAgZCA9ICd0ZXh0JzsKICAgICAgICB9CiAgICAgICAgZGF0YVR5cGUubGVuZ3RoID0gMjsKICAgICAgICBkYXRhVHlwZVswXSA9ICdpZnJhbWUnOwogICAgICAgIGRhdGFUeXBlWzFdID0gZDsKICAgICAgfQogICAgfQogIH0pOwogIGV4cG9ydHMgPSBGb3JtU2VyaWFsaXplcjsKICByZXR1cm4gZXhwb3J0czsKfSgpOwppb0Zvcm1JbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZXhwb3J0cyA9IGlvRm9ybUxpYkZvcm07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGlvRm9ybUluZGV4Owp9KTtkZWZpbmUoIm5vZGUiLCBbIm5vZGUtYmFzZSIsIm5vZGUtZXZlbnQiLCJub2RlLWFuaW0iXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgbm9kZUJhc2UgPSByZXF1aXJlKCJub2RlLWJhc2UiKTsKdmFyIG5vZGVFdmVudCA9IHJlcXVpcmUoIm5vZGUtZXZlbnQiKTsKdmFyIG5vZGVBbmltID0gcmVxdWlyZSgibm9kZS1hbmltIik7Ci8vISBDb3B5cmlnaHQgMjAxNSwgbm9kZUA2LjEuMCBNSVQgTGljZW5zZWQsIGJ1aWxkIHRpbWU6IFRodSwgMjkgT2N0IDIwMTUgMTI6MjU6MjIgR01UIAovKgpjb21iaW5lZCBtb2R1bGVzOgpub2RlCiovCnZhciBub2RlSW5kZXg7Cm5vZGVJbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIE5vZGUgPSBub2RlQmFzZTsKICBub2RlRXZlbnQ7CiAgbm9kZUFuaW07CiAgZXhwb3J0cyA9IE5vZGU7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIG5vZGVJbmRleDsKfSk7ZGVmaW5lKCJub2RlLWJhc2UiLCBbJ3V0aWwnLCdkb20nXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7CnZhciBkb21CYXNlID0gcmVxdWlyZSgnZG9tJyk7Ci8vISBDb3B5cmlnaHQgMjAxNSwgbm9kZS1iYXNlQDYuMS4xIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogV2VkLCAxNiBEZWMgMjAxNSAwNzo0MDo1NiBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6Cm5vZGUtYmFzZQpub2RlLWJhc2UvbGliL2Jhc2UKbm9kZS1iYXNlL2xpYi9hdHRhY2gKbm9kZS1iYXNlL2xpYi9vdmVycmlkZQoqLwp2YXIgbm9kZUJhc2VMaWJCYXNlLCBub2RlQmFzZUxpYkF0dGFjaCwgbm9kZUJhc2VMaWJPdmVycmlkZSwgbm9kZUJhc2VJbmRleDsKbm9kZUJhc2VMaWJCYXNlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlCiAgICogZGVmaW5pdGlvbiBmb3Igbm9kZSBhbmQgbm9kZWxpc3QKICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbSwgbGlmZXNpbmdlckBnbWFpbC5jb20KICAgKi8KICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBBUCA9IEFycmF5LnByb3RvdHlwZSwgc2xpY2UgPSBBUC5zbGljZSwgTm9kZVR5cGUgPSBEb20uTm9kZVR5cGUsIHB1c2ggPSBBUC5wdXNoLCBtYWtlQXJyYXkgPSB1dGlsLm1ha2VBcnJheSwgaXNEb21Ob2RlTGlzdCA9IERvbS5pc0RvbU5vZGVMaXN0OwogIC8qKgogICAqIFRoZSBOb2RlIGNsYXNzIHByb3ZpZGVzIGEge0BsaW5rIEtJU1NZLkRPTX0gd3JhcHBlciBmb3IgbWFuaXB1bGF0aW5nIERvbSBOb2RlLgogICAqIHVzZSBLSVNTWS5hbGwvb25lIHRvIHJldHJpZXZlIE5vZGVMaXN0IGluc3RhbmNlcy4KICAgKgogICAqCiAgICogICAgICBAZXhhbXBsZQogICAqICAgICAgS0lTU1kuYWxsKCdhJykuYXR0cignaHJlZicsJ2h0dHA6Ly9kb2NzLmtpc3N5dWkuY29tJyk7CiAgICoKICAgKiBAY2xhc3MgS0lTU1kuTm9kZQogICAqLwogIGZ1bmN0aW9uIE5vZGUoaHRtbCwgYXR0cnMsIG93bmVyRG9jdW1lbnQpIHsKICAgIHZhciBzZWxmID0gdGhpcywgZG9tTm9kZTsKICAgIGlmIChodG1sIGluc3RhbmNlb2YgTm9kZSAmJiBhcmd1bWVudHMubGVuZ3RoID09PSAxKSB7CiAgICAgIHJldHVybiBodG1sLnNsaWNlKCk7CiAgICB9CiAgICBpZiAoIShzZWxmIGluc3RhbmNlb2YgTm9kZSkpIHsKICAgICAgcmV0dXJuIE5vZGUuYWxsLmFwcGx5KE5vZGUsIGFyZ3VtZW50cyk7CiAgICB9CiAgICAvLyBoYW5kbGUgTm9kZSgnJyksIE5vZGUobnVsbCksIG9yIE5vZGUodW5kZWZpbmVkKQogICAgaWYgKCFodG1sKSB7CiAgICAgIHJldHVybiBzZWxmOwogICAgfSBlbHNlIGlmICh0eXBlb2YgaHRtbCA9PT0gJ3N0cmluZycpIHsKICAgICAgLy8gY3JlYXRlIGZyb20gaHRtbAogICAgICBkb21Ob2RlID0gRG9tLmNyZWF0ZShodG1sLCBhdHRycywgb3duZXJEb2N1bWVudCk7CiAgICAgIC8vICgnPHA+MTwvcD48cD4yPC9wPicpIOi9rOaNouS4uiBOb2RlCiAgICAgIGlmIChkb21Ob2RlLm5vZGVUeXBlID09PSBOb2RlVHlwZS5ET0NVTUVOVF9GUkFHTUVOVF9OT0RFKSB7CiAgICAgICAgLy8gZnJhZ21lbnQKICAgICAgICBwdXNoLmFwcGx5KHRoaXMsIG1ha2VBcnJheShkb21Ob2RlLmNoaWxkTm9kZXMpKTsKICAgICAgICByZXR1cm4gc2VsZjsKICAgICAgfQogICAgfSBlbHNlIGlmICh1dGlsLmlzQXJyYXkoaHRtbCkgfHwgaXNEb21Ob2RlTGlzdChodG1sKSkgewogICAgICBwdXNoLmFwcGx5KHNlbGYsIG1ha2VBcnJheShodG1sKSk7CiAgICAgIHJldHVybiBzZWxmOwogICAgfSBlbHNlIHsKICAgICAgLy8gbm9kZSwgZG9jdW1lbnQsIHdpbmRvdwogICAgICBkb21Ob2RlID0gaHRtbDsKICAgIH0KICAgIHNlbGZbMF0gPSBkb21Ob2RlOwogICAgc2VsZi5sZW5ndGggPSAxOwogICAgcmV0dXJuIHNlbGY7CiAgfQogIE5vZGUucHJvdG90eXBlID0gewogICAgY29uc3RydWN0b3I6IE5vZGUsCiAgICBpc05vZGU6IHRydWUsCiAgICAvKioKICAgICAqIGxlbmd0aCBvZiBOb2RlCiAgICAgKiBAdHlwZSB7TnVtYmVyfQogICAgICovCiAgICBsZW5ndGg6IDAsCiAgICAvKioKICAgICAqIEdldCBvbmUgbm9kZSBhdCBpbmRleAogICAgICogQHBhcmFtIHtOdW1iZXJ9IGluZGV4IEluZGV4IHBvc2l0aW9uLgogICAgICogQHJldHVybiB7S0lTU1kuTm9kZX0KICAgICAqLwogICAgaXRlbTogZnVuY3Rpb24gKGluZGV4KSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgaW5kZXggPSBwYXJzZUludChpbmRleCwgMTApOwogICAgICByZXR1cm4gdHlwZW9mIGluZGV4ID09PSAnbnVtYmVyJyAmJiAhaXNOYU4oaW5kZXgpICYmIGluZGV4IDwgc2VsZi5sZW5ndGggPyBuZXcgTm9kZShzZWxmW2luZGV4XSkgOiBudWxsOwogICAgfSwKICAgIC8qKgogICAgICogcmV0dXJuIGEgbmV3IE5vZGUgb2JqZWN0IHdoaWNoIGNvbnNpc3RzIG9mIGN1cnJlbnQgbm9kZSBsaXN0IGFuZCBwYXJhbWV0ZXIgbm9kZSBsaXN0LgogICAgICogQHBhcmFtIHtLSVNTWS5Ob2RlfSBzZWxlY3RvciBTZWxlY3RvciBzdHJpbmcgb3IgaHRtbCBzdHJpbmcgb3IgY29tbW9uIGRvbSBub2RlLgogICAgICogQHBhcmFtIHtLSVNTWS5Ob2RlfE51bWJlcn0gW2NvbnRleHRdIFNlYXJjaCBjb250ZXh0IGZvciBzZWxlY3RvcgogICAgICogQHBhcmFtIHtOdW1iZXJ9IFtpbmRleF0gSW5zZXJ0IHBvc2l0aW9uLgogICAgICogQHJldHVybiB7S0lTU1kuTm9kZX0gYSBuZXcgTm9kZQogICAgICovCiAgICBhZGQ6IGZ1bmN0aW9uIChzZWxlY3RvciwgY29udGV4dCwgaW5kZXgpIHsKICAgICAgaWYgKHR5cGVvZiBjb250ZXh0ID09PSAnbnVtYmVyJykgewogICAgICAgIGluZGV4ID0gY29udGV4dDsKICAgICAgICBjb250ZXh0ID0gdW5kZWZpbmVkOwogICAgICB9CiAgICAgIHZhciBsaXN0ID0gTm9kZS5hbGwoc2VsZWN0b3IsIGNvbnRleHQpLmdldERPTU5vZGVzKCksIHJldCA9IG5ldyBOb2RlKHRoaXMpOwogICAgICBpZiAoaW5kZXggPT09IHVuZGVmaW5lZCkgewogICAgICAgIHB1c2guYXBwbHkocmV0LCBsaXN0KTsKICAgICAgfSBlbHNlIHsKICAgICAgICB2YXIgYXJncyA9IFsKICAgICAgICAgIGluZGV4LAogICAgICAgICAgMAogICAgICAgIF07CiAgICAgICAgYXJncy5wdXNoLmFwcGx5KGFyZ3MsIGxpc3QpOwogICAgICAgIEFQLnNwbGljZS5hcHBseShyZXQsIGFyZ3MpOwogICAgICB9CiAgICAgIHJldHVybiByZXQ7CiAgICB9LAogICAgLyoqCiAgICAgKiBHZXQgcGFydCBvZiBub2RlIGxpc3QuCiAgICAgKiBBcmd1bWVudHMgYXJlIHNhbWUgd2l0aCBBcnJheS5wcm90b3R5cGUuc2xpY2UKICAgICAqIEByZXR1cm4ge0tJU1NZLk5vZGV9CiAgICAgKi8KICAgIHNsaWNlOiBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIGllPDkgOiBbMSwyXS5zbGljZSgwIC0gMix1bmRlZmluZWQpID0+IFtdCiAgICAgIC8vIGllPDkgOiBbMSwyXS5zbGljZSgwIC0gMikgPT4gWzEsMl0KICAgICAgLy8gZml4ICM4NQogICAgICByZXR1cm4gbmV3IE5vZGUoc2xpY2UuYXBwbHkodGhpcywgYXJndW1lbnRzKSk7CiAgICB9LAogICAgLyoqCiAgICAgKiBSZXRyaWV2ZXMgdGhlIERPTU5vZGVzLgogICAgICovCiAgICBnZXRET01Ob2RlczogZnVuY3Rpb24gKCkgewogICAgICByZXR1cm4gc2xpY2UuY2FsbCh0aGlzKTsKICAgIH0sCiAgICAvKioKICAgICAqIEFwcGxpZXMgdGhlIGdpdmVuIGZ1bmN0aW9uIHRvIGVhY2ggTm9kZSBpbiB0aGUgTm9kZS4KICAgICAqIEBwYXJhbSB7RnVuY3Rpb259IGZuIFRoZSBmdW5jdGlvbiB0byBhcHBseS4gSXQgcmVjZWl2ZXMgMyBhcmd1bWVudHM6CiAgICAgKiB0aGUgY3VycmVudCBub2RlIGluc3RhbmNlLCB0aGUgbm9kZSdzIGluZGV4LAogICAgICogYW5kIHRoZSBOb2RlIGluc3RhbmNlCiAgICAgKiBAcGFyYW0gW2NvbnRleHRdIEFuIG9wdGlvbmFsIGNvbnRleHQgdG8KICAgICAqIGFwcGx5IHRoZSBmdW5jdGlvbiB3aXRoIERlZmF1bHQgY29udGV4dCBpcyB0aGUgY3VycmVudCBOb2RlIGluc3RhbmNlCiAgICAgKiBAcmV0dXJuIHtLSVNTWS5Ob2RlfQogICAgICovCiAgICBlYWNoOiBmdW5jdGlvbiAoZm4sIGNvbnRleHQpIHsKICAgICAgdXRpbC5lYWNoKHRoaXMsIGZ1bmN0aW9uIChuLCBpKSB7CiAgICAgICAgLy8gbiA9IG5ldyBOb2RlKG4pOwogICAgICAgIHJldHVybiBmbi5jYWxsKGNvbnRleHQgfHwgbiwgbiwgaSwgdGhpcyk7CiAgICAgIH0sIHRoaXMpOwogICAgICByZXR1cm4gdGhpczsKICAgIH0sCiAgICAvKioKICAgICAqIEV4ZWN1dGVzIHRoZSBzdXBwbGllZCBmdW5jdGlvbiBvbiBlYWNoIGl0ZW0gaW4gdGhlIGFycmF5LgogICAgICogUmV0dXJucyBhIG5ldyBhcnJheSBjb250YWluaW5nIHRoZSBpdGVtcyB0aGF0IHRoZSBzdXBwbGllZAogICAgICogZnVuY3Rpb24gcmV0dXJuZWQgZm9yLgogICAgICogQG1ldGhvZAogICAgICogQHBhcmFtIGZuIHtGdW5jdGlvbn0gdGhlIGZ1bmN0aW9uIHRvIGV4ZWN1dGUgb24gZWFjaCBpdGVtCiAgICAgKiBAcGFyYW0gW2NvbnRleHRdIHtPYmplY3R9IG9wdGlvbmFsIGNvbnRleHQgb2JqZWN0CiAgICAgKiByZWZlcjogaHR0cHM6Ly9kZXZlbG9wZXIubW96aWxsYS5vcmcvZW4vSmF2YVNjcmlwdC9SZWZlcmVuY2UvR2xvYmFsX09iamVjdHMvQXJyYXkvbWFwCiAgICAgKiBAcmV0dXJuIHtLSVNTWS5Ob2RlfSBUaGUgaXRlbXMgb24gd2hpY2ggdGhlIHN1cHBsaWVkIGZ1bmN0aW9uIHJldHVybmVkCiAgICAgKi8KICAgIG1hcDogZnVuY3Rpb24gKGZuLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiB1dGlsLm1hcCh0aGlzLCBmdW5jdGlvbiAobiwgaSkgewogICAgICAgIC8vIG4gPSBuZXcgTm9kZShuKTsKICAgICAgICByZXR1cm4gZm4uY2FsbChjb250ZXh0IHx8IG4sIG4sIGksIHRoaXMpOwogICAgICB9LCB0aGlzKTsKICAgIH0sCiAgICAvKioKICAgICAqIFJldHJpZXZlcyB0aGUgRE9NTm9kZS4KICAgICAqIEByZXR1cm4ge0hUTUxFbGVtZW50fQogICAgICovCiAgICBnZXRET01Ob2RlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiB0aGlzWzBdOwogICAgfSwKICAgIC8qKgogICAgICogcmV0dXJuIGxhc3Qgc3RhY2sgbm9kZSBsaXN0LgogICAgICogQHJldHVybiB7S0lTU1kuTm9kZX0KICAgICAqLwogICAgZW5kOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgcmV0dXJuIHNlbGYuX19wYXJlbnQgfHwgc2VsZjsKICAgIH0sCiAgICAvKioKICAgICAqIHJldHVybiBuZXcgTm9kZSB3aGljaCBjb250YWlucyBvbmx5IG5vZGVzIHdoaWNoIHBhc3NlcyBmaWx0ZXIKICAgICAqIEBwYXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBmaWx0ZXIKICAgICAqIEByZXR1cm4ge0tJU1NZLk5vZGV9CiAgICAgKi8KICAgIGZpbHRlcjogZnVuY3Rpb24gKGZpbHRlcikgewogICAgICByZXR1cm4gbmV3IE5vZGUoRG9tLmZpbHRlcih0aGlzLCAhdXRpbC5pc1N0cmluZyhmaWx0ZXIpID8gZnVuY3Rpb24gKHZhbCwgaWR4LCBhcnIpIHsKICAgICAgICByZXR1cm4gZmlsdGVyLmNhbGwodmFsLCB2YWwsIGlkeCwgYXJyKTsKICAgICAgfSA6IGZpbHRlcikpOwogICAgfSwKICAgIC8qKgogICAgICogR2V0IG5vZGUgbGlzdCB3aGljaCBhcmUgZGVzY2VuZGFudHMgb2YgY3VycmVudCBub2RlIGxpc3QuCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gc2VsZWN0b3IgU2VsZWN0b3Igc3RyaW5nCiAgICAgKiBAcmV0dXJuIHtLSVNTWS5Ob2RlfQogICAgICovCiAgICBhbGw6IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICB2YXIgcmV0LCBzZWxmID0gdGhpczsKICAgICAgaWYgKHNlbGYubGVuZ3RoID4gMCkgewogICAgICAgIHJldCA9IE5vZGUuYWxsKHNlbGVjdG9yLCBzZWxmKTsKICAgICAgfSBlbHNlIHsKICAgICAgICByZXQgPSBuZXcgTm9kZSgpOwogICAgICB9CiAgICAgIHJldC5fX3BhcmVudCA9IHNlbGY7CiAgICAgIHJldHVybiByZXQ7CiAgICB9LAogICAgLyoqCiAgICAgKiBHZXQgbm9kZSBsaXN0IHdoaWNoIG1hdGNoIHNlbGVjdG9yIHVuZGVyIGN1cnJlbnQgbm9kZSBsaXN0IHN1YiB0cmVlLgogICAgICogQHBhcmFtIHtTdHJpbmd9IHNlbGVjdG9yCiAgICAgKiBAcmV0dXJuIHtLSVNTWS5Ob2RlfQogICAgICovCiAgICBvbmU6IGZ1bmN0aW9uIChzZWxlY3RvcikgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGFsbCA9IHNlbGYuYWxsKHNlbGVjdG9yKSwgcmV0ID0gYWxsLmxlbmd0aCA/IGFsbC5zbGljZSgwLCAxKSA6IG51bGw7CiAgICAgIGlmIChyZXQpIHsKICAgICAgICByZXQuX19wYXJlbnQgPSBzZWxmOwogICAgICB9CiAgICAgIHJldHVybiByZXQ7CiAgICB9CiAgfTsKICBOb2RlLnByb3RvdHlwZS5maW5kID0gTm9kZS5wcm90b3R5cGUuYWxsOwogIE5vZGUuZm4gPSBOb2RlLnByb3RvdHlwZTsKICB1dGlsLm1peChOb2RlLCB7CiAgICAvKioKICAgICAqIEdldCBub2RlIGxpc3QgZnJvbSBzZWxlY3RvciBvciBjb25zdHJ1Y3QgbmV3IG5vZGUgbGlzdCBmcm9tIGh0bWwgc3RyaW5nLgogICAgICogQ2FuIGFsc28gY2FsbGVkIGZyb20gS0lTU1kuYWxsCiAgICAgKiBAcGFyYW0ge1N0cmluZ3xLSVNTWS5Ob2RlfSBzZWxlY3RvciBTZWxlY3RvciBzdHJpbmcgb3IgaHRtbCBzdHJpbmcgb3IgY29tbW9uIGRvbSBub2RlLgogICAgICogQHBhcmFtIHtTdHJpbmd8S0lTU1kuTm9kZX0gW2NvbnRleHRdIFNlYXJjaCBjb250ZXh0IGZvciBzZWxlY3RvcgogICAgICogQHJldHVybiB7S0lTU1kuTm9kZX0KICAgICAqIEBtZW1iZXIgS0lTU1kuTm9kZQogICAgICogQHN0YXRpYwogICAgICovCiAgICBhbGw6IGZ1bmN0aW9uIChzZWxlY3RvciwgY29udGV4dCkgewogICAgICAvLyBhcmUgd2UgZGVhbGluZyB3aXRoIGh0bWwgc3RyaW5nID8KICAgICAgLy8gVGV4dE5vZGUg5LuN6ZyA6KaB6Ieq5bexIG5ldyBOb2RlCiAgICAgIGlmICh0eXBlb2Ygc2VsZWN0b3IgPT09ICdzdHJpbmcnICYmIChzZWxlY3RvciA9IHV0aWwudHJpbShzZWxlY3RvcikpICYmIHNlbGVjdG9yLmxlbmd0aCA+PSAzICYmIHV0aWwuc3RhcnRzV2l0aChzZWxlY3RvciwgJzwnKSAmJiB1dGlsLmVuZHNXaXRoKHNlbGVjdG9yLCAnPicpKSB7CiAgICAgICAgdmFyIGF0dHJzOwogICAgICAgIGlmIChjb250ZXh0KSB7CiAgICAgICAgICBpZiAoY29udGV4dC5nZXRET01Ob2RlKSB7CiAgICAgICAgICAgIGNvbnRleHQgPSBjb250ZXh0WzBdOwogICAgICAgICAgfQogICAgICAgICAgaWYgKCFjb250ZXh0Lm5vZGVUeXBlKSB7CiAgICAgICAgICAgIGF0dHJzID0gY29udGV4dDsKICAgICAgICAgICAgY29udGV4dCA9IGFyZ3VtZW50c1syXTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgcmV0dXJuIG5ldyBOb2RlKHNlbGVjdG9yLCBhdHRycywgY29udGV4dCk7CiAgICAgIH0KICAgICAgcmV0dXJuIG5ldyBOb2RlKERvbS5xdWVyeShzZWxlY3RvciwgY29udGV4dCkpOwogICAgfSwKICAgIC8qKgogICAgICogR2V0IG5vZGUgbGlzdCB3aXRoIGxlbmd0aCBvZiBvbmUKICAgICAqIGZyb20gc2VsZWN0b3Igb3IgY29uc3RydWN0IG5ldyBub2RlIGxpc3QgZnJvbSBodG1sIHN0cmluZy4KICAgICAqIEBwYXJhbSB7U3RyaW5nfEtJU1NZLk5vZGV9IHNlbGVjdG9yIFNlbGVjdG9yIHN0cmluZyBvciBodG1sIHN0cmluZyBvciBjb21tb24gZG9tIG5vZGUuCiAgICAgKiBAcGFyYW0ge1N0cmluZ3xLSVNTWS5Ob2RlfSBbY29udGV4dF0gU2VhcmNoIGNvbnRleHQgZm9yIHNlbGVjdG9yCiAgICAgKiBAcmV0dXJuIHtLSVNTWS5Ob2RlfQogICAgICogQG1lbWJlciBLSVNTWS5Ob2RlCiAgICAgKiBAc3RhdGljCiAgICAgKi8KICAgIG9uZTogZnVuY3Rpb24gKHNlbGVjdG9yLCBjb250ZXh0KSB7CiAgICAgIHZhciBhbGwgPSBOb2RlLmFsbChzZWxlY3RvciwgY29udGV4dCk7CiAgICAgIHJldHVybiBhbGwubGVuZ3RoID8gYWxsLnNsaWNlKDAsIDEpIDogbnVsbDsKICAgIH0KICB9KTsKICBOb2RlLkRvbSA9IERvbTsKICAvLyBmb3Iga2lzc3kKICBpZiAoJ3VuZGVmaW5lZCcgIT09IHR5cGVvZiBLSVNTWSkgewogICAgdXRpbC5taXgoS0lTU1ksIHsKICAgICAgYWxsOiBOb2RlLmFsbCwKICAgICAgb25lOiBOb2RlLm9uZQogICAgfSk7CiAgfQogIGV4cG9ydHMgPSBOb2RlOwogIHJldHVybiBleHBvcnRzOwp9KCk7Cm5vZGVCYXNlTGliQXR0YWNoID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBOb2RlID0gbm9kZUJhc2VMaWJCYXNlOwogIHZhciBOTFAgPSBOb2RlLnByb3RvdHlwZSwgbWFrZUFycmF5ID0gdXRpbC5tYWtlQXJyYXksIERPTV9JTkNMVURFU19OT1JNID0gWwogICAgICAnbm9kZU5hbWUnLAogICAgICAnaXNDdXN0b21Eb21haW4nLAogICAgICAnZ2V0RW1wdHlJZnJhbWVTcmMnLAogICAgICAnZXF1YWxzJywKICAgICAgJ2NvbnRhaW5zJywKICAgICAgJ2luZGV4JywKICAgICAgJ3Njcm9sbFRvcCcsCiAgICAgICdzY3JvbGxMZWZ0JywKICAgICAgJ2hlaWdodCcsCiAgICAgICd3aWR0aCcsCiAgICAgICdpbm5lckhlaWdodCcsCiAgICAgICdpbm5lcldpZHRoJywKICAgICAgJ291dGVySGVpZ2h0JywKICAgICAgJ291dGVyV2lkdGgnLAogICAgICAnYWRkU3R5bGVTaGVldCcsCiAgICAgICdhcHBlbmRUbycsCiAgICAgICdwcmVwZW5kVG8nLAogICAgICAnaW5zZXJ0QmVmb3JlJywKICAgICAgJ2JlZm9yZScsCiAgICAgICdhZnRlcicsCiAgICAgICdpbnNlcnRBZnRlcicsCiAgICAgICd0ZXN0JywKICAgICAgJ2hhc0NsYXNzJywKICAgICAgJ2FkZENsYXNzJywKICAgICAgJ3JlbW92ZUNsYXNzJywKICAgICAgJ3JlcGxhY2VDbGFzcycsCiAgICAgICd0b2dnbGVDbGFzcycsCiAgICAgICdyZW1vdmVBdHRyJywKICAgICAgJ2hhc0F0dHInLAogICAgICAnaGFzUHJvcCcsCiAgICAgICdzaG93JywKICAgICAgJ2hpZGUnLAogICAgICAndG9nZ2xlJywKICAgICAgJ3Njcm9sbEludG9WaWV3JywKICAgICAgJ3JlbW92ZScsCiAgICAgICdlbXB0eScsCiAgICAgICdyZW1vdmVEYXRhJywKICAgICAgJ2hhc0RhdGEnLAogICAgICAndW5zZWxlY3RhYmxlJywKICAgICAgJ3dyYXAnLAogICAgICAnd3JhcEFsbCcsCiAgICAgICdyZXBsYWNlV2l0aCcsCiAgICAgICd3cmFwSW5uZXInLAogICAgICAndW53cmFwJwogICAgXSwgRE9NX0lOQ0xVREVTX05PUk1fTk9ERV9MSVNUID0gWwogICAgICAnZ2V0V2luZG93JywKICAgICAgJ2dldERvY3VtZW50JywKICAgICAgJ2ZpcnN0JywKICAgICAgJ2xhc3QnLAogICAgICAncGFyZW50JywKICAgICAgJ2Nsb3Nlc3QnLAogICAgICAnbmV4dCcsCiAgICAgICdwcmV2JywKICAgICAgJ2Nsb25lJywKICAgICAgJ3NpYmxpbmdzJywKICAgICAgJ2NvbnRlbnRzJywKICAgICAgJ2NoaWxkcmVuJwogICAgXSwgRE9NX0lOQ0xVREVTX05PUk1fSUYgPSB7CiAgICAgIGF0dHI6IDEsCiAgICAgIHRleHQ6IDAsCiAgICAgIGNzczogMSwKICAgICAgc3R5bGU6IDEsCiAgICAgIHZhbDogMCwKICAgICAgcHJvcDogMSwKICAgICAgb2Zmc2V0OiAwLAogICAgICBodG1sOiAwLAogICAgICBvdXRlckhUTUw6IDAsCiAgICAgIG91dGVySHRtbDogMCwKICAgICAgZGF0YTogMQogICAgfTsKICBmdW5jdGlvbiBhY2Nlc3NOb3JtKGZuLCBzZWxmLCBhcmdzKSB7CiAgICBhcmdzLnVuc2hpZnQoc2VsZik7CiAgICB2YXIgcmV0ID0gRG9tW2ZuXS5hcHBseShEb20sIGFyZ3MpOwogICAgaWYgKHJldCA9PT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBzZWxmOwogICAgfQogICAgcmV0dXJuIHJldDsKICB9CiAgZnVuY3Rpb24gYWNjZXNzTm9ybUxpc3QoZm4sIHNlbGYsIGFyZ3MpIHsKICAgIGFyZ3MudW5zaGlmdChzZWxmKTsKICAgIHZhciByZXQgPSBEb21bZm5dLmFwcGx5KERvbSwgYXJncyk7CiAgICBpZiAocmV0ID09PSB1bmRlZmluZWQpIHsKICAgICAgcmV0dXJuIHNlbGY7CiAgICB9IGVsc2UgaWYgKHJldCA9PT0gbnVsbCkgewogICAgICByZXR1cm4gbnVsbDsKICAgIH0KICAgIHJldHVybiBuZXcgTm9kZShyZXQpOwogIH0KICBmdW5jdGlvbiBhY2Nlc3NOb3JtSWYoZm4sIHNlbGYsIGluZGV4LCBhcmdzKSB7CiAgICBpZiAoYXJnc1tpbmRleF0gPT09IHVuZGVmaW5lZCAmJiAhdXRpbC5pc09iamVjdChhcmdzWzBdKSkgewogICAgICBhcmdzLnVuc2hpZnQoc2VsZik7CiAgICAgIHJldHVybiBEb21bZm5dLmFwcGx5KERvbSwgYXJncyk7CiAgICB9CiAgICByZXR1cm4gYWNjZXNzTm9ybShmbiwgc2VsZiwgYXJncyk7CiAgfQogIHV0aWwuZWFjaChET01fSU5DTFVERVNfTk9STSwgZnVuY3Rpb24gKGspIHsKICAgIE5MUFtrXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGFyZ3MgPSBtYWtlQXJyYXkoYXJndW1lbnRzKTsKICAgICAgcmV0dXJuIGFjY2Vzc05vcm0oaywgdGhpcywgYXJncyk7CiAgICB9OwogIH0pOwogIHV0aWwuZWFjaChET01fSU5DTFVERVNfTk9STV9OT0RFX0xJU1QsIGZ1bmN0aW9uIChrKSB7CiAgICBOTFBba10gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBhcmdzID0gbWFrZUFycmF5KGFyZ3VtZW50cyk7CiAgICAgIHJldHVybiBhY2Nlc3NOb3JtTGlzdChrLCB0aGlzLCBhcmdzKTsKICAgIH07CiAgfSk7CiAgdXRpbC5lYWNoKERPTV9JTkNMVURFU19OT1JNX0lGLCBmdW5jdGlvbiAoaW5kZXgsIGspIHsKICAgIE5MUFtrXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIGFyZ3MgPSBtYWtlQXJyYXkoYXJndW1lbnRzKTsKICAgICAgcmV0dXJuIGFjY2Vzc05vcm1JZihrLCB0aGlzLCBpbmRleCwgYXJncyk7CiAgICB9OwogIH0pOwogIHJldHVybiBleHBvcnRzOwp9KCk7Cm5vZGVCYXNlTGliT3ZlcnJpZGUgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIERvbSA9IGRvbUJhc2U7CiAgdmFyIE5vZGUgPSBub2RlQmFzZUxpYkJhc2U7CiAgbm9kZUJhc2VMaWJBdHRhY2g7CiAgdmFyIE5MUCA9IE5vZGUucHJvdG90eXBlOwogIHV0aWwuZWFjaChbCiAgICAnYXBwZW5kJywKICAgICdwcmVwZW5kJywKICAgICdiZWZvcmUnLAogICAgJ2FmdGVyJwogIF0sIGZ1bmN0aW9uIChpbnNlcnRUeXBlKSB7CiAgICBOTFBbaW5zZXJ0VHlwZV0gPSBmdW5jdGlvbiAoaHRtbCkgewogICAgICB2YXIgbmV3Tm9kZSA9IGh0bWwsIHNlbGYgPSB0aGlzOwogICAgICBpZiAodHlwZW9mIG5ld05vZGUgIT09ICdvYmplY3QnKSB7CiAgICAgICAgbmV3Tm9kZSA9IERvbS5jcmVhdGUobmV3Tm9kZSArICcnKTsKICAgICAgfQogICAgICBpZiAobmV3Tm9kZSkgewogICAgICAgIERvbVtpbnNlcnRUeXBlXShuZXdOb2RlLCBzZWxmKTsKICAgICAgfQogICAgICByZXR1cm4gc2VsZjsKICAgIH07CiAgfSk7CiAgdXRpbC5lYWNoKFsKICAgICd3cmFwJywKICAgICd3cmFwQWxsJywKICAgICdyZXBsYWNlV2l0aCcsCiAgICAnd3JhcElubmVyJwogIF0sIGZ1bmN0aW9uIChmaXhUeXBlKSB7CiAgICB2YXIgb3JpZyA9IE5MUFtmaXhUeXBlXTsKICAgIE5MUFtmaXhUeXBlXSA9IGZ1bmN0aW9uIChvdGhlcnMpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAodHlwZW9mIG90aGVycyA9PT0gJ3N0cmluZycpIHsKICAgICAgICBvdGhlcnMgPSBOb2RlLmFsbChvdGhlcnMsIHNlbGZbMF0ub3duZXJEb2N1bWVudCk7CiAgICAgIH0KICAgICAgcmV0dXJuIG9yaWcuY2FsbChzZWxmLCBvdGhlcnMpOwogICAgfTsKICB9KTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpub2RlQmFzZUluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgTm9kZSA9IG5vZGVCYXNlTGliQmFzZTsKICBub2RlQmFzZUxpYkF0dGFjaDsKICBub2RlQmFzZUxpYk92ZXJyaWRlOwogIGV4cG9ydHMgPSBOb2RlOwogIHJldHVybiBleHBvcnRzOwp9KCk7CnJldHVybiBub2RlQmFzZUluZGV4Owp9KTtkZWZpbmUoIm5vZGUtZXZlbnQiLCBbIm5vZGUtYmFzZSIsJ3V0aWwnLCdldmVudC1kb20nXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgbm9kZUJhc2UgPSByZXF1aXJlKCJub2RlLWJhc2UiKTsKdmFyIHV0aWxCYXNlID0gcmVxdWlyZSgndXRpbCcpOwp2YXIgZXZlbnREb21CYXNlID0gcmVxdWlyZSgnZXZlbnQtZG9tJyk7Ci8vISBDb3B5cmlnaHQgMjAxNSwgbm9kZS1ldmVudEA2LjEuMiBNSVQgTGljZW5zZWQsIGJ1aWxkIHRpbWU6IFRodSwgMjkgT2N0IDIwMTUgMTI6Mjc6NTUgR01UIAovKgpjb21iaW5lZCBtb2R1bGVzOgpub2RlLWV2ZW50Cm5vZGUtZXZlbnQvbGliL2F0dGFjaAoqLwp2YXIgbm9kZUV2ZW50TGliQXR0YWNoLCBub2RlRXZlbnRJbmRleDsKbm9kZUV2ZW50TGliQXR0YWNoID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlCiAgICogaW1wb3J0IG1ldGhvZHMgZnJvbSBFdmVudCB0byBOb2RlLnByb3RvdHlwZQogICAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tCiAgICovCiAgdmFyIE5vZGVCYXNlID0gbm9kZUJhc2U7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUJhc2U7CiAgdmFyIE5MUCA9IE5vZGVCYXNlLnByb3RvdHlwZSwgbWFrZUFycmF5ID0gdXRpbC5tYWtlQXJyYXksCiAgICAvLyBFdmVudCDmt7vliqDliLAgTlAg5LiK55qE5pa55rOVCiAgICBFVkVOVF9JTkNMVURFU19TRUxGID0gWwogICAgICAnb24nLAogICAgICAnZGV0YWNoJywKICAgICAgJ2RlbGVnYXRlJywKICAgICAgJ3VuZGVsZWdhdGUnLAogICAgICAvLyBraW1pCiAgICAgICdvZmYnCiAgICBdLCBFVkVOVF9JTkNMVURFU19SRVQgPSBbCiAgICAgICdmaXJlJywKICAgICAgJ2ZpcmVIYW5kbGVyJywKICAgICAgLy8ga2ltaQogICAgICAndHJpZ2dlcicsCiAgICAgICd0cmlnZ2VySGFuZGxlcicKICAgIF07CiAgTm9kZUJhc2UuS2V5Q29kZSA9IERvbUV2ZW50LktleUNvZGU7CiAgTm9kZUJhc2UuRXZlbnQgPSBEb21FdmVudDsKICB1dGlsLmVhY2goRVZFTlRfSU5DTFVERVNfU0VMRiwgZnVuY3Rpb24gKGspIHsKICAgIE5MUFtrXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gbWFrZUFycmF5KGFyZ3VtZW50cyk7CiAgICAgIGFyZ3MudW5zaGlmdChzZWxmKTsKICAgICAgRG9tRXZlbnRba10uYXBwbHkoRG9tRXZlbnQsIGFyZ3MpOwogICAgICByZXR1cm4gc2VsZjsKICAgIH07CiAgfSk7CiAgdXRpbC5lYWNoKEVWRU5UX0lOQ0xVREVTX1JFVCwgZnVuY3Rpb24gKGspIHsKICAgIE5MUFtrXSA9IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBhcmdzID0gbWFrZUFycmF5KGFyZ3VtZW50cyk7CiAgICAgIGFyZ3MudW5zaGlmdChzZWxmKTsKICAgICAgcmV0dXJuIERvbUV2ZW50W2tdLmFwcGx5KERvbUV2ZW50LCBhcmdzKTsKICAgIH07CiAgfSk7CiAgZXhwb3J0cyA9IE5vZGVCYXNlOwogIHJldHVybiBleHBvcnRzOwp9KCk7Cm5vZGVFdmVudEluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICBleHBvcnRzID0gbm9kZUV2ZW50TGliQXR0YWNoOwogIHJldHVybiBleHBvcnRzOwp9KCk7CnJldHVybiBub2RlRXZlbnRJbmRleDsKfSk7ZGVmaW5lKCJldmVudC1kb20tYmFzZSIsIFsnZG9tJywiZXZlbnQtYmFzZSIsJ3V0aWwnXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgZG9tQmFzZSA9IHJlcXVpcmUoJ2RvbScpOwp2YXIgZXZlbnRCYXNlID0gcmVxdWlyZSgiZXZlbnQtYmFzZSIpOwp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7Ci8vISBDb3B5cmlnaHQgMjAxNSwgZXZlbnQtZG9tLWJhc2VANi4xLjEgTUlUIExpY2Vuc2VkLCBidWlsZCB0aW1lOiBUaHUsIDI5IE9jdCAyMDE1IDA4OjE2OjM2IEdNVCAKLyoKY29tYmluZWQgbW9kdWxlczoKZXZlbnQtZG9tLWJhc2UKZXZlbnQtZG9tLWJhc2UvbGliL21haW4KZXZlbnQtZG9tLWJhc2UvbGliL21haW4vZG9tLWV2ZW50CmV2ZW50LWRvbS1iYXNlL2xpYi9tYWluL3V0aWxzCmV2ZW50LWRvbS1iYXNlL2xpYi9tYWluL3NwZWNpYWwKZXZlbnQtZG9tLWJhc2UvbGliL21haW4vb2JzZXJ2YWJsZQpldmVudC1kb20tYmFzZS9saWIvbWFpbi9vYnNlcnZlcgpldmVudC1kb20tYmFzZS9saWIvbWFpbi9vYmplY3QKZXZlbnQtZG9tLWJhc2UvbGliL21haW4vc3BlY2lhbC1ldmVudHMKKi8KdmFyIGV2ZW50RG9tQmFzZUxpYk1haW5VdGlscywgZXZlbnREb21CYXNlTGliTWFpblNwZWNpYWwsIGV2ZW50RG9tQmFzZUxpYk1haW5PYnNlcnZlciwgZXZlbnREb21CYXNlTGliTWFpbk9iamVjdCwgZXZlbnREb21CYXNlTGliTWFpbk9ic2VydmFibGUsIGV2ZW50RG9tQmFzZUxpYk1haW5Eb21FdmVudCwgZXZlbnREb21CYXNlTGliTWFpblNwZWNpYWxFdmVudHMsIGV2ZW50RG9tQmFzZUxpYk1haW4sIGV2ZW50RG9tQmFzZUluZGV4OwpldmVudERvbUJhc2VMaWJNYWluVXRpbHMgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKgogICAqIEBpZ25vcmUKICAgKiB1dGlscyBmb3IgZXZlbnQKICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbQogICAqLwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBFVkVOVF9HVUlEID0gJ2tzRXZlbnRUYXJnZXRJZF8nICsgK25ldyBEYXRlKCksIGRvYyA9IGRvY3VtZW50LCBzaW1wbGVBZGQgPSBkb2MgJiYgZG9jLmFkZEV2ZW50TGlzdGVuZXIgPyBmdW5jdGlvbiAoZWwsIHR5cGUsIGZuLCBjYXB0dXJlKSB7CiAgICAgIGlmIChlbC5hZGRFdmVudExpc3RlbmVyKSB7CiAgICAgICAgZWwuYWRkRXZlbnRMaXN0ZW5lcih0eXBlLCBmbiwgISFjYXB0dXJlKTsKICAgICAgfQogICAgfSA6IGZ1bmN0aW9uIChlbCwgdHlwZSwgZm4pIHsKICAgICAgaWYgKGVsLmF0dGFjaEV2ZW50KSB7CiAgICAgICAgZWwuYXR0YWNoRXZlbnQoJ29uJyArIHR5cGUsIGZuKTsKICAgICAgfQogICAgfSwgc2ltcGxlUmVtb3ZlID0gZG9jICYmIGRvYy5yZW1vdmVFdmVudExpc3RlbmVyID8gZnVuY3Rpb24gKGVsLCB0eXBlLCBmbiwgY2FwdHVyZSkgewogICAgICBpZiAoZWwucmVtb3ZlRXZlbnRMaXN0ZW5lcikgewogICAgICAgIGVsLnJlbW92ZUV2ZW50TGlzdGVuZXIodHlwZSwgZm4sICEhY2FwdHVyZSk7CiAgICAgIH0KICAgIH0gOiBmdW5jdGlvbiAoZWwsIHR5cGUsIGZuKSB7CiAgICAgIGlmIChlbC5kZXRhY2hFdmVudCkgewogICAgICAgIGVsLmRldGFjaEV2ZW50KCdvbicgKyB0eXBlLCBmbik7CiAgICAgIH0KICAgIH07CiAgZXhwb3J0cyA9IHsKICAgIHNpbXBsZUFkZDogc2ltcGxlQWRkLAogICAgc2ltcGxlUmVtb3ZlOiBzaW1wbGVSZW1vdmUsCiAgICBkYXRhOiBmdW5jdGlvbiAoZWxlbSwgdikgewogICAgICByZXR1cm4gRG9tLmRhdGEoZWxlbSwgRVZFTlRfR1VJRCwgdik7CiAgICB9LAogICAgcmVtb3ZlRGF0YTogZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgcmV0dXJuIERvbS5yZW1vdmVEYXRhKGVsZW0sIEVWRU5UX0dVSUQpOwogICAgfQogIH07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnREb21CYXNlTGliTWFpblNwZWNpYWwgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKgogICAqIEBpZ25vcmUKICAgKiBzcGVjaWFsIGhvdXNlIGZvciBzcGVjaWFsIGV2ZW50cwogICAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tCiAgICovCiAgZXhwb3J0cyA9IHt9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50RG9tQmFzZUxpYk1haW5PYnNlcnZlciA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgLyoqCiAgICogQGlnbm9yZQogICAqIG9ic2VydmVyIGZvciBkb20gZXZlbnQuCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgQmFzZUV2ZW50ID0gZXZlbnRCYXNlOwogIHZhciBTcGVjaWFsID0gZXZlbnREb21CYXNlTGliTWFpblNwZWNpYWw7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICAvKioKICAgKiBvYnNlcnZlciBmb3IgZG9tIGV2ZW50CiAgICogQGNsYXNzIEV2ZW50LkRvbUV2ZW50Lk9ic2VydmVyCiAgICogQGV4dGVuZHMgRXZlbnQuT2JzZXJ2ZXIKICAgKiBAcHJpdmF0ZQogICAqLwogIGZ1bmN0aW9uIERvbUV2ZW50T2JzZXJ2ZXIoY2ZnKSB7CiAgICBEb21FdmVudE9ic2VydmVyLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbCh0aGlzLCBjZmcpOwogIH0KICB1dGlsLmV4dGVuZChEb21FdmVudE9ic2VydmVyLCBCYXNlRXZlbnQuT2JzZXJ2ZXIsIHsKICAgIGtleXM6IFsKICAgICAgJ2ZuJywKICAgICAgJ2ZpbHRlcicsCiAgICAgICdkYXRhJywKICAgICAgJ2NvbnRleHQnLAogICAgICAnb3JpZ2luYWxUeXBlJywKICAgICAgJ2dyb3VwcycsCiAgICAgICdsYXN0JwogICAgXSwKICAgIG5vdGlmeUludGVybmFsOiBmdW5jdGlvbiAoZXZlbnQsIGNlKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgcywgdCwgcmV0LCB0eXBlID0gZXZlbnQudHlwZSwgb3JpZ2luYWxUeXBlOwogICAgICBpZiAob3JpZ2luYWxUeXBlID0gc2VsZi5jb25maWcub3JpZ2luYWxUeXBlKSB7CiAgICAgICAgZXZlbnQudHlwZSA9IG9yaWdpbmFsVHlwZTsKICAgICAgfSBlbHNlIHsKICAgICAgICBvcmlnaW5hbFR5cGUgPSB0eXBlOwogICAgICB9CiAgICAgIC8vIGNvbnRleHQgdW5kZWZpbmVkIOaXtuS4jeiDveWGmeatu+WcqCBsaXN0ZW5lciDkuK3vvIzlkKbliJnkuI3og73kv53or4EgY2xvbmUg5pe255qEIHRoaXMKICAgICAgaWYgKChzID0gU3BlY2lhbFtvcmlnaW5hbFR5cGVdKSAmJiBzLmhhbmRsZSkgewogICAgICAgIHQgPSBzLmhhbmRsZShldmVudCwgc2VsZiwgY2UpOwogICAgICAgIC8vIGNhbiBoYW5kbGUKICAgICAgICBpZiAodCAmJiB0Lmxlbmd0aCA+IDApIHsKICAgICAgICAgIHJldCA9IHRbMF07CiAgICAgICAgfQogICAgICB9IGVsc2UgewogICAgICAgIHJldCA9IHNlbGYuc2ltcGxlTm90aWZ5KGV2ZW50LCBjZSk7CiAgICAgIH0KICAgICAgaWYgKHJldCA9PT0gZmFsc2UpIHsKICAgICAgICBldmVudC5oYWx0KCk7CiAgICAgIH0KICAgICAgLy8gbm90aWZ5IG90aGVyIG1vdXNlbW92ZSBsaXN0ZW5lcgogICAgICBldmVudC50eXBlID0gdHlwZTsKICAgICAgcmV0dXJuIHJldDsKICAgIH0KICB9KTsKICBleHBvcnRzID0gRG9tRXZlbnRPYnNlcnZlcjsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpldmVudERvbUJhc2VMaWJNYWluT2JqZWN0ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlCiAgICogZXZlbnQgb2JqZWN0IGZvciBkb20KICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbQogICAqLwogIHZhciBCYXNlRXZlbnQgPSBldmVudEJhc2U7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRE9DVU1FTlQgPSBkb2N1bWVudCwgVFJVRSA9IHRydWUsIEZBTFNFID0gZmFsc2UsIGNvbW1vblByb3BzID0gWwogICAgICAnYWx0S2V5JywKICAgICAgJ2J1YmJsZXMnLAogICAgICAnY2FuY2VsYWJsZScsCiAgICAgICdjdHJsS2V5JywKICAgICAgJ2N1cnJlbnRUYXJnZXQnLAogICAgICAnZXZlbnRQaGFzZScsCiAgICAgICdtZXRhS2V5JywKICAgICAgJ3NoaWZ0S2V5JywKICAgICAgJ3RhcmdldCcsCiAgICAgICd0aW1lU3RhbXAnLAogICAgICAndmlldycsCiAgICAgICd0eXBlJwogICAgXSwgZXZlbnROb3JtYWxpemVycyA9IFsKICAgICAgewogICAgICAgIHJlZzogL15rZXkvLAogICAgICAgIHByb3BzOiBbCiAgICAgICAgICAnY2hhcicsCiAgICAgICAgICAnY2hhckNvZGUnLAogICAgICAgICAgJ2tleScsCiAgICAgICAgICAna2V5Q29kZScsCiAgICAgICAgICAnd2hpY2gnCiAgICAgICAgXSwKICAgICAgICBmaXg6IGZ1bmN0aW9uIChldmVudCwgb3JpZ2luYWxFdmVudCkgewogICAgICAgICAgaWYgKGV2ZW50LndoaWNoID09IG51bGwpIHsKICAgICAgICAgICAgZXZlbnQud2hpY2ggPSBvcmlnaW5hbEV2ZW50LmNoYXJDb2RlICE9IG51bGwgPyBvcmlnaW5hbEV2ZW50LmNoYXJDb2RlIDogb3JpZ2luYWxFdmVudC5rZXlDb2RlOwogICAgICAgICAgfQogICAgICAgICAgLy8gYWRkIG1ldGFLZXkgdG8gbm9uLU1hYyBicm93c2VycyAodXNlIGN0cmwgZm9yIFBDICdzIGFuZCBNZXRhIGZvciBNYWNzKQogICAgICAgICAgaWYgKGV2ZW50Lm1ldGFLZXkgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICBldmVudC5tZXRhS2V5ID0gZXZlbnQuY3RybEtleTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sCiAgICAgIHsKICAgICAgICByZWc6IC9edG91Y2gvLAogICAgICAgIHByb3BzOiBbCiAgICAgICAgICAndG91Y2hlcycsCiAgICAgICAgICAnY2hhbmdlZFRvdWNoZXMnLAogICAgICAgICAgJ3RhcmdldFRvdWNoZXMnCiAgICAgICAgXQogICAgICB9LAogICAgICB7CiAgICAgICAgcmVnOiAvXmhhc2hjaGFuZ2UkLywKICAgICAgICBwcm9wczogWwogICAgICAgICAgJ25ld1VSTCcsCiAgICAgICAgICAnb2xkVVJMJwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgIHJlZzogL15nZXN0dXJlY2hhbmdlJC9pLAogICAgICAgIHByb3BzOiBbCiAgICAgICAgICAncm90YXRpb24nLAogICAgICAgICAgJ3NjYWxlJwogICAgICAgIF0KICAgICAgfSwKICAgICAgewogICAgICAgIHJlZzogL14obW91c2V3aGVlbHxET01Nb3VzZVNjcm9sbCkkLywKICAgICAgICBwcm9wczogW10sCiAgICAgICAgZml4OiBmdW5jdGlvbiAoZXZlbnQsIG9yaWdpbmFsRXZlbnQpIHsKICAgICAgICAgIHZhciBkZWx0YVgsIGRlbHRhWSwgZGVsdGEsIHdoZWVsRGVsdGEgPSBvcmlnaW5hbEV2ZW50LndoZWVsRGVsdGEsIGF4aXMgPSBvcmlnaW5hbEV2ZW50LmF4aXMsIHdoZWVsRGVsdGFZID0gb3JpZ2luYWxFdmVudC53aGVlbERlbHRhWSwgd2hlZWxEZWx0YVggPSBvcmlnaW5hbEV2ZW50LndoZWVsRGVsdGFYLCBkZXRhaWwgPSBvcmlnaW5hbEV2ZW50LmRldGFpbDsKICAgICAgICAgIC8vIGllL3dlYmtpdAogICAgICAgICAgaWYgKHdoZWVsRGVsdGEpIHsKICAgICAgICAgICAgZGVsdGEgPSB3aGVlbERlbHRhIC8gMTIwOwogICAgICAgICAgfQogICAgICAgICAgLy8gZ2Vja28KICAgICAgICAgIGlmIChkZXRhaWwpIHsKICAgICAgICAgICAgLy8gcHJlc3MgY29udHJvbCBlLmRldGFpbCA9PSAxIGVsc2UgZS5kZXRhaWwgPT0gMwogICAgICAgICAgICBkZWx0YSA9IDAgLSAoZGV0YWlsICUgMyA9PT0gMCA/IGRldGFpbCAvIDMgOiBkZXRhaWwpOwogICAgICAgICAgfQogICAgICAgICAgLy8gR2Vja28KICAgICAgICAgIGlmIChheGlzICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgaWYgKGF4aXMgPT09IGV2ZW50LkhPUklaT05UQUxfQVhJUykgewogICAgICAgICAgICAgIGRlbHRhWSA9IDA7CiAgICAgICAgICAgICAgZGVsdGFYID0gMCAtIGRlbHRhOwogICAgICAgICAgICB9IGVsc2UgaWYgKGF4aXMgPT09IGV2ZW50LlZFUlRJQ0FMX0FYSVMpIHsKICAgICAgICAgICAgICBkZWx0YVggPSAwOwogICAgICAgICAgICAgIGRlbHRhWSA9IGRlbHRhOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICAvLyBXZWJraXQKICAgICAgICAgIGlmICh3aGVlbERlbHRhWSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGRlbHRhWSA9IHdoZWVsRGVsdGFZIC8gMTIwOwogICAgICAgICAgfQogICAgICAgICAgaWYgKHdoZWVsRGVsdGFYICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgZGVsdGFYID0gLTEgKiB3aGVlbERlbHRhWCAvIDEyMDsKICAgICAgICAgIH0KICAgICAgICAgIC8vIOm7mOiupCBkZWx0YVkgKGllKQogICAgICAgICAgaWYgKCFkZWx0YVggJiYgIWRlbHRhWSkgewogICAgICAgICAgICBkZWx0YVkgPSBkZWx0YTsKICAgICAgICAgIH0KICAgICAgICAgIGlmIChkZWx0YVggIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogZGVsdGFYIG9mIG1vdXNld2hlZWwgZXZlbnQKICAgICAgICAgICAgICogQHByb3BlcnR5IGRlbHRhWAogICAgICAgICAgICAgKiBAbWVtYmVyIEV2ZW50LkRvbUV2ZW50Lk9iamVjdAogICAgICAgICAgICAgKi8KICAgICAgICAgICAgZXZlbnQuZGVsdGFYID0gZGVsdGFYOwogICAgICAgICAgfQogICAgICAgICAgaWYgKGRlbHRhWSAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIC8qKgogICAgICAgICAgICAgKiBkZWx0YVkgb2YgbW91c2V3aGVlbCBldmVudAogICAgICAgICAgICAgKiBAcHJvcGVydHkgZGVsdGFZCiAgICAgICAgICAgICAqIEBtZW1iZXIgRXZlbnQuRG9tRXZlbnQuT2JqZWN0CiAgICAgICAgICAgICAqLwogICAgICAgICAgICBldmVudC5kZWx0YVkgPSBkZWx0YVk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZGVsdGEgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAvKioKICAgICAgICAgICAgICogZGVsdGEgb2YgbW91c2V3aGVlbCBldmVudAogICAgICAgICAgICAgKiBAcHJvcGVydHkgZGVsdGEKICAgICAgICAgICAgICogQG1lbWJlciBFdmVudC5Eb21FdmVudC5PYmplY3QKICAgICAgICAgICAgICovCiAgICAgICAgICAgIGV2ZW50LmRlbHRhID0gZGVsdGE7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LAogICAgICB7CiAgICAgICAgcmVnOiAvXm1vdXNlfGNvbnRleHRtZW51fGNsaWNrfG1zcG9pbnRlcnwoXkRPTU1vdXNlU2Nyb2xsJCkvaSwKICAgICAgICBwcm9wczogWwogICAgICAgICAgJ2J1dHRvbnMnLAogICAgICAgICAgJ2NsaWVudFgnLAogICAgICAgICAgJ2NsaWVudFknLAogICAgICAgICAgJ2J1dHRvbicsCiAgICAgICAgICAnb2Zmc2V0WCcsCiAgICAgICAgICAncmVsYXRlZFRhcmdldCcsCiAgICAgICAgICAnd2hpY2gnLAogICAgICAgICAgJ2Zyb21FbGVtZW50JywKICAgICAgICAgICd0b0VsZW1lbnQnLAogICAgICAgICAgJ29mZnNldFknLAogICAgICAgICAgJ3BhZ2VYJywKICAgICAgICAgICdwYWdlWScsCiAgICAgICAgICAnc2NyZWVuWCcsCiAgICAgICAgICAnc2NyZWVuWScKICAgICAgICBdLAogICAgICAgIGZpeDogZnVuY3Rpb24gKGV2ZW50LCBvcmlnaW5hbEV2ZW50KSB7CiAgICAgICAgICB2YXIgZXZlbnREb2MsIGRvYywgYm9keSwgdGFyZ2V0ID0gZXZlbnQudGFyZ2V0LCBidXR0b24gPSBvcmlnaW5hbEV2ZW50LmJ1dHRvbjsKICAgICAgICAgIC8vIENhbGN1bGF0ZSBwYWdlWC9ZIGlmIG1pc3NpbmcgYW5kIGNsaWVudFgvWSBhdmFpbGFibGUKICAgICAgICAgIGlmICh0YXJnZXQgJiYgZXZlbnQucGFnZVggPT0gbnVsbCAmJiBvcmlnaW5hbEV2ZW50LmNsaWVudFggIT0gbnVsbCkgewogICAgICAgICAgICBldmVudERvYyA9IHRhcmdldC5vd25lckRvY3VtZW50IHx8IERPQ1VNRU5UOwogICAgICAgICAgICBkb2MgPSBldmVudERvYy5kb2N1bWVudEVsZW1lbnQ7CiAgICAgICAgICAgIGJvZHkgPSBldmVudERvYy5ib2R5OwogICAgICAgICAgICBldmVudC5wYWdlWCA9IG9yaWdpbmFsRXZlbnQuY2xpZW50WCArIChkb2MgJiYgZG9jLnNjcm9sbExlZnQgfHwgYm9keSAmJiBib2R5LnNjcm9sbExlZnQgfHwgMCkgLSAoZG9jICYmIGRvYy5jbGllbnRMZWZ0IHx8IGJvZHkgJiYgYm9keS5jbGllbnRMZWZ0IHx8IDApOwogICAgICAgICAgICBldmVudC5wYWdlWSA9IG9yaWdpbmFsRXZlbnQuY2xpZW50WSArIChkb2MgJiYgZG9jLnNjcm9sbFRvcCB8fCBib2R5ICYmIGJvZHkuc2Nyb2xsVG9wIHx8IDApIC0gKGRvYyAmJiBkb2MuY2xpZW50VG9wIHx8IGJvZHkgJiYgYm9keS5jbGllbnRUb3AgfHwgMCk7CiAgICAgICAgICB9CiAgICAgICAgICAvLyB3aGljaCBmb3IgY2xpY2s6IDEgPT09IGxlZnQ7IDIgPT09IG1pZGRsZTsgMyA9PT0gcmlnaHQKICAgICAgICAgIC8vIGRvIG5vdCB1c2UgYnV0dG9uCiAgICAgICAgICBpZiAoIWV2ZW50LndoaWNoICYmIGJ1dHRvbiAhPT0gdW5kZWZpbmVkKSB7CiAgICAgICAgICAgIGV2ZW50LndoaWNoID0gYnV0dG9uICYgMSA/IDEgOiBidXR0b24gJiAyID8gMyA6IGJ1dHRvbiAmIDQgPyAyIDogMDsKICAgICAgICAgIH0KICAgICAgICAgIC8vIGFkZCByZWxhdGVkVGFyZ2V0LCBpZiBuZWNlc3NhcnkKICAgICAgICAgIGlmICghZXZlbnQucmVsYXRlZFRhcmdldCAmJiBldmVudC5mcm9tRWxlbWVudCkgewogICAgICAgICAgICBldmVudC5yZWxhdGVkVGFyZ2V0ID0gZXZlbnQuZnJvbUVsZW1lbnQgPT09IHRhcmdldCA/IGV2ZW50LnRvRWxlbWVudCA6IGV2ZW50LmZyb21FbGVtZW50OwogICAgICAgICAgfQogICAgICAgICAgcmV0dXJuIGV2ZW50OwogICAgICAgIH0KICAgICAgfQogICAgXTsKICBmdW5jdGlvbiByZXRUcnVlKCkgewogICAgcmV0dXJuIFRSVUU7CiAgfQogIGZ1bmN0aW9uIHJldEZhbHNlKCkgewogICAgcmV0dXJuIEZBTFNFOwogIH0KICAvKioKICAgKiBEbyBub3QgbmV3IGJ5IHlvdXJzZWxmLgogICAqCiAgICogS0lTU1kgJ3MgZG9tIGV2ZW50IHN5c3RlbSBub3JtYWxpemVzIHRoZSBldmVudCBvYmplY3QgYWNjb3JkaW5nIHRvCiAgICogVzNDIHN0YW5kYXJkcy4KICAgKgogICAqIFRoZSBldmVudCBvYmplY3QgaXMgZ3VhcmFudGVlZCB0byBiZSBwYXNzZWQgdG8KICAgKiB0aGUgZXZlbnQgaGFuZGxlci4KICAgKgogICAqIE1vc3QgcHJvcGVydGllcyBmcm9tIHRoZSBvcmlnaW5hbCBldmVudCBhcmUKICAgKiBjb3BpZWQgb3ZlciBhbmQgbm9ybWFsaXplZCB0byB0aGUgbmV3IGV2ZW50IG9iamVjdAogICAqIGFjY29yZGluZyB0byBbVzNDIHN0YW5kYXJkc10oaHR0cDovL3d3dy53My5vcmcvVFIvZG9tLyNldmVudCkuCiAgICoKICAgKiBAY2xhc3MgRXZlbnQuRG9tRXZlbnQuT2JqZWN0CiAgICogQGV4dGVuZHMgRXZlbnQuT2JqZWN0CiAgICogQHByaXZhdGUKICAgKiBAcGFyYW0gb3JpZ2luYWxFdmVudCBuYXRpdmUgZG9tIGV2ZW50CiAgICovCiAgZnVuY3Rpb24gRG9tRXZlbnRPYmplY3Qob3JpZ2luYWxFdmVudCkgewogICAgdmFyIHNlbGYgPSB0aGlzLCB0eXBlID0gb3JpZ2luYWxFdmVudC50eXBlOwogICAgdmFyIGlzTmF0aXZlID0gdHlwZW9mIG9yaWdpbmFsRXZlbnQuc3RvcFByb3BhZ2F0aW9uID09PSAnZnVuY3Rpb24nIHx8IHR5cGVvZiBvcmlnaW5hbEV2ZW50LmNhbmNlbEJ1YmJsZSA9PT0gJ2Jvb2xlYW4nOwogICAgLyoqCiAgICAgKiBhbHRLZXkKICAgICAqIEBwcm9wZXJ0eSBhbHRLZXkKICAgICAqLwogICAgLyoqCiAgICAgKiBhdHRyQ2hhbmdlCiAgICAgKiBAcHJvcGVydHkgYXR0ckNoYW5nZQogICAgICovCiAgICAvKioKICAgICAqIGF0dHJOYW1lCiAgICAgKiBAcHJvcGVydHkgYXR0ck5hbWUKICAgICAqLwogICAgLyoqCiAgICAgKiBidWJibGVzCiAgICAgKiBAcHJvcGVydHkgYnViYmxlcwogICAgICovCiAgICAvKioKICAgICAqIGJ1dHRvbgogICAgICogQHByb3BlcnR5IGJ1dHRvbgogICAgICovCiAgICAvKioKICAgICAqIGNhbmNlbGFibGUKICAgICAqIEBwcm9wZXJ0eSBjYW5jZWxhYmxlCiAgICAgKi8KICAgIC8qKgogICAgICogY2hhckNvZGUKICAgICAqIEBwcm9wZXJ0eSBjaGFyQ29kZQogICAgICovCiAgICAvKioKICAgICAqIGNsaWVudFgKICAgICAqIEBwcm9wZXJ0eSBjbGllbnRYCiAgICAgKi8KICAgIC8qKgogICAgICogY2xpZW50WQogICAgICogQHByb3BlcnR5IGNsaWVudFkKICAgICAqLwogICAgLyoqCiAgICAgKiBjdHJsS2V5CiAgICAgKiBAcHJvcGVydHkgY3RybEtleQogICAgICovCiAgICAvKioKICAgICAqIGRhdGEKICAgICAqIEBwcm9wZXJ0eSBkYXRhCiAgICAgKi8KICAgIC8qKgogICAgICogZGV0YWlsCiAgICAgKiBAcHJvcGVydHkgZGV0YWlsCiAgICAgKi8KICAgIC8qKgogICAgICogZXZlbnRQaGFzZQogICAgICogQHByb3BlcnR5IGV2ZW50UGhhc2UKICAgICAqLwogICAgLyoqCiAgICAgKiBmcm9tRWxlbWVudAogICAgICogQHByb3BlcnR5IGZyb21FbGVtZW50CiAgICAgKi8KICAgIC8qKgogICAgICogaGFuZGxlcgogICAgICogQHByb3BlcnR5IGhhbmRsZXIKICAgICAqLwogICAgLyoqCiAgICAgKiBrZXlDb2RlCiAgICAgKiBAcHJvcGVydHkga2V5Q29kZQogICAgICovCiAgICAvKioKICAgICAqIG1ldGFLZXkKICAgICAqIEBwcm9wZXJ0eSBtZXRhS2V5CiAgICAgKi8KICAgIC8qKgogICAgICogbmV3VmFsdWUKICAgICAqIEBwcm9wZXJ0eSBuZXdWYWx1ZQogICAgICovCiAgICAvKioKICAgICAqIG9mZnNldFgKICAgICAqIEBwcm9wZXJ0eSBvZmZzZXRYCiAgICAgKi8KICAgIC8qKgogICAgICogb2Zmc2V0WQogICAgICogQHByb3BlcnR5IG9mZnNldFkKICAgICAqLwogICAgLyoqCiAgICAgKiBwYWdlWAogICAgICogQHByb3BlcnR5IHBhZ2VYCiAgICAgKi8KICAgIC8qKgogICAgICogcGFnZVkKICAgICAqIEBwcm9wZXJ0eSBwYWdlWQogICAgICovCiAgICAvKioKICAgICAqIHByZXZWYWx1ZQogICAgICogQHByb3BlcnR5IHByZXZWYWx1ZQogICAgICovCiAgICAvKioKICAgICAqIHJlbGF0ZWROb2RlCiAgICAgKiBAcHJvcGVydHkgcmVsYXRlZE5vZGUKICAgICAqLwogICAgLyoqCiAgICAgKiByZWxhdGVkVGFyZ2V0CiAgICAgKiBAcHJvcGVydHkgcmVsYXRlZFRhcmdldAogICAgICovCiAgICAvKioKICAgICAqIHNjcmVlblgKICAgICAqIEBwcm9wZXJ0eSBzY3JlZW5YCiAgICAgKi8KICAgIC8qKgogICAgICogc2NyZWVuWQogICAgICogQHByb3BlcnR5IHNjcmVlblkKICAgICAqLwogICAgLyoqCiAgICAgKiBzaGlmdEtleQogICAgICogQHByb3BlcnR5IHNoaWZ0S2V5CiAgICAgKi8KICAgIC8qKgogICAgICogc3JjRWxlbWVudAogICAgICogQHByb3BlcnR5IHNyY0VsZW1lbnQKICAgICAqLwogICAgLyoqCiAgICAgKiB0b0VsZW1lbnQKICAgICAqIEBwcm9wZXJ0eSB0b0VsZW1lbnQKICAgICAqLwogICAgLyoqCiAgICAgKiB2aWV3CiAgICAgKiBAcHJvcGVydHkgdmlldwogICAgICovCiAgICAvKioKICAgICAqIHdoZWVsRGVsdGEKICAgICAqIEBwcm9wZXJ0eSB3aGVlbERlbHRhCiAgICAgKi8KICAgIC8qKgogICAgICogd2hpY2gKICAgICAqIEBwcm9wZXJ0eSB3aGljaAogICAgICovCiAgICAvKioKICAgICAqIGNoYW5nZWRUb3VjaGVzCiAgICAgKiBAcHJvcGVydHkgY2hhbmdlZFRvdWNoZXMKICAgICAqLwogICAgLyoqCiAgICAgKiB0b3VjaGVzCiAgICAgKiBAcHJvcGVydHkgdG91Y2hlcwogICAgICovCiAgICAvKioKICAgICAqIHRhcmdldFRvdWNoZXMKICAgICAqIEBwcm9wZXJ0eSB0YXJnZXRUb3VjaGVzCiAgICAgKi8KICAgIC8qKgogICAgICogcm90YXRpb24KICAgICAqIEBwcm9wZXJ0eSByb3RhdGlvbgogICAgICovCiAgICAvKioKICAgICAqIHNjYWxlCiAgICAgKiBAcHJvcGVydHkgc2NhbGUKICAgICAqLwogICAgLyoqCiAgICAgKiBzb3VyY2UgaHRtbCBub2RlIG9mIGN1cnJlbnQgZXZlbnQKICAgICAqIEBwcm9wZXJ0eSB0YXJnZXQKICAgICAqIEB0eXBlIHtIVE1MRWxlbWVudH0KICAgICAqLwogICAgLyoqCiAgICAgKiBjdXJyZW50IGh0bSBub2RlIHdoaWNoIHByb2Nlc3NlcyBjdXJyZW50IGV2ZW50CiAgICAgKiBAcHJvcGVydHkgY3VycmVudFRhcmdldAogICAgICogQHR5cGUge0hUTUxFbGVtZW50fQogICAgICovCiAgICBEb21FdmVudE9iamVjdC5zdXBlcmNsYXNzLmNvbnN0cnVjdG9yLmNhbGwoc2VsZik7CiAgICBzZWxmLm9yaWdpbmFsRXZlbnQgPSBvcmlnaW5hbEV2ZW50OwogICAgLy8gaW4gY2FzZSBkb20gZXZlbnQgaGFzIGJlZW4gbWFyayBhcyBkZWZhdWx0IHByZXZlbnRlZCBieSBsb3dlciBkb20gbm9kZQogICAgdmFyIGlzRGVmYXVsdFByZXZlbnRlZCA9IHJldEZhbHNlOwogICAgaWYgKCdkZWZhdWx0UHJldmVudGVkJyBpbiBvcmlnaW5hbEV2ZW50KSB7CiAgICAgIGlzRGVmYXVsdFByZXZlbnRlZCA9IG9yaWdpbmFsRXZlbnQuZGVmYXVsdFByZXZlbnRlZCA/IHJldFRydWUgOiByZXRGYWxzZTsKICAgIH0gZWxzZSBpZiAoJ2dldFByZXZlbnREZWZhdWx0JyBpbiBvcmlnaW5hbEV2ZW50KSB7CiAgICAgIC8vIGh0dHBzOi8vYnVnemlsbGEubW96aWxsYS5vcmcvc2hvd19idWcuY2dpP2lkPTY5MTE1MQogICAgICBpc0RlZmF1bHRQcmV2ZW50ZWQgPSBvcmlnaW5hbEV2ZW50LmdldFByZXZlbnREZWZhdWx0KCkgPyByZXRUcnVlIDogcmV0RmFsc2U7CiAgICB9IGVsc2UgaWYgKCdyZXR1cm5WYWx1ZScgaW4gb3JpZ2luYWxFdmVudCkgewogICAgICBpc0RlZmF1bHRQcmV2ZW50ZWQgPSBvcmlnaW5hbEV2ZW50LnJldHVyblZhbHVlID09PSBGQUxTRSA/IHJldFRydWUgOiByZXRGYWxzZTsKICAgIH0KICAgIHNlbGYuaXNEZWZhdWx0UHJldmVudGVkID0gaXNEZWZhdWx0UHJldmVudGVkOwogICAgdmFyIGZpeEZucyA9IFtdLCBmaXhGbiwgbCwgcHJvcCwgcHJvcHMgPSBjb21tb25Qcm9wcy5jb25jYXQoKTsKICAgIHV0aWwuZWFjaChldmVudE5vcm1hbGl6ZXJzLCBmdW5jdGlvbiAobm9ybWFsaXplcikgewogICAgICBpZiAodHlwZS5tYXRjaChub3JtYWxpemVyLnJlZykpIHsKICAgICAgICBwcm9wcyA9IHByb3BzLmNvbmNhdChub3JtYWxpemVyLnByb3BzKTsKICAgICAgICBpZiAobm9ybWFsaXplci5maXgpIHsKICAgICAgICAgIGZpeEZucy5wdXNoKG5vcm1hbGl6ZXIuZml4KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0pOwogICAgbCA9IHByb3BzLmxlbmd0aDsKICAgIC8vIGNsb25lIHByb3BlcnRpZXMgb2YgdGhlIG9yaWdpbmFsIGV2ZW50IG9iamVjdAogICAgd2hpbGUgKGwpIHsKICAgICAgcHJvcCA9IHByb3BzWy0tbF07CiAgICAgIHNlbGZbcHJvcF0gPSBvcmlnaW5hbEV2ZW50W3Byb3BdOwogICAgfQogICAgLy8gZml4IHRhcmdldCBwcm9wZXJ0eSwgaWYgbmVjZXNzYXJ5CiAgICBpZiAoIXNlbGYudGFyZ2V0ICYmIGlzTmF0aXZlKSB7CiAgICAgIHNlbGYudGFyZ2V0ID0gb3JpZ2luYWxFdmVudC5zcmNFbGVtZW50IHx8IERPQ1VNRU5UOwogICAgfQogICAgLy8gY2hlY2sgaWYgdGFyZ2V0IGlzIGEgdGV4dCBub2RlIChzYWZhcmkpCiAgICBpZiAoc2VsZi50YXJnZXQgJiYgc2VsZi50YXJnZXQubm9kZVR5cGUgPT09IDMpIHsKICAgICAgc2VsZi50YXJnZXQgPSBzZWxmLnRhcmdldC5wYXJlbnROb2RlOwogICAgfQogICAgbCA9IGZpeEZucy5sZW5ndGg7CiAgICB3aGlsZSAobCkgewogICAgICBmaXhGbiA9IGZpeEZuc1stLWxdOwogICAgICBmaXhGbihzZWxmLCBvcmlnaW5hbEV2ZW50KTsKICAgIH0KICAgIHNlbGYudGltZVN0YW1wID0gb3JpZ2luYWxFdmVudC50aW1lU3RhbXAgfHwgdXRpbC5ub3coKTsKICB9CiAgdXRpbC5leHRlbmQoRG9tRXZlbnRPYmplY3QsIEJhc2VFdmVudC5PYmplY3QsIHsKICAgIGNvbnN0cnVjdG9yOiBEb21FdmVudE9iamVjdCwKICAgIHByZXZlbnREZWZhdWx0OiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgZSA9IHNlbGYub3JpZ2luYWxFdmVudDsKICAgICAgLy8gaWYgcHJldmVudERlZmF1bHQgZXhpc3RzIHJ1biBpdCBvbiB0aGUgb3JpZ2luYWwgZXZlbnQKICAgICAgaWYgKGUucHJldmVudERlZmF1bHQpIHsKICAgICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgLy8gb3RoZXJ3aXNlIHNldCB0aGUgcmV0dXJuVmFsdWUgcHJvcGVydHkgb2YgdGhlIG9yaWdpbmFsIGV2ZW50IHRvIEZBTFNFIChJRSkKICAgICAgICBlLnJldHVyblZhbHVlID0gRkFMU0U7CiAgICAgIH0KICAgICAgRG9tRXZlbnRPYmplY3Quc3VwZXJjbGFzcy5wcmV2ZW50RGVmYXVsdC5jYWxsKHNlbGYpOwogICAgfSwKICAgIHN0b3BQcm9wYWdhdGlvbjogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGUgPSBzZWxmLm9yaWdpbmFsRXZlbnQ7CiAgICAgIC8vIGlmIHN0b3BQcm9wYWdhdGlvbiBleGlzdHMgcnVuIGl0IG9uIHRoZSBvcmlnaW5hbCBldmVudAogICAgICBpZiAoZS5zdG9wUHJvcGFnYXRpb24pIHsKICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIG90aGVyd2lzZSBzZXQgdGhlIGNhbmNlbEJ1YmJsZSBwcm9wZXJ0eSBvZiB0aGUgb3JpZ2luYWwgZXZlbnQgdG8gVFJVRSAoSUUpCiAgICAgICAgZS5jYW5jZWxCdWJibGUgPSBUUlVFOwogICAgICB9CiAgICAgIERvbUV2ZW50T2JqZWN0LnN1cGVyY2xhc3Muc3RvcFByb3BhZ2F0aW9uLmNhbGwoc2VsZik7CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IERvbUV2ZW50T2JqZWN0OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50RG9tQmFzZUxpYk1haW5PYnNlcnZhYmxlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBCYXNlRXZlbnQgPSBldmVudEJhc2U7CiAgdmFyIERvbSA9IGRvbUJhc2U7CiAgdmFyIFNwZWNpYWwgPSBldmVudERvbUJhc2VMaWJNYWluU3BlY2lhbDsKICB2YXIgRG9tRXZlbnRVdGlscyA9IGV2ZW50RG9tQmFzZUxpYk1haW5VdGlsczsKICB2YXIgRG9tRXZlbnRPYnNlcnZlciA9IGV2ZW50RG9tQmFzZUxpYk1haW5PYnNlcnZlcjsKICB2YXIgRG9tRXZlbnRPYmplY3QgPSBldmVudERvbUJhc2VMaWJNYWluT2JqZWN0OwogIHZhciBCYXNlVXRpbHMgPSBCYXNlRXZlbnQuVXRpbHM7CiAgZnVuY3Rpb24gRG9tRXZlbnRPYnNlcnZhYmxlKGNmZykgewogICAgdmFyIHNlbGYgPSB0aGlzOwogICAgdXRpbC5taXgoc2VsZiwgY2ZnKTsKICAgIHNlbGYucmVzZXQoKTsKICB9CiAgdXRpbC5leHRlbmQoRG9tRXZlbnRPYnNlcnZhYmxlLCBCYXNlRXZlbnQuT2JzZXJ2YWJsZSwgewogICAgY29uc3RydWN0b3I6IERvbUV2ZW50T2JzZXJ2YWJsZSwKICAgIHNldHVwOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgdHlwZSA9IHNlbGYudHlwZSwgcyA9IFNwZWNpYWxbdHlwZV0gfHwge30sIGN1cnJlbnRUYXJnZXQgPSBzZWxmLmN1cnJlbnRUYXJnZXQsIGV2ZW50RGVzYyA9IERvbUV2ZW50VXRpbHMuZGF0YShjdXJyZW50VGFyZ2V0KSwgaGFuZGxlID0gZXZlbnREZXNjLmhhbmRsZTsKICAgICAgaWYgKCFzLnNldHVwIHx8IHMuc2V0dXAuY2FsbChjdXJyZW50VGFyZ2V0LCB0eXBlKSA9PT0gZmFsc2UpIHsKICAgICAgICBEb21FdmVudFV0aWxzLnNpbXBsZUFkZChjdXJyZW50VGFyZ2V0LCB0eXBlLCBoYW5kbGUpOwogICAgICB9CiAgICB9LAogICAgcmVzZXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBEb21FdmVudE9ic2VydmFibGUuc3VwZXJjbGFzcy5yZXNldC5jYWxsKHNlbGYpOwogICAgICBzZWxmLmRlbGVnYXRlQ291bnQgPSAwOwogICAgICBzZWxmLmxhc3RDb3VudCA9IDA7CiAgICB9LAogICAgbm90aWZ5OiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIHRhcmdldCA9IGV2ZW50LnRhcmdldCwgZXZlbnRUeXBlID0gZXZlbnQudHlwZSwgc2VsZiA9IHRoaXMsIGN1cnJlbnRUYXJnZXQgPSBzZWxmLmN1cnJlbnRUYXJnZXQsIG9ic2VydmVycyA9IHNlbGYub2JzZXJ2ZXJzLCBhbGxPYnNlcnZlcnMgPSBbXSwgY3VycmVudFRhcmdldDAsIHJldCwgZ1JldCwgb2JzZXJ2ZXJPYmosIGksIGosIGxlbiwgZGVsZWdhdGVDb3VudCA9IHNlbGYuZGVsZWdhdGVDb3VudCB8fCAwLCBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzLCBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXIsIG9ic2VydmVyOwogICAgICBpZiAoZGVsZWdhdGVDb3VudCAmJiB0YXJnZXQubm9kZVR5cGUpIHsKICAgICAgICB3aGlsZSAodGFyZ2V0ICE9PSBjdXJyZW50VGFyZ2V0KSB7CiAgICAgICAgICBpZiAodGFyZ2V0LmRpc2FibGVkICE9PSB0cnVlIHx8IGV2ZW50VHlwZSAhPT0gJ2NsaWNrJykgewogICAgICAgICAgICB2YXIgY2FjaGVkTWF0Y2ggPSB7fSwgbWF0Y2hlZCwga2V5LCBmaWx0ZXI7CiAgICAgICAgICAgIGN1cnJlbnRUYXJnZXRPYnNlcnZlcnMgPSBbXTsKICAgICAgICAgICAgZm9yIChpID0gMDsgaSA8IGRlbGVnYXRlQ291bnQ7IGkrKykgewogICAgICAgICAgICAgIG9ic2VydmVyID0gb2JzZXJ2ZXJzW2ldOwogICAgICAgICAgICAgIGZpbHRlciA9IG9ic2VydmVyLmNvbmZpZy5maWx0ZXI7CiAgICAgICAgICAgICAga2V5ID0gZmlsdGVyICsgJyc7CiAgICAgICAgICAgICAgbWF0Y2hlZCA9IGNhY2hlZE1hdGNoW2tleV07CiAgICAgICAgICAgICAgaWYgKG1hdGNoZWQgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgICAgbWF0Y2hlZCA9IGNhY2hlZE1hdGNoW2tleV0gPSBEb20udGVzdCh0YXJnZXQsIGZpbHRlcik7CiAgICAgICAgICAgICAgfQogICAgICAgICAgICAgIGlmIChtYXRjaGVkKSB7CiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpOwogICAgICAgICAgICAgIH0KICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAoY3VycmVudFRhcmdldE9ic2VydmVycy5sZW5ndGgpIHsKICAgICAgICAgICAgICBhbGxPYnNlcnZlcnMucHVzaCh7CiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0OiB0YXJnZXQsCiAgICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzOiBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzCiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICAgIHRhcmdldCA9IHRhcmdldC5wYXJlbnROb2RlIHx8IGN1cnJlbnRUYXJnZXQ7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChkZWxlZ2F0ZUNvdW50IDwgb2JzZXJ2ZXJzLmxlbmd0aCkgewogICAgICAgIGFsbE9ic2VydmVycy5wdXNoKHsKICAgICAgICAgIGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQsCiAgICAgICAgICBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzOiBvYnNlcnZlcnMuc2xpY2UoZGVsZWdhdGVDb3VudCkKICAgICAgICB9KTsKICAgICAgfQogICAgICBmb3IgKGkgPSAwLCBsZW4gPSBhbGxPYnNlcnZlcnMubGVuZ3RoOyAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSAmJiBpIDwgbGVuOyArK2kpIHsKICAgICAgICBvYnNlcnZlck9iaiA9IGFsbE9ic2VydmVyc1tpXTsKICAgICAgICBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzID0gb2JzZXJ2ZXJPYmouY3VycmVudFRhcmdldE9ic2VydmVyczsKICAgICAgICBjdXJyZW50VGFyZ2V0MCA9IG9ic2VydmVyT2JqLmN1cnJlbnRUYXJnZXQ7CiAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldCA9IGN1cnJlbnRUYXJnZXQwOwogICAgICAgIGZvciAoaiA9IDA7ICFldmVudC5pc0ltbWVkaWF0ZVByb3BhZ2F0aW9uU3RvcHBlZCgpICYmIGogPCBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzLmxlbmd0aDsgaisrKSB7CiAgICAgICAgICBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXIgPSBjdXJyZW50VGFyZ2V0T2JzZXJ2ZXJzW2pdOwogICAgICAgICAgcmV0ID0gY3VycmVudFRhcmdldE9ic2VydmVyLm5vdGlmeShldmVudCwgc2VsZik7CiAgICAgICAgICBpZiAoZ1JldCAhPT0gZmFsc2UgJiYgcmV0ICE9PSB1bmRlZmluZWQpIHsKICAgICAgICAgICAgZ1JldCA9IHJldDsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIGdSZXQ7CiAgICB9LAogICAgZmlyZTogZnVuY3Rpb24gKGV2ZW50LCBvbmx5SGFuZGxlcnMpIHsKICAgICAgZXZlbnQgPSBldmVudCB8fCB7fTsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBldmVudFR5cGUgPSBTdHJpbmcoc2VsZi50eXBlKSwgZG9tRXZlbnRPYnNlcnZhYmxlLCBldmVudERhdGEsIHNwZWNpYWxFdmVudCA9IFNwZWNpYWxbZXZlbnRUeXBlXSB8fCB7fSwgYnViYmxlcyA9IHNwZWNpYWxFdmVudC5idWJibGVzICE9PSBmYWxzZSwgY3VycmVudFRhcmdldCA9IHNlbGYuY3VycmVudFRhcmdldDsKICAgICAgaWYgKHNwZWNpYWxFdmVudC5maXJlICYmIHNwZWNpYWxFdmVudC5maXJlLmNhbGwoY3VycmVudFRhcmdldCwgb25seUhhbmRsZXJzKSA9PT0gZmFsc2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKCFldmVudC5pc0V2ZW50T2JqZWN0KSB7CiAgICAgICAgZXZlbnREYXRhID0gZXZlbnQ7CiAgICAgICAgZXZlbnQgPSBuZXcgRG9tRXZlbnRPYmplY3QoeyB0eXBlOiBldmVudFR5cGUgfSk7CiAgICAgICAgdXRpbC5taXgoZXZlbnQsIGV2ZW50RGF0YSk7CiAgICAgIH0KICAgICAgZXZlbnQuY3VycmVudFRhcmdldCA9IGN1cnJlbnRUYXJnZXQ7CiAgICAgIGV2ZW50LnRhcmdldCA9IGV2ZW50LnRhcmdldCB8fCBjdXJyZW50VGFyZ2V0OwogICAgICBpZiAoc3BlY2lhbEV2ZW50LnByZUZpcmUgJiYgc3BlY2lhbEV2ZW50LnByZUZpcmUuY2FsbChjdXJyZW50VGFyZ2V0LCBldmVudCwgb25seUhhbmRsZXJzKSA9PT0gZmFsc2UpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIGN1ciA9IGN1cnJlbnRUYXJnZXQsIHdpbiA9IERvbS5nZXRXaW5kb3coY3VyKSwgY3VyRG9jdW1lbnQgPSB3aW4uZG9jdW1lbnQsIGV2ZW50UGF0aCA9IFtdLCBncmV0LCByZXQsIG9udHlwZSA9ICdvbicgKyBldmVudFR5cGUsIGV2ZW50UGF0aEluZGV4ID0gMDsKICAgICAgZG8gewogICAgICAgIGV2ZW50UGF0aC5wdXNoKGN1cik7CiAgICAgICAgY3VyID0gY3VyLnBhcmVudE5vZGUgfHwgY3VyLm93bmVyRG9jdW1lbnQgfHwgY3VyID09PSBjdXJEb2N1bWVudCAmJiB3aW47CiAgICAgIH0gd2hpbGUgKCFvbmx5SGFuZGxlcnMgJiYgY3VyICYmIGJ1YmJsZXMpOwogICAgICBjdXIgPSBldmVudFBhdGhbZXZlbnRQYXRoSW5kZXhdOwogICAgICBkbyB7CiAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldCA9IGN1cjsKICAgICAgICBkb21FdmVudE9ic2VydmFibGUgPSBEb21FdmVudE9ic2VydmFibGUuZ2V0RG9tRXZlbnRPYnNlcnZhYmxlKGN1ciwgZXZlbnRUeXBlKTsKICAgICAgICBpZiAoZG9tRXZlbnRPYnNlcnZhYmxlKSB7CiAgICAgICAgICByZXQgPSBkb21FdmVudE9ic2VydmFibGUubm90aWZ5KGV2ZW50KTsKICAgICAgICAgIGlmIChyZXQgIT09IHVuZGVmaW5lZCAmJiBncmV0ICE9PSBmYWxzZSkgewogICAgICAgICAgICBncmV0ID0gcmV0OwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICBpZiAoY3VyW29udHlwZV0gJiYgY3VyW29udHlwZV0uY2FsbChjdXIpID09PSBmYWxzZSkgewogICAgICAgICAgZXZlbnQucHJldmVudERlZmF1bHQoKTsKICAgICAgICB9CiAgICAgICAgY3VyID0gZXZlbnRQYXRoWysrZXZlbnRQYXRoSW5kZXhdOwogICAgICB9IHdoaWxlICghb25seUhhbmRsZXJzICYmIGN1ciAmJiAhZXZlbnQuaXNQcm9wYWdhdGlvblN0b3BwZWQoKSk7CiAgICAgIGlmICghb25seUhhbmRsZXJzICYmICFldmVudC5pc0RlZmF1bHRQcmV2ZW50ZWQoKSkgewogICAgICAgIHRyeSB7CiAgICAgICAgICBpZiAoY3VycmVudFRhcmdldFtldmVudFR5cGVdICYmICF1dGlsLmlzV2luZG93KGN1cnJlbnRUYXJnZXQpKSB7CiAgICAgICAgICAgIERvbUV2ZW50T2JzZXJ2YWJsZS50cmlnZ2VyZWRFdmVudCA9IGV2ZW50VHlwZTsKICAgICAgICAgICAgY3VycmVudFRhcmdldFtldmVudFR5cGVdKCk7CiAgICAgICAgICB9CiAgICAgICAgfSBjYXRjaCAoZUVycm9yKSB7CiAgICAgICAgICBjb25zb2xlLmVycm9yKCdldmVudC1kb206IHRyaWdnZXIgYWN0aW9uIGVycm9yOiAnICsgZUVycm9yKTsKICAgICAgICB9CiAgICAgICAgRG9tRXZlbnRPYnNlcnZhYmxlLnRyaWdnZXJlZEV2ZW50ID0gJyc7CiAgICAgIH0KICAgICAgcmV0dXJuIGdyZXQ7CiAgICB9LAogICAgb246IGZ1bmN0aW9uIChjZmcpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBvYnNlcnZlcnMgPSBzZWxmLm9ic2VydmVycywgcyA9IFNwZWNpYWxbc2VsZi50eXBlXSB8fCB7fSwgb2JzZXJ2ZXIgPSBjZmcgaW5zdGFuY2VvZiBEb21FdmVudE9ic2VydmVyID8gY2ZnIDogbmV3IERvbUV2ZW50T2JzZXJ2ZXIoY2ZnKTsKICAgICAgaWYgKHNlbGYuZmluZE9ic2VydmVyKG9ic2VydmVyKSA9PT0gLTEpIHsKICAgICAgICBpZiAob2JzZXJ2ZXIuY29uZmlnLmZpbHRlcikgewogICAgICAgICAgb2JzZXJ2ZXJzLnNwbGljZShzZWxmLmRlbGVnYXRlQ291bnQsIDAsIG9ic2VydmVyKTsKICAgICAgICAgIHNlbGYuZGVsZWdhdGVDb3VudCsrOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBpZiAob2JzZXJ2ZXIuY29uZmlnLmxhc3QpIHsKICAgICAgICAgICAgb2JzZXJ2ZXJzLnB1c2gob2JzZXJ2ZXIpOwogICAgICAgICAgICBzZWxmLmxhc3RDb3VudCsrOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgb2JzZXJ2ZXJzLnNwbGljZShvYnNlcnZlcnMubGVuZ3RoIC0gc2VsZi5sYXN0Q291bnQsIDAsIG9ic2VydmVyKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgaWYgKHMuYWRkKSB7CiAgICAgICAgICBzLmFkZC5jYWxsKHNlbGYuY3VycmVudFRhcmdldCwgb2JzZXJ2ZXIpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGRldGFjaDogZnVuY3Rpb24gKGNmZykgewogICAgICB2YXIgZ3JvdXBzUmUsIHNlbGYgPSB0aGlzLCBzID0gU3BlY2lhbFtzZWxmLnR5cGVdIHx8IHt9LCBoYXNGaWx0ZXIgPSAnZmlsdGVyJyBpbiBjZmcsIGZpbHRlciA9IGNmZy5maWx0ZXIsIGNvbnRleHQgPSBjZmcuY29udGV4dCwgZm4gPSBjZmcuZm4sIGN1cnJlbnRUYXJnZXQgPSBzZWxmLmN1cnJlbnRUYXJnZXQsIG9ic2VydmVycyA9IHNlbGYub2JzZXJ2ZXJzLCBncm91cHMgPSBjZmcuZ3JvdXBzOwogICAgICBpZiAoIW9ic2VydmVycy5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgaWYgKGdyb3VwcykgewogICAgICAgIGdyb3Vwc1JlID0gQmFzZVV0aWxzLmdldEdyb3Vwc1JlKGdyb3Vwcyk7CiAgICAgIH0KICAgICAgdmFyIGksIGosIHQsIG9ic2VydmVyLCBvYnNlcnZlckNvbnRleHQsIGxlbiA9IG9ic2VydmVycy5sZW5ndGg7CiAgICAgIGlmIChmbiB8fCBoYXNGaWx0ZXIgfHwgZ3JvdXBzUmUpIHsKICAgICAgICBjb250ZXh0ID0gY29udGV4dCB8fCBjdXJyZW50VGFyZ2V0OwogICAgICAgIGZvciAoaSA9IDAsIGogPSAwLCB0ID0gW107IGkgPCBsZW47ICsraSkgewogICAgICAgICAgb2JzZXJ2ZXIgPSBvYnNlcnZlcnNbaV07CiAgICAgICAgICB2YXIgb2JzZXJ2ZXJDb25maWcgPSBvYnNlcnZlci5jb25maWc7CiAgICAgICAgICBvYnNlcnZlckNvbnRleHQgPSBvYnNlcnZlckNvbmZpZy5jb250ZXh0IHx8IGN1cnJlbnRUYXJnZXQ7CiAgICAgICAgICBpZiAoY29udGV4dCAhPT0gb2JzZXJ2ZXJDb250ZXh0IHx8IGZuICYmIGZuICE9PSBvYnNlcnZlckNvbmZpZy5mbiB8fCBoYXNGaWx0ZXIgJiYgKGZpbHRlciAmJiBmaWx0ZXIgIT09IG9ic2VydmVyQ29uZmlnLmZpbHRlciB8fCAhZmlsdGVyICYmICFvYnNlcnZlckNvbmZpZy5maWx0ZXIpIHx8IGdyb3Vwc1JlICYmICFvYnNlcnZlckNvbmZpZy5ncm91cHMubWF0Y2goZ3JvdXBzUmUpKSB7CiAgICAgICAgICAgIHRbaisrXSA9IG9ic2VydmVyOwogICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgaWYgKG9ic2VydmVyQ29uZmlnLmZpbHRlciAmJiBzZWxmLmRlbGVnYXRlQ291bnQpIHsKICAgICAgICAgICAgICBzZWxmLmRlbGVnYXRlQ291bnQtLTsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAob2JzZXJ2ZXJDb25maWcubGFzdCAmJiBzZWxmLmxhc3RDb3VudCkgewogICAgICAgICAgICAgIHNlbGYubGFzdENvdW50LS07CiAgICAgICAgICAgIH0KICAgICAgICAgICAgaWYgKHMucmVtb3ZlKSB7CiAgICAgICAgICAgICAgcy5yZW1vdmUuY2FsbChjdXJyZW50VGFyZ2V0LCBvYnNlcnZlcik7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgICAgc2VsZi5vYnNlcnZlcnMgPSB0OwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYucmVzZXQoKTsKICAgICAgfQogICAgICBzZWxmLmNoZWNrTWVtb3J5KCk7CiAgICB9LAogICAgY2hlY2tNZW1vcnk6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCB0eXBlID0gc2VsZi50eXBlLCBkb21FdmVudE9ic2VydmFibGVzLCBoYW5kbGUsIHMgPSBTcGVjaWFsW3R5cGVdIHx8IHt9LCBjdXJyZW50VGFyZ2V0ID0gc2VsZi5jdXJyZW50VGFyZ2V0LCBldmVudERlc2MgPSBEb21FdmVudFV0aWxzLmRhdGEoY3VycmVudFRhcmdldCk7CiAgICAgIGlmIChldmVudERlc2MpIHsKICAgICAgICBkb21FdmVudE9ic2VydmFibGVzID0gZXZlbnREZXNjLm9ic2VydmFibGVzOwogICAgICAgIGlmICghc2VsZi5oYXNPYnNlcnZlcigpKSB7CiAgICAgICAgICBoYW5kbGUgPSBldmVudERlc2MuaGFuZGxlOwogICAgICAgICAgaWYgKCFzLnRlYXJEb3duIHx8IHMudGVhckRvd24uY2FsbChjdXJyZW50VGFyZ2V0LCB0eXBlKSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgRG9tRXZlbnRVdGlscy5zaW1wbGVSZW1vdmUoY3VycmVudFRhcmdldCwgdHlwZSwgaGFuZGxlKTsKICAgICAgICAgIH0KICAgICAgICAgIGRlbGV0ZSBkb21FdmVudE9ic2VydmFibGVzW3R5cGVdOwogICAgICAgIH0KICAgICAgICBpZiAodXRpbC5pc0VtcHR5T2JqZWN0KGRvbUV2ZW50T2JzZXJ2YWJsZXMpKSB7CiAgICAgICAgICBldmVudERlc2MuaGFuZGxlID0gbnVsbDsKICAgICAgICAgIERvbUV2ZW50VXRpbHMucmVtb3ZlRGF0YShjdXJyZW50VGFyZ2V0KTsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9KTsKICBEb21FdmVudE9ic2VydmFibGUudHJpZ2dlcmVkRXZlbnQgPSAnJzsKICBEb21FdmVudE9ic2VydmFibGUuZ2V0RG9tRXZlbnRPYnNlcnZhYmxlID0gZnVuY3Rpb24gKG5vZGUsIHR5cGUpIHsKICAgIHZhciBkb21FdmVudE9ic2VydmFibGVzSG9sZGVyID0gRG9tRXZlbnRVdGlscy5kYXRhKG5vZGUpLCBkb21FdmVudE9ic2VydmFibGVzOwogICAgaWYgKGRvbUV2ZW50T2JzZXJ2YWJsZXNIb2xkZXIpIHsKICAgICAgZG9tRXZlbnRPYnNlcnZhYmxlcyA9IGRvbUV2ZW50T2JzZXJ2YWJsZXNIb2xkZXIub2JzZXJ2YWJsZXM7CiAgICB9CiAgICBpZiAoZG9tRXZlbnRPYnNlcnZhYmxlcykgewogICAgICByZXR1cm4gZG9tRXZlbnRPYnNlcnZhYmxlc1t0eXBlXTsKICAgIH0KICAgIHJldHVybiBudWxsOwogIH07CiAgRG9tRXZlbnRPYnNlcnZhYmxlLmdldERvbUV2ZW50T2JzZXJ2YWJsZXNIb2xkZXIgPSBmdW5jdGlvbiAobm9kZSwgY3JlYXRlKSB7CiAgICB2YXIgZG9tRXZlbnRPYnNlcnZhYmxlcyA9IERvbUV2ZW50VXRpbHMuZGF0YShub2RlKTsKICAgIGlmICghZG9tRXZlbnRPYnNlcnZhYmxlcyAmJiBjcmVhdGUpIHsKICAgICAgRG9tRXZlbnRVdGlscy5kYXRhKG5vZGUsIGRvbUV2ZW50T2JzZXJ2YWJsZXMgPSB7fSk7CiAgICB9CiAgICByZXR1cm4gZG9tRXZlbnRPYnNlcnZhYmxlczsKICB9OwogIGV4cG9ydHMgPSBEb21FdmVudE9ic2VydmFibGU7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnREb21CYXNlTGliTWFpbkRvbUV2ZW50ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgQmFzZUV2ZW50ID0gZXZlbnRCYXNlOwogIHZhciBEb21FdmVudFV0aWxzID0gZXZlbnREb21CYXNlTGliTWFpblV0aWxzOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBTcGVjaWFsID0gZXZlbnREb21CYXNlTGliTWFpblNwZWNpYWw7CiAgdmFyIERvbUV2ZW50T2JzZXJ2YWJsZSA9IGV2ZW50RG9tQmFzZUxpYk1haW5PYnNlcnZhYmxlOwogIHZhciBEb21FdmVudE9iamVjdCA9IGV2ZW50RG9tQmFzZUxpYk1haW5PYmplY3Q7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgQmFzZVV0aWxzID0gQmFzZUV2ZW50LlV0aWxzOwogIGZ1bmN0aW9uIGZpeFR5cGUoY2ZnLCB0eXBlKSB7CiAgICB2YXIgcyA9IFNwZWNpYWxbdHlwZV0gfHwge30sIHR5cGVGaXg7CiAgICBpZiAoIWNmZy5vcmlnaW5hbFR5cGUgJiYgKHR5cGVGaXggPSBzLnR5cGVGaXgpKSB7CiAgICAgIGNmZy5vcmlnaW5hbFR5cGUgPSB0eXBlOwogICAgICB0eXBlID0gdHlwZUZpeDsKICAgIH0KICAgIHJldHVybiB0eXBlOwogIH0KICBmdW5jdGlvbiBhZGRJbnRlcm5hbChjdXJyZW50VGFyZ2V0LCB0eXBlLCBjZmcpIHsKICAgIHZhciBkb21FdmVudE9ic2VydmFibGVzSG9sZGVyLCBkb21FdmVudE9ic2VydmFibGUsIGRvbUV2ZW50T2JzZXJ2YWJsZXMsIGhhbmRsZTsKICAgIGNmZyA9IHV0aWwubWVyZ2UoY2ZnKTsKICAgIHR5cGUgPSBmaXhUeXBlKGNmZywgdHlwZSk7CiAgICBkb21FdmVudE9ic2VydmFibGVzSG9sZGVyID0gRG9tRXZlbnRPYnNlcnZhYmxlLmdldERvbUV2ZW50T2JzZXJ2YWJsZXNIb2xkZXIoY3VycmVudFRhcmdldCwgMSk7CiAgICBpZiAoIShoYW5kbGUgPSBkb21FdmVudE9ic2VydmFibGVzSG9sZGVyLmhhbmRsZSkpIHsKICAgICAgaGFuZGxlID0gZG9tRXZlbnRPYnNlcnZhYmxlc0hvbGRlci5oYW5kbGUgPSBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgICB2YXIgdHlwZSA9IGV2ZW50LnR5cGUsIGRvbUV2ZW50T2JzZXJ2YWJsZSwgY3VycmVudFRhcmdldCA9IGhhbmRsZS5jdXJyZW50VGFyZ2V0OwogICAgICAgIGlmIChEb21FdmVudE9ic2VydmFibGUudHJpZ2dlcmVkRXZlbnQgPT09IHR5cGUpIHsKICAgICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgICAgfQogICAgICAgIGRvbUV2ZW50T2JzZXJ2YWJsZSA9IERvbUV2ZW50T2JzZXJ2YWJsZS5nZXREb21FdmVudE9ic2VydmFibGUoY3VycmVudFRhcmdldCwgdHlwZSk7CiAgICAgICAgaWYgKGRvbUV2ZW50T2JzZXJ2YWJsZSkgewogICAgICAgICAgZXZlbnQuY3VycmVudFRhcmdldCA9IGN1cnJlbnRUYXJnZXQ7CiAgICAgICAgICBldmVudCA9IG5ldyBEb21FdmVudE9iamVjdChldmVudCk7CiAgICAgICAgICByZXR1cm4gZG9tRXZlbnRPYnNlcnZhYmxlLm5vdGlmeShldmVudCk7CiAgICAgICAgfQogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH07CiAgICAgIGhhbmRsZS5jdXJyZW50VGFyZ2V0ID0gY3VycmVudFRhcmdldDsKICAgIH0KICAgIGlmICghKGRvbUV2ZW50T2JzZXJ2YWJsZXMgPSBkb21FdmVudE9ic2VydmFibGVzSG9sZGVyLm9ic2VydmFibGVzKSkgewogICAgICBkb21FdmVudE9ic2VydmFibGVzID0gZG9tRXZlbnRPYnNlcnZhYmxlc0hvbGRlci5vYnNlcnZhYmxlcyA9IHt9OwogICAgfQogICAgZG9tRXZlbnRPYnNlcnZhYmxlID0gZG9tRXZlbnRPYnNlcnZhYmxlc1t0eXBlXTsKICAgIGlmICghZG9tRXZlbnRPYnNlcnZhYmxlKSB7CiAgICAgIGRvbUV2ZW50T2JzZXJ2YWJsZSA9IGRvbUV2ZW50T2JzZXJ2YWJsZXNbdHlwZV0gPSBuZXcgRG9tRXZlbnRPYnNlcnZhYmxlKHsKICAgICAgICB0eXBlOiB0eXBlLAogICAgICAgIGN1cnJlbnRUYXJnZXQ6IGN1cnJlbnRUYXJnZXQKICAgICAgfSk7CiAgICAgIGRvbUV2ZW50T2JzZXJ2YWJsZS5zZXR1cCgpOwogICAgfQogICAgZG9tRXZlbnRPYnNlcnZhYmxlLm9uKGNmZyk7CiAgICBjdXJyZW50VGFyZ2V0ID0gbnVsbDsKICB9CiAgZnVuY3Rpb24gcmVtb3ZlSW50ZXJuYWwoY3VycmVudFRhcmdldCwgdHlwZSwgY2ZnKSB7CiAgICBjZmcgPSB1dGlsLm1lcmdlKGNmZyk7CiAgICB2YXIgY3VzdG9tRXZlbnQ7CiAgICB0eXBlID0gZml4VHlwZShjZmcsIHR5cGUpOwogICAgdmFyIGRvbUV2ZW50T2JzZXJ2YWJsZXNIb2xkZXIgPSBEb21FdmVudE9ic2VydmFibGUuZ2V0RG9tRXZlbnRPYnNlcnZhYmxlc0hvbGRlcihjdXJyZW50VGFyZ2V0KSwgZG9tRXZlbnRPYnNlcnZhYmxlcyA9IChkb21FdmVudE9ic2VydmFibGVzSG9sZGVyIHx8IHt9KS5vYnNlcnZhYmxlczsKICAgIGlmICghZG9tRXZlbnRPYnNlcnZhYmxlc0hvbGRlciB8fCAhZG9tRXZlbnRPYnNlcnZhYmxlcykgewogICAgICByZXR1cm47CiAgICB9CiAgICBpZiAoIXR5cGUpIHsKICAgICAgZm9yICh0eXBlIGluIGRvbUV2ZW50T2JzZXJ2YWJsZXMpIHsKICAgICAgICBkb21FdmVudE9ic2VydmFibGVzW3R5cGVdLmRldGFjaChjZmcpOwogICAgICB9CiAgICAgIHJldHVybjsKICAgIH0KICAgIGN1c3RvbUV2ZW50ID0gZG9tRXZlbnRPYnNlcnZhYmxlc1t0eXBlXTsKICAgIGlmIChjdXN0b21FdmVudCkgewogICAgICBjdXN0b21FdmVudC5kZXRhY2goY2ZnKTsKICAgIH0KICB9CiAgdmFyIERvbUV2ZW50ID0gewogICAgb246IGZ1bmN0aW9uICh0YXJnZXRzLCB0eXBlLCBmbiwgY29udGV4dCkgewogICAgICB0YXJnZXRzID0gRG9tLnF1ZXJ5KHRhcmdldHMpOwogICAgICBCYXNlVXRpbHMuYmF0Y2hGb3JUeXBlKGZ1bmN0aW9uICh0YXJnZXRzLCB0eXBlLCBmbiwgY29udGV4dCkgewogICAgICAgIHZhciBjZmcgPSBCYXNlVXRpbHMubm9ybWFsaXplUGFyYW0odHlwZSwgZm4sIGNvbnRleHQpLCBpLCB0OwogICAgICAgIHR5cGUgPSBjZmcudHlwZTsKICAgICAgICBmb3IgKGkgPSB0YXJnZXRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICB0ID0gdGFyZ2V0c1tpXTsKICAgICAgICAgIGFkZEludGVybmFsKHQsIHR5cGUsIGNmZyk7CiAgICAgICAgfQogICAgICB9LCAxLCB0YXJnZXRzLCB0eXBlLCBmbiwgY29udGV4dCk7CiAgICAgIHJldHVybiB0YXJnZXRzOwogICAgfSwKICAgIGRldGFjaDogZnVuY3Rpb24gKHRhcmdldHMsIHR5cGUsIGZuLCBjb250ZXh0KSB7CiAgICAgIHRhcmdldHMgPSBEb20ucXVlcnkodGFyZ2V0cyk7CiAgICAgIEJhc2VVdGlscy5iYXRjaEZvclR5cGUoZnVuY3Rpb24gKHRhcmdldHMsIHNpbmdsZVR5cGUsIGZuLCBjb250ZXh0KSB7CiAgICAgICAgdmFyIGNmZyA9IEJhc2VVdGlscy5ub3JtYWxpemVQYXJhbShzaW5nbGVUeXBlLCBmbiwgY29udGV4dCksIGksIGosIGVsQ2hpbGRyZW4sIHQ7CiAgICAgICAgc2luZ2xlVHlwZSA9IGNmZy50eXBlOwogICAgICAgIGZvciAoaSA9IHRhcmdldHMubGVuZ3RoIC0gMTsgaSA+PSAwOyBpLS0pIHsKICAgICAgICAgIHQgPSB0YXJnZXRzW2ldOwogICAgICAgICAgcmVtb3ZlSW50ZXJuYWwodCwgc2luZ2xlVHlwZSwgY2ZnKTsKICAgICAgICAgIGlmIChjZmcuZGVlcCAmJiB0LmdldEVsZW1lbnRzQnlUYWdOYW1lKSB7CiAgICAgICAgICAgIGVsQ2hpbGRyZW4gPSB0LmdldEVsZW1lbnRzQnlUYWdOYW1lKCcqJyk7CiAgICAgICAgICAgIGZvciAoaiA9IGVsQ2hpbGRyZW4ubGVuZ3RoIC0gMTsgaiA+PSAwOyBqLS0pIHsKICAgICAgICAgICAgICByZW1vdmVJbnRlcm5hbChlbENoaWxkcmVuW2pdLCBzaW5nbGVUeXBlLCBjZmcpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9LCAxLCB0YXJnZXRzLCB0eXBlLCBmbiwgY29udGV4dCk7CiAgICAgIHJldHVybiB0YXJnZXRzOwogICAgfSwKICAgIGRlbGVnYXRlOiBmdW5jdGlvbiAodGFyZ2V0cywgZXZlbnRUeXBlLCBmaWx0ZXIsIGZuLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiBEb21FdmVudC5vbih0YXJnZXRzLCBldmVudFR5cGUsIHsKICAgICAgICBmbjogZm4sCiAgICAgICAgY29udGV4dDogY29udGV4dCwKICAgICAgICBmaWx0ZXI6IGZpbHRlcgogICAgICB9KTsKICAgIH0sCiAgICB1bmRlbGVnYXRlOiBmdW5jdGlvbiAodGFyZ2V0cywgZXZlbnRUeXBlLCBmaWx0ZXIsIGZuLCBjb250ZXh0KSB7CiAgICAgIHJldHVybiBEb21FdmVudC5kZXRhY2godGFyZ2V0cywgZXZlbnRUeXBlLCB7CiAgICAgICAgZm46IGZuLAogICAgICAgIGNvbnRleHQ6IGNvbnRleHQsCiAgICAgICAgZmlsdGVyOiBmaWx0ZXIKICAgICAgfSk7CiAgICB9LAogICAgZmlyZTogZnVuY3Rpb24gKHRhcmdldHMsIGV2ZW50VHlwZSwgZXZlbnREYXRhLCBvbmx5SGFuZGxlcnMpIHsKICAgICAgdmFyIHJldDsKICAgICAgaWYgKGV2ZW50VHlwZS5pc0V2ZW50T2JqZWN0KSB7CiAgICAgICAgZXZlbnREYXRhID0gZXZlbnRUeXBlOwogICAgICAgIGV2ZW50VHlwZSA9IGV2ZW50VHlwZS50eXBlOwogICAgICB9CiAgICAgIGV2ZW50RGF0YSA9IGV2ZW50RGF0YSB8fCB7fTsKICAgICAgZXZlbnREYXRhLnN5bnRoZXRpYyA9IDE7CiAgICAgIEJhc2VVdGlscy5zcGxpdEFuZFJ1bihldmVudFR5cGUsIGZ1bmN0aW9uIChldmVudFR5cGUpIHsKICAgICAgICB2YXIgciwgaSwgdGFyZ2V0LCBkb21FdmVudE9ic2VydmFibGU7CiAgICAgICAgQmFzZVV0aWxzLmZpbGxHcm91cHNGb3JFdmVudChldmVudFR5cGUsIGV2ZW50RGF0YSk7CiAgICAgICAgZXZlbnRUeXBlID0gZXZlbnREYXRhLnR5cGU7CiAgICAgICAgdmFyIHMgPSBTcGVjaWFsW2V2ZW50VHlwZV07CiAgICAgICAgdmFyIG9yaWdpbmFsVHlwZSA9IGV2ZW50VHlwZTsKICAgICAgICBpZiAocyAmJiBzLnR5cGVGaXgpIHsKICAgICAgICAgIG9yaWdpbmFsVHlwZSA9IHMudHlwZUZpeDsKICAgICAgICB9CiAgICAgICAgdGFyZ2V0cyA9IERvbS5xdWVyeSh0YXJnZXRzKTsKICAgICAgICBmb3IgKGkgPSB0YXJnZXRzLmxlbmd0aCAtIDE7IGkgPj0gMDsgaS0tKSB7CiAgICAgICAgICB0YXJnZXQgPSB0YXJnZXRzW2ldOwogICAgICAgICAgZG9tRXZlbnRPYnNlcnZhYmxlID0gRG9tRXZlbnRPYnNlcnZhYmxlLmdldERvbUV2ZW50T2JzZXJ2YWJsZSh0YXJnZXQsIG9yaWdpbmFsVHlwZSk7CiAgICAgICAgICBpZiAoIW9ubHlIYW5kbGVycyAmJiAhZG9tRXZlbnRPYnNlcnZhYmxlKSB7CiAgICAgICAgICAgIGRvbUV2ZW50T2JzZXJ2YWJsZSA9IG5ldyBEb21FdmVudE9ic2VydmFibGUoewogICAgICAgICAgICAgIHR5cGU6IG9yaWdpbmFsVHlwZSwKICAgICAgICAgICAgICBjdXJyZW50VGFyZ2V0OiB0YXJnZXQKICAgICAgICAgICAgfSk7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoZG9tRXZlbnRPYnNlcnZhYmxlKSB7CiAgICAgICAgICAgIHIgPSBkb21FdmVudE9ic2VydmFibGUuZmlyZShldmVudERhdGEsIG9ubHlIYW5kbGVycyk7CiAgICAgICAgICAgIGlmIChyZXQgIT09IGZhbHNlICYmIHIgIT09IHVuZGVmaW5lZCkgewogICAgICAgICAgICAgIHJldCA9IHI7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0pOwogICAgICByZXR1cm4gcmV0OwogICAgfSwKICAgIGZpcmVIYW5kbGVyOiBmdW5jdGlvbiAodGFyZ2V0cywgZXZlbnRUeXBlLCBldmVudERhdGEpIHsKICAgICAgcmV0dXJuIERvbUV2ZW50LmZpcmUodGFyZ2V0cywgZXZlbnRUeXBlLCBldmVudERhdGEsIDEpOwogICAgfSwKICAgIGNsb25lOiBmdW5jdGlvbiAoc3JjLCBkZXN0KSB7CiAgICAgIHZhciBkb21FdmVudE9ic2VydmFibGVzSG9sZGVyLCBkb21FdmVudE9ic2VydmFibGVzOwogICAgICBpZiAoIShkb21FdmVudE9ic2VydmFibGVzSG9sZGVyID0gRG9tRXZlbnRPYnNlcnZhYmxlLmdldERvbUV2ZW50T2JzZXJ2YWJsZXNIb2xkZXIoc3JjKSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIHNyY0RhdGEgPSBEb21FdmVudFV0aWxzLmRhdGEoc3JjKTsKICAgICAgaWYgKHNyY0RhdGEgJiYgc3JjRGF0YSA9PT0gRG9tRXZlbnRVdGlscy5kYXRhKGRlc3QpKSB7CiAgICAgICAgRG9tRXZlbnRVdGlscy5yZW1vdmVEYXRhKGRlc3QpOwogICAgICB9CiAgICAgIGRvbUV2ZW50T2JzZXJ2YWJsZXMgPSBkb21FdmVudE9ic2VydmFibGVzSG9sZGVyLm9ic2VydmFibGVzOwogICAgICB1dGlsLmVhY2goZG9tRXZlbnRPYnNlcnZhYmxlcywgZnVuY3Rpb24gKGN1c3RvbUV2ZW50LCB0eXBlKSB7CiAgICAgICAgdXRpbC5lYWNoKGN1c3RvbUV2ZW50Lm9ic2VydmVycywgZnVuY3Rpb24gKG9ic2VydmVyKSB7CiAgICAgICAgICBhZGRJbnRlcm5hbChkZXN0LCB0eXBlLCBvYnNlcnZlci5jb25maWcpOwogICAgICAgIH0pOwogICAgICB9KTsKICAgIH0sCiAgICBnZXRFdmVudExpc3RlbmVyczogZnVuY3Rpb24gKHRhcmdldCwgdHlwZSkgewogICAgICB2YXIgb2JzZXJ2YWJsZXMgPSAoRG9tRXZlbnRPYnNlcnZhYmxlLmdldERvbUV2ZW50T2JzZXJ2YWJsZXNIb2xkZXIodGFyZ2V0KSB8fCB7IG9ic2VydmFibGVzOiB7fSB9KS5vYnNlcnZhYmxlczsKICAgICAgcmV0dXJuIHR5cGUgPyBvYnNlcnZhYmxlc1t0eXBlXSA6IG9ic2VydmFibGVzOwogICAgfQogIH07CiAgZXhwb3J0cyA9IERvbUV2ZW50OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50RG9tQmFzZUxpYk1haW5TcGVjaWFsRXZlbnRzID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUJhc2VMaWJNYWluRG9tRXZlbnQ7CiAgdmFyIFNwZWNpYWwgPSBldmVudERvbUJhc2VMaWJNYWluU3BlY2lhbDsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBNT1VTRV9XSEVFTCA9ICdvbm1vdXNld2hlZWwnIGluIGRvY3VtZW50LmRvY3VtZW50RWxlbWVudCA/ICdtb3VzZXdoZWVsJyA6ICdET01Nb3VzZVNjcm9sbCc7CiAgZXhwb3J0cyA9IHV0aWwubWl4KFNwZWNpYWwsIHsKICAgIG1vdXNld2hlZWw6IHsgdHlwZUZpeDogTU9VU0VfV0hFRUwgfSwKICAgIGxvYWQ6IHsgYnViYmxlczogZmFsc2UgfSwKICAgIGNsaWNrOiB7CiAgICAgIGZpcmU6IGZ1bmN0aW9uIChvbmx5SGFuZGxlcnMpIHsKICAgICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgICAgaWYgKCFvbmx5SGFuZGxlcnMgJiYgU3RyaW5nKHNlbGYudHlwZSkgPT09ICdjaGVja2JveCcgJiYgc2VsZi5jbGljayAmJiBzZWxmLm5vZGVOYW1lLnRvTG93ZXJDYXNlKCkgPT09ICdpbnB1dCcpIHsKICAgICAgICAgIHNlbGYuY2xpY2soKTsKICAgICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgICAgfQogICAgfSwKICAgIGZvY3VzOiB7CiAgICAgIGJ1YmJsZXM6IGZhbHNlLAogICAgICBwcmVGaXJlOiBmdW5jdGlvbiAoZXZlbnQsIG9ubHlIYW5kbGVycykgewogICAgICAgIGlmICghb25seUhhbmRsZXJzKSB7CiAgICAgICAgICByZXR1cm4gRG9tRXZlbnQuZmlyZSh0aGlzLCAnZm9jdXNpbicpOwogICAgICAgIH0KICAgICAgfSwKICAgICAgZmlyZTogZnVuY3Rpb24gKG9ubHlIYW5kbGVycykgewogICAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgICBpZiAoIW9ubHlIYW5kbGVycyAmJiBzZWxmLm93bmVyRG9jdW1lbnQpIHsKICAgICAgICAgIGlmIChzZWxmICE9PSBzZWxmLm93bmVyRG9jdW1lbnQuYWN0aXZlRWxlbWVudCAmJiBzZWxmLmZvY3VzKSB7CiAgICAgICAgICAgIHNlbGYuZm9jdXMoKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CiAgICB9LAogICAgYmx1cjogewogICAgICBidWJibGVzOiBmYWxzZSwKICAgICAgcHJlRmlyZTogZnVuY3Rpb24gKGV2ZW50LCBvbmx5SGFuZGxlcnMpIHsKICAgICAgICBpZiAoIW9ubHlIYW5kbGVycykgewogICAgICAgICAgcmV0dXJuIERvbUV2ZW50LmZpcmUodGhpcywgJ2ZvY3Vzb3V0Jyk7CiAgICAgICAgfQogICAgICB9LAogICAgICBmaXJlOiBmdW5jdGlvbiAob25seUhhbmRsZXJzKSB7CiAgICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICAgIGlmICghb25seUhhbmRsZXJzICYmIHNlbGYub3duZXJEb2N1bWVudCkgewogICAgICAgICAgaWYgKHNlbGYgPT09IHNlbGYub3duZXJEb2N1bWVudC5hY3RpdmVFbGVtZW50ICYmIHNlbGYuYmx1cikgewogICAgICAgICAgICBzZWxmLmJsdXIoKTsKICAgICAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICB9CiAgICB9CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnREb21CYXNlTGliTWFpbiA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUJhc2VMaWJNYWluRG9tRXZlbnQ7CiAgdmFyIERvbUV2ZW50T2JqZWN0ID0gZXZlbnREb21CYXNlTGliTWFpbk9iamVjdDsKICB2YXIgT2JzZXJ2YWJsZSA9IGV2ZW50RG9tQmFzZUxpYk1haW5PYnNlcnZhYmxlOwogIHZhciBTcGVjaWFsID0gZXZlbnREb21CYXNlTGliTWFpblNwZWNpYWxFdmVudHM7CiAgdmFyIFV0aWxzID0gZXZlbnREb21CYXNlTGliTWFpblV0aWxzOwogIGV4cG9ydHMgPSB1dGlsLm1lcmdlKHsKICAgIGFkZDogRG9tRXZlbnQub24sCiAgICByZW1vdmU6IERvbUV2ZW50LmRldGFjaCwKICAgIG9mZjogRG9tRXZlbnQuZGV0YWNoLAogICAgdHJpZ2dlcjogRG9tRXZlbnQuZmlyZSwKICAgIHRyaWdnZXJIYW5kbGVyOiBEb21FdmVudC5maXJlSGFuZGxlciwKICAgIE9ic2VydmFibGU6IE9ic2VydmFibGUsCiAgICBTcGVjaWFsOiBTcGVjaWFsLAogICAgT2JqZWN0OiBEb21FdmVudE9iamVjdCwKICAgIFV0aWxzOiBVdGlscwogIH0sIERvbUV2ZW50KTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpldmVudERvbUJhc2VJbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZXhwb3J0cyA9IGV2ZW50RG9tQmFzZUxpYk1haW47CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGV2ZW50RG9tQmFzZUluZGV4Owp9KTtkZWZpbmUoImV2ZW50LWRvbS1leHRyYSIsIFsiZXZlbnQtZG9tLWJhc2UiLCd1dGlsJywidWEiLCd1dGlsJywnZG9tJywiZmVhdHVyZSIsJ2RvbSddLCBmdW5jdGlvbihyZXF1aXJlKSB7CnZhciBldmVudERvbUJhc2UgPSByZXF1aXJlKCJldmVudC1kb20tYmFzZSIpOwp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7CnZhciBfdWFfID0gcmVxdWlyZSgidWEiKTsKdmFyIHV0aWxFeHRyYSA9IHJlcXVpcmUoJ3V0aWwnKTsKdmFyIGRvbUJhc2UgPSByZXF1aXJlKCdkb20nKTsKdmFyIF9mZWF0dXJlXyA9IHJlcXVpcmUoImZlYXR1cmUiKTsKdmFyIGRvbUV4dHJhID0gcmVxdWlyZSgnZG9tJyk7Ci8vISBDb3B5cmlnaHQgMjAxNSwgZXZlbnQtZG9tLWV4dHJhQDYuMS4yIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAwOTo0ODoyMSBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmV2ZW50LWRvbS1leHRyYQpldmVudC1kb20tZXh0cmEvbGliL2V4dHJhCmV2ZW50LWRvbS1leHRyYS9saWIvZXh0cmEvYXBpCmV2ZW50LWRvbS1leHRyYS9saWIvZXh0cmEva2V5LWNvZGVzCmV2ZW50LWRvbS1leHRyYS9saWIvZXh0cmEvZm9jdXNpbgpldmVudC1kb20tZXh0cmEvbGliL2V4dHJhL2hhc2hjaGFuZ2UKZXZlbnQtZG9tLWV4dHJhL2xpYi9leHRyYS9pbnB1dApldmVudC1kb20tZXh0cmEvbGliL2V4dHJhL21vdXNlZW50ZXIKKi8KdmFyIGV2ZW50RG9tRXh0cmFMaWJFeHRyYUtleUNvZGVzLCBldmVudERvbUV4dHJhTGliRXh0cmFBcGksIGV2ZW50RG9tRXh0cmFMaWJFeHRyYUZvY3VzaW4sIGV2ZW50RG9tRXh0cmFMaWJFeHRyYUhhc2hjaGFuZ2UsIGV2ZW50RG9tRXh0cmFMaWJFeHRyYUlucHV0LCBldmVudERvbUV4dHJhTGliRXh0cmFNb3VzZWVudGVyLCBldmVudERvbUV4dHJhTGliRXh0cmEsIGV2ZW50RG9tRXh0cmFJbmRleDsKZXZlbnREb21FeHRyYUxpYkV4dHJhS2V5Q29kZXMgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKgogICAqIEBpZ25vcmUKICAgKiBzb21lIGtleS1jb2RlcyBkZWZpbml0aW9uIGFuZCB1dGlscyBmcm9tIGNsb3N1cmUtbGlicmFyeQogICAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tCiAgICovCiAgdmFyCiAgLyoqCiAgICogQGVudW0ge051bWJlcn0gRXZlbnQuRG9tRXZlbnQuS2V5Q29kZQogICAqIEBhbGlhcyBFdmVudC5LZXlDb2RlCiAgICogQWxsIGtleSBjb2Rlcy4KICAgKi8KICBLZXlDb2RlID0gewogICAgLyoqCiAgICAgKiBNQUNfRU5URVIKICAgICAqLwogICAgTUFDX0VOVEVSOiAzLAogICAgLyoqCiAgICAgKiBCQUNLU1BBQ0UKICAgICAqLwogICAgQkFDS1NQQUNFOiA4LAogICAgLyoqCiAgICAgKiBUQUIKICAgICAqLwogICAgVEFCOiA5LAogICAgLyoqCiAgICAgKiBOVU1MT0NLIG9uIEZGL1NhZmFyaSBNYWMKICAgICAqLwogICAgTlVNX0NFTlRFUjogMTIsCiAgICAvLyBOVU1MT0NLIG9uIEZGL1NhZmFyaSBNYWMKICAgIC8qKgogICAgICogRU5URVIKICAgICAqLwogICAgRU5URVI6IDEzLAogICAgLyoqCiAgICAgKiBTSElGVAogICAgICovCiAgICBTSElGVDogMTYsCiAgICAvKioKICAgICAqIENUUkwKICAgICAqLwogICAgQ1RSTDogMTcsCiAgICAvKioKICAgICAqIEFMVAogICAgICovCiAgICBBTFQ6IDE4LAogICAgLyoqCiAgICAgKiBQQVVTRQogICAgICovCiAgICBQQVVTRTogMTksCiAgICAvKioKICAgICAqIENBUFNfTE9DSwogICAgICovCiAgICBDQVBTX0xPQ0s6IDIwLAogICAgLyoqCiAgICAgKiBFU0MKICAgICAqLwogICAgRVNDOiAyNywKICAgIC8qKgogICAgICogU1BBQ0UKICAgICAqLwogICAgU1BBQ0U6IDMyLAogICAgLyoqCiAgICAgKiBQQUdFX1VQCiAgICAgKi8KICAgIFBBR0VfVVA6IDMzLAogICAgLy8gYWxzbyBOVU1fTk9SVEhfRUFTVAogICAgLyoqCiAgICAgKiBQQUdFX0RPV04KICAgICAqLwogICAgUEFHRV9ET1dOOiAzNCwKICAgIC8vIGFsc28gTlVNX1NPVVRIX0VBU1QKICAgIC8qKgogICAgICogRU5ECiAgICAgKi8KICAgIEVORDogMzUsCiAgICAvLyBhbHNvIE5VTV9TT1VUSF9XRVNUCiAgICAvKioKICAgICAqIEhPTUUKICAgICAqLwogICAgSE9NRTogMzYsCiAgICAvLyBhbHNvIE5VTV9OT1JUSF9XRVNUCiAgICAvKioKICAgICAqIExFRlQKICAgICAqLwogICAgTEVGVDogMzcsCiAgICAvLyBhbHNvIE5VTV9XRVNUCiAgICAvKioKICAgICAqIFVQCiAgICAgKi8KICAgIFVQOiAzOCwKICAgIC8vIGFsc28gTlVNX05PUlRICiAgICAvKioKICAgICAqIFJJR0hUCiAgICAgKi8KICAgIFJJR0hUOiAzOSwKICAgIC8vIGFsc28gTlVNX0VBU1QKICAgIC8qKgogICAgICogRE9XTgogICAgICovCiAgICBET1dOOiA0MCwKICAgIC8vIGFsc28gTlVNX1NPVVRICiAgICAvKioKICAgICAqIFBSSU5UX1NDUkVFTgogICAgICovCiAgICBQUklOVF9TQ1JFRU46IDQ0LAogICAgLyoqCiAgICAgKiBJTlNFUlQKICAgICAqLwogICAgSU5TRVJUOiA0NSwKICAgIC8vIGFsc28gTlVNX0lOU0VSVAogICAgLyoqCiAgICAgKiBERUxFVEUKICAgICAqLwogICAgREVMRVRFOiA0NiwKICAgIC8vIGFsc28gTlVNX0RFTEVURQogICAgLyoqCiAgICAgKiBaRVJPCiAgICAgKi8KICAgIFpFUk86IDQ4LAogICAgLyoqCiAgICAgKiBPTkUKICAgICAqLwogICAgT05FOiA0OSwKICAgIC8qKgogICAgICogVFdPCiAgICAgKi8KICAgIFRXTzogNTAsCiAgICAvKioKICAgICAqIFRIUkVFCiAgICAgKi8KICAgIFRIUkVFOiA1MSwKICAgIC8qKgogICAgICogRk9VUgogICAgICovCiAgICBGT1VSOiA1MiwKICAgIC8qKgogICAgICogRklWRQogICAgICovCiAgICBGSVZFOiA1MywKICAgIC8qKgogICAgICogU0lYCiAgICAgKi8KICAgIFNJWDogNTQsCiAgICAvKioKICAgICAqIFNFVkVOCiAgICAgKi8KICAgIFNFVkVOOiA1NSwKICAgIC8qKgogICAgICogRUlHSFQKICAgICAqLwogICAgRUlHSFQ6IDU2LAogICAgLyoqCiAgICAgKiBOSU5FCiAgICAgKi8KICAgIE5JTkU6IDU3LAogICAgLyoqCiAgICAgKiBRVUVTVElPTl9NQVJLCiAgICAgKi8KICAgIFFVRVNUSU9OX01BUks6IDYzLAogICAgLy8gbmVlZHMgbG9jYWxpemF0aW9uCiAgICAvKioKICAgICAqIEEKICAgICAqLwogICAgQTogNjUsCiAgICAvKioKICAgICAqIEIKICAgICAqLwogICAgQjogNjYsCiAgICAvKioKICAgICAqIEMKICAgICAqLwogICAgQzogNjcsCiAgICAvKioKICAgICAqIEQKICAgICAqLwogICAgRDogNjgsCiAgICAvKioKICAgICAqIEUKICAgICAqLwogICAgRTogNjksCiAgICAvKioKICAgICAqIEYKICAgICAqLwogICAgRjogNzAsCiAgICAvKioKICAgICAqIEcKICAgICAqLwogICAgRzogNzEsCiAgICAvKioKICAgICAqIEgKICAgICAqLwogICAgSDogNzIsCiAgICAvKioKICAgICAqIEkKICAgICAqLwogICAgSTogNzMsCiAgICAvKioKICAgICAqIEoKICAgICAqLwogICAgSjogNzQsCiAgICAvKioKICAgICAqIEsKICAgICAqLwogICAgSzogNzUsCiAgICAvKioKICAgICAqIEwKICAgICAqLwogICAgTDogNzYsCiAgICAvKioKICAgICAqIE0KICAgICAqLwogICAgTTogNzcsCiAgICAvKioKICAgICAqIE4KICAgICAqLwogICAgTjogNzgsCiAgICAvKioKICAgICAqIE8KICAgICAqLwogICAgTzogNzksCiAgICAvKioKICAgICAqIFAKICAgICAqLwogICAgUDogODAsCiAgICAvKioKICAgICAqIFEKICAgICAqLwogICAgUTogODEsCiAgICAvKioKICAgICAqIFIKICAgICAqLwogICAgUjogODIsCiAgICAvKioKICAgICAqIFMKICAgICAqLwogICAgUzogODMsCiAgICAvKioKICAgICAqIFQKICAgICAqLwogICAgVDogODQsCiAgICAvKioKICAgICAqIFUKICAgICAqLwogICAgVTogODUsCiAgICAvKioKICAgICAqIFYKICAgICAqLwogICAgVjogODYsCiAgICAvKioKICAgICAqIFcKICAgICAqLwogICAgVzogODcsCiAgICAvKioKICAgICAqIFgKICAgICAqLwogICAgWDogODgsCiAgICAvKioKICAgICAqIFkKICAgICAqLwogICAgWTogODksCiAgICAvKioKICAgICAqIFoKICAgICAqLwogICAgWjogOTAsCiAgICAvKioKICAgICAqIE1FVEEKICAgICAqLwogICAgTUVUQTogOTEsCiAgICAvLyBXSU5fS0VZX0xFRlQKICAgIC8qKgogICAgICogV0lOX0tFWV9SSUdIVAogICAgICovCiAgICBXSU5fS0VZX1JJR0hUOiA5MiwKICAgIC8qKgogICAgICogQ09OVEVYVF9NRU5VCiAgICAgKi8KICAgIENPTlRFWFRfTUVOVTogOTMsCiAgICAvKioKICAgICAqIE5VTV9aRVJPCiAgICAgKi8KICAgIE5VTV9aRVJPOiA5NiwKICAgIC8qKgogICAgICogTlVNX09ORQogICAgICovCiAgICBOVU1fT05FOiA5NywKICAgIC8qKgogICAgICogTlVNX1RXTwogICAgICovCiAgICBOVU1fVFdPOiA5OCwKICAgIC8qKgogICAgICogTlVNX1RIUkVFCiAgICAgKi8KICAgIE5VTV9USFJFRTogOTksCiAgICAvKioKICAgICAqIE5VTV9GT1VSCiAgICAgKi8KICAgIE5VTV9GT1VSOiAxMDAsCiAgICAvKioKICAgICAqIE5VTV9GSVZFCiAgICAgKi8KICAgIE5VTV9GSVZFOiAxMDEsCiAgICAvKioKICAgICAqIE5VTV9TSVgKICAgICAqLwogICAgTlVNX1NJWDogMTAyLAogICAgLyoqCiAgICAgKiBOVU1fU0VWRU4KICAgICAqLwogICAgTlVNX1NFVkVOOiAxMDMsCiAgICAvKioKICAgICAqIE5VTV9FSUdIVAogICAgICovCiAgICBOVU1fRUlHSFQ6IDEwNCwKICAgIC8qKgogICAgICogTlVNX05JTkUKICAgICAqLwogICAgTlVNX05JTkU6IDEwNSwKICAgIC8qKgogICAgICogTlVNX01VTFRJUExZCiAgICAgKi8KICAgIE5VTV9NVUxUSVBMWTogMTA2LAogICAgLyoqCiAgICAgKiBOVU1fUExVUwogICAgICovCiAgICBOVU1fUExVUzogMTA3LAogICAgLyoqCiAgICAgKiBOVU1fTUlOVVMKICAgICAqLwogICAgTlVNX01JTlVTOiAxMDksCiAgICAvKioKICAgICAqIE5VTV9QRVJJT0QKICAgICAqLwogICAgTlVNX1BFUklPRDogMTEwLAogICAgLyoqCiAgICAgKiBOVU1fRElWSVNJT04KICAgICAqLwogICAgTlVNX0RJVklTSU9OOiAxMTEsCiAgICAvKioKICAgICAqIEYxCiAgICAgKi8KICAgIEYxOiAxMTIsCiAgICAvKioKICAgICAqIEYyCiAgICAgKi8KICAgIEYyOiAxMTMsCiAgICAvKioKICAgICAqIEYzCiAgICAgKi8KICAgIEYzOiAxMTQsCiAgICAvKioKICAgICAqIEY0CiAgICAgKi8KICAgIEY0OiAxMTUsCiAgICAvKioKICAgICAqIEY1CiAgICAgKi8KICAgIEY1OiAxMTYsCiAgICAvKioKICAgICAqIEY2CiAgICAgKi8KICAgIEY2OiAxMTcsCiAgICAvKioKICAgICAqIEY3CiAgICAgKi8KICAgIEY3OiAxMTgsCiAgICAvKioKICAgICAqIEY4CiAgICAgKi8KICAgIEY4OiAxMTksCiAgICAvKioKICAgICAqIEY5CiAgICAgKi8KICAgIEY5OiAxMjAsCiAgICAvKioKICAgICAqIEYxMAogICAgICovCiAgICBGMTA6IDEyMSwKICAgIC8qKgogICAgICogRjExCiAgICAgKi8KICAgIEYxMTogMTIyLAogICAgLyoqCiAgICAgKiBGMTIKICAgICAqLwogICAgRjEyOiAxMjMsCiAgICAvKioKICAgICAqIE5VTUxPQ0sKICAgICAqLwogICAgTlVNTE9DSzogMTQ0LAogICAgLyoqCiAgICAgKiBTRU1JQ09MT04KICAgICAqLwogICAgU0VNSUNPTE9OOiAxODYsCiAgICAvLyBuZWVkcyBsb2NhbGl6YXRpb24KICAgIC8qKgogICAgICogREFTSAogICAgICovCiAgICBEQVNIOiAxODksCiAgICAvLyBuZWVkcyBsb2NhbGl6YXRpb24KICAgIC8qKgogICAgICogRVFVQUxTCiAgICAgKi8KICAgIEVRVUFMUzogMTg3LAogICAgLy8gbmVlZHMgbG9jYWxpemF0aW9uCiAgICAvKioKICAgICAqIENPTU1BCiAgICAgKi8KICAgIENPTU1BOiAxODgsCiAgICAvLyBuZWVkcyBsb2NhbGl6YXRpb24KICAgIC8qKgogICAgICogUEVSSU9ECiAgICAgKi8KICAgIFBFUklPRDogMTkwLAogICAgLy8gbmVlZHMgbG9jYWxpemF0aW9uCiAgICAvKioKICAgICAqIFNMQVNICiAgICAgKi8KICAgIFNMQVNIOiAxOTEsCiAgICAvLyBuZWVkcyBsb2NhbGl6YXRpb24KICAgIC8qKgogICAgICogQVBPU1RST1BIRQogICAgICovCiAgICBBUE9TVFJPUEhFOiAxOTIsCiAgICAvLyBuZWVkcyBsb2NhbGl6YXRpb24KICAgIC8qKgogICAgICogU0lOR0xFX1FVT1RFCiAgICAgKi8KICAgIFNJTkdMRV9RVU9URTogMjIyLAogICAgLy8gbmVlZHMgbG9jYWxpemF0aW9uCiAgICAvKioKICAgICAqIE9QRU5fU1FVQVJFX0JSQUNLRVQKICAgICAqLwogICAgT1BFTl9TUVVBUkVfQlJBQ0tFVDogMjE5LAogICAgLy8gbmVlZHMgbG9jYWxpemF0aW9uCiAgICAvKioKICAgICAqIEJBQ0tTTEFTSAogICAgICovCiAgICBCQUNLU0xBU0g6IDIyMCwKICAgIC8vIG5lZWRzIGxvY2FsaXphdGlvbgogICAgLyoqCiAgICAgKiBDTE9TRV9TUVVBUkVfQlJBQ0tFVAogICAgICovCiAgICBDTE9TRV9TUVVBUkVfQlJBQ0tFVDogMjIxLAogICAgLy8gbmVlZHMgbG9jYWxpemF0aW9uCiAgICAvKioKICAgICAqIFdJTl9LRVkKICAgICAqLwogICAgV0lOX0tFWTogMjI0LAogICAgLyoqCiAgICAgKiBNQUNfRkZfTUVUQQogICAgICovCiAgICBNQUNfRkZfTUVUQTogMjI0LAogICAgLy8gRmlyZWZveCAoR2Vja28pIGZpcmVzIHRoaXMgZm9yIHRoZSBtZXRhIGtleSBpbnN0ZWFkIG9mIDkxCiAgICAvKioKICAgICAqIFdJTl9JTUUKICAgICAqLwogICAgV0lOX0lNRTogMjI5CiAgfTsKICAvKgogICB3aGV0aGVyIHRleHQgYW5kIG1vZGlmaWVkIGtleSBpcyBlbnRlcmVkIGF0IHRoZSBzYW1lIHRpbWUuCiAgICovCiAgS2V5Q29kZS5pc1RleHRNb2RpZnlpbmdLZXlFdmVudCA9IGZ1bmN0aW9uIChlKSB7CiAgICB2YXIga2V5Q29kZSA9IGUua2V5Q29kZTsKICAgIGlmIChlLmFsdEtleSAmJiAhZS5jdHJsS2V5IHx8IGUubWV0YUtleSB8fCAvLyBGdW5jdGlvbiBrZXlzIGRvbid0IGdlbmVyYXRlIHRleHQKICAgICAga2V5Q29kZSA+PSBLZXlDb2RlLkYxICYmIGtleUNvZGUgPD0gS2V5Q29kZS5GMTIpIHsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLy8gVGhlIGZvbGxvd2luZyBrZXlzIGFyZSBxdWl0ZSBoYXJtbGVzcywgZXZlbiBpbiBjb21iaW5hdGlvbiB3aXRoCiAgICAvLyBDVFJMLCBBTFQgb3IgU0hJRlQuCiAgICBzd2l0Y2ggKGtleUNvZGUpIHsKICAgIGNhc2UgS2V5Q29kZS5BTFQ6CiAgICBjYXNlIEtleUNvZGUuQ0FQU19MT0NLOgogICAgY2FzZSBLZXlDb2RlLkNPTlRFWFRfTUVOVToKICAgIGNhc2UgS2V5Q29kZS5DVFJMOgogICAgY2FzZSBLZXlDb2RlLkRPV046CiAgICBjYXNlIEtleUNvZGUuRU5EOgogICAgY2FzZSBLZXlDb2RlLkVTQzoKICAgIGNhc2UgS2V5Q29kZS5IT01FOgogICAgY2FzZSBLZXlDb2RlLklOU0VSVDoKICAgIGNhc2UgS2V5Q29kZS5MRUZUOgogICAgY2FzZSBLZXlDb2RlLk1BQ19GRl9NRVRBOgogICAgY2FzZSBLZXlDb2RlLk1FVEE6CiAgICBjYXNlIEtleUNvZGUuTlVNTE9DSzoKICAgIGNhc2UgS2V5Q29kZS5OVU1fQ0VOVEVSOgogICAgY2FzZSBLZXlDb2RlLlBBR0VfRE9XTjoKICAgIGNhc2UgS2V5Q29kZS5QQUdFX1VQOgogICAgY2FzZSBLZXlDb2RlLlBBVVNFOgogICAgY2FzZSBLZXlDb2RlLlBSSU5UX1NDUkVFTjoKICAgIGNhc2UgS2V5Q29kZS5SSUdIVDoKICAgIGNhc2UgS2V5Q29kZS5TSElGVDoKICAgIGNhc2UgS2V5Q29kZS5VUDoKICAgIGNhc2UgS2V5Q29kZS5XSU5fS0VZOgogICAgY2FzZSBLZXlDb2RlLldJTl9LRVlfUklHSFQ6CiAgICAgIHJldHVybiBmYWxzZTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiB0cnVlOwogICAgfQogIH07CiAgLyoKICAgd2hldGhlciBjaGFyYWN0ZXIgaXMgZW50ZXJlZC4KICAgKi8KICBLZXlDb2RlLmlzQ2hhcmFjdGVyS2V5ID0gZnVuY3Rpb24gKGtleUNvZGUpIHsKICAgIGlmIChrZXlDb2RlID49IEtleUNvZGUuWkVSTyAmJiBrZXlDb2RlIDw9IEtleUNvZGUuTklORSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGlmIChrZXlDb2RlID49IEtleUNvZGUuTlVNX1pFUk8gJiYga2V5Q29kZSA8PSBLZXlDb2RlLk5VTV9NVUxUSVBMWSkgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIGlmIChrZXlDb2RlID49IEtleUNvZGUuQSAmJiBrZXlDb2RlIDw9IEtleUNvZGUuWikgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0KICAgIC8vIFNhZmFyaSBzZW5kcyB6ZXJvIGtleSBjb2RlIGZvciBub24tbGF0aW4gY2hhcmFjdGVycy4KICAgIGlmICh3aW5kb3cubmF2aWdhdGlvbi51c2VyQWdlbnQuaW5kZXhPZignV2ViS2l0JykgIT09IC0xICYmIGtleUNvZGUgPT09IDApIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgICBzd2l0Y2ggKGtleUNvZGUpIHsKICAgIGNhc2UgS2V5Q29kZS5TUEFDRToKICAgIGNhc2UgS2V5Q29kZS5RVUVTVElPTl9NQVJLOgogICAgY2FzZSBLZXlDb2RlLk5VTV9QTFVTOgogICAgY2FzZSBLZXlDb2RlLk5VTV9NSU5VUzoKICAgIGNhc2UgS2V5Q29kZS5OVU1fUEVSSU9EOgogICAgY2FzZSBLZXlDb2RlLk5VTV9ESVZJU0lPTjoKICAgIGNhc2UgS2V5Q29kZS5TRU1JQ09MT046CiAgICBjYXNlIEtleUNvZGUuREFTSDoKICAgIGNhc2UgS2V5Q29kZS5FUVVBTFM6CiAgICBjYXNlIEtleUNvZGUuQ09NTUE6CiAgICBjYXNlIEtleUNvZGUuUEVSSU9EOgogICAgY2FzZSBLZXlDb2RlLlNMQVNIOgogICAgY2FzZSBLZXlDb2RlLkFQT1NUUk9QSEU6CiAgICBjYXNlIEtleUNvZGUuU0lOR0xFX1FVT1RFOgogICAgY2FzZSBLZXlDb2RlLk9QRU5fU1FVQVJFX0JSQUNLRVQ6CiAgICBjYXNlIEtleUNvZGUuQkFDS1NMQVNIOgogICAgY2FzZSBLZXlDb2RlLkNMT1NFX1NRVUFSRV9CUkFDS0VUOgogICAgICByZXR1cm4gdHJ1ZTsKICAgIGRlZmF1bHQ6CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICB9OwogIGV4cG9ydHMgPSBLZXlDb2RlOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50RG9tRXh0cmFMaWJFeHRyYUFwaSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIEV2ZW50RG9tID0gZXZlbnREb21CYXNlOwogIHZhciBLZXlDb2RlID0gZXZlbnREb21FeHRyYUxpYkV4dHJhS2V5Q29kZXM7CiAgRXZlbnREb20uS2V5Q29kZSA9IEtleUNvZGU7CiAgZXhwb3J0cyA9IEV2ZW50RG9tOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50RG9tRXh0cmFMaWJFeHRyYUZvY3VzaW4gPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKgogICAqIEBpZ25vcmUKICAgKiBldmVudC1mb2N1c2luCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUV4dHJhTGliRXh0cmFBcGk7CiAgdmFyIFNwZWNpYWwgPSBEb21FdmVudC5TcGVjaWFsOwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIHVhID0gX3VhXzsKICAvLyDorqnpnZ4gSUUg5rWP6KeI5Zmo5pSv5oyBIGZvY3VzaW4vZm9jdXNvdXQKICBpZiAoIXVhLmllKSB7CiAgICB1dGlsLmVhY2goWwogICAgICB7CiAgICAgICAgbmFtZTogJ2ZvY3VzaW4nLAogICAgICAgIGZpeDogJ2ZvY3VzJwogICAgICB9LAogICAgICB7CiAgICAgICAgbmFtZTogJ2ZvY3Vzb3V0JywKICAgICAgICBmaXg6ICdibHVyJwogICAgICB9CiAgICBdLCBmdW5jdGlvbiAobykgewogICAgICB2YXIga2V5ID0gdXRpbC5ndWlkKCdhdHRhY2hlc18nICsgdXRpbC5ub3coKSArICdfJyk7CiAgICAgIFNwZWNpYWxbby5uYW1lXSA9IHsKICAgICAgICAvLyDnu5/kuIDlnKggZG9jdW1lbnQg5LiKIGNhcHR1cmUgZm9jdXMvYmx1ciDkuovku7bvvIznhLblkI7mqKHmi5/lhpLms6EgZmlyZSDlh7rmnaUKICAgICAgICAvLyDovr7liLDlkowgZm9jdXNpbiDkuIDmoLfnmoTmlYjmnpwgZm9jdXNpbiAtPiBmb2N1cwogICAgICAgIC8vIHJlZmVyOiBodHRwOi8veWltaW5naGUuaXRleWUuY29tL2Jsb2cvODEzMjU1CiAgICAgICAgc2V0dXA6IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIC8vIHRoaXMgbWF5YmUgZG9jdW1lbnQKICAgICAgICAgIHZhciBkb2MgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpczsKICAgICAgICAgIGlmICghKGtleSBpbiBkb2MpKSB7CiAgICAgICAgICAgIGRvY1trZXldID0gMDsKICAgICAgICAgIH0KICAgICAgICAgIGRvY1trZXldICs9IDE7CiAgICAgICAgICBpZiAoZG9jW2tleV0gPT09IDEpIHsKICAgICAgICAgICAgZG9jLmFkZEV2ZW50TGlzdGVuZXIoby5maXgsIGhhbmRsZXIsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgdGVhckRvd246IGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBkb2MgPSB0aGlzLm93bmVyRG9jdW1lbnQgfHwgdGhpczsKICAgICAgICAgIGRvY1trZXldIC09IDE7CiAgICAgICAgICBpZiAoZG9jW2tleV0gPT09IDApIHsKICAgICAgICAgICAgZG9jLnJlbW92ZUV2ZW50TGlzdGVuZXIoby5maXgsIGhhbmRsZXIsIHRydWUpOwogICAgICAgICAgfQogICAgICAgIH0KICAgICAgfTsKICAgICAgZnVuY3Rpb24gaGFuZGxlcihldmVudCkgewogICAgICAgIHZhciB0YXJnZXQgPSBldmVudC50YXJnZXQ7CiAgICAgICAgcmV0dXJuIERvbUV2ZW50LmZpcmUodGFyZ2V0LCBvLm5hbWUpOwogICAgICB9CiAgICB9KTsKICB9CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnREb21FeHRyYUxpYkV4dHJhSGFzaGNoYW5nZSA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgLyoqCiAgICogQGlnbm9yZQogICAqIGhhc2hjaGFuZ2UgZXZlbnQgZm9yIG5vbi1zdGFuZGFyZCBicm93c2VyCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20sIHhpYW9tYWNqaUBnbWFpbC5jb20KICAgKi8KICB2YXIgdXRpbCA9IHV0aWxFeHRyYTsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUV4dHJhTGliRXh0cmFBcGk7CiAgdmFyIERvbSA9IGRvbUJhc2U7CiAgdmFyIFVBID0gX3VhXzsKICB2YXIgZmVhdHVyZSA9IF9mZWF0dXJlXzsKICB2YXIgaGFzaENoYW5nZSwgaWZyYW1lLCB1cmxXaXRob3V0SGFzaCwgU3BlY2lhbCA9IERvbUV2ZW50LlNwZWNpYWwsIHdpbiA9IHdpbmRvdywKICAgIC8vIOeUqOS6juWumuaXtuWZqOajgOa1i++8jOS4iuasoeWumuaXtuWZqOiusOW9leeahCBoYXNoIOWAvAogICAgbGFzdEhhc2gsIGRvYyA9IHdpbi5kb2N1bWVudCwgUkVQTEFDRV9ISVNUT1JZID0gJ19fa3NfcmVwbGFjZV9oaXN0b3J5X18nLCBpZSA9IFVBLmllTW9kZSwgSEFTSF9DSEFOR0UgPSAnaGFzaGNoYW5nZSc7CiAgaWYgKCFmZWF0dXJlLmlzSGFzaENoYW5nZVN1cHBvcnRlZCgpKSB7CiAgICB2YXIgUE9MTF9JTlRFUlZBTCA9IDUwLCBJRlJBTUVfVEVNUExBVEUgPSAnPGh0bWw+PGhlYWQ+PHRpdGxlPicgKyAoZG9jICYmIGRvYy50aXRsZSB8fCAnJykgKyAnIC0ge2hhc2h9PC90aXRsZT57aGVhZH08L2hlYWQ+PGJvZHk+e2hhc2h9PC9ib2R5PjwvaHRtbD4nOwogICAgRG9tRXZlbnQuUkVQTEFDRV9ISVNUT1JZID0gUkVQTEFDRV9ISVNUT1JZOwogICAgdmFyIGdldEhhc2ggPSBmdW5jdGlvbiAoKSB7CiAgICAgIC8vIOS4jeiDvSBsb2NhdGlvbi5oYXNoCiAgICAgIC8vIDEuCiAgICAgIC8vIGh0dHA6Ly94eC5jb20vI3l5P3o9MQogICAgICAvLyBpZTYgPT4gbG9jYXRpb24uaGFzaCA9ICN5eQogICAgICAvLyDlhbbku5bmtY/op4jlmaggPT4gbG9jYXRpb24uaGFzaCA9ICN5eT96PTEKICAgICAgLy8gMi4KICAgICAgLy8gIyEvaG9tZS9xPXslMjJ0aGVkYXRlJTIyOiUyMjIwMTIxMDEwfjIwMTIxMDEwJTIyfQogICAgICAvLyBmaXJlZm94IDE1ID0+ICMhL2hvbWUvcT17J3RoZWRhdGUnOicyMDEyMTAxMH4yMDEyMTAxMCd9CiAgICAgIC8vICEhIDooCiAgICAgIHZhciBtID0gbG9jYXRpb24uaHJlZi5tYXRjaCgvIy4rJC8pOwogICAgICByZXR1cm4gbSAmJiBtWzBdIHx8ICcjJzsKICAgIH07CiAgICB2YXIgbm90aWZ5SGFzaENoYW5nZSA9IGZ1bmN0aW9uICgpIHsKICAgICAgLy8gUy5sb2coJ2hhc2ggY2hhbmdlZCA6ICcgKyBnZXRIYXNoKCkpOwogICAgICAvLyBkb2VzIG5vdCBuZWVkIGJ1YmJsaW5nCiAgICAgIERvbUV2ZW50LmZpcmVIYW5kbGVyKHdpbiwgSEFTSF9DSEFOR0UsIHsKICAgICAgICBuZXdVUkw6IGxvY2F0aW9uLmhyZWYsCiAgICAgICAgb2xkVVJMOiB1cmxXaXRob3V0SGFzaCArIGxhc3RIYXNoCiAgICAgIH0pOwogICAgICBsYXN0SGFzaCA9IGdldEhhc2goKTsKICAgIH07CiAgICAvLyAxLiDkuI3mlK/mjIEgaGFzaGNoYW5nZSDkuovku7bvvIzmlK/mjIEgaGFzaCDljoblj7Llr7zoiKoob3BlcmE/PynvvJrlrprml7blmajnm5HmjqcKICAgIC8vIDIuIOS4jeaUr+aMgSBoYXNoY2hhbmdlIOS6i+S7tu+8jOS4jeaUr+aMgSBoYXNoIOWOhuWPsuWvvOiIqihpZTY3KSA6IGlmcmFtZSArIOWumuaXtuWZqAogICAgdmFyIGdldElmcmFtZURvYyA9IGZ1bmN0aW9uIChpZnJhbWUpIHsKICAgICAgcmV0dXJuIGlmcmFtZS5jb250ZW50V2luZG93LmRvY3VtZW50OwogICAgfTsKICAgIGhhc2hDaGFuZ2UgPSBpZSAmJiBpZSA8IDggPyBmdW5jdGlvbiAoaGFzaCwgcmVwbGFjZUhpc3RvcnkpIHsKICAgICAgLy8gUy5sb2coJ3NldCBpZnJhbWUgaHRtbCA6JyArIGhhc2gpOwogICAgICB2YXIgaHRtbCA9IHV0aWwuc3Vic3RpdHV0ZShJRlJBTUVfVEVNUExBVEUsIHsKICAgICAgICAgIC8vIOmYsuatoiBoYXNoIOmHjOacieS7o+eggemAoOaIkCB4c3MKICAgICAgICAgIC8vIOWQjumdoumAmui/hyBpbm5lclRleHTvvIznm7jlvZPkuo4gdW5Fc2NhcGVIdG1sCiAgICAgICAgICBoYXNoOiB1dGlsLmVzY2FwZUh0bWwoaGFzaCksCiAgICAgICAgICAvLyDkuIDlrpropoHliqDlk6YKICAgICAgICAgIGhlYWQ6IERvbS5pc0N1c3RvbURvbWFpbigpID8gJzxzY3JpcHQ+JyArICdkb2N1bWVudC4nICsgJ2RvbWFpbiA9ICInICsgZG9jLmRvbWFpbiArICciOzwvc2NyaXB0PicgOiAnJwogICAgICAgIH0pLCBpZnJhbWVEb2MgPSBnZXRJZnJhbWVEb2MoaWZyYW1lKTsKICAgICAgdHJ5IHsKICAgICAgICAvLyBpZSDkuIvkuI3nlZnljoblj7LorrDlvZXvvIEKICAgICAgICBpZiAocmVwbGFjZUhpc3RvcnkpIHsKICAgICAgICAgIGlmcmFtZURvYy5vcGVuKCd0ZXh0L2h0bWwnLCAncmVwbGFjZScpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAvLyDlhpnlhaXljoblj7IgaGFzaAogICAgICAgICAgaWZyYW1lRG9jLm9wZW4oKTsKICAgICAgICB9CiAgICAgICAgLy8g5Y+W5pe26KaB55SoIGlubmVyVGV4dCAhIQogICAgICAgIC8vIOWQpuWImeWPliBpbm5lckhUTUwg5Lya5Zug5Li6IGVzY2FwZUh0bWwg5a+8572uIGJvZHkuaW5uZXJIVE1sICE9IGhhc2gKICAgICAgICBpZnJhbWVEb2Mud3JpdGUoaHRtbCk7CiAgICAgICAgaWZyYW1lRG9jLmNsb3NlKCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgfQogICAgfSA6IGZ1bmN0aW9uICgpIHsKICAgICAgbm90aWZ5SGFzaENoYW5nZSgpOwogICAgfTsKICAgIHZhciB0aW1lciwgcG9sbCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgaGFzaCA9IGdldEhhc2goKSwgcmVwbGFjZUhpc3RvcnkgPSAwOwogICAgICAgIGlmIChoYXNoLmluZGV4T2YoUkVQTEFDRV9ISVNUT1JZKSAhPT0gLTEpIHsKICAgICAgICAgIHJlcGxhY2VIaXN0b3J5ID0gMTsKICAgICAgICAgIGhhc2ggPSBoYXNoLnJlcGxhY2UoUkVQTEFDRV9ISVNUT1JZLCAnJyk7CiAgICAgICAgICAvLyDljrvpmaQgaWU2NyBoYWNrIOagh+iusAogICAgICAgICAgbG9jYXRpb24uaGFzaCA9IGhhc2g7CiAgICAgICAgfQogICAgICAgIGlmIChoYXNoICE9PSBsYXN0SGFzaCkgewogICAgICAgICAgLy8gUy5sb2coJ3BvbGwgc3VjY2VzcyA6JyArIGhhc2ggKyAnIDonICsgbGFzdEhhc2gpOwogICAgICAgICAgLy8g6YCa55+l5a6M6LCD55So6ICFIGhhc2hjaGFuZ2Ug5LqL5Lu25YmN6K6+572uIGxhc3RIYXNoCiAgICAgICAgICAvLyBpZTw4IOWQjOatpSA6IGhhc2hDaGFuZ2UgLT4gb25JZnJhbWVMb2FkCiAgICAgICAgICBoYXNoQ2hhbmdlKGhhc2gsIHJlcGxhY2VIaXN0b3J5KTsKICAgICAgICB9CiAgICAgICAgdGltZXIgPSBzZXRUaW1lb3V0KHBvbGwsIFBPTExfSU5URVJWQUwpOwogICAgICB9LCBzZXR1cCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIXRpbWVyKSB7CiAgICAgICAgICBwb2xsKCk7CiAgICAgICAgfQogICAgICB9LCB0ZWFyRG93biA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAodGltZXIpIHsKICAgICAgICAgIGNsZWFyVGltZW91dCh0aW1lcik7CiAgICAgICAgfQogICAgICAgIHRpbWVyID0gMDsKICAgICAgfTsKICAgIC8vIGllNiwgNywg6KaG55uW5LiA5LqbZnVuY3Rpb24KICAgIGlmIChpZSAmJiBpZSA8IDgpIHsKICAgICAgLyoKICAgICAgIOWJjei/m+WQjumAgCA6IHN0YXJ0IC0+IG5vdGlmeUhhc2hDaGFuZ2UKICAgICAgIOebtOaOpei+k+WFpSA6IHBvbGwgLT4gaGFzaENoYW5nZSAtPiBzdGFydAogICAgICAgaWZyYW1lIOWGheWuueWSjCB1cmwg5ZCM5q2lCiAgICAgICAqLwogICAgICBzZXR1cCA9IGZ1bmN0aW9uICgpIHsKICAgICAgICBpZiAoIWlmcmFtZSkgewogICAgICAgICAgdmFyIGlmcmFtZVNyYyA9IERvbS5nZXRFbXB0eUlmcmFtZVNyYygpOwogICAgICAgICAgLy9odHRwOi8vd3d3LnBhY2llbGxvZ3JvdXAuY29tL2Jsb2cvP3A9NjA0CiAgICAgICAgICBpZnJhbWUgPSBEb20uY3JlYXRlKCc8aWZyYW1lICcgKyAoaWZyYW1lU3JjID8gJ3NyYz0iJyArIGlmcmFtZVNyYyArICciJyA6ICcnKSArICcgc3R5bGU9ImRpc3BsYXk6IG5vbmUiICcgKyAnaGVpZ2h0PSIwIiAnICsgJ3dpZHRoPSIwIiAnICsgJ3RhYmluZGV4PSItMSIgJyArICd0aXRsZT0iZW1wdHkiLz4nKTsKICAgICAgICAgIC8vIEFwcGVuZCB0aGUgaWZyYW1lIHRvIHRoZSBkb2N1bWVudEVsZW1lbnQgcmF0aGVyIHRoYW4gdGhlIGJvZHkuCiAgICAgICAgICAvLyBLZWVwaW5nIGl0IG91dHNpZGUgdGhlIGJvZHkgcHJldmVudHMgc2Nyb2xsaW5nIG9uIHRoZSBpbml0aWFsCiAgICAgICAgICAvLyBwYWdlIGxvYWQKICAgICAgICAgIERvbS5wcmVwZW5kKGlmcmFtZSwgZG9jLmRvY3VtZW50RWxlbWVudCk7CiAgICAgICAgICAvLyBpbml077yM56ys5LiA5qyh6Kem5Y+R77yM5Lul5ZCO6YO95pivIG9uSWZyYW1lTG9hZAogICAgICAgICAgRG9tRXZlbnQuYWRkKGlmcmFtZSwgJ2xvYWQnLCBmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIERvbUV2ZW50LnJlbW92ZShpZnJhbWUsICdsb2FkJyk7CiAgICAgICAgICAgIC8vIFVwZGF0ZSB0aGUgaWZyYW1lIHdpdGggdGhlIGluaXRpYWwgbG9jYXRpb24gaGFzaCwgaWYgYW55LiBUaGlzCiAgICAgICAgICAgIC8vIHdpbGwgY3JlYXRlIGFuIGluaXRpYWwgaGlzdG9yeSBlbnRyeSB0aGF0IHRoZSB1c2VyIGNhbiByZXR1cm4gdG8KICAgICAgICAgICAgLy8gYWZ0ZXIgdGhlIHN0YXRlIGhhcyBjaGFuZ2VkLgogICAgICAgICAgICBoYXNoQ2hhbmdlKGdldEhhc2goKSk7CiAgICAgICAgICAgIERvbUV2ZW50LmFkZChpZnJhbWUsICdsb2FkJywgb25JZnJhbWVMb2FkKTsKICAgICAgICAgICAgcG9sbCgpOwogICAgICAgICAgfSk7CiAgICAgICAgICAvLyBXaGVuZXZlciBgZG9jdW1lbnQudGl0bGVgIGNoYW5nZXMsIHVwZGF0ZSB0aGUgSWZyYW1lJ3MgdGl0bGUgdG8KICAgICAgICAgIC8vIHByZXR0aWZ5IHRoZSBiYWNrL25leHQgaGlzdG9yeSBtZW51IGVudHJpZXMuIFNpbmNlIElFIHNvbWV0aW1lcwogICAgICAgICAgLy8gZXJyb3JzIHdpdGggJ1Vuc3BlY2lmaWVkIGVycm9yJyB0aGUgdmVyeSBmaXJzdCB0aW1lIHRoaXMgaXMgc2V0CiAgICAgICAgICAvLyAoeWVzLCB2ZXJ5IHVzZWZ1bCkgd3JhcCB0aGlzIHdpdGggYSB0cnkvY2F0Y2ggYmxvY2suCiAgICAgICAgICBkb2MuYXR0YWNoRXZlbnQoJ3Byb3BlcnR5Y2hhbmdlJywgZnVuY3Rpb24gKGUpIHsKICAgICAgICAgICAgZSA9IGUgfHwgd2luZG93LmV2ZW50OwogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIGlmIChlLnByb3BlcnR5TmFtZSA9PT0gJ3RpdGxlJykgewogICAgICAgICAgICAgICAgZ2V0SWZyYW1lRG9jKGlmcmFtZSkudGl0bGUgPSBkb2MudGl0bGUgKyAnIC0gJyArIGdldEhhc2goKTsKICAgICAgICAgICAgICB9CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgfQogICAgICAgICAgfSk7CiAgICAgICAgICAvKgogICAgICAgICAgIOWJjei/m+WQjumAgCDvvJogb25JZnJhbWVMb2FkIC0+IOinpuWPkQogICAgICAgICAgIOebtOaOpei+k+WFpSA6IHRpbWVyIC0+IGhhc2hDaGFuZ2UgLT4gb25JZnJhbWVMb2FkIC0+IOinpuWPkQogICAgICAgICAgIOinpuWPkee7n+S4gOWcqCBzdGFydChsb2FkKQogICAgICAgICAgIGlmcmFtZSDlhoXlrrnlkowgdXJsIOWQjOatpQogICAgICAgICAgICovCiAgICAgICAgICB2YXIgb25JZnJhbWVMb2FkID0gZnVuY3Rpb24gKCkgewogICAgICAgICAgICAvLyBTLmxvZygnaWZyYW1lIHN0YXJ0IGxvYWQuLicpOwogICAgICAgICAgICAvLyAyMDExLjExLjAyIG5vdGU6IOS4jeiDveeUqCBpbm5lckhUTUwg5Lya6Ieq5Yqo6L2s5LmJ77yB77yBCiAgICAgICAgICAgIC8vICMveD96PTEmeT0yID0+ICMveD96PTEmYW1wO3k9MgogICAgICAgICAgICAvLyDlkI7pgIDml7bkuI3nrYkKICAgICAgICAgICAgLy8g5a6a5pe25Zmo6LCD55SoIGhhc2hDaGFuZ2UoKSDkv67mlLkgaWZyYW1lIOWQjOatpeiwg+eUqOi/h+adpeeahCjmiYvliqjmlLnlj5ggbG9jYXRpb24p5YiZ55u4562JCiAgICAgICAgICAgIC8vIFMubG9nKCdzZXQgbG9jIGhhc2ggOicgKyBjKTsKICAgICAgICAgICAgbG9jYXRpb24uaGFzaCA9IHV0aWwudHJpbShnZXRJZnJhbWVEb2MoaWZyYW1lKS5ib2R5LmlubmVyVGV4dCk7CiAgICAgICAgICAgIC8vIOS9vyBsYXN0IGhhc2gg5Li6IGlmcmFtZSDljoblj7LvvIwg5LiN54S26YeN5paw5YaZaWZyYW1l77yMCiAgICAgICAgICAgIC8vIOS8muWvvOiHtOacgOaWsOeKtuaAge+8iOS4ouWkseWJjei/m+eKtuaAge+8iQogICAgICAgICAgICAvLyDlkI7pgIDliJnnq4vljbPop6blj5EgaGFzaGNoYW5nZe+8jAogICAgICAgICAgICAvLyDlubbmm7TmlrDlrprml7blmajorrDlvZXnmoTkuIrkuKogaGFzaCDlgLwKICAgICAgICAgICAgbm90aWZ5SGFzaENoYW5nZSgpOwogICAgICAgICAgfTsKICAgICAgICB9CiAgICAgIH07CiAgICAgIHRlYXJEb3duID0gZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aW1lcikgewogICAgICAgICAgY2xlYXJUaW1lb3V0KHRpbWVyKTsKICAgICAgICB9CiAgICAgICAgdGltZXIgPSAwOwogICAgICAgIERvbUV2ZW50LmRldGFjaChpZnJhbWUpOwogICAgICAgIERvbS5yZW1vdmUoaWZyYW1lKTsKICAgICAgICBpZnJhbWUgPSAwOwogICAgICB9OwogICAgfQogICAgU3BlY2lhbFtIQVNIX0NIQU5HRV0gPSB7CiAgICAgIHNldHVwOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgaWYgKHRoaXMgIT09IHdpbikgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICAvLyDnrKzkuIDmrKHlkK/liqggaGFzaGNoYW5nZSDml7blj5bkuIDkuIvvvIzkuI3og73nsbvlupPovb3lhaXlkI7nq4vljbPlj5YKICAgICAgICAvLyDpmLLmraLnsbvlupPltYzlhaXlkI7vvIzmiYvliqjkv67mlLnov4cgaGFzaO+8jAogICAgICAgIGxhc3RIYXNoID0gZ2V0SGFzaCgpOwogICAgICAgIHVybFdpdGhvdXRIYXNoID0gbG9jYXRpb24uaHJlZi5yZXBsYWNlKC8jLisvLCAnJyk7CiAgICAgICAgLy8g5LiN55So5rOo5YaMIGRvbSDkuovku7YKICAgICAgICBzZXR1cCgpOwogICAgICB9LAogICAgICB0ZWFyRG93bjogZnVuY3Rpb24gKCkgewogICAgICAgIGlmICh0aGlzICE9PSB3aW4pIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgdGVhckRvd24oKTsKICAgICAgfQogICAgfTsKICB9CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnREb21FeHRyYUxpYkV4dHJhSW5wdXQgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKgogICAqIEBpZ25vcmUKICAgKiBodG1sIGlucHV0IGV2ZW50IHBvbHlmaWxsCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUV4dHJhTGliRXh0cmFBcGk7CiAgdmFyIERvbSA9IGRvbUV4dHJhOwogIHZhciBub29wID0gZnVuY3Rpb24gKCkgewogIH07CiAgdmFyIFNwZWNpYWwgPSBEb21FdmVudC5TcGVjaWFsOwogIGZ1bmN0aW9uIGNhbkZpcmVJbnB1dChuKSB7CiAgICB2YXIgbm9kZU5hbWUgPSAobi5ub2RlTmFtZSB8fCAnJykudG9Mb3dlckNhc2UoKTsKICAgIGlmIChub2RlTmFtZSA9PT0gJ3RleHRhcmVhJykgewogICAgICByZXR1cm4gdHJ1ZTsKICAgIH0gZWxzZSBpZiAobm9kZU5hbWUgPT09ICdpbnB1dCcpIHsKICAgICAgcmV0dXJuIG4udHlwZSA9PT0gJ3RleHQnIHx8IG4udHlwZSA9PT0gJ3Bhc3N3b3JkJzsKICAgIH0KICAgIHJldHVybiBmYWxzZTsKICB9CiAgdmFyIElOUFVUX0NIQU5HRSA9ICdpbnB1dCcsIEtFWSA9ICdldmVudC1kb20vaW5wdXQnLCBISVNUT1JZX0tFWSA9IEtFWSArICcvaGlzdG9yeScsIFBPTExfS0VZID0gS0VZICsgJy9wb2xsJywgaW50ZXJ2YWwgPSA1MDsKICBmdW5jdGlvbiBjbGVhclBvbGxUaW1lcih0YXJnZXQpIHsKICAgIGlmIChEb20uaGFzRGF0YSh0YXJnZXQsIFBPTExfS0VZKSkgewogICAgICB2YXIgcG9sbCA9IERvbS5kYXRhKHRhcmdldCwgUE9MTF9LRVkpOwogICAgICBjbGVhclRpbWVvdXQocG9sbCk7CiAgICAgIERvbS5yZW1vdmVEYXRhKHRhcmdldCwgUE9MTF9LRVkpOwogICAgfQogIH0KICBmdW5jdGlvbiBzdG9wUG9sbCh0YXJnZXQpIHsKICAgIERvbS5yZW1vdmVEYXRhKHRhcmdldCwgSElTVE9SWV9LRVkpOwogICAgY2xlYXJQb2xsVGltZXIodGFyZ2V0KTsKICB9CiAgZnVuY3Rpb24gc3RvcFBvbGxIYW5kbGVyKGV2KSB7CiAgICBjbGVhclBvbGxUaW1lcihldi50YXJnZXQpOwogIH0KICBmdW5jdGlvbiBjaGVja0NoYW5nZSh0YXJnZXQpIHsKICAgIHZhciB2ID0gdGFyZ2V0LnZhbHVlLCBoID0gRG9tLmRhdGEodGFyZ2V0LCBISVNUT1JZX0tFWSk7CiAgICBpZiAodiAhPT0gaCkgewogICAgICAvLyBhbGxvdyBkZWxlZ2F0ZQogICAgICBEb21FdmVudC5maXJlKHRhcmdldCwgSU5QVVRfQ0hBTkdFKTsKICAgICAgRG9tLmRhdGEodGFyZ2V0LCBISVNUT1JZX0tFWSwgdik7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHN0YXJ0UG9sbCh0YXJnZXQpIHsKICAgIGlmIChEb20uaGFzRGF0YSh0YXJnZXQsIFBPTExfS0VZKSkgewogICAgICByZXR1cm47CiAgICB9CiAgICBEb20uZGF0YSh0YXJnZXQsIFBPTExfS0VZLCBzZXRUaW1lb3V0KGZ1bmN0aW9uIGNoZWNrKCkgewogICAgICBjaGVja0NoYW5nZSh0YXJnZXQpOwogICAgICBEb20uZGF0YSh0YXJnZXQsIFBPTExfS0VZLCBzZXRUaW1lb3V0KGNoZWNrLCBpbnRlcnZhbCkpOwogICAgfSwgaW50ZXJ2YWwpKTsKICB9CiAgZnVuY3Rpb24gc3RhcnRQb2xsSGFuZGxlcihldikgewogICAgdmFyIHRhcmdldCA9IGV2LnRhcmdldDsKICAgIC8vIHdoZW4gZm9jdXMsIHJlY29yZCBpdHMgY3VycmVudCB2YWx1ZSBpbW1lZGlhdGVseQogICAgaWYgKGV2LnR5cGUgPT09ICdmb2N1cycpIHsKICAgICAgRG9tLmRhdGEodGFyZ2V0LCBISVNUT1JZX0tFWSwgdGFyZ2V0LnZhbHVlKTsKICAgIH0KICAgIHN0YXJ0UG9sbCh0YXJnZXQpOwogIH0KICBmdW5jdGlvbiBtb25pdG9yKHRhcmdldCkgewogICAgdW5tb25pdG9yZWQodGFyZ2V0KTsKICAgIERvbUV2ZW50Lm9uKHRhcmdldCwgJ2JsdXInLCBzdG9wUG9sbEhhbmRsZXIpOwogICAgRG9tRXZlbnQub24odGFyZ2V0LCAnbW91c2Vkb3duIGtleXVwIGtleWRvd24gZm9jdXMnLCBzdGFydFBvbGxIYW5kbGVyKTsKICB9CiAgZnVuY3Rpb24gdW5tb25pdG9yZWQodGFyZ2V0KSB7CiAgICBzdG9wUG9sbCh0YXJnZXQpOwogICAgRG9tRXZlbnQuZGV0YWNoKHRhcmdldCwgJ2JsdXInLCBzdG9wUG9sbEhhbmRsZXIpOwogICAgRG9tRXZlbnQuZGV0YWNoKHRhcmdldCwgJ21vdXNlZG93biBrZXl1cCBrZXlkb3duIGZvY3VzJywgc3RhcnRQb2xsSGFuZGxlcik7CiAgfQogIFNwZWNpYWwuaW5wdXQgPSB7CiAgICBzZXR1cDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGlmIChjYW5GaXJlSW5wdXQoc2VsZikpIHsKICAgICAgICBtb25pdG9yKHNlbGYpOwogICAgICB9IGVsc2UgewogICAgICAgIC8vIGlmIGJpbmQgb24gcGFyZW50Tm9kZSwgbGF6eSBiaW5kIGV2ZW50IHRvIGl0cyBmb3JtIGVsZW1lbnRzCiAgICAgICAgRG9tRXZlbnQub24oc2VsZiwgJ2ZvY3VzaW4nLCBiZWZvcmVBY3RpdmF0ZSk7CiAgICAgIH0KICAgIH0sCiAgICB0ZWFyRG93bjogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGlmIChjYW5GaXJlSW5wdXQoc2VsZikpIHsKICAgICAgICB1bm1vbml0b3JlZChzZWxmKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBEb21FdmVudC5yZW1vdmUoc2VsZiwgJ2ZvY3VzaW4nLCBiZWZvcmVBY3RpdmF0ZSk7CiAgICAgICAgRG9tLnF1ZXJ5KCd0ZXh0YXJlYSxpbnB1dCcsIHNlbGYpLmVhY2goZnVuY3Rpb24gKGZlbCkgewogICAgICAgICAgaWYgKGZlbC5fX2lucHV0SGFuZGxlcikgewogICAgICAgICAgICBmZWwuX19pbnB1dEhhbmRsZXIgPSAwOwogICAgICAgICAgICBEb21FdmVudC5yZW1vdmUoZmVsLCAnaW5wdXQnLCBub29wKTsKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgfQogICAgfQogIH07CiAgZnVuY3Rpb24gYmVmb3JlQWN0aXZhdGUoZSkgewogICAgdmFyIHQgPSBlLnRhcmdldDsKICAgIGlmIChjYW5GaXJlSW5wdXQodCkgJiYgIXQuX19pbnB1dEhhbmRsZXIpIHsKICAgICAgdC5fX2lucHV0SGFuZGxlciA9IDE7CiAgICAgIC8vIHN0YXJ0IGlucHV0IG1vbml0b3IKICAgICAgRG9tRXZlbnQub24odCwgJ2lucHV0Jywgbm9vcCk7CiAgICB9CiAgfQogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50RG9tRXh0cmFMaWJFeHRyYU1vdXNlZW50ZXIgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIC8qKgogICAqIEBpZ25vcmUKICAgKiBldmVudC1tb3VzZWVudGVyCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgRG9tID0gZG9tQmFzZTsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUV4dHJhTGliRXh0cmFBcGk7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgU3BlY2lhbCA9IERvbUV2ZW50LlNwZWNpYWw7CiAgdXRpbC5lYWNoKFsKICAgIHsKICAgICAgbmFtZTogJ21vdXNlZW50ZXInLAogICAgICBmaXg6ICdtb3VzZW92ZXInCiAgICB9LAogICAgewogICAgICBuYW1lOiAnbW91c2VsZWF2ZScsCiAgICAgIGZpeDogJ21vdXNlb3V0JwogICAgfQogIF0sIGZ1bmN0aW9uIChvKSB7CiAgICBTcGVjaWFsW28ubmFtZV0gPSB7CiAgICAgIC8vIGZpeCAjNzUKICAgICAgdHlwZUZpeDogby5maXgsCiAgICAgIGhhbmRsZTogZnVuY3Rpb24gKGV2ZW50LCBvYnNlcnZlciwgY2UpIHsKICAgICAgICB2YXIgY3VycmVudFRhcmdldCA9IGV2ZW50LmN1cnJlbnRUYXJnZXQsIHJlbGF0ZWRUYXJnZXQgPSBldmVudC5yZWxhdGVkVGFyZ2V0OwogICAgICAgIC8vIOWcqOiHqui6q+Wklui+ueWwseinpuWPkQogICAgICAgIC8vIHNlbGYgPT09IGRvY3VtZW50LHBhcmVudCA9PT0gbnVsbAogICAgICAgIC8vIHJlbGF0ZWRUYXJnZXQg5LiOIGN1cnJlbnRUYXJnZXQg5LmL6Ze05bCx5pivIG1vdXNlZW50ZXIvbGVhdmUKICAgICAgICBpZiAoIXJlbGF0ZWRUYXJnZXQgfHwgcmVsYXRlZFRhcmdldCAhPT0gY3VycmVudFRhcmdldCAmJiAhRG9tLmNvbnRhaW5zKGN1cnJlbnRUYXJnZXQsIHJlbGF0ZWRUYXJnZXQpKSB7CiAgICAgICAgICAvLyBodHRwOi8vbXNkbi5taWNyb3NvZnQuY29tL2VuLXVzL2xpYnJhcnkvbXM1MzY5NDUodj12cy44NSkuYXNweAogICAgICAgICAgLy8gZG9lcyBub3QgYnViYmxlCiAgICAgICAgICAvLyAyMDEyLTA0LTEyIOaKiiBtb3VzZW92ZXIg6Zi75q2i5YaS5rOh5pyJ6Zeu6aKY77yBCiAgICAgICAgICAvLyA8ZGl2IGlkPScwJz48ZGl2IGlkPScxJz48ZGl2IGlkPScyJz48ZGl2IGlkPSczJz48L2Rpdj48L2Rpdj48L2Rpdj48L2Rpdj4KICAgICAgICAgIC8vIDIgbW91c2VvdmVyIOWBnOatouWGkuazoQogICAgICAgICAgLy8g54S25ZCO5b+r6YCfIDIsMSDpo57ov4fvvIzlj6/og70gMSDnmoQgbW91c2VvdmVyIOaYryAyIOWGkuazoei/h+adpeeahAogICAgICAgICAgLy8gbW91c2VvdmVyIOmHh+agt+aXtui3s+i3g+eahO+8jOWPr+iDvSAyLDEg55qEIG1vdXNlb3ZlciDkuovku7YKICAgICAgICAgIC8vIHRhcmdldCDpg73mmK8gMyzogIwgcmVsYXRlZFRhcmdldCDpg73mmK8gMAogICAgICAgICAgLy8gZXZlbnQuc3RvcFByb3BhZ2F0aW9uKCk7CiAgICAgICAgICByZXR1cm4gW29ic2VydmVyLnNpbXBsZU5vdGlmeShldmVudCwgY2UpXTsKICAgICAgICB9CiAgICAgIH0KICAgIH07CiAgfSk7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnREb21FeHRyYUxpYkV4dHJhID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgRXZlbnREb20gPSBldmVudERvbUV4dHJhTGliRXh0cmFBcGk7CiAgZXZlbnREb21FeHRyYUxpYkV4dHJhRm9jdXNpbjsKICBldmVudERvbUV4dHJhTGliRXh0cmFIYXNoY2hhbmdlOwogIGV2ZW50RG9tRXh0cmFMaWJFeHRyYUlucHV0OwogIGV2ZW50RG9tRXh0cmFMaWJFeHRyYU1vdXNlZW50ZXI7CiAgZXhwb3J0cyA9IEV2ZW50RG9tOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50RG9tRXh0cmFJbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgZXhwb3J0cyA9IGV2ZW50RG9tRXh0cmFMaWJFeHRyYTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gZXZlbnREb21FeHRyYUluZGV4Owp9KTtkZWZpbmUoImV2ZW50LWdlc3R1cmUiLCBbImV2ZW50LWRvbS1iYXNlIiwndXRpbCcsImV2ZW50LXRvdWNoIiwiZmVhdHVyZSJdLCBmdW5jdGlvbihyZXF1aXJlKSB7CnZhciBldmVudERvbUJhc2UgPSByZXF1aXJlKCJldmVudC1kb20tYmFzZSIpOwp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7CnZhciBldmVudFRvdWNoID0gcmVxdWlyZSgiZXZlbnQtdG91Y2giKTsKdmFyIGZlYXR1cmUgPSByZXF1aXJlKCJmZWF0dXJlIik7Ci8vISBDb3B5cmlnaHQgMjAxNSwgZXZlbnQtZ2VzdHVyZUA2LjEuMSBNSVQgTGljZW5zZWQsIGJ1aWxkIHRpbWU6IFRodSwgMjkgT2N0IDIwMTUgMTM6Mzk6MzQgR01UIAovKgpjb21iaW5lZCBtb2R1bGVzOgpldmVudC1nZXN0dXJlCmV2ZW50LWdlc3R1cmUvbGliL2VkZ2UtcGFuCmV2ZW50LWdlc3R1cmUvbGliL3BhbgpldmVudC1nZXN0dXJlL2xpYi9waW5jaApldmVudC1nZXN0dXJlL2xpYi9yb3RhdGUKZXZlbnQtZ2VzdHVyZS9saWIvc2hha2UKKi8KdmFyIGV2ZW50R2VzdHVyZUxpYkVkZ2VQYW4sIGV2ZW50R2VzdHVyZUxpYlBhbiwgZXZlbnRHZXN0dXJlTGliUGluY2gsIGV2ZW50R2VzdHVyZUxpYlJvdGF0ZSwgZXZlbnRHZXN0dXJlTGliU2hha2UsIGV2ZW50R2VzdHVyZUluZGV4OwpldmVudEdlc3R1cmVMaWJFZGdlUGFuID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBlZGdlIGRyYWcgZ2VzdHVyZQogICAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tCiAgICovCiAgdmFyIEdlc3R1cmVVdGlsID0gZXZlbnRUb3VjaC5fZ2VzdHVyZVV0aWw7CiAgdmFyIERvbUV2ZW50ID0gZXZlbnREb21CYXNlOwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIGFkZEdlc3R1cmVFdmVudCA9IEdlc3R1cmVVdGlsLmFkZEV2ZW50OwogIHZhciBTaW5nbGVUb3VjaCA9IEdlc3R1cmVVdGlsLlNpbmdsZVRvdWNoOwogIHZhciBFREdFX1BBTl9TVEFSVCA9ICdlZGdlUGFuU3RhcnQnLCBFREdFX1BBTiA9ICdlZGdlUGFuJywgRURHRV9QQU5fRU5EID0gJ2VkZ2VQYW5FbmQnLCBNSU5fRURHRV9ESVNUQU5DRSA9IDYwOwogIGZ1bmN0aW9uIGZpcmUoc2VsZiwgZSwgbW92ZSkgewogICAgdmFyIHRvdWNoZXMgPSBzZWxmLmxhc3RUb3VjaGVzLCB0b3VjaCA9IHRvdWNoZXNbMF0sIHggPSB0b3VjaC5wYWdlWCwgeSA9IHRvdWNoLnBhZ2VZLCBkZWx0YVggPSB4IC0gc2VsZi5zdGFydFgsIGRlbHRhWSA9IHkgLSBzZWxmLnN0YXJ0WSwgYWJzRGVsdGFYID0gTWF0aC5hYnMoZGVsdGFYKSwgYWJzRGVsdGFZID0gTWF0aC5hYnMoZGVsdGFZKSwgZGlzdGFuY2UsIGV2ZW50LCBkaXJlY3Rpb24gPSBzZWxmLmRpcmVjdGlvbjsKICAgIGlmICghZGlyZWN0aW9uKSB7CiAgICAgIGlmIChhYnNEZWx0YVggPiBhYnNEZWx0YVkpIHsKICAgICAgICBkaXJlY3Rpb24gPSBkZWx0YVggPCAwID8gJ2xlZnQnIDogJ3JpZ2h0JzsKICAgICAgfSBlbHNlIHsKICAgICAgICBkaXJlY3Rpb24gPSBkZWx0YVkgPCAwID8gJ3VwJyA6ICdkb3duJzsKICAgICAgfQogICAgICBzZWxmLmRpcmVjdGlvbiA9IGRpcmVjdGlvbjsKICAgIH0KICAgIGlmIChkaXJlY3Rpb24gPT09ICd1cCcgfHwgZGlyZWN0aW9uID09PSAnZG93bicpIHsKICAgICAgZGlzdGFuY2UgPSBhYnNEZWx0YVk7CiAgICB9IGVsc2UgewogICAgICBkaXN0YW5jZSA9IGFic0RlbHRhWDsKICAgIH0KICAgIHZhciB2ZWxvY2l0eVgsIHZlbG9jaXR5WTsKICAgIHZhciBkdXJhdGlvbiA9IGUudGltZVN0YW1wIC0gc2VsZi5zdGFydFRpbWU7CiAgICBpZiAoIW1vdmUpIHsKICAgICAgZXZlbnQgPSBFREdFX1BBTl9FTkQ7CiAgICAgIGlmIChkaXJlY3Rpb24gPT09ICdsZWZ0JyB8fCBkaXJlY3Rpb24gPT09ICdyaWdodCcpIHsKICAgICAgICB2ZWxvY2l0eVggPSBkaXN0YW5jZSAvIGR1cmF0aW9uOwogICAgICB9IGVsc2UgewogICAgICAgIHZlbG9jaXR5WSA9IGRpc3RhbmNlIC8gZHVyYXRpb247CiAgICAgIH0KICAgIH0gZWxzZSBpZiAoc2VsZi5pc1N0YXJ0ZWQpIHsKICAgICAgZXZlbnQgPSBFREdFX1BBTjsKICAgIH0gZWxzZSB7CiAgICAgIGV2ZW50ID0gRURHRV9QQU5fU1RBUlQ7CiAgICAgIHZhciB3aW4gPSB3aW5kb3c7CiAgICAgIHZhciBpbnZhbGlkUmVnaW9uID0gewogICAgICAgIGxlZnQ6IHdpbi5wYWdlWE9mZnNldCArIE1JTl9FREdFX0RJU1RBTkNFLAogICAgICAgIHJpZ2h0OiB3aW4ucGFnZVhPZmZzZXQgKyB3aW4uaW5uZXJXaWR0aCAtIE1JTl9FREdFX0RJU1RBTkNFLAogICAgICAgIHRvcDogd2luLnBhZ2VZT2Zmc2V0ICsgTUlOX0VER0VfRElTVEFOQ0UsCiAgICAgICAgYm90dG9tOiB3aW4ucGFnZVlPZmZzZXQgKyB3aW4uaW5uZXJIZWlnaHQgLSBNSU5fRURHRV9ESVNUQU5DRQogICAgICB9OwogICAgICBpZiAoZGlyZWN0aW9uID09PSAncmlnaHQnICYmIHggPiBpbnZhbGlkUmVnaW9uLmxlZnQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnbGVmdCcgJiYgeCA8IGludmFsaWRSZWdpb24ucmlnaHQpIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0gZWxzZSBpZiAoZGlyZWN0aW9uID09PSAnZG93bicgJiYgeSA+IGludmFsaWRSZWdpb24udG9wKSB7CiAgICAgICAgcmV0dXJuIGZhbHNlOwogICAgICB9IGVsc2UgaWYgKGRpcmVjdGlvbiA9PT0gJ3VwJyAmJiB5IDwgaW52YWxpZFJlZ2lvbi5ib3R0b20pIHsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgc2VsZi5pc1N0YXJ0ZWQgPSAxOwogICAgICBzZWxmLnN0YXJ0VGltZSA9IGUudGltZVN0YW1wOwogICAgfQogICAgLyoqCiAgICAgKiBmaXJlZCB3aGVuIGVkZ2UgZHJhZyBzdGFydGVkCiAgICAgKiBAZXZlbnQgRURHRV9QQU5fU1RBUlQKICAgICAqIEBtZW1iZXIgRXZlbnQuR2VzdHVyZS5FZGdlRHJhZwogICAgICogQHBhcmFtIHtFdmVudC5Eb21FdmVudC5PYmplY3R9IGUKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlLnBhZ2VYIGRyYWcgcG9pbnQgcGFnZVgKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlLnBhZ2VZIGRyYWcgcG9pbnQgcGFnZVkKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlLmRpc3RhbmNlIGRpc3RhbmNlIGJldHdlZW4gY3VycmVudCB0b3VjaCBhbmQgc3RhcnQgdG91Y2gKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlLmR1cmF0aW9uIHRpbWUgZHVyYXRpb24gYmV0d2VlbiBjdXJyZW50IHRvdWNoIGFuZCBzdGFydCB0b3VjaAogICAgICogQHBhcmFtIHtOdW1iZXJ9IGUudmVsb2NpdHlYIHZlbG9jaXR5IGF0IHgtYXhpcwogICAgICogQHBhcmFtIHtOdW1iZXJ9IGUudmVsb2NpdHlZIHZlbG9jaXR5IGF0IHktYXhpcwogICAgICogQHBhcmFtIHtTdHJpbmd9IGUuZGlyZWN0aW9uIGRyYWcgc3RhcnQgZGlyZWN0aW9uICd1cCcgb3IgJ2Rvd24nIG9yICdsZWZ0JyBvciAncmlnaHQnCiAgICAgKi8KICAgIC8qKgogICAgICogZmlyZWQgd2hlbiBlZGdlIGRyYWcKICAgICAqIEBldmVudCBFREdFX1BBTgogICAgICogQG1lbWJlciBFdmVudC5HZXN0dXJlLkVkZ2VEcmFnCiAgICAgKiBAcGFyYW0ge0V2ZW50LkRvbUV2ZW50Lk9iamVjdH0gZQogICAgICogQHBhcmFtIHtOdW1iZXJ9IGUucGFnZVggZHJhZyBwb2ludCBwYWdlWAogICAgICogQHBhcmFtIHtOdW1iZXJ9IGUucGFnZVkgZHJhZyBwb2ludCBwYWdlWQogICAgICogQHBhcmFtIHtOdW1iZXJ9IGUuZGlzdGFuY2UgZGlzdGFuY2UgYmV0d2VlbiBjdXJyZW50IHRvdWNoIGFuZCBzdGFydCB0b3VjaAogICAgICogQHBhcmFtIHtOdW1iZXJ9IGUuZHVyYXRpb24gdGltZSBkdXJhdGlvbiBiZXR3ZWVuIGN1cnJlbnQgdG91Y2ggYW5kIHN0YXJ0IHRvdWNoCiAgICAgKiBAcGFyYW0ge051bWJlcn0gZS52ZWxvY2l0eVggdmVsb2NpdHkgYXQgeC1heGlzCiAgICAgKiBAcGFyYW0ge051bWJlcn0gZS52ZWxvY2l0eVkgdmVsb2NpdHkgYXQgeS1heGlzCiAgICAgKiBAcGFyYW0ge1N0cmluZ30gZS5kaXJlY3Rpb24gZHJhZyBzdGFydCBkaXJlY3Rpb24gJ3VwJyBvciAnZG93bicgb3IgJ2xlZnQnIG9yICdyaWdodCcKICAgICAqLwogICAgLyoqCiAgICAgKiBmaXJlZCB3aGVuIGVkZ2UgZHJhZyBnZXN0dXJlIGlzIGZpbmlzaGVkCiAgICAgKiBAZXZlbnQgRURHRV9QQU5fRU5ECiAgICAgKiBAbWVtYmVyIEV2ZW50Lkdlc3R1cmUuRWRnZURyYWcKICAgICAqIEBwYXJhbSB7RXZlbnQuRG9tRXZlbnQuT2JqZWN0fSBlCiAgICAgKiBAcGFyYW0ge051bWJlcn0gZS5wYWdlWCBkcmFnIHBvaW50IHBhZ2VYCiAgICAgKiBAcGFyYW0ge051bWJlcn0gZS5wYWdlWSBkcmFnIHBvaW50IHBhZ2VZCiAgICAgKiBAcGFyYW0ge051bWJlcn0gZS5kaXN0YW5jZSBkaXN0YW5jZSBiZXR3ZWVuIGN1cnJlbnQgdG91Y2ggYW5kIHN0YXJ0IHRvdWNoCiAgICAgKiBAcGFyYW0ge051bWJlcn0gZS5kdXJhdGlvbiB0aW1lIGR1cmF0aW9uIGJldHdlZW4gY3VycmVudCB0b3VjaCBhbmQgc3RhcnQgdG91Y2gKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlLnZlbG9jaXR5WCB2ZWxvY2l0eSBhdCB4LWF4aXMKICAgICAqIEBwYXJhbSB7TnVtYmVyfSBlLnZlbG9jaXR5WSB2ZWxvY2l0eSBhdCB5LWF4aXMKICAgICAqIEBwYXJhbSB7U3RyaW5nfSBlLmRpcmVjdGlvbiBkcmFnIHN0YXJ0IGRpcmVjdGlvbiAndXAnIG9yICdkb3duJyBvciAnbGVmdCcgb3IgJ3JpZ2h0JwogICAgICovCiAgICBEb21FdmVudC5maXJlKHRvdWNoLnRhcmdldCwgZXZlbnQsIHsKICAgICAgb3JpZ2luYWxFdmVudDogZS5vcmlnaW5hbEV2ZW50LAogICAgICBwYWdlWDogdG91Y2gucGFnZVgsCiAgICAgIHBhZ2VZOiB0b3VjaC5wYWdlWSwKICAgICAgd2hpY2g6IDEsCiAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLAogICAgICBkaXN0YW5jZTogZGlzdGFuY2UsCiAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbiAvIDEwMDAsCiAgICAgIHZlbG9jaXR5WDogdmVsb2NpdHlYLAogICAgICB2ZWxvY2l0eVk6IHZlbG9jaXR5WQogICAgfSk7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KICBmdW5jdGlvbiBFZGdlRHJhZygpIHsKICB9CiAgdXRpbC5leHRlbmQoRWRnZURyYWcsIFNpbmdsZVRvdWNoLCB7CiAgICByZXF1aXJlZEdlc3R1cmVUeXBlOiAndG91Y2gnLAogICAgc3RhcnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBFZGdlRHJhZy5zdXBlcmNsYXNzLnN0YXJ0LmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7CiAgICAgIHZhciB0b3VjaCA9IHNlbGYubGFzdFRvdWNoZXNbMF07CiAgICAgIHNlbGYuZGlyZWN0aW9uID0gbnVsbDsKICAgICAgc2VsZi5zdGFydFggPSB0b3VjaC5wYWdlWDsKICAgICAgc2VsZi5zdGFydFkgPSB0b3VjaC5wYWdlWTsKICAgIH0sCiAgICBtb3ZlOiBmdW5jdGlvbiAoZSkgewogICAgICBFZGdlRHJhZy5zdXBlcmNsYXNzLm1vdmUuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgcmV0dXJuIGZpcmUodGhpcywgZSwgMSk7CiAgICB9LAogICAgZW5kOiBmdW5jdGlvbiAoZSkgewogICAgICBFZGdlRHJhZy5zdXBlcmNsYXNzLmVuZC5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogICAgICByZXR1cm4gZmlyZSh0aGlzLCBlLCAwKTsKICAgIH0KICB9KTsKICBhZGRHZXN0dXJlRXZlbnQoWwogICAgRURHRV9QQU4sCiAgICBFREdFX1BBTl9FTkQsCiAgICBFREdFX1BBTl9TVEFSVAogIF0sIHsgaGFuZGxlOiBuZXcgRWRnZURyYWcoKSB9KTsKICBleHBvcnRzID0gewogICAgRURHRV9QQU46IEVER0VfUEFOLAogICAgRURHRV9QQU5fU1RBUlQ6IEVER0VfUEFOX1NUQVJULAogICAgRURHRV9QQU5fRU5EOiBFREdFX1BBTl9FTkQKICB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50R2VzdHVyZUxpYlBhbiA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIEdlc3R1cmVVdGlsID0gZXZlbnRUb3VjaC5fZ2VzdHVyZVV0aWw7CiAgdmFyIERvbUV2ZW50ID0gZXZlbnREb21CYXNlOwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIGFkZEdlc3R1cmVFdmVudCA9IEdlc3R1cmVVdGlsLmFkZEV2ZW50OwogIHZhciBTaW5nbGVUb3VjaCA9IEdlc3R1cmVVdGlsLlNpbmdsZVRvdWNoOwogIHZhciBQQU5fU1RBUlQgPSAncGFuU3RhcnQnLCBQQU5fRU5EID0gJ3BhbkVuZCcsIFBBTiA9ICdwYW4nLCBTQU1QTEVfSU5URVJWQUwgPSAzMDAsIE1JTl9ESVNUQU5DRSA9IDM7CiAgdmFyIGRvYyA9IGRvY3VtZW50OwogIGZ1bmN0aW9uIGdldERpc3RhbmNlKHAxLCBwMikgewogICAgdmFyIGRlbHRhWCA9IHAxLnBhZ2VYIC0gcDIucGFnZVgsIGRlbHRhWSA9IHAxLnBhZ2VZIC0gcDIucGFnZVk7CiAgICByZXR1cm4gTWF0aC5zcXJ0KGRlbHRhWCAqIGRlbHRhWCArIGRlbHRhWSAqIGRlbHRhWSk7CiAgfQogIGZ1bmN0aW9uIHN0YXJ0RHJhZyhzZWxmLCBlKSB7CiAgICB2YXIgY3VycmVudFRvdWNoID0gc2VsZi5sYXN0VG91Y2hlc1swXTsKICAgIHZhciBzdGFydFBvcyA9IHNlbGYuc3RhcnRQb3M7CiAgICBpZiAoIXNlbGYuZGlyZWN0aW9uKSB7CiAgICAgIHZhciBkZWx0YVggPSBlLnBhZ2VYIC0gc2VsZi5zdGFydFBvcy5wYWdlWCwgZGVsdGFZID0gZS5wYWdlWSAtIHNlbGYuc3RhcnRQb3MucGFnZVksIGFic0RlbHRhWCA9IE1hdGguYWJzKGRlbHRhWCksIGFic0RlbHRhWSA9IE1hdGguYWJzKGRlbHRhWSk7CiAgICAgIGlmIChhYnNEZWx0YVggPiBhYnNEZWx0YVkpIHsKICAgICAgICBzZWxmLmRpcmVjdGlvbiA9IGRlbHRhWCA8IDAgPyAnbGVmdCcgOiAncmlnaHQnOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYuZGlyZWN0aW9uID0gZGVsdGFZIDwgMCA/ICd1cCcgOiAnZG93bic7CiAgICAgIH0KICAgIH0KICAgIGlmIChnZXREaXN0YW5jZShjdXJyZW50VG91Y2gsIHN0YXJ0UG9zKSA+IE1JTl9ESVNUQU5DRSkgewogICAgICBpZiAoc2VsZi5pc1N0YXJ0ZWQpIHsKICAgICAgICBzYW1wbGUoc2VsZiwgZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGRvYy5ib2R5LnNldENhcHR1cmUpIHsKICAgICAgICAgIGRvYy5ib2R5LnNldENhcHR1cmUoKTsKICAgICAgICB9CiAgICAgICAgc2VsZi5pc1N0YXJ0ZWQgPSB0cnVlOwogICAgICB9CiAgICAgIERvbUV2ZW50LmZpcmUoc2VsZi5kcmFnVGFyZ2V0LCBQQU5fU1RBUlQsIGdldEV2ZW50T2JqZWN0KHNlbGYsIGUpKTsKICAgIH0gZWxzZSB7CiAgICB9CiAgfQogIGZ1bmN0aW9uIHNhbXBsZShzZWxmLCBlKSB7CiAgICB2YXIgY3VycmVudFRvdWNoID0gc2VsZi5sYXN0VG91Y2hlc1swXTsKICAgIHZhciBjdXJyZW50VGltZSA9IGUudGltZVN0YW1wOwogICAgaWYgKGN1cnJlbnRUaW1lIC0gc2VsZi5sYXN0VGltZSA+IFNBTVBMRV9JTlRFUlZBTCkgewogICAgICBzZWxmLmxhc3RQb3MgPSB7CiAgICAgICAgcGFnZVg6IGN1cnJlbnRUb3VjaC5wYWdlWCwKICAgICAgICBwYWdlWTogY3VycmVudFRvdWNoLnBhZ2VZCiAgICAgIH07CiAgICAgIHNlbGYubGFzdFRpbWUgPSBjdXJyZW50VGltZTsKICAgIH0KICB9CiAgZnVuY3Rpb24gZ2V0RXZlbnRPYmplY3Qoc2VsZiwgZSwgcmV0KSB7CiAgICB2YXIgc3RhcnRQb3MgPSBzZWxmLnN0YXJ0UG9zOwogICAgcmV0ID0gcmV0IHx8IHt9OwogICAgdmFyIGN1cnJlbnRUb3VjaCA9IHNlbGYubGFzdFRvdWNoZXNbMF07CiAgICByZXQud2hpY2ggPSAxOwogICAgcmV0LnBhZ2VYID0gY3VycmVudFRvdWNoLnBhZ2VYOwogICAgcmV0LnBhZ2VZID0gY3VycmVudFRvdWNoLnBhZ2VZOwogICAgcmV0Lm9yaWdpbmFsRXZlbnQgPSBlLm9yaWdpbmFsRXZlbnQ7CiAgICByZXQuZGVsdGFYID0gY3VycmVudFRvdWNoLnBhZ2VYIC0gc3RhcnRQb3MucGFnZVg7CiAgICByZXQuZGVsdGFZID0gY3VycmVudFRvdWNoLnBhZ2VZIC0gc3RhcnRQb3MucGFnZVk7CiAgICByZXQuc3RhcnRUaW1lID0gc2VsZi5zdGFydFRpbWU7CiAgICByZXQuc3RhcnRQb3MgPSBzZWxmLnN0YXJ0UG9zOwogICAgcmV0Lmdlc3R1cmVUeXBlID0gZS5nZXN0dXJlVHlwZTsKICAgIHJldC5kaXJlY3Rpb24gPSBzZWxmLmRpcmVjdGlvbjsKICAgIHJldHVybiByZXQ7CiAgfQogIGZ1bmN0aW9uIERyYWcoKSB7CiAgfQogIHV0aWwuZXh0ZW5kKERyYWcsIFNpbmdsZVRvdWNoLCB7CiAgICBzdGFydDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIERyYWcuc3VwZXJjbGFzcy5zdGFydC5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogICAgICB2YXIgdG91Y2ggPSBzZWxmLmxhc3RUb3VjaGVzWzBdOwogICAgICBzZWxmLmxhc3RUaW1lID0gc2VsZi5zdGFydFRpbWU7CiAgICAgIHNlbGYuZHJhZ1RhcmdldCA9IHRvdWNoLnRhcmdldDsKICAgICAgc2VsZi5zdGFydFBvcyA9IHNlbGYubGFzdFBvcyA9IHsKICAgICAgICBwYWdlWDogdG91Y2gucGFnZVgsCiAgICAgICAgcGFnZVk6IHRvdWNoLnBhZ2VZCiAgICAgIH07CiAgICAgIHNlbGYuZGlyZWN0aW9uID0gbnVsbDsKICAgIH0sCiAgICBtb3ZlOiBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIERyYWcuc3VwZXJjbGFzcy5tb3ZlLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7CiAgICAgIGlmICghc2VsZi5pc1N0YXJ0ZWQpIHsKICAgICAgICBzdGFydERyYWcoc2VsZiwgZSk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgc2FtcGxlKHNlbGYsIGUpOwogICAgICAgIERvbUV2ZW50LmZpcmUoc2VsZi5kcmFnVGFyZ2V0LCBQQU4sIGdldEV2ZW50T2JqZWN0KHNlbGYsIGUpKTsKICAgICAgfQogICAgfSwKICAgIGVuZDogZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB2YXIgY3VycmVudFRvdWNoID0gc2VsZi5sYXN0VG91Y2hlc1swXTsKICAgICAgdmFyIGN1cnJlbnRUaW1lID0gZS50aW1lU3RhbXA7CiAgICAgIHZhciB2ZWxvY2l0eVggPSAoY3VycmVudFRvdWNoLnBhZ2VYIC0gc2VsZi5sYXN0UG9zLnBhZ2VYKSAvIChjdXJyZW50VGltZSAtIHNlbGYubGFzdFRpbWUpOwogICAgICB2YXIgdmVsb2NpdHlZID0gKGN1cnJlbnRUb3VjaC5wYWdlWSAtIHNlbGYubGFzdFBvcy5wYWdlWSkgLyAoY3VycmVudFRpbWUgLSBzZWxmLmxhc3RUaW1lKTsKICAgICAgRG9tRXZlbnQuZmlyZShzZWxmLmRyYWdUYXJnZXQsIFBBTl9FTkQsIGdldEV2ZW50T2JqZWN0KHNlbGYsIGUsIHsKICAgICAgICB2ZWxvY2l0eVg6IHZlbG9jaXR5WCB8fCAwLAogICAgICAgIHZlbG9jaXR5WTogdmVsb2NpdHlZIHx8IDAKICAgICAgfSkpOwogICAgICBpZiAoZG9jLmJvZHkucmVsZWFzZUNhcHR1cmUpIHsKICAgICAgICBkb2MuYm9keS5yZWxlYXNlQ2FwdHVyZSgpOwogICAgICB9CiAgICB9CiAgfSk7CiAgYWRkR2VzdHVyZUV2ZW50KFsKICAgIFBBTl9TVEFSVCwKICAgIFBBTiwKICAgIFBBTl9FTkQKICBdLCB7IGhhbmRsZTogbmV3IERyYWcoKSB9KTsKICBleHBvcnRzID0gewogICAgUEFOX1NUQVJUOiBQQU5fU1RBUlQsCiAgICBQQU46IFBBTiwKICAgIFBBTl9FTkQ6IFBBTl9FTkQKICB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50R2VzdHVyZUxpYlBpbmNoID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgR2VzdHVyZVV0aWwgPSBldmVudFRvdWNoLl9nZXN0dXJlVXRpbDsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUJhc2U7CiAgdmFyIEZlYXR1cmUgPSBmZWF0dXJlOwogIHZhciB1dGlsID0gdXRpbEJhc2U7CiAgdmFyIERvdWJsZVRvdWNoID0gR2VzdHVyZVV0aWwuRG91YmxlVG91Y2g7CiAgdmFyIGFkZEdlc3R1cmVFdmVudCA9IEdlc3R1cmVVdGlsLmFkZEV2ZW50OwogIHZhciBQSU5DSCA9ICdwaW5jaCcsIFBJTkNIX1NUQVJUID0gJ3BpbmNoU3RhcnQnLCBQSU5DSF9FTkQgPSAncGluY2hFbmQnOwogIGZ1bmN0aW9uIGdldERpc3RhbmNlKHAxLCBwMikgewogICAgdmFyIGRlbHRhWCA9IHAxLnBhZ2VYIC0gcDIucGFnZVgsIGRlbHRhWSA9IHAxLnBhZ2VZIC0gcDIucGFnZVk7CiAgICByZXR1cm4gTWF0aC5zcXJ0KGRlbHRhWCAqIGRlbHRhWCArIGRlbHRhWSAqIGRlbHRhWSk7CiAgfQogIGZ1bmN0aW9uIFBpbmNoKCkgewogIH0KICB1dGlsLmV4dGVuZChQaW5jaCwgRG91YmxlVG91Y2gsIHsKICAgIHJlcXVpcmVkR2VzdHVyZVR5cGU6ICd0b3VjaCcsCiAgICBtb3ZlOiBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIFBpbmNoLnN1cGVyY2xhc3MubW92ZS5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogICAgICB2YXIgdG91Y2hlcyA9IHNlbGYubGFzdFRvdWNoZXM7CiAgICAgIGlmICghKHRvdWNoZXNbMF0ucGFnZVggPiAwICYmIHRvdWNoZXNbMF0ucGFnZVkgPiAwICYmIHRvdWNoZXNbMV0ucGFnZVggPiAwICYmIHRvdWNoZXNbMV0ucGFnZVkgPiAwKSkgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICB2YXIgZGlzdGFuY2UgPSBnZXREaXN0YW5jZSh0b3VjaGVzWzBdLCB0b3VjaGVzWzFdKTsKICAgICAgaWYgKCFzZWxmLmlzU3RhcnRlZCkgewogICAgICAgIHNlbGYuaXNTdGFydGVkID0gdHJ1ZTsKICAgICAgICBzZWxmLnN0YXJ0RGlzdGFuY2UgPSBkaXN0YW5jZTsKICAgICAgICB2YXIgdGFyZ2V0ID0gc2VsZi50YXJnZXQgPSBzZWxmLmdldENvbW1vblRhcmdldChlKTsKICAgICAgICBEb21FdmVudC5maXJlKHRhcmdldCwgUElOQ0hfU1RBUlQsIHV0aWwubWl4KGUsIHsKICAgICAgICAgIGRpc3RhbmNlOiBkaXN0YW5jZSwKICAgICAgICAgIHNjYWxlOiAxCiAgICAgICAgfSkpOwogICAgICB9IGVsc2UgewogICAgICAgIERvbUV2ZW50LmZpcmUoc2VsZi50YXJnZXQsIFBJTkNILCB1dGlsLm1peChlLCB7CiAgICAgICAgICBkaXN0YW5jZTogZGlzdGFuY2UsCiAgICAgICAgICBzY2FsZTogZGlzdGFuY2UgLyBzZWxmLnN0YXJ0RGlzdGFuY2UKICAgICAgICB9KSk7CiAgICAgIH0KICAgIH0sCiAgICBlbmQ6IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgUGluY2guc3VwZXJjbGFzcy5lbmQuYXBwbHkoc2VsZiwgYXJndW1lbnRzKTsKICAgICAgRG9tRXZlbnQuZmlyZShzZWxmLnRhcmdldCwgUElOQ0hfRU5ELCB1dGlsLm1peChlLCB7IHRvdWNoZXM6IHNlbGYubGFzdFRvdWNoZXMgfSkpOwogICAgfQogIH0pOwogIHZhciBwID0gbmV3IFBpbmNoKCk7CiAgYWRkR2VzdHVyZUV2ZW50KFsKICAgIFBJTkNIX1NUQVJULAogICAgUElOQ0hfRU5ECiAgXSwgeyBoYW5kbGU6IHAgfSk7CiAgZnVuY3Rpb24gcHJldmVudChlKSB7CiAgICBpZiAoZS50YXJnZXRUb3VjaGVzLmxlbmd0aCA9PT0gMikgewogICAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgICB9CiAgfQogIHZhciBjb25maWcgPSB7IGhhbmRsZTogcCB9OwogIGlmIChGZWF0dXJlLmlzVG91Y2hFdmVudFN1cHBvcnRlZCgpKSB7CiAgICBjb25maWcuc2V0dXAgPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMuYWRkRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgcHJldmVudCwgZmFsc2UpOwogICAgfTsKICAgIGNvbmZpZy50ZWFyRG93biA9IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5yZW1vdmVFdmVudExpc3RlbmVyKCd0b3VjaG1vdmUnLCBwcmV2ZW50LCBmYWxzZSk7CiAgICB9OwogIH0KICBhZGRHZXN0dXJlRXZlbnQoUElOQ0gsIGNvbmZpZyk7CiAgZXhwb3J0cyA9IHsKICAgIFBJTkNIOiBQSU5DSCwKICAgIFBJTkNIX1NUQVJUOiBQSU5DSF9TVEFSVCwKICAgIFBJTkNIX0VORDogUElOQ0hfRU5ECiAgfTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpldmVudEdlc3R1cmVMaWJSb3RhdGUgPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBHZXN0dXJlVXRpbCA9IGV2ZW50VG91Y2guX2dlc3R1cmVVdGlsOwogIHZhciBEb21FdmVudCA9IGV2ZW50RG9tQmFzZTsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBGZWF0dXJlID0gZmVhdHVyZTsKICB2YXIgRG91YmxlVG91Y2ggPSBHZXN0dXJlVXRpbC5Eb3VibGVUb3VjaDsKICB2YXIgYWRkR2VzdHVyZUV2ZW50ID0gR2VzdHVyZVV0aWwuYWRkRXZlbnQ7CiAgdmFyIFJPVEFURV9TVEFSVCA9ICdyb3RhdGVTdGFydCcsIFJPVEFURSA9ICdyb3RhdGUnLCBSQURfMl9ERUcgPSAxODAgLyBNYXRoLlBJLCBST1RBVEVfRU5EID0gJ3JvdGF0ZUVuZCc7CiAgZnVuY3Rpb24gUm90YXRlKCkgewogIH0KICB1dGlsLmV4dGVuZChSb3RhdGUsIERvdWJsZVRvdWNoLCB7CiAgICByZXF1aXJlZEdlc3R1cmVUeXBlOiAndG91Y2gnLAogICAgbW92ZTogZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBSb3RhdGUuc3VwZXJjbGFzcy5tb3ZlLmFwcGx5KHNlbGYsIGFyZ3VtZW50cyk7CiAgICAgIHZhciB0b3VjaGVzID0gc2VsZi5sYXN0VG91Y2hlcywgb25lID0gdG91Y2hlc1swXSwgdHdvID0gdG91Y2hlc1sxXSwgbGFzdEFuZ2xlID0gc2VsZi5sYXN0QW5nbGUsIGFuZ2xlID0gTWF0aC5hdGFuMih0d28ucGFnZVkgLSBvbmUucGFnZVksIHR3by5wYWdlWCAtIG9uZS5wYWdlWCkgKiBSQURfMl9ERUc7CiAgICAgIGlmIChsYXN0QW5nbGUgIT09IHVuZGVmaW5lZCkgewogICAgICAgIHZhciBkaWZmID0gTWF0aC5hYnMoYW5nbGUgLSBsYXN0QW5nbGUpOwogICAgICAgIHZhciBwb3NpdGl2ZUFuZ2xlID0gKGFuZ2xlICsgMzYwKSAlIDM2MDsKICAgICAgICB2YXIgbmVnYXRpdmVBbmdsZSA9IChhbmdsZSAtIDM2MCkgJSAzNjA7CiAgICAgICAgaWYgKE1hdGguYWJzKHBvc2l0aXZlQW5nbGUgLSBsYXN0QW5nbGUpIDwgZGlmZikgewogICAgICAgICAgYW5nbGUgPSBwb3NpdGl2ZUFuZ2xlOwogICAgICAgIH0gZWxzZSBpZiAoTWF0aC5hYnMobmVnYXRpdmVBbmdsZSAtIGxhc3RBbmdsZSkgPCBkaWZmKSB7CiAgICAgICAgICBhbmdsZSA9IG5lZ2F0aXZlQW5nbGU7CiAgICAgICAgfQogICAgICB9CiAgICAgIHNlbGYubGFzdEFuZ2xlID0gYW5nbGU7CiAgICAgIGlmICghc2VsZi5pc1N0YXJ0ZWQpIHsKICAgICAgICBzZWxmLmlzU3RhcnRlZCA9IHRydWU7CiAgICAgICAgc2VsZi5zdGFydEFuZ2xlID0gYW5nbGU7CiAgICAgICAgc2VsZi50YXJnZXQgPSBzZWxmLmdldENvbW1vblRhcmdldChlKTsKICAgICAgICBEb21FdmVudC5maXJlKHNlbGYudGFyZ2V0LCBST1RBVEVfU1RBUlQsIHV0aWwubWl4KGUsIHsKICAgICAgICAgIGFuZ2xlOiBhbmdsZSwKICAgICAgICAgIHJvdGF0aW9uOiAwCiAgICAgICAgfSkpOwogICAgICB9IGVsc2UgewogICAgICAgIERvbUV2ZW50LmZpcmUoc2VsZi50YXJnZXQsIFJPVEFURSwgdXRpbC5taXgoZSwgewogICAgICAgICAgYW5nbGU6IGFuZ2xlLAogICAgICAgICAgcm90YXRpb246IGFuZ2xlIC0gc2VsZi5zdGFydEFuZ2xlCiAgICAgICAgfSkpOwogICAgICB9CiAgICB9LAogICAgZW5kOiBmdW5jdGlvbiAoZSkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIFJvdGF0ZS5zdXBlcmNsYXNzLmVuZC5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogICAgICBzZWxmLmxhc3RBbmdsZSA9IHVuZGVmaW5lZDsKICAgICAgRG9tRXZlbnQuZmlyZShzZWxmLnRhcmdldCwgUk9UQVRFX0VORCwgdXRpbC5taXgoZSwgeyB0b3VjaGVzOiBzZWxmLmxhc3RUb3VjaGVzIH0pKTsKICAgIH0KICB9KTsKICBmdW5jdGlvbiBwcmV2ZW50KGUpIHsKICAgIGlmIChlLnRhcmdldFRvdWNoZXMubGVuZ3RoID09PSAyKSB7CiAgICAgIGUucHJldmVudERlZmF1bHQoKTsKICAgIH0KICB9CiAgdmFyIHIgPSBuZXcgUm90YXRlKCk7CiAgYWRkR2VzdHVyZUV2ZW50KFsKICAgIFJPVEFURV9FTkQsCiAgICBST1RBVEVfU1RBUlQKICBdLCB7IGhhbmRsZTogciB9KTsKICB2YXIgY29uZmlnID0geyBoYW5kbGU6IHIgfTsKICBpZiAoRmVhdHVyZS5pc1RvdWNoRXZlbnRTdXBwb3J0ZWQoKSkgewogICAgY29uZmlnLnNldHVwID0gZnVuY3Rpb24gKCkgewogICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIHByZXZlbnQsIGZhbHNlKTsKICAgIH07CiAgICBjb25maWcudGVhckRvd24gPSBmdW5jdGlvbiAoKSB7CiAgICAgIHRoaXMucmVtb3ZlRXZlbnRMaXN0ZW5lcigndG91Y2htb3ZlJywgcHJldmVudCwgZmFsc2UpOwogICAgfTsKICB9CiAgYWRkR2VzdHVyZUV2ZW50KFJPVEFURSwgY29uZmlnKTsKICBleHBvcnRzID0gewogICAgUk9UQVRFX1NUQVJUOiBST1RBVEVfU1RBUlQsCiAgICBST1RBVEU6IFJPVEFURSwKICAgIFJPVEFURV9FTkQ6IFJPVEFURV9FTkQKICB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50R2VzdHVyZUxpYlNoYWtlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUJhc2U7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgU3BlY2lhbCA9IERvbUV2ZW50LlNwZWNpYWwsIHN0YXJ0ID0gNSwgZW5vdWdoID0gMjAsIHNoYWtpbmcgPSAwLCBTSEFLRSA9ICdzaGFrZScsIGxhc3RYLCBsYXN0WSwgbGFzdFosIG1heCA9IE1hdGgubWF4LCBhYnMgPSBNYXRoLmFicywgd2luID0gd2luZG93LCBkZXZpY2Vtb3Rpb24gPSAnZGV2aWNlbW90aW9uJywgY2hlY2tTaGFrZSA9IHV0aWwuYnVmZmVyKGZ1bmN0aW9uICgpIHsKICAgICAgaWYgKHNoYWtpbmcpIHsKICAgICAgICBEb21FdmVudC5maXJlSGFuZGxlcih3aW4sIFNIQUtFLCB7CiAgICAgICAgICBhY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5OiB7CiAgICAgICAgICAgIHg6IGxhc3RYLAogICAgICAgICAgICB5OiBsYXN0WSwKICAgICAgICAgICAgejogbGFzdFoKICAgICAgICAgIH0KICAgICAgICB9KTsKICAgICAgICBjbGVhcigpOwogICAgICB9CiAgICB9LCAyNTApOwogIFNwZWNpYWwuc2hha2UgPSB7CiAgICBzZXR1cDogZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcyAhPT0gd2luKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIHdpbi5hZGRFdmVudExpc3RlbmVyKGRldmljZW1vdGlvbiwgc2hha2UsIGZhbHNlKTsKICAgIH0sCiAgICB0ZWFyRG93bjogZnVuY3Rpb24gKCkgewogICAgICBpZiAodGhpcyAhPT0gd2luKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CiAgICAgIGNoZWNrU2hha2Uuc3RvcCgpOwogICAgICBjbGVhcigpOwogICAgICB3aW4ucmVtb3ZlRXZlbnRMaXN0ZW5lcihkZXZpY2Vtb3Rpb24sIHNoYWtlLCBmYWxzZSk7CiAgICB9CiAgfTsKICBmdW5jdGlvbiBjbGVhcigpIHsKICAgIGxhc3RYID0gdW5kZWZpbmVkOwogICAgc2hha2luZyA9IDA7CiAgfQogIGZ1bmN0aW9uIHNoYWtlKGUpIHsKICAgIHZhciBhY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5ID0gZS5hY2NlbGVyYXRpb25JbmNsdWRpbmdHcmF2aXR5LCB4ID0gYWNjZWxlcmF0aW9uSW5jbHVkaW5nR3Jhdml0eS54LCB5ID0gYWNjZWxlcmF0aW9uSW5jbHVkaW5nR3Jhdml0eS55LCB6ID0gYWNjZWxlcmF0aW9uSW5jbHVkaW5nR3Jhdml0eS56LCBkaWZmOwogICAgaWYgKGxhc3RYICE9PSB1bmRlZmluZWQpIHsKICAgICAgZGlmZiA9IG1heChhYnMoeCAtIGxhc3RYKSwgYWJzKHkgLSBsYXN0WSksIGFicyh6IC0gbGFzdFopKTsKICAgICAgaWYgKGRpZmYgPiBzdGFydCkgewogICAgICAgIGNoZWNrU2hha2UoKTsKICAgICAgfQogICAgICBpZiAoZGlmZiA+IGVub3VnaCkgewogICAgICAgIHNoYWtpbmcgPSAxOwogICAgICB9CiAgICB9CiAgICBsYXN0WCA9IHg7CiAgICBsYXN0WSA9IHk7CiAgICBsYXN0WiA9IHo7CiAgfQogIGV4cG9ydHMgPSB7IFNIQUtFOiBTSEFLRSB9OwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50R2VzdHVyZUluZGV4ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBkb21FdmVudCA9IGV2ZW50RG9tQmFzZTsKICB2YXIgVG91Y2hFdmVudCA9IGV2ZW50VG91Y2g7CiAgdmFyIEVkZ2VQYW5HZXN0dXJlRXZlbnQgPSBldmVudEdlc3R1cmVMaWJFZGdlUGFuOwogIHZhciBQYW5HZXN0dXJlRXZlbnQgPSBldmVudEdlc3R1cmVMaWJQYW47CiAgdmFyIFBpbmNoR2VzdHVyZUV2ZW50ID0gZXZlbnRHZXN0dXJlTGliUGluY2g7CiAgdmFyIFJvdGF0ZUdlc3R1cmVFdmVudCA9IGV2ZW50R2VzdHVyZUxpYlJvdGF0ZTsKICB2YXIgU2hha2VHZXN0dXJlRXZlbnQgPSBldmVudEdlc3R1cmVMaWJTaGFrZTsKICB2YXIgR2VzdHVyZUV2ZW50ID0gewogICAgRWRnZVBhbkdlc3R1cmVFdmVudDogRWRnZVBhbkdlc3R1cmVFdmVudCwKICAgIFBhbkdlc3R1cmVFdmVudDogUGFuR2VzdHVyZUV2ZW50LAogICAgUGluY2hHZXN0dXJlRXZlbnQ6IFBpbmNoR2VzdHVyZUV2ZW50LAogICAgUm90YXRlR2VzdHVyZUV2ZW50OiBSb3RhdGVHZXN0dXJlRXZlbnQsCiAgICBTaGFrZUdlc3R1cmVFdmVudDogU2hha2VHZXN0dXJlRXZlbnQKICB9OwogIHV0aWwubWl4KEdlc3R1cmVFdmVudCwgVG91Y2hFdmVudCk7CiAgdXRpbC5taXgoZG9tRXZlbnQsIEdlc3R1cmVFdmVudCk7CiAgZXhwb3J0cyA9IEdlc3R1cmVFdmVudDsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gZXZlbnRHZXN0dXJlSW5kZXg7Cn0pO2RlZmluZSgiZXZlbnQtdG91Y2giLCBbJ3V0aWwnLCdkb20nLCJldmVudC1kb20tYmFzZSIsImZlYXR1cmUiXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7CnZhciBkb21CYXNlID0gcmVxdWlyZSgnZG9tJyk7CnZhciBldmVudERvbUJhc2UgPSByZXF1aXJlKCJldmVudC1kb20tYmFzZSIpOwp2YXIgZmVhdHVyZSA9IHJlcXVpcmUoImZlYXR1cmUiKTsKLy8hIENvcHlyaWdodCAyMDE1LCBldmVudC10b3VjaEA2LjEuMiBNSVQgTGljZW5zZWQsIGJ1aWxkIHRpbWU6IFRodSwgMjkgT2N0IDIwMTUgMTM6NDA6MDggR01UIAovKgpjb21iaW5lZCBtb2R1bGVzOgpldmVudC10b3VjaApldmVudC10b3VjaC9saWIvYmFzaWMKZXZlbnQtdG91Y2gvbGliL3V0aWwKZXZlbnQtdG91Y2gvbGliL3V0aWwvYWRkLWV2ZW50CmV2ZW50LXRvdWNoL2xpYi91dGlsL3RvdWNoCmV2ZW50LXRvdWNoL2xpYi91dGlsL3NpbmdsZS10b3VjaApldmVudC10b3VjaC9saWIvdXRpbC9kb3VibGUtdG91Y2gKZXZlbnQtdG91Y2gvbGliL3N3aXBlCmV2ZW50LXRvdWNoL2xpYi90YXAKKi8KdmFyIGV2ZW50VG91Y2hMaWJVdGlsQWRkRXZlbnQsIGV2ZW50VG91Y2hMaWJVdGlsVG91Y2gsIGV2ZW50VG91Y2hMaWJVdGlsU2luZ2xlVG91Y2gsIGV2ZW50VG91Y2hMaWJVdGlsRG91YmxlVG91Y2gsIGV2ZW50VG91Y2hMaWJVdGlsLCBldmVudFRvdWNoTGliU3dpcGUsIGV2ZW50VG91Y2hMaWJUYXAsIGV2ZW50VG91Y2hMaWJCYXNpYywgZXZlbnRUb3VjaEluZGV4OwpldmVudFRvdWNoTGliVXRpbEFkZEV2ZW50ID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlCiAgICogYmFzZSBoYW5kbGUgZm9yIHRvdWNoIGdlc3R1cmUsIG1vdXNlIGFuZCB0b3VjaCBub3JtYWxpemF0aW9uCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBldmVudEhhbmRsZU1hcCA9IHt9OwogIHZhciBEb21FdmVudCA9IGV2ZW50RG9tQmFzZTsKICB2YXIgU3BlY2lhbCA9IERvbUV2ZW50LlNwZWNpYWw7CiAgdmFyIGtleSA9IHV0aWwuZ3VpZCgndG91Y2gtaGFuZGxlJyksIEZlYXR1cmUgPSBmZWF0dXJlLCBnZXN0dXJlU3RhcnRFdmVudCwgZ2VzdHVyZU1vdmVFdmVudCwgZ2VzdHVyZUVuZEV2ZW50OwogIHZhciBpb3MgPSAvaVBhZHxpUGhvbmV8aVBvZC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKICBmdW5jdGlvbiBpc1RvdWNoRXZlbnQodHlwZSkgewogICAgcmV0dXJuIHV0aWwuc3RhcnRzV2l0aCh0eXBlLCAndG91Y2gnKTsKICB9CiAgZnVuY3Rpb24gaXNNb3VzZUV2ZW50KHR5cGUpIHsKICAgIHJldHVybiB1dGlsLnN0YXJ0c1dpdGgodHlwZSwgJ21vdXNlJyk7CiAgfQogIGZ1bmN0aW9uIGlzUG9pbnRlckV2ZW50KHR5cGUpIHsKICAgIHJldHVybiB1dGlsLnN0YXJ0c1dpdGgodHlwZSwgJ01TUG9pbnRlcicpIHx8IHV0aWwuc3RhcnRzV2l0aCh0eXBlLCAncG9pbnRlcicpOwogIH0KICAvLyBUaGlzIHNob3VsZCBiZSBsb25nIGVub3VnaCB0byBpZ25vcmUgY29tcGF0aWJsZSBtb3VzZSBldmVudHMgbWFkZSBieSB0b3VjaAogIHZhciBEVVBfVElNRU9VVCA9IDI1MDA7CiAgLy8gcmFkaXVzIGFyb3VuZCB0b3VjaGVuZCB0aGF0IHN3YWxsb3dzIG1vdXNlIGV2ZW50cwogIHZhciBEVVBfRElTVCA9IDI1OwogIGlmIChGZWF0dXJlLmlzVG91Y2hFdmVudFN1cHBvcnRlZCgpKSB7CiAgICBpZiAoaW9zKSB7CiAgICAgIC8vIGlvcyBtb3VzZWRvd24gaXMgYnVnZ3kKICAgICAgZ2VzdHVyZUVuZEV2ZW50ID0gJ3RvdWNoZW5kIHRvdWNoY2FuY2VsJzsKICAgICAgZ2VzdHVyZVN0YXJ0RXZlbnQgPSAndG91Y2hzdGFydCc7CiAgICAgIGdlc3R1cmVNb3ZlRXZlbnQgPSAndG91Y2htb3ZlJzsKICAgIH0gZWxzZSB7CiAgICAgIGdlc3R1cmVFbmRFdmVudCA9ICd0b3VjaGVuZCB0b3VjaGNhbmNlbCBtb3VzZXVwJzsKICAgICAgLy8gYWxsb3cgdG91Y2ggYW5kIG1vdXNlIGJvdGghCiAgICAgIGdlc3R1cmVTdGFydEV2ZW50ID0gJ3RvdWNoc3RhcnQgbW91c2Vkb3duJzsKICAgICAgZ2VzdHVyZU1vdmVFdmVudCA9ICd0b3VjaG1vdmUgbW91c2Vtb3ZlJzsKICAgIH0KICB9IGVsc2UgaWYgKEZlYXR1cmUuaXNQb2ludGVyU3VwcG9ydGVkKCkpIHsKICAgIC8vIGllMTEgcmVxdWlyZXMgbG93ZXJjYXNlCiAgICAvLyBodHRwczovL2dpdGh1Yi5jb20va2lzc3l0ZWFtL2tpc3N5L2lzc3Vlcy81MDkKICAgIGdlc3R1cmVTdGFydEV2ZW50ID0gJ3BvaW50ZXJkb3duJzsKICAgIGdlc3R1cmVNb3ZlRXZlbnQgPSAncG9pbnRlcm1vdmUnOwogICAgZ2VzdHVyZUVuZEV2ZW50ID0gJ3BvaW50ZXJ1cCBwb2ludGVyY2FuY2VsJzsKICB9IGVsc2UgaWYgKEZlYXR1cmUuaXNNc1BvaW50ZXJTdXBwb3J0ZWQoKSkgewogICAgZ2VzdHVyZVN0YXJ0RXZlbnQgPSAnTVNQb2ludGVyRG93bic7CiAgICBnZXN0dXJlTW92ZUV2ZW50ID0gJ01TUG9pbnRlck1vdmUnOwogICAgZ2VzdHVyZUVuZEV2ZW50ID0gJ01TUG9pbnRlclVwIE1TUG9pbnRlckNhbmNlbCc7CiAgfSBlbHNlIHsKICAgIGdlc3R1cmVTdGFydEV2ZW50ID0gJ21vdXNlZG93bic7CiAgICBnZXN0dXJlTW92ZUV2ZW50ID0gJ21vdXNlbW92ZSc7CiAgICBnZXN0dXJlRW5kRXZlbnQgPSAnbW91c2V1cCc7CiAgfQogIGZ1bmN0aW9uIERvY3VtZW50SGFuZGxlcihkb2MpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHNlbGYuZG9jID0gZG9jOwogICAgc2VsZi5ldmVudEhhbmRsZXMgPSBbXTsKICAgIHNlbGYuaW5pdCgpOwogICAgLy8gbm9ybWFsaXplIHBvaW50ZXIgZXZlbnQgdG8gdG91Y2ggZXZlbnQKICAgIHNlbGYudG91Y2hlcyA9IFtdOwogICAgLy8gdG91Y2hlcyBsZW5ndGggb2YgdG91Y2ggZXZlbnQKICAgIHNlbGYuaW5Ub3VjaCA9IDA7CiAgfQogIERvY3VtZW50SGFuZGxlci5wcm90b3R5cGUgPSB7CiAgICBjb25zdHJ1Y3RvcjogRG9jdW1lbnRIYW5kbGVyLAogICAgbGFzdFRvdWNoZXM6IFtdLAogICAgZmlyc3RUb3VjaDogbnVsbCwKICAgIGluaXQ6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBkb2MgPSBzZWxmLmRvYzsKICAgICAgRG9tRXZlbnQub24oZG9jLCBnZXN0dXJlU3RhcnRFdmVudCwgc2VsZi5vblRvdWNoU3RhcnQsIHNlbGYpOwogICAgICAvLyBwb2ludGVybW92ZSB3aWxsIGJlIGZpcmVkIHJlZ2FyZGxlc3Mgb2YgcG9pbnRlcmRvd24KICAgICAgaWYgKCFpc1BvaW50ZXJFdmVudChnZXN0dXJlTW92ZUV2ZW50KSkgewogICAgICAgIERvbUV2ZW50Lm9uKGRvYywgZ2VzdHVyZU1vdmVFdmVudCwgc2VsZi5vblRvdWNoTW92ZSwgc2VsZik7CiAgICAgIH0KICAgICAgRG9tRXZlbnQub24oZG9jLCBnZXN0dXJlRW5kRXZlbnQsIHNlbGYub25Ub3VjaEVuZCwgc2VsZik7CiAgICB9LAogICAgYWRkVG91Y2g6IGZ1bmN0aW9uIChvcmlnaW5hbEV2ZW50KSB7CiAgICAgIG9yaWdpbmFsRXZlbnQuaWRlbnRpZmllciA9IG9yaWdpbmFsRXZlbnQucG9pbnRlcklkOwogICAgICB0aGlzLnRvdWNoZXMucHVzaChvcmlnaW5hbEV2ZW50KTsKICAgIH0sCiAgICByZW1vdmVUb3VjaDogZnVuY3Rpb24gKG9yaWdpbmFsRXZlbnQpIHsKICAgICAgdmFyIGkgPSAwLCB0b3VjaCwgcG9pbnRlcklkID0gb3JpZ2luYWxFdmVudC5wb2ludGVySWQsIHRvdWNoZXMgPSB0aGlzLnRvdWNoZXMsIGwgPSB0b3VjaGVzLmxlbmd0aDsKICAgICAgZm9yICg7IGkgPCBsOyBpKyspIHsKICAgICAgICB0b3VjaCA9IHRvdWNoZXNbaV07CiAgICAgICAgaWYgKHRvdWNoLnBvaW50ZXJJZCA9PT0gcG9pbnRlcklkKSB7CiAgICAgICAgICB0b3VjaGVzLnNwbGljZShpLCAxKTsKICAgICAgICAgIGJyZWFrOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHVwZGF0ZVRvdWNoOiBmdW5jdGlvbiAob3JpZ2luYWxFdmVudCkgewogICAgICB2YXIgaSA9IDAsIHRvdWNoLCBwb2ludGVySWQgPSBvcmlnaW5hbEV2ZW50LnBvaW50ZXJJZCwgdG91Y2hlcyA9IHRoaXMudG91Y2hlcywgbCA9IHRvdWNoZXMubGVuZ3RoOwogICAgICBmb3IgKDsgaSA8IGw7IGkrKykgewogICAgICAgIHRvdWNoID0gdG91Y2hlc1tpXTsKICAgICAgICBpZiAodG91Y2gucG9pbnRlcklkID09PSBwb2ludGVySWQpIHsKICAgICAgICAgIHRvdWNoZXNbaV0gPSBvcmlnaW5hbEV2ZW50OwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGlzUHJpbWFyeVRvdWNoOiBmdW5jdGlvbiAoaW5Ub3VjaCkgewogICAgICByZXR1cm4gdGhpcy5maXJzdFRvdWNoID09PSBpblRvdWNoLmlkZW50aWZpZXI7CiAgICB9LAogICAgc2V0UHJpbWFyeVRvdWNoOiBmdW5jdGlvbiAoaW5Ub3VjaCkgewogICAgICBpZiAodGhpcy5maXJzdFRvdWNoID09PSBudWxsKSB7CiAgICAgICAgdGhpcy5maXJzdFRvdWNoID0gaW5Ub3VjaC5pZGVudGlmaWVyOwogICAgICB9CiAgICB9LAogICAgcmVtb3ZlUHJpbWFyeVRvdWNoOiBmdW5jdGlvbiAoaW5Ub3VjaCkgewogICAgICBpZiAodGhpcy5pc1ByaW1hcnlUb3VjaChpblRvdWNoKSkgewogICAgICAgIHRoaXMuZmlyc3RUb3VjaCA9IG51bGw7CiAgICAgIH0KICAgIH0sCiAgICAvLyBwcmV2ZW50IG1vdXNlIGV2ZW50cyBmcm9tIGNyZWF0aW5nIHBvaW50ZXIgZXZlbnRzCiAgICBkdXBNb3VzZTogZnVuY3Rpb24gKGluRXZlbnQpIHsKICAgICAgdmFyIGx0cyA9IHRoaXMubGFzdFRvdWNoZXM7CiAgICAgIHZhciB0ID0gaW5FdmVudC5jaGFuZ2VkVG91Y2hlc1swXTsKICAgICAgLy8gb25seSB0aGUgcHJpbWFyeSBmaW5nZXIgd2lsbCBkdXAgbW91c2UgZXZlbnRzCiAgICAgIGlmICh0aGlzLmlzUHJpbWFyeVRvdWNoKHQpKSB7CiAgICAgICAgLy8gcmVtZW1iZXIgeC95IG9mIGxhc3QgdG91Y2gKICAgICAgICB2YXIgbHQgPSB7CiAgICAgICAgICB4OiB0LmNsaWVudFgsCiAgICAgICAgICB5OiB0LmNsaWVudFkKICAgICAgICB9OwogICAgICAgIGx0cy5wdXNoKGx0KTsKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHZhciBpID0gbHRzLmluZGV4T2YobHQpOwogICAgICAgICAgaWYgKGkgPiAtMSkgewogICAgICAgICAgICBsdHMuc3BsaWNlKGksIDEpOwogICAgICAgICAgfQogICAgICAgIH0sIERVUF9USU1FT1VUKTsKICAgICAgfQogICAgfSwKICAgIC8vIGNvbGxpZGUgd2l0aCB0aGUgdG91Y2ggZXZlbnQKICAgIGlzRXZlbnRTaW11bGF0ZWRGcm9tVG91Y2g6IGZ1bmN0aW9uIChpbkV2ZW50KSB7CiAgICAgIHZhciBsdHMgPSB0aGlzLmxhc3RUb3VjaGVzOwogICAgICB2YXIgeCA9IGluRXZlbnQuY2xpZW50WCwgeSA9IGluRXZlbnQuY2xpZW50WTsKICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBsdHMubGVuZ3RoLCB0OyBpIDwgbCAmJiAodCA9IGx0c1tpXSk7IGkrKykgewogICAgICAgIC8vIHNpbXVsYXRlZCBtb3VzZSBldmVudHMgd2lsbCBiZSBzd2FsbG93ZWQgbmVhciBhIHByaW1hcnkgdG91Y2hlbmQKICAgICAgICB2YXIgZHggPSBNYXRoLmFicyh4IC0gdC54KSwgZHkgPSBNYXRoLmFicyh5IC0gdC55KTsKICAgICAgICBpZiAoZHggPD0gRFVQX0RJU1QgJiYgZHkgPD0gRFVQX0RJU1QpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gMDsKICAgIH0sCiAgICBub3JtYWxpemU6IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0eXBlID0gZS50eXBlLCBub3RVcCwgdG91Y2hFdmVudCwgdG91Y2hMaXN0OwogICAgICBpZiAodG91Y2hFdmVudCA9IGlzVG91Y2hFdmVudCh0eXBlKSkgewogICAgICAgIHRvdWNoTGlzdCA9IHR5cGUgPT09ICd0b3VjaGVuZCcgfHwgdHlwZSA9PT0gJ3RvdWNoY2FuY2VsJyA/IGUuY2hhbmdlZFRvdWNoZXMgOiBlLnRvdWNoZXM7CiAgICAgICAgZS5nZXN0dXJlVHlwZSA9ICd0b3VjaCc7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgaWYgKGlzUG9pbnRlckV2ZW50KHR5cGUpKSB7CiAgICAgICAgICBlLmdlc3R1cmVUeXBlID0gZS5vcmlnaW5hbEV2ZW50LnBvaW50ZXJUeXBlOwogICAgICAgIH0gZWxzZSBpZiAoaXNNb3VzZUV2ZW50KHR5cGUpKSB7CiAgICAgICAgICBlLmdlc3R1cmVUeXBlID0gJ21vdXNlJzsKICAgICAgICB9CiAgICAgICAgdG91Y2hMaXN0ID0gdGhpcy50b3VjaGVzOwogICAgICB9CiAgICAgIGlmICh0b3VjaExpc3QgJiYgdG91Y2hMaXN0Lmxlbmd0aCA9PT0gMSkgewogICAgICAgIGUud2hpY2ggPSAxOwogICAgICAgIGUucGFnZVggPSB0b3VjaExpc3RbMF0ucGFnZVg7CiAgICAgICAgZS5wYWdlWSA9IHRvdWNoTGlzdFswXS5wYWdlWTsKICAgICAgfQogICAgICBpZiAodG91Y2hFdmVudCkgewogICAgICAgIHJldHVybiBlOwogICAgICB9CiAgICAgIG5vdFVwID0gIXR5cGUubWF0Y2goLyh1cHxjYW5jZWwpJC9pKTsKICAgICAgZS50b3VjaGVzID0gbm90VXAgPyB0b3VjaExpc3QgOiBbXTsKICAgICAgZS50YXJnZXRUb3VjaGVzID0gbm90VXAgPyB0b3VjaExpc3QgOiBbXTsKICAgICAgZS5jaGFuZ2VkVG91Y2hlcyA9IHRvdWNoTGlzdDsKICAgICAgcmV0dXJuIGU7CiAgICB9LAogICAgb25Ub3VjaFN0YXJ0OiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIGUsIGgsIHNlbGYgPSB0aGlzLCB0eXBlID0gZXZlbnQudHlwZSwgZXZlbnRIYW5kbGVzID0gc2VsZi5ldmVudEhhbmRsZXM7CiAgICAgIGlmIChpc1RvdWNoRXZlbnQodHlwZSkpIHsKICAgICAgICBzZWxmLnNldFByaW1hcnlUb3VjaChldmVudC5jaGFuZ2VkVG91Y2hlc1swXSk7CiAgICAgICAgc2VsZi5kdXBNb3VzZShldmVudCk7CiAgICAgIH0gZWxzZSBpZiAoaXNNb3VzZUV2ZW50KHR5cGUpKSB7CiAgICAgICAgaWYgKHNlbGYuaXNFdmVudFNpbXVsYXRlZEZyb21Ub3VjaChldmVudCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgICAgc2VsZi50b3VjaGVzID0gW2V2ZW50XTsKICAgICAgfSBlbHNlIGlmIChpc1BvaW50ZXJFdmVudCh0eXBlKSkgewogICAgICAgIHNlbGYuYWRkVG91Y2goZXZlbnQub3JpZ2luYWxFdmVudCk7CiAgICAgICAgaWYgKHNlbGYudG91Y2hlcy5sZW5ndGggPT09IDEpIHsKICAgICAgICAgIERvbUV2ZW50Lm9uKHNlbGYuZG9jLCBnZXN0dXJlTW92ZUV2ZW50LCBzZWxmLm9uVG91Y2hNb3ZlLCBzZWxmKTsKICAgICAgICB9CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bnJlY29nbml6ZWQgdG91Y2ggZXZlbnQ6ICcgKyBldmVudC50eXBlKTsKICAgICAgfQogICAgICBmb3IgKHZhciBpID0gMCwgbCA9IGV2ZW50SGFuZGxlcy5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBlID0gZXZlbnRIYW5kbGVzW2ldOwogICAgICAgIGggPSBldmVudEhhbmRsZXNbZV0uaGFuZGxlOwogICAgICAgIGguaXNBY3RpdmUgPSAxOwogICAgICB9CiAgICAgIC8vIGlmIHByZXZlbnREZWZhdWx0LCB3aWxsIG5vdCB0cmlnZ2VyIGNsaWNrIGV2ZW50CiAgICAgIHNlbGYuY2FsbEV2ZW50SGFuZGxlKCdvblRvdWNoU3RhcnQnLCBldmVudCk7CiAgICB9LAogICAgb25Ub3VjaE1vdmU6IGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIHR5cGUgPSBldmVudC50eXBlOwogICAgICBpZiAoaXNNb3VzZUV2ZW50KHR5cGUpKSB7CiAgICAgICAgaWYgKHNlbGYuaXNFdmVudFNpbXVsYXRlZEZyb21Ub3VjaCh0eXBlKSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgICBzZWxmLnRvdWNoZXMgPSBbZXZlbnRdOwogICAgICB9IGVsc2UgaWYgKGlzUG9pbnRlckV2ZW50KHR5cGUpKSB7CiAgICAgICAgc2VsZi51cGRhdGVUb3VjaChldmVudC5vcmlnaW5hbEV2ZW50KTsKICAgICAgfSBlbHNlIGlmICghaXNUb3VjaEV2ZW50KHR5cGUpKSB7CiAgICAgICAgdGhyb3cgbmV3IEVycm9yKCd1bnJlY29nbml6ZWQgdG91Y2ggZXZlbnQ6ICcgKyBldmVudC50eXBlKTsKICAgICAgfQogICAgICAvLyBubyB0aHJvdHRsZSEgdG8gYWxsb3cgcHJldmVudERlZmF1bHQKICAgICAgc2VsZi5jYWxsRXZlbnRIYW5kbGUoJ29uVG91Y2hNb3ZlJywgZXZlbnQpOwogICAgfSwKICAgIG9uVG91Y2hFbmQ6IGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIHR5cGUgPSBldmVudC50eXBlOwogICAgICBpZiAoaXNNb3VzZUV2ZW50KHR5cGUpKSB7CiAgICAgICAgaWYgKHNlbGYuaXNFdmVudFNpbXVsYXRlZEZyb21Ub3VjaChldmVudCkpIHsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CiAgICAgIH0KICAgICAgc2VsZi5jYWxsRXZlbnRIYW5kbGUoJ29uVG91Y2hFbmQnLCBldmVudCk7CiAgICAgIGlmIChpc1RvdWNoRXZlbnQodHlwZSkpIHsKICAgICAgICBzZWxmLmR1cE1vdXNlKGV2ZW50KTsKICAgICAgICB1dGlsLm1ha2VBcnJheShldmVudC5jaGFuZ2VkVG91Y2hlcykuZm9yRWFjaChmdW5jdGlvbiAodG91Y2gpIHsKICAgICAgICAgIHNlbGYucmVtb3ZlUHJpbWFyeVRvdWNoKHRvdWNoKTsKICAgICAgICB9KTsKICAgICAgfSBlbHNlIGlmIChpc01vdXNlRXZlbnQodHlwZSkpIHsKICAgICAgICBzZWxmLnRvdWNoZXMgPSBbXTsKICAgICAgfSBlbHNlIGlmIChpc1BvaW50ZXJFdmVudCh0eXBlKSkgewogICAgICAgIHNlbGYucmVtb3ZlVG91Y2goZXZlbnQub3JpZ2luYWxFdmVudCk7CiAgICAgICAgaWYgKCFzZWxmLnRvdWNoZXMubGVuZ3RoKSB7CiAgICAgICAgICBEb21FdmVudC5kZXRhY2goc2VsZi5kb2MsIGdlc3R1cmVNb3ZlRXZlbnQsIHNlbGYub25Ub3VjaE1vdmUsIHNlbGYpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGNhbGxFdmVudEhhbmRsZTogZnVuY3Rpb24gKG1ldGhvZCwgZXZlbnQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBldmVudEhhbmRsZXMgPSBzZWxmLmV2ZW50SGFuZGxlcywgaGFuZGxlQXJyYXkgPSBldmVudEhhbmRsZXMuY29uY2F0KCksIGUsIGg7CiAgICAgIGV2ZW50ID0gc2VsZi5ub3JtYWxpemUoZXZlbnQpOwogICAgICB2YXIgZ2VzdHVyZVR5cGUgPSBldmVudC5nZXN0dXJlVHlwZTsKICAgICAgLy8gaWUgdG91Y2hzdGFydCBvbiBpZnJhbWUgdGhlbiB0b3VjaGVuZCBvbiBwYXJlbnQKICAgICAgaWYgKCFldmVudC5jaGFuZ2VkVG91Y2hlcy5sZW5ndGgpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgZm9yICh2YXIgaSA9IDAsIGwgPSBoYW5kbGVBcnJheS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBlID0gaGFuZGxlQXJyYXlbaV07CiAgICAgICAgaWYgKGV2ZW50SGFuZGxlc1tlXSkgewogICAgICAgICAgLy8gZXZlbnQgcHJvY2Vzc29yIHNoYXJlZCBieSBtdWx0aXBsZSBldmVudHMKICAgICAgICAgIGggPSBldmVudEhhbmRsZXNbZV0uaGFuZGxlOwogICAgICAgICAgLy8gdG91Y2ggb25seSBnZXN0dXJlCiAgICAgICAgICBpZiAoaC5yZXF1aXJlZEdlc3R1cmVUeXBlICYmIGdlc3R1cmVUeXBlICE9PSBoLnJlcXVpcmVkR2VzdHVyZVR5cGUpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgICBpZiAoaC5wcm9jZXNzZWQpIHsKICAgICAgICAgICAgY29udGludWU7CiAgICAgICAgICB9CiAgICAgICAgICBoLnByb2Nlc3NlZCA9IDE7CiAgICAgICAgICBpZiAoaC5pc0FjdGl2ZSAmJiBoW21ldGhvZF0gJiYgaFttZXRob2RdKGV2ZW50KSA9PT0gZmFsc2UpIHsKICAgICAgICAgICAgaC5pc0FjdGl2ZSA9IDA7CiAgICAgICAgICB9CiAgICAgICAgfQogICAgICB9CiAgICAgIGZvciAoaSA9IDAsIGwgPSBoYW5kbGVBcnJheS5sZW5ndGg7IGkgPCBsOyBpKyspIHsKICAgICAgICBlID0gZXZlbnRIYW5kbGVzW2ldOwogICAgICAgIGlmIChldmVudEhhbmRsZXNbZV0pIHsKICAgICAgICAgIGggPSBldmVudEhhbmRsZXNbZV0uaGFuZGxlOwogICAgICAgICAgaC5wcm9jZXNzZWQgPSAwOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIGFkZEV2ZW50SGFuZGxlOiBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBldmVudEhhbmRsZXMgPSBzZWxmLmV2ZW50SGFuZGxlcywgaGFuZGxlID0gZXZlbnRIYW5kbGVNYXBbZXZlbnRdLmhhbmRsZTsKICAgICAgaWYgKGV2ZW50SGFuZGxlc1tldmVudF0pIHsKICAgICAgICBldmVudEhhbmRsZXNbZXZlbnRdLmNvdW50Kys7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZXZlbnRIYW5kbGVzLnB1c2goZXZlbnQpOwogICAgICAgIHNlbGYuc29ydEV2ZW50SGFuZGxlcygpOwogICAgICAgIGV2ZW50SGFuZGxlc1tldmVudF0gPSB7CiAgICAgICAgICBjb3VudDogMSwKICAgICAgICAgIGhhbmRsZTogaGFuZGxlCiAgICAgICAgfTsKICAgICAgfQogICAgfSwKICAgIHNvcnRFdmVudEhhbmRsZXM6IGZ1bmN0aW9uICgpIHsKICAgICAgdGhpcy5ldmVudEhhbmRsZXMuc29ydChmdW5jdGlvbiAoZTEsIGUyKSB7CiAgICAgICAgdmFyIGUxQ29uZmlnID0gZXZlbnRIYW5kbGVNYXBbZTFdOwogICAgICAgIHZhciBlMkNvbmZpZyA9IGV2ZW50SGFuZGxlTWFwW2UyXTsKICAgICAgICByZXR1cm4gZTFDb25maWcub3JkZXIgLSBlMkNvbmZpZy5vcmRlcjsKICAgICAgfSk7CiAgICB9LAogICAgcmVtb3ZlRXZlbnRIYW5kbGU6IGZ1bmN0aW9uIChldmVudCkgewogICAgICB2YXIgZXZlbnRIYW5kbGVzID0gdGhpcy5ldmVudEhhbmRsZXM7CiAgICAgIGlmIChldmVudEhhbmRsZXNbZXZlbnRdKSB7CiAgICAgICAgZXZlbnRIYW5kbGVzW2V2ZW50XS5jb3VudC0tOwogICAgICAgIGlmICghZXZlbnRIYW5kbGVzW2V2ZW50XS5jb3VudCkgewogICAgICAgICAgZXZlbnRIYW5kbGVzLnNwbGljZSh1dGlsLmluZGV4T2YoZXZlbnQsIGV2ZW50SGFuZGxlcyksIDEpOwogICAgICAgICAgZGVsZXRlIGV2ZW50SGFuZGxlc1tldmVudF07CiAgICAgICAgfQogICAgICB9CiAgICB9LAogICAgZGVzdHJveTogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGRvYyA9IHNlbGYuZG9jOwogICAgICBEb21FdmVudC5kZXRhY2goZG9jLCBnZXN0dXJlU3RhcnRFdmVudCwgc2VsZi5vblRvdWNoU3RhcnQsIHNlbGYpOwogICAgICBEb21FdmVudC5kZXRhY2goZG9jLCBnZXN0dXJlTW92ZUV2ZW50LCBzZWxmLm9uVG91Y2hNb3ZlLCBzZWxmKTsKICAgICAgRG9tRXZlbnQuZGV0YWNoKGRvYywgZ2VzdHVyZUVuZEV2ZW50LCBzZWxmLm9uVG91Y2hFbmQsIHNlbGYpOwogICAgfQogIH07CiAgZnVuY3Rpb24gc2V0dXAoZXZlbnQpIHsKICAgIGFkZERvY3VtZW50SGFuZGxlKHRoaXMsIGV2ZW50KTsKICB9CiAgZnVuY3Rpb24gdGVhckRvd24oZXZlbnQpIHsKICAgIHJlbW92ZURvY3VtZW50SGFuZGxlKHRoaXMsIGV2ZW50KTsKICB9CiAgZnVuY3Rpb24gc2V0dXBFeHRyYShldmVudCkgewogICAgc2V0dXAuY2FsbCh0aGlzLCBldmVudCk7CiAgICBldmVudEhhbmRsZU1hcFtldmVudF0uc2V0dXAuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgZnVuY3Rpb24gdGVhckRvd25FeHRyYShldmVudCkgewogICAgdGVhckRvd24uY2FsbCh0aGlzLCBldmVudCk7CiAgICBldmVudEhhbmRsZU1hcFtldmVudF0udGVhckRvd24uYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICB9CiAgZnVuY3Rpb24gYWRkRG9jdW1lbnRIYW5kbGUoZWwsIGV2ZW50KSB7CiAgICB2YXIgZG9jID0gRG9tLmdldERvY3VtZW50KGVsKSwgaGFuZGxlID0gRG9tLmRhdGEoZG9jLCBrZXkpOwogICAgaWYgKCFoYW5kbGUpIHsKICAgICAgRG9tLmRhdGEoZG9jLCBrZXksIGhhbmRsZSA9IG5ldyBEb2N1bWVudEhhbmRsZXIoZG9jKSk7CiAgICB9CiAgICBpZiAoZXZlbnQpIHsKICAgICAgaGFuZGxlLmFkZEV2ZW50SGFuZGxlKGV2ZW50KTsKICAgIH0KICB9CiAgZnVuY3Rpb24gcmVtb3ZlRG9jdW1lbnRIYW5kbGUoZWwsIGV2ZW50KSB7CiAgICB2YXIgZG9jID0gRG9tLmdldERvY3VtZW50KGVsKSwgaGFuZGxlID0gRG9tLmRhdGEoZG9jLCBrZXkpOwogICAgaWYgKGhhbmRsZSkgewogICAgICBpZiAoZXZlbnQpIHsKICAgICAgICBoYW5kbGUucmVtb3ZlRXZlbnRIYW5kbGUoZXZlbnQpOwogICAgICB9CiAgICAgIGlmICghaGFuZGxlLmV2ZW50SGFuZGxlcy5sZW5ndGgpIHsKICAgICAgICBoYW5kbGUuZGVzdHJveSgpOwogICAgICAgIERvbS5yZW1vdmVEYXRhKGRvYywga2V5KTsKICAgICAgfQogICAgfQogIH0KICBleHBvcnRzID0gZnVuY3Rpb24gKGV2ZW50cywgY29uZmlnKSB7CiAgICBpZiAodHlwZW9mIGV2ZW50cyA9PT0gJ3N0cmluZycpIHsKICAgICAgZXZlbnRzID0gW2V2ZW50c107CiAgICB9CiAgICB1dGlsLmVhY2goZXZlbnRzLCBmdW5jdGlvbiAoZXZlbnQpIHsKICAgICAgdmFyIHNwZWNpYWxFdmVudCA9IHt9OwogICAgICBzcGVjaWFsRXZlbnQuc2V0dXAgPSBjb25maWcuc2V0dXAgPyBzZXR1cEV4dHJhIDogc2V0dXA7CiAgICAgIHNwZWNpYWxFdmVudC50ZWFyRG93biA9IGNvbmZpZy50ZWFyRG93biA/IHRlYXJEb3duRXh0cmEgOiB0ZWFyRG93bjsKICAgICAgc3BlY2lhbEV2ZW50LmFkZCA9IGNvbmZpZy5hZGQ7CiAgICAgIHNwZWNpYWxFdmVudC5yZW1vdmUgPSBjb25maWcucmVtb3ZlOwogICAgICBjb25maWcub3JkZXIgPSBjb25maWcub3JkZXIgfHwgMTAwOwogICAgICBldmVudEhhbmRsZU1hcFtldmVudF0gPSBjb25maWc7CiAgICAgIFNwZWNpYWxbZXZlbnRdID0gc3BlY2lhbEV2ZW50OwogICAgfSk7CiAgfTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpldmVudFRvdWNoTGliVXRpbFRvdWNoID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgbm9vcCA9IGZ1bmN0aW9uICgpIHsKICB9OwogIGZ1bmN0aW9uIFRvdWNoKCkgewogIH0KICBUb3VjaC5wcm90b3R5cGUgPSB7CiAgICBjb25zdHJ1Y3RvcjogVG91Y2gsCiAgICByZXF1aXJlZFRvdWNoQ291bnQ6IDAsCiAgICBvblRvdWNoU3RhcnQ6IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgcmVxdWlyZWRUb3VjaGVzQ291bnQgPSBzZWxmLnJlcXVpcmVkVG91Y2hDb3VudCwgdG91Y2hlcyA9IGUudG91Y2hlcywgdG91Y2hlc0NvdW50ID0gdG91Y2hlcy5sZW5ndGg7CiAgICAgIGlmICh0b3VjaGVzQ291bnQgPT09IHJlcXVpcmVkVG91Y2hlc0NvdW50KSB7CiAgICAgICAgaWYgKCFzZWxmLmlzVHJhY2tpbmcpIHsKICAgICAgICAgIHNlbGYuaXNUcmFja2luZyA9IHRydWU7CiAgICAgICAgICBzZWxmLmlzU3RhcnRlZCA9IGZhbHNlOwogICAgICAgIH0KICAgICAgICBzZWxmLmxhc3RUb3VjaGVzID0gZS50b3VjaGVzOwogICAgICAgIHNlbGYuc3RhcnRUaW1lID0gZS50aW1lU3RhbXA7CiAgICAgICAgcmV0dXJuIHNlbGYuc3RhcnQoZSk7CiAgICAgIH0gZWxzZSBpZiAodG91Y2hlc0NvdW50ID4gcmVxdWlyZWRUb3VjaGVzQ291bnQpIHsKICAgICAgICBzZWxmLm9uVG91Y2hFbmQoZSwgdHJ1ZSk7CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0sCiAgICBvblRvdWNoTW92ZTogZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAoIXNlbGYuaXNUcmFja2luZykgewogICAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICAgIH0KICAgICAgc2VsZi5sYXN0VG91Y2hlcyA9IGUudG91Y2hlczsKICAgICAgcmV0dXJuIHNlbGYubW92ZShlKTsKICAgIH0sCiAgICBvblRvdWNoRW5kOiBmdW5jdGlvbiAoZSwgbW9yZVRvdWNoZXMpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAoc2VsZi5pc1RyYWNraW5nKSB7CiAgICAgICAgc2VsZi5pc1RyYWNraW5nID0gZmFsc2U7CiAgICAgICAgaWYgKHNlbGYuaXNTdGFydGVkKSB7CiAgICAgICAgICBzZWxmLmlzU3RhcnRlZCA9IGZhbHNlOwogICAgICAgICAgc2VsZi5lbmQoZSwgbW9yZVRvdWNoZXMpOwogICAgICAgIH0KICAgICAgfQogICAgfSwKICAgIHN0YXJ0OiBub29wLAogICAgbW92ZTogbm9vcCwKICAgIGVuZDogbm9vcAogIH07CiAgZXhwb3J0cyA9IFRvdWNoOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50VG91Y2hMaWJVdGlsU2luZ2xlVG91Y2ggPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBUb3VjaCA9IGV2ZW50VG91Y2hMaWJVdGlsVG91Y2g7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICBmdW5jdGlvbiBTaW5nbGVUb3VjaCgpIHsKICB9CiAgdXRpbC5leHRlbmQoU2luZ2xlVG91Y2gsIFRvdWNoLCB7CiAgICByZXF1aXJlZFRvdWNoQ291bnQ6IDEsCiAgICBzdGFydDogZnVuY3Rpb24gKCkgewogICAgICBTaW5nbGVUb3VjaC5zdXBlcmNsYXNzLnN0YXJ0LmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIHZhciBzZWxmID0gdGhpcywgdG91Y2hlcyA9IHNlbGYubGFzdFRvdWNoZXM7CiAgICAgIHNlbGYubGFzdFhZID0gewogICAgICAgIHBhZ2VYOiB0b3VjaGVzWzBdLnBhZ2VYLAogICAgICAgIHBhZ2VZOiB0b3VjaGVzWzBdLnBhZ2VZCiAgICAgIH07CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IFNpbmdsZVRvdWNoOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50VG91Y2hMaWJVdGlsRG91YmxlVG91Y2ggPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBUb3VjaCA9IGV2ZW50VG91Y2hMaWJVdGlsVG91Y2g7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICBmdW5jdGlvbiBEb3VibGVUb3VjaCgpIHsKICB9CiAgdXRpbC5leHRlbmQoRG91YmxlVG91Y2gsIFRvdWNoLCB7CiAgICByZXF1aXJlZFRvdWNoQ291bnQ6IDIsCiAgICBnZXRDb21tb25UYXJnZXQ6IGZ1bmN0aW9uIChlKSB7CiAgICAgIHZhciB0b3VjaGVzID0gZS50b3VjaGVzLCB0MSA9IHRvdWNoZXNbMF0udGFyZ2V0LCB0MiA9IHRvdWNoZXNbMV0udGFyZ2V0OwogICAgICBpZiAodDEgPT09IHQyKSB7CiAgICAgICAgcmV0dXJuIHQxOwogICAgICB9CiAgICAgIGlmIChEb20uY29udGFpbnModDEsIHQyKSkgewogICAgICAgIHJldHVybiB0MTsKICAgICAgfQogICAgICB3aGlsZSAodDIpIHsKICAgICAgICBpZiAoRG9tLmNvbnRhaW5zKHQyLCB0MSkpIHsKICAgICAgICAgIHJldHVybiB0MjsKICAgICAgICB9CiAgICAgICAgdDIgPSB0Mi5wYXJlbnROb2RlOwogICAgICB9CiAgICAgIHJldHVybiB1bmRlZmluZWQ7CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IERvdWJsZVRvdWNoOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50VG91Y2hMaWJVdGlsID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgYWRkR2VzdHVyZUV2ZW50ID0gZXZlbnRUb3VjaExpYlV0aWxBZGRFdmVudDsKICBleHBvcnRzID0gewogICAgYWRkRXZlbnQ6IGFkZEdlc3R1cmVFdmVudCwKICAgIFRvdWNoOiBldmVudFRvdWNoTGliVXRpbFRvdWNoLAogICAgU2luZ2xlVG91Y2g6IGV2ZW50VG91Y2hMaWJVdGlsU2luZ2xlVG91Y2gsCiAgICBEb3VibGVUb3VjaDogZXZlbnRUb3VjaExpYlV0aWxEb3VibGVUb3VjaAogIH07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnRUb3VjaExpYlN3aXBlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBHZXN0dXJlVXRpbCA9IGV2ZW50VG91Y2hMaWJVdGlsOwogIHZhciBhZGRHZXN0dXJlRXZlbnQgPSBHZXN0dXJlVXRpbC5hZGRFdmVudDsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUJhc2U7CiAgdmFyIFNpbmdsZVRvdWNoID0gR2VzdHVyZVV0aWwuU2luZ2xlVG91Y2g7CiAgdmFyIFNXSVBFID0gJ3N3aXBlJywgTUFYX0RVUkFUSU9OID0gMTAwMCwgTUFYX09GRlNFVCA9IDM1LCBNSU5fRElTVEFOQ0UgPSA1MDsKICBmdW5jdGlvbiBmaXJlKHNlbGYsIGUsIGluZykgewogICAgdmFyIHRvdWNoZXMgPSBzZWxmLmxhc3RUb3VjaGVzLCB0b3VjaCA9IHRvdWNoZXNbMF0sIHggPSB0b3VjaC5wYWdlWCwgeSA9IHRvdWNoLnBhZ2VZLCBkZWx0YVggPSB4IC0gc2VsZi5zdGFydFgsIGRlbHRhWSA9IHkgLSBzZWxmLnN0YXJ0WSwgYWJzRGVsdGFYID0gTWF0aC5hYnMoZGVsdGFYKSwgYWJzRGVsdGFZID0gTWF0aC5hYnMoZGVsdGFZKSwgZGlzdGFuY2UsIGRpcmVjdGlvbiwgdGltZSA9IGUudGltZVN0YW1wOwogICAgc2VsZi5pc1N0YXJ0ZWQgPSAxOwogICAgaWYgKHRpbWUgLSBzZWxmLnN0YXJ0VGltZSA+IE1BWF9EVVJBVElPTikgewogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgICBpZiAoc2VsZi5pc1ZlcnRpY2FsICYmIGFic0RlbHRhWCA+IE1BWF9PRkZTRVQpIHsKICAgICAgc2VsZi5pc1ZlcnRpY2FsID0gMDsKICAgIH0KICAgIGlmIChzZWxmLmlzSG9yaXpvbnRhbCAmJiBhYnNEZWx0YVkgPiBNQVhfT0ZGU0VUKSB7CiAgICAgIHNlbGYuaXNIb3Jpem9udGFsID0gMDsKICAgIH0KICAgIGlmIChzZWxmLmlzVmVydGljYWwgJiYgc2VsZi5pc0hvcml6b250YWwpIHsKICAgICAgaWYgKGFic0RlbHRhWSA+IGFic0RlbHRhWCkgewogICAgICAgIHNlbGYuaXNIb3Jpem9udGFsID0gMDsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZWxmLmlzVmVydGljYWwgPSAwOwogICAgICB9CiAgICB9CiAgICBpZiAoIWluZykgewogICAgICBpZiAoc2VsZi5pc1ZlcnRpY2FsICYmIGFic0RlbHRhWSA8IE1JTl9ESVNUQU5DRSkgewogICAgICAgIHNlbGYuaXNWZXJ0aWNhbCA9IDA7CiAgICAgIH0KICAgICAgaWYgKHNlbGYuaXNIb3Jpem9udGFsICYmIGFic0RlbHRhWCA8IE1JTl9ESVNUQU5DRSkgewogICAgICAgIHNlbGYuaXNIb3Jpem9udGFsID0gMDsKICAgICAgfQogICAgfQogICAgaWYgKHNlbGYuaXNIb3Jpem9udGFsKSB7CiAgICAgIGRpcmVjdGlvbiA9IGRlbHRhWCA8IDAgPyAnbGVmdCcgOiAncmlnaHQnOwogICAgICBkaXN0YW5jZSA9IGFic0RlbHRhWDsKICAgIH0gZWxzZSBpZiAoc2VsZi5pc1ZlcnRpY2FsKSB7CiAgICAgIGRpcmVjdGlvbiA9IGRlbHRhWSA8IDAgPyAndXAnIDogJ2Rvd24nOwogICAgICBkaXN0YW5jZSA9IGFic0RlbHRhWTsKICAgIH0gZWxzZSB7CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0KICAgIGlmIChpbmcpIHsKICAgICAgdmFyIHByZXZlbnQgPSBlLm9yaWdpbmFsRXZlbnQuX2tzU3dpcGVQcmV2ZW50OwogICAgICBpZiAocHJldmVudCkgewogICAgICAgIGlmIChwcmV2ZW50ID09PSB0cnVlIHx8IHByZXZlbnRbZGlyZWN0aW9uXSkgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm47CiAgICB9CiAgICBEb21FdmVudC5maXJlKHRvdWNoLnRhcmdldCwgU1dJUEUsIHsKICAgICAgb3JpZ2luYWxFdmVudDogZS5vcmlnaW5hbEV2ZW50LAogICAgICBwYWdlWDogdG91Y2gucGFnZVgsCiAgICAgIHBhZ2VZOiB0b3VjaC5wYWdlWSwKICAgICAgd2hpY2g6IDEsCiAgICAgIGRpcmVjdGlvbjogZGlyZWN0aW9uLAogICAgICBkaXN0YW5jZTogZGlzdGFuY2UsCiAgICAgIGR1cmF0aW9uOiAoZS50aW1lU3RhbXAgLSBzZWxmLnN0YXJ0VGltZSkgLyAxMDAwCiAgICB9KTsKICB9CiAgZnVuY3Rpb24gU3dpcGUoKSB7CiAgfQogIHV0aWwuZXh0ZW5kKFN3aXBlLCBTaW5nbGVUb3VjaCwgewogICAgcmVxdWlyZWRHZXN0dXJlVHlwZTogJ3RvdWNoJywKICAgIHN0YXJ0OiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgU3dpcGUuc3VwZXJjbGFzcy5zdGFydC5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogICAgICB2YXIgdG91Y2ggPSBzZWxmLmxhc3RUb3VjaGVzWzBdOwogICAgICBzZWxmLmlzSG9yaXpvbnRhbCA9IDE7CiAgICAgIHNlbGYuaXNWZXJ0aWNhbCA9IDE7CiAgICAgIHNlbGYuc3RhcnRYID0gdG91Y2gucGFnZVg7CiAgICAgIHNlbGYuc3RhcnRZID0gdG91Y2gucGFnZVk7CiAgICB9LAogICAgbW92ZTogZnVuY3Rpb24gKGUpIHsKICAgICAgU3dpcGUuc3VwZXJjbGFzcy5tb3ZlLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICAgIHJldHVybiBmaXJlKHRoaXMsIGUsIDEpOwogICAgfSwKICAgIGVuZDogZnVuY3Rpb24gKGUpIHsKICAgICAgU3dpcGUuc3VwZXJjbGFzcy5lbmQuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgICAgcmV0dXJuIGZpcmUodGhpcywgZSwgMCk7CiAgICB9CiAgfSk7CiAgZnVuY3Rpb24gbWF0Y2hGaWx0ZXIodGFyZ2V0LCBjdXJyZW50VGFyZ2V0LCBmaWx0ZXIpIHsKICAgIHZhciByZXQgPSBmYWxzZTsKICAgIHdoaWxlICh0YXJnZXQgIT09IGN1cnJlbnRUYXJnZXQpIHsKICAgICAgcmV0ID0gRG9tLnRlc3QodGFyZ2V0LCBmaWx0ZXIpOwogICAgICBpZiAocmV0KSB7CiAgICAgICAgYnJlYWs7CiAgICAgIH0KICAgICAgdGFyZ2V0ID0gdGFyZ2V0LnBhcmVudE5vZGU7CiAgICB9CiAgICByZXR1cm4gcmV0OwogIH0KICBhZGRHZXN0dXJlRXZlbnQoW1NXSVBFXSwgewogICAgaGFuZGxlOiBuZXcgU3dpcGUoKSwKICAgIGFkZDogZnVuY3Rpb24gKG9ic2VydmVyKSB7CiAgICAgIHZhciBjb25maWcgPSBvYnNlcnZlci5jb25maWc7CiAgICAgIHZhciBwcmV2ZW50RGVmYXVsdCA9IGNvbmZpZy5wcmV2ZW50RGVmYXVsdDsKICAgICAgaWYgKHByZXZlbnREZWZhdWx0KSB7CiAgICAgICAgdmFyIGZpbHRlciA9IGNvbmZpZy5maWx0ZXI7CiAgICAgICAgb2JzZXJ2ZXIuX3ByZXZlbnRGbiA9IGZ1bmN0aW9uIChlKSB7CiAgICAgICAgICBpZiAoIWZpbHRlciB8fCBtYXRjaEZpbHRlcihlLnRhcmdldCwgZS5jdXJyZW50VGFyZ2V0LCBmaWx0ZXIpKSB7CiAgICAgICAgICAgIGUuX2tzU3dpcGVQcmV2ZW50ID0gcHJldmVudERlZmF1bHQ7CiAgICAgICAgICB9CiAgICAgICAgfTsKICAgICAgICB0aGlzLmFkZEV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG9ic2VydmVyLl9wcmV2ZW50Rm4pOwogICAgICB9CiAgICB9LAogICAgcmVtb3ZlOiBmdW5jdGlvbiAob2JzZXJ2ZXIpIHsKICAgICAgaWYgKG9ic2VydmVyLl9wcmV2ZW50Rm4pIHsKICAgICAgICB0aGlzLnJlbW92ZUV2ZW50TGlzdGVuZXIoJ3RvdWNobW92ZScsIG9ic2VydmVyLl9wcmV2ZW50Rm4pOwogICAgICAgIG9ic2VydmVyLl9wcmV2ZW50Rm4gPSBudWxsOwogICAgICB9CiAgICB9CiAgfSk7CiAgZXhwb3J0cyA9IHsgU1dJUEU6IFNXSVBFIH07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnRUb3VjaExpYlRhcCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIEdlc3R1cmVVdGlsID0gZXZlbnRUb3VjaExpYlV0aWw7CiAgdmFyIGFkZEdlc3R1cmVFdmVudCA9IEdlc3R1cmVVdGlsLmFkZEV2ZW50OwogIHZhciBEb21FdmVudCA9IGV2ZW50RG9tQmFzZTsKICB2YXIgU2luZ2xlVG91Y2ggPSBHZXN0dXJlVXRpbC5TaW5nbGVUb3VjaDsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBTSU5HTEVfVEFQID0gJ3NpbmdsZVRhcCcsIERPVUJMRV9UQVAgPSAnZG91YmxlVGFwJywgSE9MRCA9ICdob2xkJywgVEFQID0gJ3RhcCcsIFRBUF9IT0xEX0RFTEFZID0gMTAwMCwgU0lOR0xFX1RBUF9ERUxBWSA9IDMwMCwgVE9VQ0hfTU9WRV9TRU5TSVRJVklUWSA9IDUsIERvbUV2ZW50T2JqZWN0ID0gRG9tRXZlbnQuT2JqZWN0OwogIHZhciBpb3MgPSAvaVBhZHxpUGhvbmV8aVBvZC8udGVzdChuYXZpZ2F0b3IudXNlckFnZW50KTsKICBmdW5jdGlvbiBwcmV2ZW50RGVmYXVsdChlKSB7CiAgICBlLnByZXZlbnREZWZhdWx0KCk7CiAgfQogIGZ1bmN0aW9uIGNsZWFyVGltZXJzKHNlbGYpIHsKICAgIGlmIChzZWxmLnNpbmdsZVRhcFRpbWVyKSB7CiAgICAgIGNsZWFyVGltZW91dChzZWxmLnNpbmdsZVRhcFRpbWVyKTsKICAgICAgc2VsZi5zaW5nbGVUYXBUaW1lciA9IDA7CiAgICB9CiAgICBpZiAoc2VsZi50YXBIb2xkVGltZXIpIHsKICAgICAgY2xlYXJUaW1lb3V0KHNlbGYudGFwSG9sZFRpbWVyKTsKICAgICAgc2VsZi50YXBIb2xkVGltZXIgPSAwOwogICAgfQogIH0KICBmdW5jdGlvbiBUYXAoKSB7CiAgICBUYXAuc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5hcHBseSh0aGlzLCBhcmd1bWVudHMpOwogIH0KICB1dGlsLmV4dGVuZChUYXAsIFNpbmdsZVRvdWNoLCB7CiAgICBzdGFydDogZnVuY3Rpb24gKGUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBUYXAuc3VwZXJjbGFzcy5zdGFydC5jYWxsKHNlbGYsIGUpOwogICAgICBjbGVhclRpbWVycyhzZWxmKTsKICAgICAgdmFyIGN1cnJlbnRUb3VjaCA9IHNlbGYubGFzdFRvdWNoZXNbMF07CiAgICAgIHNlbGYudGFwSG9sZFRpbWVyID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgdmFyIGV2ZW50T2JqID0gdXRpbC5taXgoewogICAgICAgICAgd2hpY2g6IDEsCiAgICAgICAgICBkdXJhdGlvbjogKHV0aWwubm93KCkgLSBlLnRpbWVTdGFtcCkgLyAxMDAwCiAgICAgICAgfSwgc2VsZi5sYXN0WFkpOwogICAgICAgIHNlbGYudGFwSG9sZFRpbWVyID0gMDsKICAgICAgICBzZWxmLmxhc3RYWSA9IDA7CiAgICAgICAgRG9tRXZlbnQuZmlyZShjdXJyZW50VG91Y2gudGFyZ2V0LCBIT0xELCBldmVudE9iaik7CiAgICAgIH0sIFRBUF9IT0xEX0RFTEFZKTsKICAgICAgc2VsZi5pc1N0YXJ0ZWQgPSB0cnVlOwogICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgfSwKICAgIG1vdmU6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBsYXN0WFk7CiAgICAgIGlmICghKGxhc3RYWSA9IHNlbGYubGFzdFhZKSkgewogICAgICAgIHJldHVybiBmYWxzZTsKICAgICAgfQogICAgICB2YXIgY3VycmVudFRvdWNoID0gc2VsZi5sYXN0VG91Y2hlc1swXTsKICAgICAgaWYgKCFjdXJyZW50VG91Y2ggfHwgTWF0aC5hYnMoY3VycmVudFRvdWNoLnBhZ2VYIC0gbGFzdFhZLnBhZ2VYKSA+IFRPVUNIX01PVkVfU0VOU0lUSVZJVFkgfHwgTWF0aC5hYnMoY3VycmVudFRvdWNoLnBhZ2VZIC0gbGFzdFhZLnBhZ2VZKSA+IFRPVUNIX01PVkVfU0VOU0lUSVZJVFkpIHsKICAgICAgICBjbGVhclRpbWVycyhzZWxmKTsKICAgICAgICByZXR1cm4gZmFsc2U7CiAgICAgIH0KICAgICAgcmV0dXJuIHVuZGVmaW5lZDsKICAgIH0sCiAgICBlbmQ6IGZ1bmN0aW9uIChlLCBtb3JlVG91Y2hlcykgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGxhc3RYWTsKICAgICAgY2xlYXJUaW1lcnMoc2VsZik7CiAgICAgIGlmIChtb3JlVG91Y2hlcykgewogICAgICAgIHJldHVybjsKICAgICAgfQogICAgICBpZiAoIShsYXN0WFkgPSBzZWxmLmxhc3RYWSkpIHsKICAgICAgICByZXR1cm47CiAgICAgIH0KICAgICAgdmFyIHRvdWNoID0gc2VsZi5sYXN0VG91Y2hlc1swXTsKICAgICAgdmFyIHRhcmdldCA9IHRvdWNoLnRhcmdldDsKICAgICAgdmFyIGV2ZW50T2JqZWN0ID0gbmV3IERvbUV2ZW50T2JqZWN0KGUub3JpZ2luYWxFdmVudCk7CiAgICAgIHV0aWwubWl4KGV2ZW50T2JqZWN0LCB7CiAgICAgICAgdHlwZTogVEFQLAogICAgICAgIHdoaWNoOiAxLAogICAgICAgIHBhZ2VYOiBsYXN0WFkucGFnZVgsCiAgICAgICAgcGFnZVk6IGxhc3RYWS5wYWdlWSwKICAgICAgICB0YXJnZXQ6IHRhcmdldCwKICAgICAgICBjdXJyZW50VGFyZ2V0OiB0YXJnZXQKICAgICAgfSk7CiAgICAgIERvbUV2ZW50LmZpcmUodGFyZ2V0LCBUQVAsIGV2ZW50T2JqZWN0KTsKICAgICAgaWYgKGV2ZW50T2JqZWN0LmlzRGVmYXVsdFByZXZlbnRlZCgpKSB7CiAgICAgICAgaWYgKGlvcykgewogICAgICAgICAgZS5wcmV2ZW50RGVmYXVsdCgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBEb21FdmVudC5vbih0YXJnZXQub3duZXJEb2N1bWVudCB8fCB0YXJnZXQsICdjbGljaycsIHsKICAgICAgICAgICAgZm46IHByZXZlbnREZWZhdWx0LAogICAgICAgICAgICBvbmNlOiAxCiAgICAgICAgICB9KTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIGxhc3RFbmRUaW1lID0gc2VsZi5sYXN0RW5kVGltZSwgdGltZSA9IGUudGltZVN0YW1wLCBkdXJhdGlvbjsKICAgICAgc2VsZi5sYXN0RW5kVGltZSA9IHRpbWU7CiAgICAgIGlmIChsYXN0RW5kVGltZSkgewogICAgICAgIGR1cmF0aW9uID0gdGltZSAtIGxhc3RFbmRUaW1lOwogICAgICAgIGlmIChkdXJhdGlvbiA8IFNJTkdMRV9UQVBfREVMQVkpIHsKICAgICAgICAgIHNlbGYubGFzdEVuZFRpbWUgPSAwOwogICAgICAgICAgRG9tRXZlbnQuZmlyZSh0YXJnZXQsIERPVUJMRV9UQVAsIHsKICAgICAgICAgICAgcGFnZVg6IGxhc3RYWS5wYWdlWCwKICAgICAgICAgICAgcGFnZVk6IGxhc3RYWS5wYWdlWSwKICAgICAgICAgICAgd2hpY2g6IDEsCiAgICAgICAgICAgIGR1cmF0aW9uOiBkdXJhdGlvbiAvIDEwMDAKICAgICAgICAgIH0pOwogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICBkdXJhdGlvbiA9IHRpbWUgLSBzZWxmLnN0YXJ0VGltZTsKICAgICAgaWYgKGR1cmF0aW9uID4gU0lOR0xFX1RBUF9ERUxBWSkgewogICAgICAgIERvbUV2ZW50LmZpcmUodGFyZ2V0LCBTSU5HTEVfVEFQLCB7CiAgICAgICAgICBwYWdlWDogbGFzdFhZLnBhZ2VYLAogICAgICAgICAgcGFnZVk6IGxhc3RYWS5wYWdlWSwKICAgICAgICAgIHdoaWNoOiAxLAogICAgICAgICAgZHVyYXRpb246IGR1cmF0aW9uIC8gMTAwMAogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHNlbGYuc2luZ2xlVGFwVGltZXIgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIERvbUV2ZW50LmZpcmUodGFyZ2V0LCBTSU5HTEVfVEFQLCB7CiAgICAgICAgICAgIHBhZ2VYOiBsYXN0WFkucGFnZVgsCiAgICAgICAgICAgIHBhZ2VZOiBsYXN0WFkucGFnZVksCiAgICAgICAgICAgIHdoaWNoOiAxLAogICAgICAgICAgICBkdXJhdGlvbjogKHV0aWwubm93KCkgLSBzZWxmLnN0YXJ0VGltZSkgLyAxMDAwCiAgICAgICAgICB9KTsKICAgICAgICB9LCBTSU5HTEVfVEFQX0RFTEFZKTsKICAgICAgfQogICAgfQogIH0pOwogIGFkZEdlc3R1cmVFdmVudChbCiAgICBUQVAsCiAgICBET1VCTEVfVEFQLAogICAgU0lOR0xFX1RBUCwKICAgIEhPTEQKICBdLCB7IGhhbmRsZTogbmV3IFRhcCgpIH0pOwogIGV4cG9ydHMgPSB7CiAgICBUQVA6IFRBUCwKICAgIFNJTkdMRV9UQVA6IFNJTkdMRV9UQVAsCiAgICBET1VCTEVfVEFQOiBET1VCTEVfVEFQLAogICAgSE9MRDogSE9MRAogIH07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKZXZlbnRUb3VjaExpYkJhc2ljID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgRG9tRXZlbnQgPSBldmVudERvbUJhc2U7CiAgdmFyIEdlc3R1cmVVdGlsID0gZXZlbnRUb3VjaExpYlV0aWw7CiAgdmFyIGFkZEdlc3R1cmVFdmVudCA9IEdlc3R1cmVVdGlsLmFkZEV2ZW50OwogIHZhciBCYXNpY0dlc3R1cmUgPSBleHBvcnRzID0gewogICAgU1RBUlQ6ICdrc0dlc3R1cmVTdGFydCcsCiAgICBNT1ZFOiAna3NHZXN0dXJlTW92ZScsCiAgICBFTkQ6ICdrc0dlc3R1cmVFbmQnCiAgfTsKICBmdW5jdGlvbiBhZGRCYXNpY0dlc3R1cmVFdmVudChldmVudCwgb25IYW5kbGVyKSB7CiAgICB2YXIgaGFuZGxlID0geyBpc0FjdGl2ZTogMSB9OwogICAgaGFuZGxlW29uSGFuZGxlcl0gPSBmdW5jdGlvbiAoZSkgewogICAgICBEb21FdmVudC5maXJlKGUudGFyZ2V0LCBldmVudCwgZSk7CiAgICB9OwogICAgYWRkR2VzdHVyZUV2ZW50KGV2ZW50LCB7CiAgICAgIG9yZGVyOiAxLAogICAgICBoYW5kbGU6IGhhbmRsZQogICAgfSk7CiAgfQogIGFkZEJhc2ljR2VzdHVyZUV2ZW50KEJhc2ljR2VzdHVyZS5TVEFSVCwgJ29uVG91Y2hTdGFydCcpOwogIGFkZEJhc2ljR2VzdHVyZUV2ZW50KEJhc2ljR2VzdHVyZS5NT1ZFLCAnb25Ub3VjaE1vdmUnKTsKICBhZGRCYXNpY0dlc3R1cmVFdmVudChCYXNpY0dlc3R1cmUuRU5ELCAnb25Ub3VjaEVuZCcpOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmV2ZW50VG91Y2hJbmRleCA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIHV0aWwgPSB1dGlsQmFzZTsKICB2YXIgZG9tRXZlbnQgPSBldmVudERvbUJhc2U7CiAgdmFyIEJhc2ljR2VzdHVyZUV2ZW50ID0gZXZlbnRUb3VjaExpYkJhc2ljOwogIHZhciBTd2lwZUdlc3R1cmVFdmVudCA9IGV2ZW50VG91Y2hMaWJTd2lwZTsKICB2YXIgVGFwR2VzdHVyZUV2ZW50ID0gZXZlbnRUb3VjaExpYlRhcDsKICB2YXIgR2VzdHVyZVV0aWwgPSBldmVudFRvdWNoTGliVXRpbDsKICB2YXIgVG91Y2hFdmVudCA9IHsKICAgIEJhc2ljR2VzdHVyZUV2ZW50OiBCYXNpY0dlc3R1cmVFdmVudCwKICAgIFN3aXBlR2VzdHVyZUV2ZW50OiBTd2lwZUdlc3R1cmVFdmVudCwKICAgIFRhcEdlc3R1cmVFdmVudDogVGFwR2VzdHVyZUV2ZW50CiAgfTsKICBUb3VjaEV2ZW50Ll9nZXN0dXJlVXRpbCA9IEdlc3R1cmVVdGlsOwogIHV0aWwubWl4KGRvbUV2ZW50LCBUb3VjaEV2ZW50KTsKICBleHBvcnRzID0gVG91Y2hFdmVudDsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gZXZlbnRUb3VjaEluZGV4Owp9KTtkZWZpbmUoIm5vZGUtYW5pbSIsIFsibm9kZS1iYXNlIiwnYW5pbScsJ3V0aWwnXSwgZnVuY3Rpb24ocmVxdWlyZSkgewp2YXIgbm9kZUJhc2UgPSByZXF1aXJlKCJub2RlLWJhc2UiKTsKdmFyIGFuaW1UcmFuc2l0aW9uID0gcmVxdWlyZSgnYW5pbScpOwp2YXIgdXRpbEJhc2UgPSByZXF1aXJlKCd1dGlsJyk7Ci8vISBDb3B5cmlnaHQgMjAxNSwgbm9kZS1hbmltQDYuMS4yIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAxMjoyNjowMSBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6Cm5vZGUtYW5pbQpub2RlLWFuaW0vbGliL2F0dGFjaAoqLwp2YXIgbm9kZUFuaW1MaWJBdHRhY2gsIG5vZGVBbmltSW5kZXg7Cm5vZGVBbmltTGliQXR0YWNoID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlCiAgICogYW5pbS1ub2RlLXBsdWdpbgogICAqIEBhdXRob3IgeWltaW5naGVAZ21haWwuY29tLAogICAqICAgICAgICAgbGlmZXNpbmdlckBnbWFpbC5jb20sCiAgICogICAgICAgICBxaWFvaHVhQHRhb2Jhby5jb20sCiAgICovCiAgdmFyIE5vZGVCYXNlID0gbm9kZUJhc2U7CiAgdmFyIEFuaW0gPSBhbmltVHJhbnNpdGlvbjsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBOb2RlQmFzZS5Eb207CiAgdmFyIEZYID0gWwogICAgLy8gaGVpZ2h0IGFuaW1hdGlvbnMKICAgIFsKICAgICAgJ2hlaWdodCcsCiAgICAgICdtYXJnaW4tdG9wJywKICAgICAgJ21hcmdpbi1ib3R0b20nLAogICAgICAncGFkZGluZy10b3AnLAogICAgICAncGFkZGluZy1ib3R0b20nCiAgICBdLAogICAgLy8gd2lkdGggYW5pbWF0aW9ucwogICAgWwogICAgICAnd2lkdGgnLAogICAgICAnbWFyZ2luLWxlZnQnLAogICAgICAnbWFyZ2luLXJpZ2h0JywKICAgICAgJ3BhZGRpbmctbGVmdCcsCiAgICAgICdwYWRkaW5nLXJpZ2h0JwogICAgXSwKICAgIC8vIG9wYWNpdHkgYW5pbWF0aW9ucwogICAgWydvcGFjaXR5J10KICBdOwogIGZ1bmN0aW9uIGdldEZ4cyh0eXBlLCBudW0sIGZyb20pIHsKICAgIHZhciByZXQgPSBbXSwgb2JqID0ge307CiAgICBmb3IgKHZhciBpID0gZnJvbSB8fCAwOyBpIDwgbnVtOyBpKyspIHsKICAgICAgcmV0LnB1c2guYXBwbHkocmV0LCBGWFtpXSk7CiAgICB9CiAgICBmb3IgKGkgPSAwOyBpIDwgcmV0Lmxlbmd0aDsgaSsrKSB7CiAgICAgIG9ialtyZXRbaV1dID0gdHlwZTsKICAgIH0KICAgIHJldHVybiBvYmo7CiAgfQogIHV0aWwuYXVnbWVudChOb2RlQmFzZSwgewogICAgLyoqCiAgICAgKiBhbmltYXRlIGZvciBjdXJyZW50IG5vZGUgbGlzdC4KICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBtZW1iZXIgS0lTU1kuTm9kZQogICAgICovCiAgICBhbmltYXRlOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpcywgbCA9IHNlbGYubGVuZ3RoLCBuZWVkQ2xvbmUgPSBzZWxmLmxlbmd0aCA+IDEsIG9yaWdpbkFyZ3MgPSB1dGlsLm1ha2VBcnJheShhcmd1bWVudHMpOwogICAgICB2YXIgY2ZnID0gb3JpZ2luQXJnc1swXTsKICAgICAgdmFyIEFuaW1Db25zdHJ1Y3RvciA9IEFuaW07CiAgICAgIGlmIChjZmcudG8pIHsKICAgICAgICBBbmltQ29uc3RydWN0b3IgPSBjZmcuQW5pbSB8fCBBbmltOwogICAgICB9IGVsc2UgewogICAgICAgIGNmZyA9IG9yaWdpbkFyZ3NbMV07CiAgICAgICAgaWYgKGNmZykgewogICAgICAgICAgQW5pbUNvbnN0cnVjdG9yID0gY2ZnLkFuaW0gfHwgQW5pbTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBsOyBpKyspIHsKICAgICAgICB2YXIgZWxlbSA9IHNlbGZbaV07CiAgICAgICAgdmFyIGFyZ3MgPSBuZWVkQ2xvbmUgPyB1dGlsLmNsb25lKG9yaWdpbkFyZ3MpIDogb3JpZ2luQXJncywgYXJnMCA9IGFyZ3NbMF07CiAgICAgICAgaWYgKGFyZzAudG8pIHsKICAgICAgICAgIGFyZzAubm9kZSA9IGVsZW07CiAgICAgICAgICBuZXcgQW5pbUNvbnN0cnVjdG9yKGFyZzApLnJ1bigpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBBbmltQ29uc3RydWN0b3IuYXBwbHkodW5kZWZpbmVkLCBbZWxlbV0uY29uY2F0KGFyZ3MpKS5ydW4oKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgcmV0dXJuIHNlbGY7CiAgICB9LAogICAgLyoqCiAgICAgKiBzdG9wIGFuaW0gb2YgY3VycmVudCBub2RlIGxpc3QuCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IFtlbmRdIHNlZSB7QGxpbmsgS0lTU1kuQW5pbSNzdGF0aWMtbWV0aG9kLXN0b3B9CiAgICAgKiBAcGFyYW0gW2NsZWFyUXVldWVdCiAgICAgKiBAcGFyYW0gW3F1ZXVlXQogICAgICogQGNoYWluYWJsZQogICAgICogQG1lbWJlciBLSVNTWS5Ob2RlCiAgICAgKi8KICAgIHN0b3A6IGZ1bmN0aW9uIChlbmQsIGNsZWFyUXVldWUsIHF1ZXVlKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdXRpbC5lYWNoKHNlbGYsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgQW5pbS5zdG9wKGVsZW0sIGVuZCwgY2xlYXJRdWV1ZSwgcXVldWUpOwogICAgICB9KTsKICAgICAgcmV0dXJuIHNlbGY7CiAgICB9LAogICAgLyoqCiAgICAgKiBwYXVzZSBhbmltIG9mIGN1cnJlbnQgbm9kZSBsaXN0LgogICAgICogQHBhcmFtIHtCb29sZWFufSBlbmQgc2VlIHtAbGluayBLSVNTWS5BbmltI3N0YXRpYy1tZXRob2QtcGF1c2V9CiAgICAgKiBAcGFyYW0gcXVldWUKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBtZW1iZXIgS0lTU1kuTm9kZQogICAgICovCiAgICBwYXVzZTogZnVuY3Rpb24gKGVuZCwgcXVldWUpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICB1dGlsLmVhY2goc2VsZiwgZnVuY3Rpb24gKGVsZW0pIHsKICAgICAgICBBbmltLnBhdXNlKGVsZW0sIHF1ZXVlKTsKICAgICAgfSk7CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIC8qKgogICAgICogcmVzdW1lIGFuaW0gb2YgY3VycmVudCBub2RlIGxpc3QuCiAgICAgKiBAcGFyYW0ge0Jvb2xlYW59IGVuZCBzZWUge0BsaW5rIEtJU1NZLkFuaW0jc3RhdGljLW1ldGhvZC1yZXN1bWV9CiAgICAgKiBAcGFyYW0gcXVldWUKICAgICAqIEBjaGFpbmFibGUKICAgICAqIEBtZW1iZXIgS0lTU1kuTm9kZQogICAgICovCiAgICByZXN1bWU6IGZ1bmN0aW9uIChlbmQsIHF1ZXVlKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgdXRpbC5lYWNoKHNlbGYsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgQW5pbS5yZXN1bWUoZWxlbSwgcXVldWUpOwogICAgICB9KTsKICAgICAgcmV0dXJuIHNlbGY7CiAgICB9LAogICAgLyoqCiAgICAgKiB3aGV0aGVyIG9uZSBvZiBjdXJyZW50IG5vZGUgbGlzdCBpcyBhbmltYXRpbmcuCiAgICAgKiBAcmV0dXJuIHtCb29sZWFufQogICAgICogQG1lbWJlciBLSVNTWS5Ob2RlCiAgICAgKi8KICAgIGlzUnVubmluZzogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXM7CiAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgc2VsZi5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChBbmltLmlzUnVubmluZyhzZWxmW2ldKSkgewogICAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBmYWxzZTsKICAgIH0sCiAgICAvKioKICAgICAqIHdoZXRoZXIgb25lIG9mIGN1cnJlbnQgbm9kZSBsaXN0ICdzIGFuaW1hdGlvbiBpcyBwYXVzZWQuCiAgICAgKiBAcmV0dXJuIHtCb29sZWFufQogICAgICogQG1lbWJlciBLSVNTWS5Ob2RlCiAgICAgKi8KICAgIGlzUGF1c2VkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgZm9yICh2YXIgaSA9IDA7IGkgPCBzZWxmLmxlbmd0aDsgaSsrKSB7CiAgICAgICAgaWYgKEFuaW0uaXNQYXVzZWQoc2VsZltpXSkpIHsKICAgICAgICAgIHJldHVybiB0cnVlOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gZmFsc2U7CiAgICB9CiAgfSk7CiAgLyoqCiAgICogYW5pbWF0ZSBzaG93IGVmZmVjdCBmb3IgY3VycmVudCBub2RlIGxpc3QuCiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1cmF0aW9uIGR1cmF0aW9uIG9mIGVmZmVjdAogICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wbGV0ZV0gY2FsbGJhY2sgZnVuY3Rpb24gb24gYW5pbSBjb21wbGV0ZS4KICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gW2Vhc2luZ10gZWFzaW5nIHR5cGUgb3IgY3VzdG9tIGZ1bmN0aW9uLgogICAqIEBjaGFpbmFibGUKICAgKiBAbWVtYmVyIEtJU1NZLk5vZGUKICAgKiBAbWV0aG9kIHNob3cKICAgKi8KICAvKioKICAgKiBhbmltYXRlIGhpZGUgZWZmZWN0IGZvciBjdXJyZW50IG5vZGUgbGlzdC4KICAgKiBAcGFyYW0ge051bWJlcn0gZHVyYXRpb24gZHVyYXRpb24gb2YgZWZmZWN0CiAgICogQHBhcmFtIHtGdW5jdGlvbn0gW2NvbXBsZXRlXSBjYWxsYmFjayBmdW5jdGlvbiBvbiBhbmltIGNvbXBsZXRlLgogICAqIEBwYXJhbSB7U3RyaW5nfEZ1bmN0aW9ufSBbZWFzaW5nXSBlYXNpbmcgdHlwZSBvciBjdXN0b20gZnVuY3Rpb24uCiAgICogQGNoYWluYWJsZQogICAqIEBtZW1iZXIgS0lTU1kuTm9kZQogICAqIEBtZXRob2QgaGlkZQogICAqLwogIC8qKgogICAqIHRvZ2dsZSBzaG93IGFuZCBoaWRlIGVmZmVjdCBmb3IgY3VycmVudCBub2RlIGxpc3QuCiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1cmF0aW9uIGR1cmF0aW9uIG9mIGVmZmVjdAogICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wbGV0ZV0gY2FsbGJhY2sgZnVuY3Rpb24gb24gYW5pbSBjb21wbGV0ZS4KICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gW2Vhc2luZ10gZWFzaW5nIHR5cGUgb3IgY3VzdG9tIGZ1bmN0aW9uLgogICAqIEBjaGFpbmFibGUKICAgKiBAbWVtYmVyIEtJU1NZLk5vZGUKICAgKiBAbWV0aG9kIHRvZ2dsZQogICAqLwogIC8qKgogICAqIGFuaW1hdGUgZmFkZUluIGVmZmVjdCBmb3IgY3VycmVudCBub2RlIGxpc3QuCiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1cmF0aW9uIGR1cmF0aW9uIG9mIGVmZmVjdAogICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wbGV0ZV0gY2FsbGJhY2sgZnVuY3Rpb24gb24gYW5pbSBjb21wbGV0ZS4KICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gW2Vhc2luZ10gZWFzaW5nIHR5cGUgb3IgY3VzdG9tIGZ1bmN0aW9uLgogICAqIEBjaGFpbmFibGUKICAgKiBAbWVtYmVyIEtJU1NZLk5vZGUKICAgKiBAbWV0aG9kIGZhZGVJbgogICAqLwogIC8qKgogICAqIGFuaW1hdGUgZmFkZU91dCBlZmZlY3QgZm9yIGN1cnJlbnQgbm9kZSBsaXN0LgogICAqIEBwYXJhbSB7TnVtYmVyfSBkdXJhdGlvbiBkdXJhdGlvbiBvZiBlZmZlY3QKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGxldGVdIGNhbGxiYWNrIGZ1bmN0aW9uIG9uIGFuaW0gY29tcGxldGUuCiAgICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IFtlYXNpbmddIGVhc2luZyB0eXBlIG9yIGN1c3RvbSBmdW5jdGlvbi4KICAgKiBAY2hhaW5hYmxlCiAgICogQG1lbWJlciBLSVNTWS5Ob2RlCiAgICogQG1ldGhvZCBmYWRlT3V0CiAgICovCiAgLyoqCiAgICogdG9nZ2xlIGZhZGVJbiBhbmQgZmFkZU91dCBlZmZlY3QgZm9yIGN1cnJlbnQgbm9kZSBsaXN0LgogICAqIEBwYXJhbSB7TnVtYmVyfSBkdXJhdGlvbiBkdXJhdGlvbiBvZiBlZmZlY3QKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGxldGVdIGNhbGxiYWNrIGZ1bmN0aW9uIG9uIGFuaW0gY29tcGxldGUuCiAgICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IFtlYXNpbmddIGVhc2luZyB0eXBlIG9yIGN1c3RvbSBmdW5jdGlvbi4KICAgKiBAY2hhaW5hYmxlCiAgICogQG1lbWJlciBLSVNTWS5Ob2RlCiAgICogQG1ldGhvZCBmYWRlVG9nZ2xlCiAgICovCiAgLyoqCiAgICogYW5pbWF0ZSBzbGlkZVVwIGVmZmVjdCBmb3IgY3VycmVudCBub2RlIGxpc3QuCiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1cmF0aW9uIGR1cmF0aW9uIG9mIGVmZmVjdAogICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wbGV0ZV0gY2FsbGJhY2sgZnVuY3Rpb24gb24gYW5pbSBjb21wbGV0ZS4KICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gW2Vhc2luZ10gZWFzaW5nIHR5cGUgb3IgY3VzdG9tIGZ1bmN0aW9uLgogICAqIEBjaGFpbmFibGUKICAgKiBAbWVtYmVyIEtJU1NZLk5vZGUKICAgKiBAbWV0aG9kIHNsaWRlVXAKICAgKi8KICAvKioKICAgKiBhbmltYXRlIHNsaWRlRG93biBlZmZlY3QgZm9yIGN1cnJlbnQgbm9kZSBsaXN0LgogICAqIEBwYXJhbSB7TnVtYmVyfSBkdXJhdGlvbiBkdXJhdGlvbiBvZiBlZmZlY3QKICAgKiBAcGFyYW0ge0Z1bmN0aW9ufSBbY29tcGxldGVdIGNhbGxiYWNrIGZ1bmN0aW9uIG9uIGFuaW0gY29tcGxldGUuCiAgICogQHBhcmFtIHtTdHJpbmd8RnVuY3Rpb259IFtlYXNpbmddIGVhc2luZyB0eXBlIG9yIGN1c3RvbSBmdW5jdGlvbi4KICAgKiBAY2hhaW5hYmxlCiAgICogQG1lbWJlciBLSVNTWS5Ob2RlCiAgICogQG1ldGhvZCBzbGlkZURvd24KICAgKi8KICAvKioKICAgKiB0b2dnbGUgc2xpZGVVcCBhbmQgc2xpZGVEb3duIGVmZmVjdCBmb3IgY3VycmVudCBub2RlIGxpc3QuCiAgICogQHBhcmFtIHtOdW1iZXJ9IGR1cmF0aW9uIGR1cmF0aW9uIG9mIGVmZmVjdAogICAqIEBwYXJhbSB7RnVuY3Rpb259IFtjb21wbGV0ZV0gY2FsbGJhY2sgZnVuY3Rpb24gb24gYW5pbSBjb21wbGV0ZS4KICAgKiBAcGFyYW0ge1N0cmluZ3xGdW5jdGlvbn0gW2Vhc2luZ10gZWFzaW5nIHR5cGUgb3IgY3VzdG9tIGZ1bmN0aW9uLgogICAqIEBjaGFpbmFibGUKICAgKiBAbWVtYmVyIEtJU1NZLk5vZGUKICAgKiBAbWV0aG9kIHNsaWRlVG9nZ2xlCiAgICovCiAgdXRpbC5lYWNoKHsKICAgIHNob3c6IGdldEZ4cygnc2hvdycsIDMpLAogICAgaGlkZTogZ2V0RnhzKCdoaWRlJywgMyksCiAgICB0b2dnbGU6IGdldEZ4cygndG9nZ2xlJywgMyksCiAgICBmYWRlSW46IGdldEZ4cygnc2hvdycsIDMsIDIpLAogICAgZmFkZU91dDogZ2V0RnhzKCdoaWRlJywgMywgMiksCiAgICBmYWRlVG9nZ2xlOiBnZXRGeHMoJ3RvZ2dsZScsIDMsIDIpLAogICAgc2xpZGVEb3duOiBnZXRGeHMoJ3Nob3cnLCAxKSwKICAgIHNsaWRlVXA6IGdldEZ4cygnaGlkZScsIDEpLAogICAgc2xpZGVUb2dnbGU6IGdldEZ4cygndG9nZ2xlJywgMSkKICB9LCBmdW5jdGlvbiAodiwgaykgewogICAgTm9kZUJhc2UucHJvdG90eXBlW2tdID0gZnVuY3Rpb24gKGR1cmF0aW9uLCBjb21wbGV0ZSwgZWFzaW5nKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgLy8g5rKh5pyJ5Y+C5pWw5pe277yM6LCD55SoIERvbSDkuK3nmoTlr7nlupTmlrnms5UKICAgICAgaWYgKERvbVtrXSAmJiAhZHVyYXRpb24pIHsKICAgICAgICBEb21ba10oc2VsZik7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgdmFyIEFuaW1Db25zdHJ1Y3RvciA9IEFuaW07CiAgICAgICAgaWYgKHR5cGVvZiBkdXJhdGlvbiA9PT0gJ29iamVjdCcpIHsKICAgICAgICAgIEFuaW1Db25zdHJ1Y3RvciA9IGR1cmF0aW9uLkFuaW0gfHwgQW5pbTsKICAgICAgICB9CiAgICAgICAgdXRpbC5lYWNoKHNlbGYsIGZ1bmN0aW9uIChlbGVtKSB7CiAgICAgICAgICBuZXcgQW5pbUNvbnN0cnVjdG9yKGVsZW0sIHYsIGR1cmF0aW9uLCBlYXNpbmcsIGNvbXBsZXRlKS5ydW4oKTsKICAgICAgICB9KTsKICAgICAgfQogICAgICByZXR1cm4gc2VsZjsKICAgIH07CiAgfSk7CiAgZXhwb3J0cyA9IE5vZGVCYXNlOwogIHJldHVybiBleHBvcnRzOwp9KCk7Cm5vZGVBbmltSW5kZXggPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIGV4cG9ydHMgPSBub2RlQW5pbUxpYkF0dGFjaDsKICByZXR1cm4gZXhwb3J0czsKfSgpOwpyZXR1cm4gbm9kZUFuaW1JbmRleDsKfSk7ZGVmaW5lKCJhbmltLXRyYW5zaXRpb24iLCBbJ3V0aWwnLCdkb20nLCJhbmltLWJhc2UiLCJmZWF0dXJlIl0sIGZ1bmN0aW9uKHJlcXVpcmUpIHsKdmFyIHV0aWxCYXNlID0gcmVxdWlyZSgndXRpbCcpOwp2YXIgZG9tQmFzZSA9IHJlcXVpcmUoJ2RvbScpOwp2YXIgYW5pbUJhc2UgPSByZXF1aXJlKCJhbmltLWJhc2UiKTsKdmFyIGZlYXR1cmUgPSByZXF1aXJlKCJmZWF0dXJlIik7Ci8vISBDb3B5cmlnaHQgMjAxNSwgYW5pbS10cmFuc2l0aW9uQDYuMS4yIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogVGh1LCAyOSBPY3QgMjAxNSAwNjo1NzoxNiBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmFuaW0tdHJhbnNpdGlvbgphbmltLXRyYW5zaXRpb24vbGliL3RyYW5zaXRpb24KKi8KdmFyIGFuaW1UcmFuc2l0aW9uTGliVHJhbnNpdGlvbiwgYW5pbVRyYW5zaXRpb25JbmRleDsKYW5pbVRyYW5zaXRpb25MaWJUcmFuc2l0aW9uID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBhbmltYXRpb24gdXNpbmcgY3NzIHRyYW5zaXRpb24KICAgKiBAYXV0aG9yIHlpbWluZ2hlQGdtYWlsLmNvbQogICAqIEBpZ25vcmUKICAgKi8KICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIHZhciBEb20gPSBkb21CYXNlOwogIHZhciBBbmltQmFzZSA9IGFuaW1CYXNlOwogIHZhciBGZWF0dXJlID0gZmVhdHVyZTsKICB2YXIgZ2V0Q3NzVmVuZG9ySW5mbyA9IEZlYXR1cmUuZ2V0Q3NzVmVuZG9ySW5mbzsKICB2YXIgdHJhbnNpdGlvblZlbmRvckluZm8gPSBnZXRDc3NWZW5kb3JJbmZvKCd0cmFuc2l0aW9uJyk7CiAgZnVuY3Rpb24gZ2VuVHJhbnNpdGlvbihwcm9wc0RhdGEpIHsKICAgIHZhciBzdHIgPSAnJzsKICAgIHV0aWwuZWFjaChwcm9wc0RhdGEsIGZ1bmN0aW9uIChwcm9wRGF0YSwgcHJvcCkgewogICAgICBpZiAoc3RyKSB7CiAgICAgICAgc3RyICs9ICcsJzsKICAgICAgfQogICAgICBzdHIgKz0gcHJvcCArICcgJyArIHByb3BEYXRhLmR1cmF0aW9uICsgJ3MgJyArIHByb3BEYXRhLmVhc2luZyArICcgJyArIHByb3BEYXRhLmRlbGF5ICsgJ3MnOwogICAgfSk7CiAgICByZXR1cm4gc3RyOwogIH0KICBmdW5jdGlvbiB1bkNhbWVsQ2FzZShwcm9wZXJ0eU5hbWUpIHsKICAgIHJldHVybiBwcm9wZXJ0eU5hbWUucmVwbGFjZSgvW0EtWl0vZywgZnVuY3Rpb24gKG0pIHsKICAgICAgcmV0dXJuICctJyArIG0udG9Mb3dlckNhc2UoKTsKICAgIH0pOwogIH0KICBmdW5jdGlvbiBUcmFuc2l0aW9uQW5pbShub2RlLCB0bywgZHVyYXRpb24sIGVhc2luZywgY29tcGxldGUpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIGlmICghKHNlbGYgaW5zdGFuY2VvZiBUcmFuc2l0aW9uQW5pbSkpIHsKICAgICAgcmV0dXJuIG5ldyBUcmFuc2l0aW9uQW5pbShub2RlLCB0bywgZHVyYXRpb24sIGVhc2luZywgY29tcGxldGUpOwogICAgfQogICAgVHJhbnNpdGlvbkFuaW0uc3VwZXJjbGFzcy5jb25zdHJ1Y3Rvci5hcHBseShzZWxmLCBhcmd1bWVudHMpOwogIH0KICBpZiAodHJhbnNpdGlvblZlbmRvckluZm8pIHsKICAgIHZhciBUUkFOU0lUSU9OID0gdHJhbnNpdGlvblZlbmRvckluZm8ucHJvcGVydHlOYW1lOwogICAgdmFyIERFRkFVTFRfRUFTSU5HID0gJ2xpbmVhcic7CiAgICB2YXIgY3NzM0FuaW0gPSB7CiAgICAgIGVhc2U6IDEsCiAgICAgIGxpbmVhcjogMSwKICAgICAgJ2Vhc2UtaW4nOiAxLAogICAgICAnZWFzZS1vdXQnOiAxLAogICAgICAnZWFzZS1pbi1vdXQnOiAxCiAgICB9OwogICAgdXRpbC5leHRlbmQoVHJhbnNpdGlvbkFuaW0sIEFuaW1CYXNlLCB7CiAgICAgIHByZXBhcmVGeDogZnVuY3Rpb24gKCkgewogICAgICAgIHZhciBzZWxmID0gdGhpcywgcHJvcHNEYXRhID0gc2VsZi5fcHJvcHNEYXRhOwogICAgICAgIHZhciBuZXdQcm9wcyA9IHt9OwogICAgICAgIHZhciB2YWw7CiAgICAgICAgdmFyIHZlbmRvckluZm87CiAgICAgICAgZm9yICh2YXIgcHJvcGVydHlOYW1lIGluIHByb3BzRGF0YSkgewogICAgICAgICAgdmFsID0gcHJvcHNEYXRhW3Byb3BlcnR5TmFtZV07CiAgICAgICAgICBpZiAodHlwZW9mIHZhbC5lYXNpbmcgPT09ICdzdHJpbmcnKSB7CiAgICAgICAgICAgIGlmICghdXRpbC5zdGFydHNXaXRoKHZhbC5lYXNpbmcsICdjdWJpYy1iZXppZXInKSAmJiAhY3NzM0FuaW1bdmFsLmVhc2luZ10pIHsKICAgICAgICAgICAgICB2YWwuZWFzaW5nID0gREVGQVVMVF9FQVNJTkc7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgIHZhbC5lYXNpbmcgPSBERUZBVUxUX0VBU0lORzsKICAgICAgICAgIH0KICAgICAgICAgIHZlbmRvckluZm8gPSBnZXRDc3NWZW5kb3JJbmZvKHByb3BlcnR5TmFtZSk7CiAgICAgICAgICBpZiAoIXZlbmRvckluZm8pIHsKICAgICAgICAgICAgY29uc29sZS5lcnJvcignYW5pbTogdW5zdXBwb3J0ZWQgY3NzIHByb3BlcnR5IGZvciB0cmFuc2l0aW9uIGFuaW06ICcgKyBwcm9wZXJ0eU5hbWUpOwogICAgICAgICAgICBjb250aW51ZTsKICAgICAgICAgIH0KICAgICAgICAgIG5ld1Byb3BzW3VuQ2FtZWxDYXNlKHZlbmRvckluZm8ucHJvcGVydHlOYW1lKV0gPSBwcm9wc0RhdGFbcHJvcGVydHlOYW1lXTsKICAgICAgICB9CiAgICAgICAgc2VsZi5fcHJvcHNEYXRhID0gbmV3UHJvcHM7CiAgICAgIH0sCiAgICAgIGRvU3RhcnQ6IGZ1bmN0aW9uICgpIHsKICAgICAgICB2YXIgc2VsZiA9IHRoaXMsIG5vZGUgPSBzZWxmLm5vZGUsIGVsU3R5bGUgPSBub2RlLnN0eWxlLCBfcHJvcHNEYXRhID0gc2VsZi5fcHJvcHNEYXRhLCBvcmlnaW5hbCA9IGVsU3R5bGVbVFJBTlNJVElPTl0sIHRvdGFsRHVyYXRpb24gPSAwLCBwcm9wc0NzcyA9IHt9OwogICAgICAgIHV0aWwuZWFjaChfcHJvcHNEYXRhLCBmdW5jdGlvbiAocHJvcERhdGEsIHByb3ApIHsKICAgICAgICAgIHZhciB2ID0gcHJvcERhdGEudmFsdWU7CiAgICAgICAgICAvLyBoYWNrLCBmb3IgdG8gcmVmbG93PwogICAgICAgICAgRG9tLmNzcyhub2RlLCBwcm9wLCBEb20uY3NzKG5vZGUsIHByb3ApKTsKICAgICAgICAgIHByb3BzQ3NzW3Byb3BdID0gdjsKICAgICAgICAgIHRvdGFsRHVyYXRpb24gPSBNYXRoLm1heChwcm9wRGF0YS5kdXJhdGlvbiArIHByb3BEYXRhLmRlbGF5LCB0b3RhbER1cmF0aW9uKTsKICAgICAgICB9KTsKICAgICAgICAvLyBjaHJvbWUgbm9uZQogICAgICAgIC8vIGZpcmVmb3ggbm9uZSAwcyBlYXNlIDBzCiAgICAgICAgaWYgKG9yaWdpbmFsLmluZGV4T2YoJ25vbmUnKSAhPT0gLTEpIHsKICAgICAgICAgIG9yaWdpbmFsID0gJyc7CiAgICAgICAgfSBlbHNlIGlmIChvcmlnaW5hbCkgewogICAgICAgICAgb3JpZ2luYWwgKz0gJywnOwogICAgICAgIH0KICAgICAgICBlbFN0eWxlW1RSQU5TSVRJT05dID0gb3JpZ2luYWwgKyBnZW5UcmFuc2l0aW9uKF9wcm9wc0RhdGEpOwogICAgICAgIC8vIGJ1ZyB3aGVuIHNldCBsZWZ0IG9uIHJlbGF0aXZlIGVsZW1lbnQKICAgICAgICBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIERvbS5jc3Mobm9kZSwgcHJvcHNDc3MpOwogICAgICAgIH0sIDApOwogICAgICAgIC8vIHRpbWVyIGlzIG1vcmUgcmVsaWFibGUgYW5kIGNhbiBkZWFsIHdpdGggc2hvcnQgaGFuZCBjc3MgcHJvcGVydGllcwogICAgICAgIHNlbGYuX3RyYW5zaXRpb25FbmRUaW1lciA9IHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgICAgc2VsZi5zdG9wKHRydWUpOwogICAgICAgIH0sIHRvdGFsRHVyYXRpb24gKiAxMDAwKTsKICAgICAgfSwKICAgICAgYmVmb3JlUmVzdW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgICAgLy8gbm90ZTogcGF1c2UvcmVzdW1lIGluIGNzcyB0cmFuc2l0aW9uIGlzIG5vdCBzbW9vdGggYXMganMgdGltZXIKICAgICAgICAvLyBhbHJlYWR5IHJ1biB0aW1lIGJlZm9yZSBwYXVzZQogICAgICAgIHZhciBzZWxmID0gdGhpcywgcHJvcHNEYXRhID0gc2VsZi5fcHJvcHNEYXRhLCB0bXBQcm9wc0RhdGEgPSB1dGlsLm1lcmdlKHByb3BzRGF0YSksIHJ1blRpbWUgPSBzZWxmLl9ydW5UaW1lIC8gMTAwMDsKICAgICAgICB1dGlsLmVhY2godG1wUHJvcHNEYXRhLCBmdW5jdGlvbiAocHJvcERhdGEsIHByb3ApIHsKICAgICAgICAgIHZhciB0UnVuVGltZSA9IHJ1blRpbWU7CiAgICAgICAgICBpZiAocHJvcERhdGEuZGVsYXkgPj0gdFJ1blRpbWUpIHsKICAgICAgICAgICAgcHJvcERhdGEuZGVsYXkgLT0gdFJ1blRpbWU7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0UnVuVGltZSAtPSBwcm9wRGF0YS5kZWxheTsKICAgICAgICAgICAgcHJvcERhdGEuZGVsYXkgPSAwOwogICAgICAgICAgICBpZiAocHJvcERhdGEuZHVyYXRpb24gPj0gdFJ1blRpbWUpIHsKICAgICAgICAgICAgICBwcm9wRGF0YS5kdXJhdGlvbiAtPSB0UnVuVGltZTsKICAgICAgICAgICAgfSBlbHNlIHsKICAgICAgICAgICAgICBkZWxldGUgcHJvcHNEYXRhW3Byb3BdOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgfSk7CiAgICAgIH0sCiAgICAgIGRvU3RvcDogZnVuY3Rpb24gKGZpbmlzaCkgewogICAgICAgIHZhciBzZWxmID0gdGhpcywgbm9kZSA9IHNlbGYubm9kZSwgZWxTdHlsZSA9IG5vZGUuc3R5bGUsIF9wcm9wc0RhdGEgPSBzZWxmLl9wcm9wc0RhdGEsIHByb3BMaXN0ID0gW10sIGNsZWFyLCBwcm9wc0NzcyA9IHt9OwogICAgICAgIGlmIChzZWxmLl90cmFuc2l0aW9uRW5kVGltZXIpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChzZWxmLl90cmFuc2l0aW9uRW5kVGltZXIpOwogICAgICAgICAgc2VsZi5fdHJhbnNpdGlvbkVuZFRpbWVyID0gbnVsbDsKICAgICAgICB9CiAgICAgICAgdXRpbC5lYWNoKF9wcm9wc0RhdGEsIGZ1bmN0aW9uIChwcm9wRGF0YSwgcHJvcCkgewogICAgICAgICAgaWYgKCFmaW5pc2gpIHsKICAgICAgICAgICAgcHJvcHNDc3NbcHJvcF0gPSBEb20uY3NzKG5vZGUsIHByb3ApOwogICAgICAgICAgfQogICAgICAgICAgcHJvcExpc3QucHVzaChwcm9wKTsKICAgICAgICB9KTsKICAgICAgICAvLyBmaXJlZm94IG5lZWQgc2V0IHRyYW5zaXRpb24gYW5kIG5lZWQgc2V0IG5vbmUKICAgICAgICBjbGVhciA9IHV0aWwudHJpbShlbFN0eWxlW1RSQU5TSVRJT05dLnJlcGxhY2UobmV3IFJlZ0V4cCgnKF58LCknICsgJ1xccyooPzonICsgcHJvcExpc3Quam9pbignfCcpICsgJylcXHMrW14sXSsnLCAnZ2knKSwgJyQxJykpLnJlcGxhY2UoL14sfCwsfCwkL2csICcnKSB8fCAnbm9uZSc7CiAgICAgICAgZWxTdHlsZVtUUkFOU0lUSU9OXSA9IGNsZWFyOwogICAgICAgIERvbS5jc3Mobm9kZSwgcHJvcHNDc3MpOwogICAgICB9CiAgICB9KTsKICAgIHV0aWwubWl4KFRyYW5zaXRpb25BbmltLCBBbmltQmFzZS5TdGF0aWNzKTsKICAgIC8vIGJhZAogICAgZXhwb3J0cyA9IFRyYW5zaXRpb25BbmltOwogICAgVHJhbnNpdGlvbkFuaW0uX25hbWVfID0gJ1RyYW5zaXRpb25BbmltJzsKICB9IGVsc2UgewogICAgZXhwb3J0cyA9IG51bGw7CiAgfQogIHJldHVybiBleHBvcnRzOwp9KCk7CmFuaW1UcmFuc2l0aW9uSW5kZXggPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBBbmltVHJhbnNpdGlvbiA9IGFuaW1UcmFuc2l0aW9uTGliVHJhbnNpdGlvbjsKICBleHBvcnRzID0gQW5pbVRyYW5zaXRpb247CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGFuaW1UcmFuc2l0aW9uSW5kZXg7Cn0pO2RlZmluZSgiYW5pbS1iYXNlIiwgWydkb20nLCd1dGlsJywicHJvbWlzZSJdLCBmdW5jdGlvbihyZXF1aXJlKSB7CnZhciBkb21CYXNlID0gcmVxdWlyZSgnZG9tJyk7CnZhciB1dGlsQmFzZSA9IHJlcXVpcmUoJ3V0aWwnKTsKdmFyIHByb21pc2UgPSByZXF1aXJlKCJwcm9taXNlIik7Ci8vISBDb3B5cmlnaHQgMjAxNSwgYW5pbS1iYXNlQDYuMS4xIE1JVCBMaWNlbnNlZCwgYnVpbGQgdGltZTogV2VkLCAwNCBOb3YgMjAxNSAwNDo1OTo1NyBHTVQgCi8qCmNvbWJpbmVkIG1vZHVsZXM6CmFuaW0tYmFzZQphbmltLWJhc2UvbGliL2Jhc2UKYW5pbS1iYXNlL2xpYi9iYXNlL3V0aWxzCmFuaW0tYmFzZS9saWIvYmFzZS9xdWV1ZQoqLwp2YXIgYW5pbUJhc2VMaWJCYXNlUXVldWUsIGFuaW1CYXNlTGliQmFzZVV0aWxzLCBhbmltQmFzZUxpYkJhc2UsIGFuaW1CYXNlSW5kZXg7CmFuaW1CYXNlTGliQmFzZVF1ZXVlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICAvKioKICAgKiBAaWdub3JlIHF1ZXVlIGRhdGEgc3RydWN0dXJlCiAgICogQGF1dGhvciB5aW1pbmdoZUBnbWFpbC5jb20KICAgKi8KICB2YXIgRG9tID0gZG9tQmFzZTsKICB2YXIgdXRpbCA9IHV0aWxCYXNlOwogIC8vIOmYn+WIl+mbhuWQiOWuueWZqAogIHZhciBxdWV1ZUNvbGxlY3Rpb25LZXkgPSB1dGlsLmd1aWQoJ2tzLXF1ZXVlLScgKyB1dGlsLm5vdygpICsgJy0nKSwKICAgIC8vIOm7mOiupOmYn+WIlwogICAgcXVldWVLZXkgPSB1dGlsLmd1aWQoJ2tzLXF1ZXVlLScgKyB1dGlsLm5vdygpICsgJy0nKSwgUTsKICBmdW5jdGlvbiBnZXRRdWV1ZShub2RlLCBuYW1lLCByZWFkT25seSkgewogICAgbmFtZSA9IG5hbWUgfHwgcXVldWVLZXk7CiAgICB2YXIgcXUsIHF1Q29sbGVjdGlvbiA9IERvbS5kYXRhKG5vZGUsIHF1ZXVlQ29sbGVjdGlvbktleSk7CiAgICBpZiAoIXF1Q29sbGVjdGlvbiAmJiAhcmVhZE9ubHkpIHsKICAgICAgRG9tLmRhdGEobm9kZSwgcXVldWVDb2xsZWN0aW9uS2V5LCBxdUNvbGxlY3Rpb24gPSB7fSk7CiAgICB9CiAgICBpZiAocXVDb2xsZWN0aW9uKSB7CiAgICAgIHF1ID0gcXVDb2xsZWN0aW9uW25hbWVdOwogICAgICBpZiAoIXF1ICYmICFyZWFkT25seSkgewogICAgICAgIHF1ID0gcXVDb2xsZWN0aW9uW25hbWVdID0gW107CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBxdTsKICB9CiAgUSA9IHsKICAgIHF1ZXVlQ29sbGVjdGlvbktleTogcXVldWVDb2xsZWN0aW9uS2V5LAogICAgcXVldWU6IGZ1bmN0aW9uIChub2RlLCBxdWV1ZSwgaXRlbSkgewogICAgICB2YXIgcXUgPSBnZXRRdWV1ZShub2RlLCBxdWV1ZSk7CiAgICAgIHF1LnB1c2goaXRlbSk7CiAgICAgIHJldHVybiBxdTsKICAgIH0sCiAgICByZW1vdmU6IGZ1bmN0aW9uIChub2RlLCBxdWV1ZSwgaXRlbSkgewogICAgICB2YXIgcXUgPSBnZXRRdWV1ZShub2RlLCBxdWV1ZSwgMSksIGluZGV4OwogICAgICBpZiAocXUpIHsKICAgICAgICBpbmRleCA9IHV0aWwuaW5kZXhPZihpdGVtLCBxdSk7CiAgICAgICAgaWYgKGluZGV4ID4gLTEpIHsKICAgICAgICAgIHF1LnNwbGljZShpbmRleCwgMSk7CiAgICAgICAgfQogICAgICB9CiAgICAgIGlmIChxdSAmJiAhcXUubGVuZ3RoKSB7CiAgICAgICAgLy8gcmVtb3ZlIHF1ZXVlIGRhdGEKICAgICAgICBRLmNsZWFyUXVldWUobm9kZSwgcXVldWUpOwogICAgICB9CiAgICAgIHJldHVybiBxdTsKICAgIH0sCiAgICBjbGVhclF1ZXVlczogZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgRG9tLnJlbW92ZURhdGEobm9kZSwgcXVldWVDb2xsZWN0aW9uS2V5KTsKICAgIH0sCiAgICBjbGVhclF1ZXVlOiBmdW5jdGlvbiBjbGVhclF1ZXVlKG5vZGUsIHF1ZXVlKSB7CiAgICAgIHF1ZXVlID0gcXVldWUgfHwgcXVldWVLZXk7CiAgICAgIHZhciBxdUNvbGxlY3Rpb24gPSBEb20uZGF0YShub2RlLCBxdWV1ZUNvbGxlY3Rpb25LZXkpOwogICAgICBpZiAocXVDb2xsZWN0aW9uKSB7CiAgICAgICAgZGVsZXRlIHF1Q29sbGVjdGlvbltxdWV1ZV07CiAgICAgIH0KICAgICAgaWYgKHV0aWwuaXNFbXB0eU9iamVjdChxdUNvbGxlY3Rpb24pKSB7CiAgICAgICAgRG9tLnJlbW92ZURhdGEobm9kZSwgcXVldWVDb2xsZWN0aW9uS2V5KTsKICAgICAgfQogICAgfSwKICAgIGRlcXVldWU6IGZ1bmN0aW9uIChub2RlLCBxdWV1ZSkgewogICAgICB2YXIgcXUgPSBnZXRRdWV1ZShub2RlLCBxdWV1ZSwgMSk7CiAgICAgIGlmIChxdSkgewogICAgICAgIHF1LnNoaWZ0KCk7CiAgICAgICAgaWYgKCFxdS5sZW5ndGgpIHsKICAgICAgICAgIC8vIHJlbW92ZSBxdWV1ZSBkYXRhCiAgICAgICAgICBRLmNsZWFyUXVldWUobm9kZSwgcXVldWUpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gcXU7CiAgICB9CiAgfTsKICBleHBvcnRzID0gUTsKICByZXR1cm4gZXhwb3J0czsKfSgpOwphbmltQmFzZUxpYkJhc2VVdGlscyA9IGZ1bmN0aW9uIChleHBvcnRzKSB7CiAgdmFyIFEgPSBhbmltQmFzZUxpYkJhc2VRdWV1ZSwgdXRpbCA9IHV0aWxCYXNlLCBEb20gPSBkb21CYXNlOwogIHZhciBydW5uaW5nS2V5ID0gdXRpbC5ndWlkKCdrcy1hbmltLXVucXVldWVkLScgKyB1dGlsLm5vdygpICsgJy0nKTsKICBmdW5jdGlvbiBzYXZlUnVubmluZ0FuaW0oYW5pbSkgewogICAgdmFyIG5vZGUgPSBhbmltLm5vZGUsIGFsbFJ1bm5pbmcgPSBEb20uZGF0YShub2RlLCBydW5uaW5nS2V5KTsKICAgIGlmICghYWxsUnVubmluZykgewogICAgICBEb20uZGF0YShub2RlLCBydW5uaW5nS2V5LCBhbGxSdW5uaW5nID0ge30pOwogICAgfQogICAgYWxsUnVubmluZ1t1dGlsLnN0YW1wKGFuaW0pXSA9IGFuaW07CiAgfQogIGZ1bmN0aW9uIHJlbW92ZVJ1bm5pbmdBbmltKGFuaW0pIHsKICAgIHZhciBub2RlID0gYW5pbS5ub2RlLCBhbGxSdW5uaW5nID0gRG9tLmRhdGEobm9kZSwgcnVubmluZ0tleSk7CiAgICBpZiAoYWxsUnVubmluZykgewogICAgICBkZWxldGUgYWxsUnVubmluZ1t1dGlsLnN0YW1wKGFuaW0pXTsKICAgICAgaWYgKHV0aWwuaXNFbXB0eU9iamVjdChhbGxSdW5uaW5nKSkgewogICAgICAgIERvbS5yZW1vdmVEYXRhKG5vZGUsIHJ1bm5pbmdLZXkpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGlzQW5pbVJ1bm5pbmcoYW5pbSkgewogICAgdmFyIG5vZGUgPSBhbmltLm5vZGUsIGFsbFJ1bm5pbmcgPSBEb20uZGF0YShub2RlLCBydW5uaW5nS2V5KTsKICAgIGlmIChhbGxSdW5uaW5nKSB7CiAgICAgIHJldHVybiAhIWFsbFJ1bm5pbmdbdXRpbC5zdGFtcChhbmltKV07CiAgICB9CiAgICByZXR1cm4gMDsKICB9CiAgdmFyIHBhdXNlZEtleSA9IHV0aWwuZ3VpZCgna3MtYW5pbS1wYXVzZWQtJyArIHV0aWwubm93KCkgKyAnLScpOwogIGZ1bmN0aW9uIHNhdmVQYXVzZWRBbmltKGFuaW0pIHsKICAgIHZhciBub2RlID0gYW5pbS5ub2RlLCBwYXVzZWQgPSBEb20uZGF0YShub2RlLCBwYXVzZWRLZXkpOwogICAgaWYgKCFwYXVzZWQpIHsKICAgICAgRG9tLmRhdGEobm9kZSwgcGF1c2VkS2V5LCBwYXVzZWQgPSB7fSk7CiAgICB9CiAgICBwYXVzZWRbdXRpbC5zdGFtcChhbmltKV0gPSBhbmltOwogIH0KICBmdW5jdGlvbiByZW1vdmVQYXVzZWRBbmltKGFuaW0pIHsKICAgIHZhciBub2RlID0gYW5pbS5ub2RlLCBwYXVzZWQgPSBEb20uZGF0YShub2RlLCBwYXVzZWRLZXkpOwogICAgaWYgKHBhdXNlZCkgewogICAgICBkZWxldGUgcGF1c2VkW3V0aWwuc3RhbXAoYW5pbSldOwogICAgICBpZiAodXRpbC5pc0VtcHR5T2JqZWN0KHBhdXNlZCkpIHsKICAgICAgICBEb20ucmVtb3ZlRGF0YShub2RlLCBwYXVzZWRLZXkpOwogICAgICB9CiAgICB9CiAgfQogIGZ1bmN0aW9uIGlzQW5pbVBhdXNlZChhbmltKSB7CiAgICB2YXIgbm9kZSA9IGFuaW0ubm9kZSwgcGF1c2VkID0gRG9tLmRhdGEobm9kZSwgcGF1c2VkS2V5KTsKICAgIGlmIChwYXVzZWQpIHsKICAgICAgcmV0dXJuICEhcGF1c2VkW3V0aWwuc3RhbXAoYW5pbSldOwogICAgfQogICAgcmV0dXJuIDA7CiAgfQogIGZ1bmN0aW9uIHBhdXNlT3JSZXN1bWVRdWV1ZShub2RlLCBxdWV1ZSwgYWN0aW9uKSB7CiAgICB2YXIgYWxsQW5pbXMgPSBEb20uZGF0YShub2RlLCBhY3Rpb24gPT09ICdyZXN1bWUnID8gcGF1c2VkS2V5IDogcnVubmluZ0tleSksIGFuaW1zID0gdXRpbC5tZXJnZShhbGxBbmltcyk7CiAgICB1dGlsLmVhY2goYW5pbXMsIGZ1bmN0aW9uIChhbmltKSB7CiAgICAgIGlmIChxdWV1ZSA9PT0gdW5kZWZpbmVkIHx8IGFuaW0uY29uZmlnLnF1ZXVlID09PSBxdWV1ZSkgewogICAgICAgIGFuaW1bYWN0aW9uXSgpOwogICAgICB9CiAgICB9KTsKICB9CiAgZXhwb3J0cyA9IHsKICAgIHNhdmVSdW5uaW5nQW5pbTogc2F2ZVJ1bm5pbmdBbmltLAogICAgcmVtb3ZlUnVubmluZ0FuaW06IHJlbW92ZVJ1bm5pbmdBbmltLAogICAgaXNBbmltUGF1c2VkOiBpc0FuaW1QYXVzZWQsCiAgICByZW1vdmVQYXVzZWRBbmltOiByZW1vdmVQYXVzZWRBbmltLAogICAgc2F2ZVBhdXNlZEFuaW06IHNhdmVQYXVzZWRBbmltLAogICAgaXNBbmltUnVubmluZzogaXNBbmltUnVubmluZywKICAgIGlzRWxQYXVzZWQ6IGZ1bmN0aW9uIChub2RlKSB7CiAgICAgIHZhciBwYXVzZWQgPSBEb20uZGF0YShub2RlLCBwYXVzZWRLZXkpOwogICAgICByZXR1cm4gcGF1c2VkICYmICF1dGlsLmlzRW1wdHlPYmplY3QocGF1c2VkKTsKICAgIH0sCiAgICBpc0VsUnVubmluZzogZnVuY3Rpb24gKG5vZGUpIHsKICAgICAgdmFyIGFsbFJ1bm5pbmcgPSBEb20uZGF0YShub2RlLCBydW5uaW5nS2V5KTsKICAgICAgcmV0dXJuIGFsbFJ1bm5pbmcgJiYgIXV0aWwuaXNFbXB0eU9iamVjdChhbGxSdW5uaW5nKTsKICAgIH0sCiAgICBwYXVzZU9yUmVzdW1lUXVldWU6IHBhdXNlT3JSZXN1bWVRdWV1ZSwKICAgIHN0b3BFbDogZnVuY3Rpb24gKG5vZGUsIGVuZCwgY2xlYXJRdWV1ZSwgcXVldWUpIHsKICAgICAgaWYgKGNsZWFyUXVldWUpIHsKICAgICAgICBpZiAocXVldWUgPT09IHVuZGVmaW5lZCkgewogICAgICAgICAgUS5jbGVhclF1ZXVlcyhub2RlKTsKICAgICAgICB9IGVsc2UgaWYgKHF1ZXVlICE9PSBmYWxzZSkgewogICAgICAgICAgUS5jbGVhclF1ZXVlKG5vZGUsIHF1ZXVlKTsKICAgICAgICB9CiAgICAgIH0KICAgICAgdmFyIGFsbFJ1bm5pbmcgPSBEb20uZGF0YShub2RlLCBydW5uaW5nS2V5KSwgYW5pbXMgPSB1dGlsLm1lcmdlKGFsbFJ1bm5pbmcpOwogICAgICB1dGlsLmVhY2goYW5pbXMsIGZ1bmN0aW9uIChhbmltKSB7CiAgICAgICAgaWYgKHF1ZXVlID09PSB1bmRlZmluZWQgfHwgYW5pbS5jb25maWcucXVldWUgPT09IHF1ZXVlKSB7CiAgICAgICAgICBhbmltLnN0b3AoZW5kKTsKICAgICAgICB9CiAgICAgIH0pOwogICAgfQogIH07CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKYW5pbUJhc2VMaWJCYXNlID0gZnVuY3Rpb24gKGV4cG9ydHMpIHsKICB2YXIgRG9tID0gZG9tQmFzZSwgVXRpbHMgPSBhbmltQmFzZUxpYkJhc2VVdGlscywgUSA9IGFuaW1CYXNlTGliQmFzZVF1ZXVlOwogIHZhciBQcm9taXNlID0gcHJvbWlzZTsKICB2YXIgdXRpbCA9IHV0aWxCYXNlLCBOb2RlVHlwZSA9IERvbS5Ob2RlVHlwZSwgY2FtZWxDYXNlID0gdXRpbC5jYW1lbENhc2UsIG5vb3AgPSB1dGlsLm5vb3AsIHNwZWNpYWxWYWxzID0gewogICAgICB0b2dnbGU6IDEsCiAgICAgIGhpZGU6IDEsCiAgICAgIHNob3c6IDEKICAgIH07CiAgdmFyIHVuZGVmOwogIHZhciBkZWZhdWx0Q29uZmlnID0gewogICAgZHVyYXRpb246IDEsCiAgICBlYXNpbmc6ICdsaW5lYXInCiAgfTsKICBmdW5jdGlvbiBzeW5jQ29tcGxldGUoc2VsZikgewogICAgdmFyIF9iYWNrdXBQcm9wcywgY29tcGxldGUgPSBzZWxmLmNvbmZpZy5jb21wbGV0ZTsKICAgIGlmICghdXRpbC5pc0VtcHR5T2JqZWN0KF9iYWNrdXBQcm9wcyA9IHNlbGYuX2JhY2t1cFByb3BzKSkgewogICAgICBEb20uY3NzKHNlbGYubm9kZSwgX2JhY2t1cFByb3BzKTsKICAgIH0KICAgIGlmIChjb21wbGV0ZSkgewogICAgICBjb21wbGV0ZS5jYWxsKHNlbGYpOwogICAgfQogIH0KICBmdW5jdGlvbiBBbmltQmFzZShub2RlLCB0bywgZHVyYXRpb24sIGVhc2luZywgY29tcGxldGUpIHsKICAgIHZhciBzZWxmID0gdGhpczsKICAgIHZhciBjb25maWc7CiAgICBpZiAobm9kZS5ub2RlKSB7CiAgICAgIGNvbmZpZyA9IG5vZGU7CiAgICB9IGVsc2UgewogICAgICBpZiAodXRpbC5pc1BsYWluT2JqZWN0KGR1cmF0aW9uKSkgewogICAgICAgIGNvbmZpZyA9IHV0aWwuY2xvbmUoZHVyYXRpb24pOwogICAgICB9IGVsc2UgewogICAgICAgIGNvbmZpZyA9IHsgY29tcGxldGU6IGNvbXBsZXRlIH07CiAgICAgICAgaWYgKGR1cmF0aW9uKSB7CiAgICAgICAgICBjb25maWcuZHVyYXRpb24gPSBkdXJhdGlvbjsKICAgICAgICB9CiAgICAgICAgaWYgKGVhc2luZykgewogICAgICAgICAgY29uZmlnLmVhc2luZyA9IGVhc2luZzsKICAgICAgICB9CiAgICAgIH0KICAgICAgY29uZmlnLm5vZGUgPSBub2RlOwogICAgICBjb25maWcudG8gPSB0bzsKICAgIH0KICAgIGNvbmZpZyA9IHV0aWwubWVyZ2UoZGVmYXVsdENvbmZpZywgY29uZmlnKTsKICAgIEFuaW1CYXNlLnN1cGVyY2xhc3MuY29uc3RydWN0b3IuY2FsbChzZWxmKTsKICAgIFByb21pc2UuRGVmZXIoc2VsZik7CiAgICBzZWxmLmNvbmZpZyA9IGNvbmZpZzsKICAgIG5vZGUgPSBjb25maWcubm9kZTsKICAgIGlmICghdXRpbC5pc1BsYWluT2JqZWN0KG5vZGUpKSB7CiAgICAgIG5vZGUgPSBEb20uZ2V0KGNvbmZpZy5ub2RlKTsKICAgIH0KICAgIHNlbGYubm9kZSA9IHNlbGYuZWwgPSBub2RlOwogICAgc2VsZi5fYmFja3VwUHJvcHMgPSB7fTsKICAgIHNlbGYuX3Byb3BzRGF0YSA9IHt9OwogICAgdmFyIG5ld1RvID0ge307CiAgICB0byA9IGNvbmZpZy50bzsKICAgIGZvciAodmFyIHByb3AgaW4gdG8pIHsKICAgICAgbmV3VG9bY2FtZWxDYXNlKHByb3ApXSA9IHRvW3Byb3BdOwogICAgfQogICAgY29uZmlnLnRvID0gbmV3VG87CiAgfQogIHV0aWwuZXh0ZW5kKEFuaW1CYXNlLCBQcm9taXNlLCB7CiAgICBwcmVwYXJlRng6IG5vb3AsCiAgICBydW5JbnRlcm5hbDogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIGNvbmZpZyA9IHNlbGYuY29uZmlnLCBub2RlID0gc2VsZi5ub2RlLCB2YWwsIF9iYWNrdXBQcm9wcyA9IHNlbGYuX2JhY2t1cFByb3BzLCBfcHJvcHNEYXRhID0gc2VsZi5fcHJvcHNEYXRhLCB0byA9IGNvbmZpZy50bywgZGVmYXVsdERlbGF5ID0gY29uZmlnLmRlbGF5IHx8IDAsIGRlZmF1bHREdXJhdGlvbiA9IGNvbmZpZy5kdXJhdGlvbjsKICAgICAgVXRpbHMuc2F2ZVJ1bm5pbmdBbmltKHNlbGYpOwogICAgICB1dGlsLmVhY2godG8sIGZ1bmN0aW9uICh2YWwsIHByb3ApIHsKICAgICAgICBpZiAoIXV0aWwuaXNQbGFpbk9iamVjdCh2YWwpKSB7CiAgICAgICAgICB2YWwgPSB7IHZhbHVlOiB2YWwgfTsKICAgICAgICB9CiAgICAgICAgX3Byb3BzRGF0YVtwcm9wXSA9IHV0aWwubWl4KHsKICAgICAgICAgIGRlbGF5OiBkZWZhdWx0RGVsYXksCiAgICAgICAgICBlYXNpbmc6IGNvbmZpZy5lYXNpbmcsCiAgICAgICAgICBmcmFtZTogY29uZmlnLmZyYW1lLAogICAgICAgICAgZHVyYXRpb246IGRlZmF1bHREdXJhdGlvbgogICAgICAgIH0sIHZhbCk7CiAgICAgIH0pOwogICAgICBpZiAobm9kZS5ub2RlVHlwZSA9PT0gTm9kZVR5cGUuRUxFTUVOVF9OT0RFKSB7CiAgICAgICAgaWYgKHRvLndpZHRoIHx8IHRvLmhlaWdodCkgewogICAgICAgICAgdmFyIGVsU3R5bGUgPSBub2RlLnN0eWxlOwogICAgICAgICAgdXRpbC5taXgoX2JhY2t1cFByb3BzLCB7CiAgICAgICAgICAgIG92ZXJmbG93OiBlbFN0eWxlLm92ZXJmbG93LAogICAgICAgICAgICAnb3ZlcmZsb3cteCc6IGVsU3R5bGUub3ZlcmZsb3dYLAogICAgICAgICAgICAnb3ZlcmZsb3cteSc6IGVsU3R5bGUub3ZlcmZsb3dZCiAgICAgICAgICB9KTsKICAgICAgICAgIGVsU3R5bGUub3ZlcmZsb3cgPSAnaGlkZGVuJzsKICAgICAgICB9CiAgICAgICAgdmFyIGV4aXQsIGhpZGRlbjsKICAgICAgICB1dGlsLmVhY2goX3Byb3BzRGF0YSwgZnVuY3Rpb24gKF9wcm9wRGF0YSwgcHJvcCkgewogICAgICAgICAgdmFsID0gX3Byb3BEYXRhLnZhbHVlOwogICAgICAgICAgaWYgKHNwZWNpYWxWYWxzW3ZhbF0pIHsKICAgICAgICAgICAgaWYgKGhpZGRlbiA9PT0gdW5kZWYpIHsKICAgICAgICAgICAgICBoaWRkZW4gPSBEb20uY3NzKG5vZGUsICdkaXNwbGF5JykgPT09ICdub25lJzsKICAgICAgICAgICAgfQogICAgICAgICAgICBpZiAodmFsID09PSAnaGlkZScgJiYgaGlkZGVuIHx8IHZhbCA9PT0gJ3Nob3cnICYmICFoaWRkZW4pIHsKICAgICAgICAgICAgICBzZWxmLnN0b3AodHJ1ZSk7CiAgICAgICAgICAgICAgZXhpdCA9IGZhbHNlOwogICAgICAgICAgICAgIHJldHVybiBleGl0OwogICAgICAgICAgICB9CiAgICAgICAgICAgIF9iYWNrdXBQcm9wc1twcm9wXSA9IERvbS5fc3R5bGUobm9kZSwgcHJvcCk7CiAgICAgICAgICAgIGlmICh2YWwgPT09ICd0b2dnbGUnKSB7CiAgICAgICAgICAgICAgdmFsID0gaGlkZGVuID8gJ3Nob3cnIDogJ2hpZGUnOwogICAgICAgICAgICB9CiAgICAgICAgICAgIGlmICh2YWwgPT09ICdoaWRlJykgewogICAgICAgICAgICAgIF9wcm9wRGF0YS52YWx1ZSA9IDA7CiAgICAgICAgICAgICAgX2JhY2t1cFByb3BzLmRpc3BsYXkgPSAnbm9uZSc7CiAgICAgICAgICAgIH0gZWxzZSB7CiAgICAgICAgICAgICAgX3Byb3BEYXRhLnZhbHVlID0gRG9tLmNzcyhub2RlLCBwcm9wKTsKICAgICAgICAgICAgICBEb20uY3NzKG5vZGUsIHByb3AsIDApOwogICAgICAgICAgICAgIERvbS5zaG93KG5vZGUpOwogICAgICAgICAgICB9CiAgICAgICAgICB9CiAgICAgICAgICByZXR1cm4gdW5kZWZpbmVkOwogICAgICAgIH0pOwogICAgICAgIGlmIChleGl0ID09PSBmYWxzZSkgewogICAgICAgICAgcmV0dXJuOwogICAgICAgIH0KICAgICAgfQogICAgICBzZWxmLnN0YXJ0VGltZSA9IHV0aWwubm93KCk7CiAgICAgIGlmICh1dGlsLmlzRW1wdHlPYmplY3QoX3Byb3BzRGF0YSkpIHsKICAgICAgICBzZWxmLl9fdG90YWxUaW1lID0gZGVmYXVsdER1cmF0aW9uICogMTAwMDsKICAgICAgICBzZWxmLl9fd2FpdFRpbWVvdXQgPSBzZXRUaW1lb3V0KGZ1bmN0aW9uICgpIHsKICAgICAgICAgIHNlbGYuc3RvcCh0cnVlKTsKICAgICAgICB9LCBzZWxmLl9fdG90YWxUaW1lKTsKICAgICAgfSBlbHNlIHsKICAgICAgICBzZWxmLnByZXBhcmVGeCgpOwogICAgICAgIHNlbGYuZG9TdGFydCgpOwogICAgICB9CiAgICB9LAogICAgaXNSdW5uaW5nOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBVdGlscy5pc0FuaW1SdW5uaW5nKHRoaXMpOwogICAgfSwKICAgIGlzUGF1c2VkOiBmdW5jdGlvbiAoKSB7CiAgICAgIHJldHVybiBVdGlscy5pc0FuaW1QYXVzZWQodGhpcyk7CiAgICB9LAogICAgcGF1c2U6IGZ1bmN0aW9uICgpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzOwogICAgICBpZiAoc2VsZi5pc1J1bm5pbmcoKSkgewogICAgICAgIHNlbGYuX3J1blRpbWUgPSB1dGlsLm5vdygpIC0gc2VsZi5zdGFydFRpbWU7CiAgICAgICAgc2VsZi5fX3RvdGFsVGltZSAtPSBzZWxmLl9ydW5UaW1lOwogICAgICAgIFV0aWxzLnJlbW92ZVJ1bm5pbmdBbmltKHNlbGYpOwogICAgICAgIFV0aWxzLnNhdmVQYXVzZWRBbmltKHNlbGYpOwogICAgICAgIGlmIChzZWxmLl9fd2FpdFRpbWVvdXQpIHsKICAgICAgICAgIGNsZWFyVGltZW91dChzZWxmLl9fd2FpdFRpbWVvdXQpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWxmLmRvU3RvcCgpOwogICAgICAgIH0KICAgICAgfQogICAgICByZXR1cm4gc2VsZjsKICAgIH0sCiAgICBkb1N0b3A6IG5vb3AsCiAgICBkb1N0YXJ0OiBub29wLAogICAgcmVzdW1lOiBmdW5jdGlvbiAoKSB7CiAgICAgIHZhciBzZWxmID0gdGhpczsKICAgICAgaWYgKHNlbGYuaXNQYXVzZWQoKSkgewogICAgICAgIHNlbGYuc3RhcnRUaW1lID0gdXRpbC5ub3coKSAtIHNlbGYuX3J1blRpbWU7CiAgICAgICAgVXRpbHMucmVtb3ZlUGF1c2VkQW5pbShzZWxmKTsKICAgICAgICBVdGlscy5zYXZlUnVubmluZ0FuaW0oc2VsZik7CiAgICAgICAgaWYgKHNlbGYuX193YWl0VGltZW91dCkgewogICAgICAgICAgc2VsZi5fX3dhaXRUaW1lb3V0ID0gc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgICAgIHNlbGYuc3RvcCh0cnVlKTsKICAgICAgICAgIH0sIHNlbGYuX190b3RhbFRpbWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBzZWxmLmJlZm9yZVJlc3VtZSgpOwogICAgICAgICAgc2VsZi5kb1N0YXJ0KCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIGJlZm9yZVJlc3VtZTogbm9vcCwKICAgIHJ1bjogZnVuY3Rpb24gKCkgewogICAgICB2YXIgc2VsZiA9IHRoaXMsIHEsIHF1ZXVlID0gc2VsZi5jb25maWcucXVldWU7CiAgICAgIGlmIChxdWV1ZSA9PT0gZmFsc2UpIHsKICAgICAgICBzZWxmLnJ1bkludGVybmFsKCk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgcSA9IFEucXVldWUoc2VsZi5ub2RlLCBxdWV1ZSwgc2VsZik7CiAgICAgICAgaWYgKHEubGVuZ3RoID09PSAxKSB7CiAgICAgICAgICBzZWxmLnJ1bkludGVybmFsKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzZWxmOwogICAgfSwKICAgIHN0b3A6IGZ1bmN0aW9uIChmaW5pc2gpIHsKICAgICAgdmFyIHNlbGYgPSB0aGlzLCBub2RlID0gc2VsZi5ub2RlLCBxLCBxdWV1ZSA9IHNlbGYuY29uZmlnLnF1ZXVlOwogICAgICBpZiAoc2VsZi5pc1Jlc29sdmVkKCkgfHwgc2VsZi5pc1JlamVjdGVkKCkpIHsKICAgICAgICByZXR1cm4gc2VsZjsKICAgICAgfQogICAgICBpZiAoc2VsZi5fX3dhaXRUaW1lb3V0KSB7CiAgICAgICAgY2xlYXJUaW1lb3V0KHNlbGYuX193YWl0VGltZW91dCk7CiAgICAgICAgc2VsZi5fX3dhaXRUaW1lb3V0ID0gMDsKICAgICAgfQogICAgICBpZiAoIXNlbGYuaXNSdW5uaW5nKCkgJiYgIXNlbGYuaXNQYXVzZWQoKSkgewogICAgICAgIGlmIChxdWV1ZSAhPT0gZmFsc2UpIHsKICAgICAgICAgIFEucmVtb3ZlKG5vZGUsIHF1ZXVlLCBzZWxmKTsKICAgICAgICB9CiAgICAgICAgcmV0dXJuIHNlbGY7CiAgICAgIH0KICAgICAgc2VsZi5kb1N0b3AoZmluaXNoKTsKICAgICAgVXRpbHMucmVtb3ZlUnVubmluZ0FuaW0oc2VsZik7CiAgICAgIFV0aWxzLnJlbW92ZVBhdXNlZEFuaW0oc2VsZik7CiAgICAgIHZhciBkZWZlciA9IHNlbGYuZGVmZXI7CiAgICAgIGlmIChmaW5pc2gpIHsKICAgICAgICBzeW5jQ29tcGxldGUoc2VsZik7CiAgICAgICAgZGVmZXIucmVzb2x2ZShbc2VsZl0pOwogICAgICB9IGVsc2UgewogICAgICAgIGRlZmVyLnJlamVjdChbc2VsZl0pOwogICAgICB9CiAgICAgIGlmIChxdWV1ZSAhPT0gZmFsc2UpIHsKICAgICAgICBxID0gUS5kZXF1ZXVlKG5vZGUsIHF1ZXVlKTsKICAgICAgICBpZiAocSAmJiBxWzBdKSB7CiAgICAgICAgICBxWzBdLnJ1bkludGVybmFsKCk7CiAgICAgICAgfQogICAgICB9CiAgICAgIHJldHVybiBzZWxmOwogICAgfQogIH0pOwogIHZhciBTdGF0aWNzID0gQW5pbUJhc2UuU3RhdGljcyA9IHsKICAgIGlzUnVubmluZzogVXRpbHMuaXNFbFJ1bm5pbmcsCiAgICBpc1BhdXNlZDogVXRpbHMuaXNFbFBhdXNlZCwKICAgIHN0b3A6IFV0aWxzLnN0b3BFbCwKICAgIFE6IFEKICB9OwogIHV0aWwuZWFjaChbCiAgICAncGF1c2UnLAogICAgJ3Jlc3VtZScKICBdLCBmdW5jdGlvbiAoYWN0aW9uKSB7CiAgICBTdGF0aWNzW2FjdGlvbl0gPSBmdW5jdGlvbiAobm9kZSwgcXVldWUpIHsKICAgICAgaWYgKHF1ZXVlID09PSBudWxsIHx8IHR5cGVvZiBxdWV1ZSA9PT0gJ3N0cmluZycgfHwgcXVldWUgPT09IGZhbHNlKSB7CiAgICAgICAgcmV0dXJuIFV0aWxzLnBhdXNlT3JSZXN1bWVRdWV1ZShub2RlLCBxdWV1ZSwgYWN0aW9uKTsKICAgICAgfQogICAgICByZXR1cm4gVXRpbHMucGF1c2VPclJlc3VtZVF1ZXVlKG5vZGUsIHVuZGVmaW5lZCwgYWN0aW9uKTsKICAgIH07CiAgfSk7CiAgZXhwb3J0cyA9IEFuaW1CYXNlOwogIHJldHVybiBleHBvcnRzOwp9KCk7CmFuaW1CYXNlSW5kZXggPSBmdW5jdGlvbiAoZXhwb3J0cykgewogIHZhciBBbmltQmFzZSA9IGFuaW1CYXNlTGliQmFzZTsKICBleHBvcnRzID0gQW5pbUJhc2U7CiAgcmV0dXJuIGV4cG9ydHM7Cn0oKTsKcmV0dXJuIGFuaW1CYXNlSW5kZXg7Cn0pOw==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="295765" offset="0" length="2961" />
        <PacketInfo time="295765" offset="2961" length="16384" />
        <PacketInfo time="295781" offset="19345" length="15736" />
        <PacketInfo time="295781" offset="35081" length="16384" />
        <PacketInfo time="295796" offset="51465" length="16384" />
        <PacketInfo time="295812" offset="67849" length="16384" />
        <PacketInfo time="295812" offset="84233" length="16384" />
        <PacketInfo time="295812" offset="100617" length="1449" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
  <HTTPTask id="456" hostname="img.alicdn.com" path="/tfs/TB1S_dkRQvoK1RjSZFNXXcxMVXa-270-364.png" url="https://img.alicdn.com/tfs/TB1S_dkRQvoK1RjSZFNXXcxMVXa-270-364.png" ip="116.207.100.253" port="443" connectionId="19" origin="ExtraRes" frame="1" startDateTime="2019-06-12T18:56:39.069+08:00" startTime="295750" endTime="295781">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Accept" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1hZ2UvcG5nLCBpbWFnZS9zdmcreG1sLCBpbWFnZS9qeHIsIGltYWdlLyo7cT0wLjgsICovKjtxPTAuNQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9zZWFyY2guZGFtYWkuY24vc2VhcmNoLmh0bWw/a2V5d29yZD0lRTUlOTElQTglRTYlOUQlQjAlRTQlQkMlQTYmc3BtPWEyb2VnLmhvbWUuc2VhcmNodHh0LmRzZWFyY2hidG4=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>emgtQ04=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1nLmFsaWNkbi5jb20=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC90ZnMvVEIxU19ka1JRdm9LMVJqU1pGTlhYY3hNVlhhLTI3MC0zNjQucG5nIEhUVFAvMS4xDQpBY2NlcHQ6IGltYWdlL3BuZywgaW1hZ2Uvc3ZnK3htbCwgaW1hZ2UvanhyLCBpbWFnZS8qO3E9MC44LCAqLyo7cT0wLjUNClJlZmVyZXI6IGh0dHBzOi8vc2VhcmNoLmRhbWFpLmNuL3NlYXJjaC5odG1sP2tleXdvcmQ9JUU1JTkxJUE4JUU2JTlEJUIwJUU0JUJDJUE2JnNwbT1hMm9lZy5ob21lLnNlYXJjaHR4dC5kc2VhcmNoYnRuDQpBY2NlcHQtTGFuZ3VhZ2U6IHpoLUNODQpVc2VyLUFnZW50OiBNb3ppbGxhLzUuMCAoV2luZG93cyBOVCAxMC4wOyBXT1c2NDsgVHJpZGVudC83LjA7IHJ2OjExLjApIGxpa2UgR2Vja28NCkFjY2VwdC1FbmNvZGluZzogZ3ppcCwgZGVmbGF0ZQ0KSG9zdDogaW1nLmFsaWNkbi5jb20NCkNvbm5lY3Rpb246IEtlZXAtQWxpdmUNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>15445</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGVuZ2luZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1hZ2UvcG5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTU0NDU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAyNCBBcHIgMjAxOSAwMTozNzozNiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="last-modified" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAxOCBBcHIgMjAxOSAwOTo1ODo0OSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Expires" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGh1LCAyMyBBcHIgMjAyMCAwMTozNzozNiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bWF4LWFnZT0zMTUzNjAwMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Ali-Swift-Global-Savetime" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTU1NjA2OTg1Ng==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Via" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2FjaGUzOC5sMm5lMVs2MCwyMDAtMCxNXSwgY2FjaGU0Ny5sMm5lMVs2MSwwXSwgY2FjaGUxOC5jbjEyNDBbMCwyMDAtMCxIXSwgY2FjaGUxNy5jbjEyNDBbMSwwXQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Access-Control-Allow-Origin" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Age" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NDI2NzEyOQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Cache" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SElUIFRDUF9NRU1fSElUIGRpcm46MTM6NzU1OTc0NDM2</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-SaveTime" index="13">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAyNCBBcHIgMjAxOSAwMTozNzozNiBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-CacheTime" index="14">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MzE1MzYwMDA=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Timing-Allow-Origin" index="15">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="EagleId" index="16">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NzRjZjY0YTUxNTYwMzM2OTg1MTkzNDE2N2U=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IFRlbmdpbmUNCkNvbnRlbnQtVHlwZTogaW1hZ2UvcG5nDQpDb250ZW50LUxlbmd0aDogMTU0NDUNCkNvbm5lY3Rpb246IGtlZXAtYWxpdmUNCkRhdGU6IFdlZCwgMjQgQXByIDIwMTkgMDE6Mzc6MzYgR01UDQpsYXN0LW1vZGlmaWVkOiBUaHUsIDE4IEFwciAyMDE5IDA5OjU4OjQ5IEdNVA0KRXhwaXJlczogVGh1LCAyMyBBcHIgMjAyMCAwMTozNzozNiBHTVQNCkNhY2hlLUNvbnRyb2w6IG1heC1hZ2U9MzE1MzYwMDANCkFsaS1Td2lmdC1HbG9iYWwtU2F2ZXRpbWU6IDE1NTYwNjk4NTYNClZpYTogY2FjaGUzOC5sMm5lMVs2MCwyMDAtMCxNXSwgY2FjaGU0Ny5sMm5lMVs2MSwwXSwgY2FjaGUxOC5jbjEyNDBbMCwyMDAtMCxIXSwgY2FjaGUxNy5jbjEyNDBbMSwwXQ0KQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luOiAqDQpBZ2U6IDQyNjcxMjkNClgtQ2FjaGU6IEhJVCBUQ1BfTUVNX0hJVCBkaXJuOjEzOjc1NTk3NDQzNg0KWC1Td2lmdC1TYXZlVGltZTogV2VkLCAyNCBBcHIgMjAxOSAwMTozNzozNiBHTVQNClgtU3dpZnQtQ2FjaGVUaW1lOiAzMTUzNjAwMA0KVGltaW5nLUFsbG93LU9yaWdpbjogKg0KRWFnbGVJZDogNzRjZjY0YTUxNTYwMzM2OTg1MTkzNDE2N2UNCg0K</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>iVBORw0KGgoAAAANSUhEUgAAAQ4AAAFsAgMAAABA479nAAA4KmlUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMxMzggNzkuMTU5ODI0LCAyMDE2LzA5LzE0LTAxOjA5OjAxICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmRjPSJodHRwOi8vcHVybC5vcmcvZGMvZWxlbWVudHMvMS4xLyIKICAgICAgICAgICAgeG1sbnM6cGhvdG9zaG9wPSJodHRwOi8vbnMuYWRvYmUuY29tL3Bob3Rvc2hvcC8xLjAvIgogICAgICAgICAgICB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6dGlmZj0iaHR0cDovL25zLmFkb2JlLmNvbS90aWZmLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOmV4aWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vZXhpZi8xLjAvIj4KICAgICAgICAgPHhtcDpDcmVhdG9yVG9vbD5BZG9iZSBQaG90b3Nob3AgQ0MgMjAxNyAoTWFjaW50b3NoKTwveG1wOkNyZWF0b3JUb29sPgogICAgICAgICA8eG1wOkNyZWF0ZURhdGU+MjAxOS0wNC0xNVQxMToyOTozNSswODowMDwveG1wOkNyZWF0ZURhdGU+CiAgICAgICAgIDx4bXA6TW9kaWZ5RGF0ZT4yMDE5LTA0LTE1VDExOjMwOjI0KzA4OjAwPC94bXA6TW9kaWZ5RGF0ZT4KICAgICAgICAgPHhtcDpNZXRhZGF0YURhdGU+MjAxOS0wNC0xNVQxMTozMDoyNCswODowMDwveG1wOk1ldGFkYXRhRGF0ZT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHhtcE1NOkluc3RhbmNlSUQ+eG1wLmlpZDo5YWQ1ZGJmOS03Mzc3LTQxZmQtOTg0Ni1mNTI3OTc5NTFkZWE8L3htcE1NOkluc3RhbmNlSUQ+CiAgICAgICAgIDx4bXBNTTpEb2N1bWVudElEPnhtcC5kaWQ6OWFkNWRiZjktNzM3Ny00MWZkLTk4NDYtZjUyNzk3OTUxZGVhPC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6OWFkNWRiZjktNzM3Ny00MWZkLTk4NDYtZjUyNzk3OTUxZGVhPC94bXBNTTpPcmlnaW5hbERvY3VtZW50SUQ+CiAgICAgICAgIDx4bXBNTTpIaXN0b3J5PgogICAgICAgICAgICA8cmRmOlNlcT4KICAgICAgICAgICAgICAgPHJkZjpsaSByZGY6cGFyc2VUeXBlPSJSZXNvdXJjZSI+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDphY3Rpb24+Y3JlYXRlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOjlhZDVkYmY5LTczNzctNDFmZC05ODQ2LWY1Mjc5Nzk1MWRlYTwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxOS0wNC0xNVQxMToyOTozNSswODowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTcgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjI3MDwvZXhpZjpQaXhlbFhEaW1lbnNpb24+CiAgICAgICAgIDxleGlmOlBpeGVsWURpbWVuc2lvbj4zNjQ8L2V4aWY6UGl4ZWxZRGltZW5zaW9uPgogICAgICA8L3JkZjpEZXNjcmlwdGlvbj4KICAgPC9yZGY6UkRGPgo8L3g6eG1wbWV0YT4KICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAKPD94cGFja2V0IGVuZD0idyI/PuO936sAAAAJcEhZcwAACxMAAAsTAQCanBgAAAAJUExURfT09NnZ2efn58odDSUAAAO8SURBVHja7Zg9btwwEIVJAQKiVFuYgUsjgIzYp+ARWOwIgitWgY9B+ARulNrNBsGeMhz+7K6LFDPrwM37kMCWAT4N3ww5pIwBAAAAAAAAAAAAAAAAAAAAAAAAAAAAgE9l2KIx89N1IiMtZiDyV4k4ojQRhatEthzFSLReJUJEcSbaX+VrFgl5Sote4vFCZHjTaVgKZ5ED6URmWk4i+ZeozcxLF5m0GcoCvonsR2WGeCpxqyLrrMyQbVH0/6QV4QhYgCP6PBH2hA1lETZ40YpwalnkRSvCKSZbRXhqe22xcQhZhAPSFNtAKZtKqYiwNRSnRb5w1qmWbBdJm3j5bHX15dxmkTDXNbjKU5Nqzdd/JbBFXmm8L+Zqywpca3FWifC7sxtZxLe4hEXLprIL+4lFUn3ISuJIyOcKsSwy1LCkImUI21BEbP1dOp0SyWq5ZIPjgi2WkDzFxQefRbK7+/oHxepjU+IW3NrKV7wGXTMluuBywfpiibSvj82UMAcXXbPEazaCxdA6Bue3aol8Mygm5OEsQkFRJcYcomEX4rhMwb3UKonm8CwskzRUU2xwlnhyCwcntHU1D8WUIXyzxRJfjk3CBMcyyKVwM4XSz2dhkmtqvrIp/vV25Cox4gSVemVvVxtfb2ezUTVaVLNFJHu7LSbsdjcDPdWUK0TWPDLt7u52+UeZoUaE3oyLX4xJc3VVKFJfy4fG4uSv6qrQ2CZCz+aeN5dcqwoR18ZkL/KCGZqrwjoZ6f2be2Siiu0WtNPr3J9k++P9z8Lx+Iefjsfj7/KsOxB/Po/HRp9ORXTVuDT2h9bY6Txqipeakm329Go/bDzu4V3GhWWfF15ecjZd/EEukkfzu59qg9fsbBz8VFxwUbMVnHIxl3yMSxq0IjkIdiXmyaza7XEtF1Kzrfzsq0/inS3xluAND3S1gcg3pVjEkuXeOVLrGUFWbMXR3oAtteYcZWXvy489B+GLSaU5i04X29quGhxUPDVnzQWbu6crRozq+9vQMrv2c63ug1L2oBUHac5brVpqCL0TKT4tWY5hOpWd7kJa3Bhby7KksvahxD/3/YzkFwTz/VBDOHnhlFcV6mebtbfnJDaE6ifD5oVViNQLQoto6XuM5mgfewNKzRTFhw86HVR8jU2c4urnfO5ZVlFs22kL6PWu+F63leAve9YsX4AbDxnenQbu5N+E47nmSPn1sr520hwp/nkU9VeIzJpzyX8R+ZDpfIixg+o4DgAAAAAAAAAAAAAAAAAAAAAAAAAAAAAfzl8NH+invloUlgAAAABJRU5ErkJggg==</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="295781" offset="0" length="3025" />
        <PacketInfo time="295796" offset="3025" length="13053" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
  <HTTPTask id="460" hostname="img.alicdn.com" path="/tfs/TB1981syYGYBuNjy0FoXXciBFXa-36-323.png" url="https://img.alicdn.com/tfs/TB1981syYGYBuNjy0FoXXciBFXa-36-323.png" ip="116.207.100.253" port="443" connectionId="23" origin="ExtraRes" frame="1" startDateTime="2019-06-12T18:56:39.076+08:00" startTime="295750" endTime="295812">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Accept" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1hZ2UvcG5nLCBpbWFnZS9zdmcreG1sLCBpbWFnZS9qeHIsIGltYWdlLyo7cT0wLjgsICovKjtxPTAuNQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9zZWFyY2guZGFtYWkuY24vc2VhcmNoLmh0bWw/a2V5d29yZD0lRTUlOTElQTglRTYlOUQlQjAlRTQlQkMlQTYmc3BtPWEyb2VnLmhvbWUuc2VhcmNodHh0LmRzZWFyY2hidG4=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>emgtQ04=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1nLmFsaWNkbi5jb20=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC90ZnMvVEIxOTgxc3lZR1lCdU5qeTBGb1hYY2lCRlhhLTM2LTMyMy5wbmcgSFRUUC8xLjENCkFjY2VwdDogaW1hZ2UvcG5nLCBpbWFnZS9zdmcreG1sLCBpbWFnZS9qeHIsIGltYWdlLyo7cT0wLjgsICovKjtxPTAuNQ0KUmVmZXJlcjogaHR0cHM6Ly9zZWFyY2guZGFtYWkuY24vc2VhcmNoLmh0bWw/a2V5d29yZD0lRTUlOTElQTglRTYlOUQlQjAlRTQlQkMlQTYmc3BtPWEyb2VnLmhvbWUuc2VhcmNodHh0LmRzZWFyY2hidG4NCkFjY2VwdC1MYW5ndWFnZTogemgtQ04NClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbw0KQWNjZXB0LUVuY29kaW5nOiBnemlwLCBkZWZsYXRlDQpIb3N0OiBpbWcuYWxpY2RuLmNvbQ0KQ29ubmVjdGlvbjogS2VlcC1BbGl2ZQ0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>15357</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGVuZ2luZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1hZ2UvcG5n</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTUzNTc=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>RnJpLCAyOSBNYXIgMjAxOSAwMzoxMToxOSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="last-modified" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>V2VkLCAyMCBKdW4gMjAxOCAwNjowMDo0NyBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Expires" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>U2F0LCAyOCBNYXIgMjAyMCAwMzoxMToxOSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bWF4LWFnZT0zMTUzNjAwMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Ali-Swift-Global-Savetime" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTU1MzgyOTA3OQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Via" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2FjaGUxLmwybmUxWzAsMjAwLTAsSF0sIGNhY2hlMzYubDJuZTFbMSwwXSwgY2FjaGU4LmNuMTI0MFswLDIwMC0wLEhdLCBjYWNoZTguY24xMjQwWzAsMF0=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Access-Control-Allow-Origin" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Age" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NjUwNzkwNg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Cache" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SElUIFRDUF9NRU1fSElUIGRpcm46MTI6NTQ0MTEyOTU0</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-SaveTime" index="13">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VHVlLCAxNiBBcHIgMjAxOSAwMzo0MTo0NSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-CacheTime" index="14">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Mjk5Nzg5NzQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Timing-Allow-Origin" index="15">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="EagleId" index="16">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NzRjZjY0OWMxNTYwMzM2OTg1MTk5MzQzNGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IFRlbmdpbmUNCkNvbnRlbnQtVHlwZTogaW1hZ2UvcG5nDQpDb250ZW50LUxlbmd0aDogMTUzNTcNCkNvbm5lY3Rpb246IGtlZXAtYWxpdmUNCkRhdGU6IEZyaSwgMjkgTWFyIDIwMTkgMDM6MTE6MTkgR01UDQpsYXN0LW1vZGlmaWVkOiBXZWQsIDIwIEp1biAyMDE4IDA2OjAwOjQ3IEdNVA0KRXhwaXJlczogU2F0LCAyOCBNYXIgMjAyMCAwMzoxMToxOSBHTVQNCkNhY2hlLUNvbnRyb2w6IG1heC1hZ2U9MzE1MzYwMDANCkFsaS1Td2lmdC1HbG9iYWwtU2F2ZXRpbWU6IDE1NTM4MjkwNzkNClZpYTogY2FjaGUxLmwybmUxWzAsMjAwLTAsSF0sIGNhY2hlMzYubDJuZTFbMSwwXSwgY2FjaGU4LmNuMTI0MFswLDIwMC0wLEhdLCBjYWNoZTguY24xMjQwWzAsMF0NCkFjY2Vzcy1Db250cm9sLUFsbG93LU9yaWdpbjogKg0KQWdlOiA2NTA3OTA2DQpYLUNhY2hlOiBISVQgVENQX01FTV9ISVQgZGlybjoxMjo1NDQxMTI5NTQNClgtU3dpZnQtU2F2ZVRpbWU6IFR1ZSwgMTYgQXByIDIwMTkgMDM6NDE6NDUgR01UDQpYLVN3aWZ0LUNhY2hlVGltZTogMjk5Nzg5NzQNClRpbWluZy1BbGxvdy1PcmlnaW46ICoNCkVhZ2xlSWQ6IDc0Y2Y2NDljMTU2MDMzNjk4NTE5OTM0MzRlDQoNCg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>iVBORw0KGgoAAAANSUhEUgAAACQAAAFDBAMAAACgqLH9AAA5o2lUWHRYTUw6Y29tLmFkb2JlLnhtcAAAAAAAPD94cGFja2V0IGJlZ2luPSLvu78iIGlkPSJXNU0wTXBDZWhpSHpyZVN6TlRjemtjOWQiPz4KPHg6eG1wbWV0YSB4bWxuczp4PSJhZG9iZTpuczptZXRhLyIgeDp4bXB0az0iQWRvYmUgWE1QIENvcmUgNS42LWMwNjcgNzkuMTU3NzQ3LCAyMDE1LzAzLzMwLTIzOjQwOjQyICAgICAgICAiPgogICA8cmRmOlJERiB4bWxuczpyZGY9Imh0dHA6Ly93d3cudzMub3JnLzE5OTkvMDIvMjItcmRmLXN5bnRheC1ucyMiPgogICAgICA8cmRmOkRlc2NyaXB0aW9uIHJkZjphYm91dD0iIgogICAgICAgICAgICB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnhtcE1NPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvbW0vIgogICAgICAgICAgICB4bWxuczpzdFJlZj0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL3NUeXBlL1Jlc291cmNlUmVmIyIKICAgICAgICAgICAgeG1sbnM6c3RFdnQ9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZUV2ZW50IyIKICAgICAgICAgICAgeG1sbnM6ZGM9Imh0dHA6Ly9wdXJsLm9yZy9kYy9lbGVtZW50cy8xLjEvIgogICAgICAgICAgICB4bWxuczpwaG90b3Nob3A9Imh0dHA6Ly9ucy5hZG9iZS5jb20vcGhvdG9zaG9wLzEuMC8iCiAgICAgICAgICAgIHhtbG5zOnRpZmY9Imh0dHA6Ly9ucy5hZG9iZS5jb20vdGlmZi8xLjAvIgogICAgICAgICAgICB4bWxuczpleGlmPSJodHRwOi8vbnMuYWRvYmUuY29tL2V4aWYvMS4wLyI+CiAgICAgICAgIDx4bXA6Q3JlYXRvclRvb2w+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3htcDpDcmVhdG9yVG9vbD4KICAgICAgICAgPHhtcDpDcmVhdGVEYXRlPjIwMTctMDktMjdUMTc6MDA6NTgrMDg6MDA8L3htcDpDcmVhdGVEYXRlPgogICAgICAgICA8eG1wOk1vZGlmeURhdGU+MjAxNy0wOS0yN1QxNzowODowMiswODowMDwveG1wOk1vZGlmeURhdGU+CiAgICAgICAgIDx4bXA6TWV0YWRhdGFEYXRlPjIwMTctMDktMjdUMTc6MDg6MDIrMDg6MDA8L3htcDpNZXRhZGF0YURhdGU+CiAgICAgICAgIDx4bXBNTTpJbnN0YW5jZUlEPnhtcC5paWQ6ZWE4MmNkOTItOTBkOC00ZTVjLWEzY2MtMzZmNWQ1ODMxYTBmPC94bXBNTTpJbnN0YW5jZUlEPgogICAgICAgICA8eG1wTU06RG9jdW1lbnRJRD54bXAuZGlkOkQ1MjI3OTQ5MURCODExRTc4MTA3Qjk3Q0ZDMDVERjg1PC94bXBNTTpEb2N1bWVudElEPgogICAgICAgICA8eG1wTU06RGVyaXZlZEZyb20gcmRmOnBhcnNlVHlwZT0iUmVzb3VyY2UiPgogICAgICAgICAgICA8c3RSZWY6aW5zdGFuY2VJRD54bXAuaWlkOkQ1MjI3OTQ2MURCODExRTc4MTA3Qjk3Q0ZDMDVERjg1PC9zdFJlZjppbnN0YW5jZUlEPgogICAgICAgICAgICA8c3RSZWY6ZG9jdW1lbnRJRD54bXAuZGlkOkQ1MjI3OTQ3MURCODExRTc4MTA3Qjk3Q0ZDMDVERjg1PC9zdFJlZjpkb2N1bWVudElEPgogICAgICAgICA8L3htcE1NOkRlcml2ZWRGcm9tPgogICAgICAgICA8eG1wTU06T3JpZ2luYWxEb2N1bWVudElEPnhtcC5kaWQ6RDUyMjc5NDkxREI4MTFFNzgxMDdCOTdDRkMwNURGODU8L3htcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD4KICAgICAgICAgPHhtcE1NOkhpc3Rvcnk+CiAgICAgICAgICAgIDxyZGY6U2VxPgogICAgICAgICAgICAgICA8cmRmOmxpIHJkZjpwYXJzZVR5cGU9IlJlc291cmNlIj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OmFjdGlvbj5zYXZlZDwvc3RFdnQ6YWN0aW9uPgogICAgICAgICAgICAgICAgICA8c3RFdnQ6aW5zdGFuY2VJRD54bXAuaWlkOmVhODJjZDkyLTkwZDgtNGU1Yy1hM2NjLTM2ZjVkNTgzMWEwZjwvc3RFdnQ6aW5zdGFuY2VJRD4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OndoZW4+MjAxNy0wOS0yN1QxNzowODowMiswODowMDwvc3RFdnQ6d2hlbj4KICAgICAgICAgICAgICAgICAgPHN0RXZ0OnNvZnR3YXJlQWdlbnQ+QWRvYmUgUGhvdG9zaG9wIENDIDIwMTUgKE1hY2ludG9zaCk8L3N0RXZ0OnNvZnR3YXJlQWdlbnQ+CiAgICAgICAgICAgICAgICAgIDxzdEV2dDpjaGFuZ2VkPi88L3N0RXZ0OmNoYW5nZWQ+CiAgICAgICAgICAgICAgIDwvcmRmOmxpPgogICAgICAgICAgICA8L3JkZjpTZXE+CiAgICAgICAgIDwveG1wTU06SGlzdG9yeT4KICAgICAgICAgPGRjOmZvcm1hdD5pbWFnZS9wbmc8L2RjOmZvcm1hdD4KICAgICAgICAgPHBob3Rvc2hvcDpDb2xvck1vZGU+MzwvcGhvdG9zaG9wOkNvbG9yTW9kZT4KICAgICAgICAgPHRpZmY6T3JpZW50YXRpb24+MTwvdGlmZjpPcmllbnRhdGlvbj4KICAgICAgICAgPHRpZmY6WFJlc29sdXRpb24+NzIwMDAwLzEwMDAwPC90aWZmOlhSZXNvbHV0aW9uPgogICAgICAgICA8dGlmZjpZUmVzb2x1dGlvbj43MjAwMDAvMTAwMDA8L3RpZmY6WVJlc29sdXRpb24+CiAgICAgICAgIDx0aWZmOlJlc29sdXRpb25Vbml0PjI8L3RpZmY6UmVzb2x1dGlvblVuaXQ+CiAgICAgICAgIDxleGlmOkNvbG9yU3BhY2U+NjU1MzU8L2V4aWY6Q29sb3JTcGFjZT4KICAgICAgICAgPGV4aWY6UGl4ZWxYRGltZW5zaW9uPjM2PC9leGlmOlBpeGVsWERpbWVuc2lvbj4KICAgICAgICAgPGV4aWY6UGl4ZWxZRGltZW5zaW9uPjMyMzwvZXhpZjpQaXhlbFlEaW1lbnNpb24+CiAgICAgIDwvcmRmOkRlc2NyaXB0aW9uPgogICA8L3JkZjpSREY+CjwveDp4bXBtZXRhPgogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgIAogICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgCiAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAgICAKICAgICAgICAgICAgICAgICAgICAgICAgICAgIAo8P3hwYWNrZXQgZW5kPSJ3Ij8+MV0BPwAAAAlwSFlzAAALEwAACxMBAJqcGAAAAC1QTFRFR3BM7Qp17Qp17Qp17Qp17Qp17Qp17Qp1+g97/w18///+/9DC/2c//wZ2/6mPZHnfQAAAAAh0Uk5TAPtr36xBMROMDiy1AAABs0lEQVRYw+2YTU7DMBCFTfhpp2JBqOg6FRcoCIltWxBr4ARFXKBSL5BlFlXlrXMC4hVLBBdAcIIsuAvjVGozY0uJoKoE8asTKZ+ex1Pb8VQVovNW0qtAdd6Tsj4QHRKSzBE9UZQgetkUerbRwkbJp43mdVyLWiPWzt4xE475csyqV9MF0rSyFEjTKtCyDxCkBH5giy61VAXy+r86uOreMNQf348iajoW06BH0N7wsTu5JmgnOgsHfYpuw/DojqDdaBQOTwkKLoNx65yg1gUOMaB5PUSiP6Eo6GFqTFezIUez7pSj/RO/9l5bLRTmWGWVYnVbH9IAUgLtZxDpKU3FAWKTxcFNTncwJz4IWYWKjhSBCVjRUfhC0Wzhbubrj5sG6C8MIXHvAnCXYi6MBfZekvy5eBV4R6ms8NzlToKZiiSYy8vrV++ItMqAozKQp/zLiBcFvjEzG4ncRlDriIbccmEgK1Zumtcflzb6CVJK812SZjrNKMq00imLleqsRiwcMKt0YaRUV4Z3uVxIceTVJBV/48UExavbGrWTRFS7NoowK56EaHMUL6/yF8KrHfuFbYS+ATMuW8s1vkYWAAAAAElFTkSuQmCC</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="295812" offset="0" length="15985" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
  <HTTPTask id="465" hostname="img.alicdn.com" path="/bao/uploaded/i2/2251059038/O1CN018QU5Wd2GdSAEyFnpX_!!0-item_pic.jpg_q60.jpg" url="https://img.alicdn.com/bao/uploaded/i2/2251059038/O1CN018QU5Wd2GdSAEyFnpX_!!0-item_pic.jpg_q60.jpg" ip="116.207.100.253" port="443" connectionId="23" origin="ExtraRes" frame="1" startDateTime="2019-06-12T18:56:39.082+08:00" startTime="295812" endTime="295843">
    <HTTPRequest method="GET">
      <HTTPHeaders>
        <HTTPHeaderEntity name="Accept" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1hZ2UvcG5nLCBpbWFnZS9zdmcreG1sLCBpbWFnZS9qeHIsIGltYWdlLyo7cT0wLjgsICovKjtxPTAuNQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Referer" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aHR0cHM6Ly9zZWFyY2guZGFtYWkuY24vc2VhcmNoLmh0bWw/a2V5d29yZD0lRTUlOTElQTglRTYlOUQlQjAlRTQlQkMlQTYmc3BtPWEyb2VnLmhvbWUuc2VhcmNodHh0LmRzZWFyY2hidG4=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Language" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>emgtQ04=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="User-Agent" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW96aWxsYS81LjAgKFdpbmRvd3MgTlQgMTAuMDsgV09XNjQ7IFRyaWRlbnQvNy4wOyBydjoxMS4wKSBsaWtlIEdlY2tv</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Accept-Encoding" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Z3ppcCwgZGVmbGF0ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Host" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1nLmFsaWNkbi5jb20=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>S2VlcC1BbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>R0VUIC9iYW8vdXBsb2FkZWQvaTIvMjI1MTA1OTAzOC9PMUNOMDE4UVU1V2QyR2RTQUV5Rm5wWF8hITAtaXRlbV9waWMuanBnX3E2MC5qcGcgSFRUUC8xLjENCkFjY2VwdDogaW1hZ2UvcG5nLCBpbWFnZS9zdmcreG1sLCBpbWFnZS9qeHIsIGltYWdlLyo7cT0wLjgsICovKjtxPTAuNQ0KUmVmZXJlcjogaHR0cHM6Ly9zZWFyY2guZGFtYWkuY24vc2VhcmNoLmh0bWw/a2V5d29yZD0lRTUlOTElQTglRTYlOUQlQjAlRTQlQkMlQTYmc3BtPWEyb2VnLmhvbWUuc2VhcmNodHh0LmRzZWFyY2hidG4NCkFjY2VwdC1MYW5ndWFnZTogemgtQ04NClVzZXItQWdlbnQ6IE1vemlsbGEvNS4wIChXaW5kb3dzIE5UIDEwLjA7IFdPVzY0OyBUcmlkZW50LzcuMDsgcnY6MTEuMCkgbGlrZSBHZWNrbw0KQWNjZXB0LUVuY29kaW5nOiBnemlwLCBkZWZsYXRlDQpIb3N0OiBpbWcuYWxpY2RuLmNvbQ0KQ29ubmVjdGlvbjogS2VlcC1BbGl2ZQ0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
    </HTTPRequest>
    <HTTPResponse>
      <contentLenght>22268</contentLenght>
      <HTTPHeaders>
        <HTTPHeaderEntity name="Server" index="0">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VGVuZ2luZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Type" index="1">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>aW1hZ2UvanBlZw==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Content-Length" index="2">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MjIyNjg=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Connection" index="3">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>a2VlcC1hbGl2ZQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Date" index="4">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAyOSBBcHIgMjAxOSAwNTowMToyNSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="x-tb-traceid" index="5">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NzRjZjY0YTcxNTU2NTE0MDg1NjIwNzA3M2U=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="last-modified" index="6">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAyOSBBcHIgMjAxOSAwMzo1MjoxNCBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Expires" index="7">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>VHVlLCAyOCBBcHIgMjAyMCAwNTowMToyNSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Cache-Control" index="8">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>bWF4LWFnZT0zMTUzNjAwMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Ali-Swift-Global-Savetime" index="9">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MTU1NjUxNDA4NQ==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Via" index="10">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Y2FjaGUxOS5sMm5lMVsxOCwyMDAtMCxNXSwgY2FjaGUyNi5sMm5lMVsxOCwwXSwgY2FjaGUxNi5jbjEyNDBbMCwyMDAtMCxIXSwgY2FjaGU4LmNuMTI0MFsxLDBd</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Access-Control-Allow-Origin" index="11">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Age" index="12">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MzgyMjkwMA==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Cache" index="13">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SElUIFRDUF9ISVQgZGlybjoxMjo4MzMwNDA5MzE=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-SaveTime" index="14">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>TW9uLCAyOSBBcHIgMjAxOSAwNTowMToyNSBHTVQ=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="X-Swift-CacheTime" index="15">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>MzE1MzYwMDA=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="Timing-Allow-Origin" index="16">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>Kg==</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPHeaderEntity name="EagleId" index="17">
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>NzRjZjY0OWMxNTYwMzM2OTg1MjY2MzgzMGU=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPHeaderEntity>
        <HTTPAllHeaders>
          <HTTPDataSet>
            <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
              <ActualData>SFRUUC8xLjEgMjAwIE9LDQpTZXJ2ZXI6IFRlbmdpbmUNCkNvbnRlbnQtVHlwZTogaW1hZ2UvanBlZw0KQ29udGVudC1MZW5ndGg6IDIyMjY4DQpDb25uZWN0aW9uOiBrZWVwLWFsaXZlDQpEYXRlOiBNb24sIDI5IEFwciAyMDE5IDA1OjAxOjI1IEdNVA0KeC10Yi10cmFjZWlkOiA3NGNmNjRhNzE1NTY1MTQwODU2MjA3MDczZQ0KbGFzdC1tb2RpZmllZDogTW9uLCAyOSBBcHIgMjAxOSAwMzo1MjoxNCBHTVQNCkV4cGlyZXM6IFR1ZSwgMjggQXByIDIwMjAgMDU6MDE6MjUgR01UDQpDYWNoZS1Db250cm9sOiBtYXgtYWdlPTMxNTM2MDAwDQpBbGktU3dpZnQtR2xvYmFsLVNhdmV0aW1lOiAxNTU2NTE0MDg1DQpWaWE6IGNhY2hlMTkubDJuZTFbMTgsMjAwLTAsTV0sIGNhY2hlMjYubDJuZTFbMTgsMF0sIGNhY2hlMTYuY24xMjQwWzAsMjAwLTAsSF0sIGNhY2hlOC5jbjEyNDBbMSwwXQ0KQWNjZXNzLUNvbnRyb2wtQWxsb3ctT3JpZ2luOiAqDQpBZ2U6IDM4MjI5MDANClgtQ2FjaGU6IEhJVCBUQ1BfSElUIGRpcm46MTI6ODMzMDQwOTMxDQpYLVN3aWZ0LVNhdmVUaW1lOiBNb24sIDI5IEFwciAyMDE5IDA1OjAxOjI1IEdNVA0KWC1Td2lmdC1DYWNoZVRpbWU6IDMxNTM2MDAwDQpUaW1pbmctQWxsb3ctT3JpZ2luOiAqDQpFYWdsZUlkOiA3NGNmNjQ5YzE1NjAzMzY5ODUyNjYzODMwZQ0KDQo=</ActualData>
            </HTTPData>
          </HTTPDataSet>
          <IsExternalData>false</IsExternalData>
        </HTTPAllHeaders>
      </HTTPHeaders>
      <HTTPBody>
        <HTTPDataSet>
          <HTTPData dataFilePath="" dfeDataType="Raw" sectionDataType="1">
            <ActualData>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</ActualData>
          </HTTPData>
        </HTTPDataSet>
        <IsExternalData>false</IsExternalData>
      </HTTPBody>
      <TcpPackets>
        <PacketInfo time="295843" offset="0" length="3024" />
        <PacketInfo time="295843" offset="3024" length="16384" />
        <PacketInfo time="295843" offset="19408" length="1136" />
        <PacketInfo time="295859" offset="20544" length="2395" />
      </TcpPackets>
    </HTTPResponse>
  </HTTPTask>
</HTTPSnapshot>